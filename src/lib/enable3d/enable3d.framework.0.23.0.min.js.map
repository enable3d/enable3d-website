{"version":3,"file":"enable3d.framework.0.23.0.min.js","mappings":"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","sources":["webpack://ENABLE3D/webpack/universalModuleDefinition","webpack://ENABLE3D/../ammoPhysics/node_modules/@yandeu/events/cjs/index.js","webpack://ENABLE3D/../ammoPhysics/node_modules/@yandeu/events/cjs/version.js","webpack://ENABLE3D/../common/node_modules/@yandeu/events/cjs/index.js","webpack://ENABLE3D/../common/node_modules/@yandeu/events/cjs/version.js","webpack://ENABLE3D/../threeGraphics/node_modules/@yandeu/events/cjs/index.js","webpack://ENABLE3D/../threeGraphics/node_modules/@yandeu/events/cjs/version.js","webpack://ENABLE3D/external \"Matter\"","webpack://ENABLE3D/external \"THREE\"","webpack://ENABLE3D/webpack/bootstrap","webpack://ENABLE3D/webpack/runtime/define property getters","webpack://ENABLE3D/webpack/runtime/hasOwnProperty shorthand","webpack://ENABLE3D/webpack/runtime/make namespace object","webpack://ENABLE3D/../threeGraphics/node_modules/three/examples/jsm/deprecated/Geometry.js","webpack://ENABLE3D/../threeWrapper/dist/deprecated/face3.js","webpack://ENABLE3D/../threeGraphics/node_modules/three/examples/jsm/loaders/SVGLoader.js","webpack://ENABLE3D/../threeGraphics/jsm/csg/_directGeometry.js","webpack://ENABLE3D/../threeGraphics/jsm/csg/_fromGeometry.js","webpack://ENABLE3D/../threeGraphics/jsm/plugins/transform.js","webpack://ENABLE3D/../threeGraphics/jsm/csg/index.js","webpack://ENABLE3D/../threeGraphics/node_modules/three/examples/jsm/libs/fflate.module.js","webpack://ENABLE3D/../threeGraphics/node_modules/three/examples/jsm/curves/NURBSUtils.js","webpack://ENABLE3D/../threeGraphics/node_modules/three/examples/jsm/curves/NURBSCurve.js","webpack://ENABLE3D/../threeGraphics/node_modules/three/examples/jsm/loaders/FBXLoader.js","webpack://ENABLE3D/../threeGraphics/node_modules/three/examples/jsm/loaders/GLTFLoader.js","webpack://ENABLE3D/../threeGraphics/jsm/plugins/loaders.js","webpack://ENABLE3D/../threeGraphics/jsm/plugins/lights.js","webpack://ENABLE3D/../common/dist/extendedMesh.js","webpack://ENABLE3D/../common/dist/logger.js","webpack://ENABLE3D/../common/dist/defaultMaterial.js","webpack://ENABLE3D/../common/dist/factories.js","webpack://ENABLE3D/../threeGraphics/jsm/plugins/heightmap.js","webpack://ENABLE3D/../threeGraphics/node_modules/three/examples/jsm/controls/OrbitControls.js","webpack://ENABLE3D/../threeGraphics/jsm/plugins/warpSpeed.js","webpack://ENABLE3D/../threeGraphics/node_modules/three/examples/jsm/objects/Reflector.js","webpack://ENABLE3D/../threeGraphics/node_modules/three/examples/jsm/objects/Refractor.js","webpack://ENABLE3D/../threeGraphics/node_modules/three/examples/jsm/objects/Water2.js","webpack://ENABLE3D/../threeGraphics/jsm/plugins/misc.js","webpack://ENABLE3D/../threeGraphics/jsm/plugins/water.js","webpack://ENABLE3D/../threeGraphics/node_modules/three/examples/jsm/libs/motion-controllers.module.js","webpack://ENABLE3D/../threeGraphics/node_modules/three/examples/jsm/webxr/XRControllerModelFactory.js","webpack://ENABLE3D/../threeGraphics/jsm/plugins/webxr.js","webpack://ENABLE3D/../threeGraphics/node_modules/three/examples/jsm/webxr/VRButton.js","webpack://ENABLE3D/../threeGraphics/jsm/plugins/cameras.js","webpack://ENABLE3D/./src/scene3d.ts","webpack://ENABLE3D/../threeGraphics/jsm/plugins/mixers.js","webpack://ENABLE3D/../threeGraphics/jsm/plugins/haveSomeFun.js","webpack://ENABLE3D/../common/dist/extendedObject3D.js","webpack://ENABLE3D/../common/dist/extendedGroup.js","webpack://ENABLE3D/../ammoPhysics/dist/constraints.js","webpack://ENABLE3D/../ammoPhysics/dist/three-to-ammo.js","webpack://ENABLE3D/../ammoPhysics/dist/collisionEvents.js","webpack://ENABLE3D/../ammoPhysics/dist/debugDrawer.js","webpack://ENABLE3D/../ammoPhysics/node_modules/three/examples/jsm/math/ConvexHull.js","webpack://ENABLE3D/../ammoPhysics/node_modules/three/examples/jsm/geometries/ConvexGeometry.js","webpack://ENABLE3D/../ammoPhysics/dist/convexObjectBreaker.js","webpack://ENABLE3D/../common/dist/wasmLoader.js","webpack://ENABLE3D/../common/dist/physicsLoader.js","webpack://ENABLE3D/../common/dist/applyMixins.js","webpack://ENABLE3D/../ammoPhysics/dist/raycaster/raycaster.js","webpack://ENABLE3D/../ammoPhysics/dist/raycaster/closestRayResultCallback.js","webpack://ENABLE3D/../ammoPhysics/dist/raycaster/allHitsRayResultCallback.js","webpack://ENABLE3D/../ammoPhysics/dist/physics.js","webpack://ENABLE3D/../ammoPhysics/dist/shapes.js","webpack://ENABLE3D/../ammoPhysics/dist/torusShape.js","webpack://ENABLE3D/../common/dist/physicsBody.js","webpack://ENABLE3D/../threeGraphics/jsm/index.js","webpack://ENABLE3D/./src/project.ts","webpack://ENABLE3D/../threeGraphics/jsm/core.js","webpack://ENABLE3D/../threeGraphics/node_modules/@yandeu/tap/lib/eventMatrix.js","webpack://ENABLE3D/../threeGraphics/node_modules/@yandeu/tap/lib/index.js","webpack://ENABLE3D/../threeGraphics/node_modules/@yandeu/tap/lib/version.js","webpack://ENABLE3D/../threeGraphics/jsm/flat/_misc.js","webpack://ENABLE3D/../threeGraphics/jsm/flat/simpleSprite.js","webpack://ENABLE3D/../threeGraphics/jsm/flat/actionSprite.js","webpack://ENABLE3D/../threeGraphics/jsm/flat/spriteSheet.js","webpack://ENABLE3D/../threeGraphics/jsm/flat/button.js","webpack://ENABLE3D/../threeGraphics/jsm/flat/draw.js","webpack://ENABLE3D/../threeGraphics/jsm/flat/flat.js","webpack://ENABLE3D/../threeGraphics/jsm/flat/text.js","webpack://ENABLE3D/../threeGraphics/jsm/flat/textureAtlas.js","webpack://ENABLE3D/../threeGraphics/jsm/flat/physics/_misc.js","webpack://ENABLE3D/../threeGraphics/jsm/flat/physics/physics.js","webpack://ENABLE3D/../common/dist/misc/joystick.js","webpack://ENABLE3D/../common/dist/misc/thirdPersonControls.js","webpack://ENABLE3D/../common/dist/misc/firstPersonControls.js","webpack://ENABLE3D/../common/dist/misc/pointerLock.js","webpack://ENABLE3D/../common/dist/misc/pointerDrag.js","webpack://ENABLE3D/../../node_modules/three/examples/jsm/shaders/CopyShader.js","webpack://ENABLE3D/../../node_modules/three/examples/jsm/postprocessing/Pass.js","webpack://ENABLE3D/../../node_modules/three/examples/jsm/postprocessing/ShaderPass.js","webpack://ENABLE3D/../../node_modules/three/examples/jsm/postprocessing/MaskPass.js","webpack://ENABLE3D/../../node_modules/three/examples/jsm/postprocessing/EffectComposer.js","webpack://ENABLE3D/../../node_modules/three/examples/jsm/postprocessing/RenderPass.js","webpack://ENABLE3D/../../node_modules/three/examples/jsm/shaders/DigitalGlitch.js","webpack://ENABLE3D/../../node_modules/three/examples/jsm/postprocessing/GlitchPass.js","webpack://ENABLE3D/../../node_modules/three/examples/jsm/shaders/DotScreenShader.js"],"sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory(require(\"THREE\"), require(\"Matter\"));\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([\"THREE\", \"Matter\"], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"ENABLE3D\"] = factory(require(\"THREE\"), require(\"Matter\"));\n\telse\n\t\troot[\"ENABLE3D\"] = factory(root[\"THREE\"], root[\"Matter\"]);\n})(self, function(__WEBPACK_EXTERNAL_MODULE__428__, __WEBPACK_EXTERNAL_MODULE__626__) {\nreturn ","\"use strict\";\r\n/**\r\n * @package      npmjs.com/package/@yandeu/events (events.min.js)\r\n *\r\n * @author       Arnout Kazemier (https://github.com/3rd-Eden)\r\n * @copyright    Copyright (c) 2014 Arnout Kazemier\r\n * @license      {@link https://github.com/primus/eventemitter3/blob/master/LICENSE|MIT}\r\n *\r\n * @author       Yannick Deubel (https://github.com/yandeu)\r\n * @copyright    Copyright (c) 2021 Yannick Deubel; Project Url: https://github.com/yandeu/events\r\n * @license      {@link https://github.com/yandeu/events/blob/master/LICENSE|MIT}\r\n */\r\nvar __spreadArray = (this && this.__spreadArray) || function (to, from) {\r\n    for (var i = 0, il = from.length, j = to.length; i < il; i++, j++)\r\n        to[j] = from[i];\r\n    return to;\r\n};\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.Events = void 0;\r\nvar version_1 = require(\"./version\");\r\nvar EE = /** @class */ (function () {\r\n    function EE(fn, context, once) {\r\n        if (once === void 0) { once = false; }\r\n        this.fn = fn;\r\n        this.context = context;\r\n        this.once = once;\r\n    }\r\n    return EE;\r\n}());\r\nvar addListener = function (emitter, event, fn, context, once) {\r\n    if (typeof fn !== 'function') {\r\n        throw new TypeError('The listener must be a function');\r\n    }\r\n    var listener = new EE(fn, context || emitter, once);\r\n    if (!emitter._events.has(event))\r\n        emitter._events.set(event, listener), emitter._eventsCount++;\r\n    else if (!emitter._events.get(event).fn)\r\n        emitter._events.get(event).push(listener);\r\n    else\r\n        emitter._events.set(event, [emitter._events.get(event), listener]);\r\n    return emitter;\r\n};\r\nvar clearEvent = function (emitter, event) {\r\n    if (--emitter._eventsCount === 0)\r\n        emitter._events = new Map();\r\n    else\r\n        emitter._events.delete(event);\r\n};\r\nvar Events = /** @class */ (function () {\r\n    function Events() {\r\n        this._events = new Map();\r\n        this._eventsCount = 0;\r\n    }\r\n    Object.defineProperty(Events, \"VERSION\", {\r\n        get: function () {\r\n            return version_1.VERSION;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Events.prototype.eventNames = function () {\r\n        return Array.from(this._events.keys());\r\n    };\r\n    Events.prototype.listeners = function (event) {\r\n        var handlers = this._events.get(event);\r\n        if (!handlers)\r\n            return [];\r\n        if (handlers.fn)\r\n            return [handlers.fn];\r\n        for (var i = 0, l = handlers.length, ee = new Array(l); i < l; i++) {\r\n            ee[i] = handlers[i].fn;\r\n        }\r\n        return ee;\r\n    };\r\n    Events.prototype.listenerCount = function (event) {\r\n        var listeners = this._events.get(event);\r\n        if (!listeners)\r\n            return 0;\r\n        if (listeners.fn)\r\n            return 1;\r\n        return listeners.length;\r\n    };\r\n    Events.prototype.emit = function (event) {\r\n        var _a, _b;\r\n        var args = [];\r\n        for (var _i = 1; _i < arguments.length; _i++) {\r\n            args[_i - 1] = arguments[_i];\r\n        }\r\n        if (!this._events.has(event))\r\n            return false;\r\n        var listeners = this._events.get(event);\r\n        var i;\r\n        if (listeners.fn) {\r\n            if (listeners.once)\r\n                this.removeListener(event, listeners.fn, undefined, true);\r\n            return (_a = listeners.fn).call.apply(_a, __spreadArray([listeners.context], args)), true;\r\n        }\r\n        else {\r\n            var length_1 = listeners.length;\r\n            for (i = 0; i < length_1; i++) {\r\n                if (listeners[i].once)\r\n                    this.removeListener(event, listeners[i].fn, undefined, true);\r\n                (_b = listeners[i].fn).call.apply(_b, __spreadArray([listeners[i].context], args));\r\n            }\r\n        }\r\n        return true;\r\n    };\r\n    Events.prototype.on = function (event, fn, context) {\r\n        return addListener(this, event, fn, context, false);\r\n    };\r\n    Events.prototype.once = function (event, fn, context) {\r\n        return addListener(this, event, fn, context, true);\r\n    };\r\n    Events.prototype.removeListener = function (event, fn, context, once) {\r\n        if (!this._events.has(event))\r\n            return this;\r\n        if (!fn) {\r\n            clearEvent(this, event);\r\n            return this;\r\n        }\r\n        var listeners = this._events.get(event);\r\n        if (listeners.fn) {\r\n            if (listeners.fn === fn && (!once || listeners.once) && (!context || listeners.context === context)) {\r\n                clearEvent(this, event);\r\n            }\r\n        }\r\n        else {\r\n            for (var i = 0, events = [], length = listeners.length; i < length; i++) {\r\n                if (listeners[i].fn !== fn || (once && !listeners[i].once) || (context && listeners[i].context !== context)) {\r\n                    events.push(listeners[i]);\r\n                }\r\n            }\r\n            // Reset the array, or remove it completely if we have no more listeners.\r\n            if (events.length)\r\n                this._events.set(event, events.length === 1 ? events[0] : events);\r\n            else\r\n                clearEvent(this, event);\r\n        }\r\n        return this;\r\n    };\r\n    Events.prototype.removeAllListeners = function (event) {\r\n        if (event) {\r\n            if (this._events.delete(event))\r\n                clearEvent(this, event);\r\n        }\r\n        else {\r\n            this._events = new Map();\r\n            this._eventsCount = 0;\r\n        }\r\n        return this;\r\n    };\r\n    Object.defineProperty(Events.prototype, \"off\", {\r\n        // alias\r\n        get: function () {\r\n            return this.removeListener;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Events.prototype, \"addListener\", {\r\n        // alias\r\n        get: function () {\r\n            return this.on;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    return Events;\r\n}());\r\nexports.Events = Events;\r\n/** TESTING SECTION */\r\n// type Colors = 'red' | 'blue' | 'yellow'\r\n// interface EventMap {\r\n//   signal: () => void\r\n//   error: (err: string) => void\r\n//   something: (a: number, b: { colors?: Colors[] }, c: [number, number, string]) => void\r\n// }\r\n// const test = new Events<EventMap>()\r\n// const listener: EventListener<EventMap, 'something'> = (a, b, c) => {\r\n//   console.log(a, b.colors, c)\r\n// }\r\n// test.on('something', listener)\r\n// setTimeout(() => {\r\n//   test.removeListener('something', listener)\r\n// }, 5000)\r\n// test.once('error', err => {\r\n//   console.log('error:', err)\r\n// })\r\n// console.log(test.eventNames())\r\n// test.emit('error', 'ok')\r\n// test.emit('error', 'failed')\r\n// test.emit('something', 1234, { colors: ['blue'] }, [3, 3, 'k'])\r\n//# sourceMappingURL=index.js.map","\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.VERSION = void 0;\r\n// THIS IS AN AUTOGENERATED FILE. DO NOT EDIT THIS FILE DIRECTLY.\r\nexports.VERSION = \"0.0.5\";\r\n//# sourceMappingURL=version.js.map","\"use strict\";\r\n/**\r\n * @package      npmjs.com/package/@yandeu/events (events.min.js)\r\n *\r\n * @author       Arnout Kazemier (https://github.com/3rd-Eden)\r\n * @copyright    Copyright (c) 2014 Arnout Kazemier\r\n * @license      {@link https://github.com/primus/eventemitter3/blob/master/LICENSE|MIT}\r\n *\r\n * @author       Yannick Deubel (https://github.com/yandeu)\r\n * @copyright    Copyright (c) 2021 Yannick Deubel; Project Url: https://github.com/yandeu/events\r\n * @license      {@link https://github.com/yandeu/events/blob/master/LICENSE|MIT}\r\n */\r\nvar __spreadArray = (this && this.__spreadArray) || function (to, from) {\r\n    for (var i = 0, il = from.length, j = to.length; i < il; i++, j++)\r\n        to[j] = from[i];\r\n    return to;\r\n};\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.Events = void 0;\r\nvar version_1 = require(\"./version\");\r\nvar EE = /** @class */ (function () {\r\n    function EE(fn, context, once) {\r\n        if (once === void 0) { once = false; }\r\n        this.fn = fn;\r\n        this.context = context;\r\n        this.once = once;\r\n    }\r\n    return EE;\r\n}());\r\nvar addListener = function (emitter, event, fn, context, once) {\r\n    if (typeof fn !== 'function') {\r\n        throw new TypeError('The listener must be a function');\r\n    }\r\n    var listener = new EE(fn, context || emitter, once);\r\n    if (!emitter._events.has(event))\r\n        emitter._events.set(event, listener), emitter._eventsCount++;\r\n    else if (!emitter._events.get(event).fn)\r\n        emitter._events.get(event).push(listener);\r\n    else\r\n        emitter._events.set(event, [emitter._events.get(event), listener]);\r\n    return emitter;\r\n};\r\nvar clearEvent = function (emitter, event) {\r\n    if (--emitter._eventsCount === 0)\r\n        emitter._events = new Map();\r\n    else\r\n        emitter._events.delete(event);\r\n};\r\nvar Events = /** @class */ (function () {\r\n    function Events() {\r\n        this._events = new Map();\r\n        this._eventsCount = 0;\r\n    }\r\n    Object.defineProperty(Events, \"VERSION\", {\r\n        get: function () {\r\n            return version_1.VERSION;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Events.prototype.eventNames = function () {\r\n        return Array.from(this._events.keys());\r\n    };\r\n    Events.prototype.listeners = function (event) {\r\n        var handlers = this._events.get(event);\r\n        if (!handlers)\r\n            return [];\r\n        if (handlers.fn)\r\n            return [handlers.fn];\r\n        for (var i = 0, l = handlers.length, ee = new Array(l); i < l; i++) {\r\n            ee[i] = handlers[i].fn;\r\n        }\r\n        return ee;\r\n    };\r\n    Events.prototype.listenerCount = function (event) {\r\n        var listeners = this._events.get(event);\r\n        if (!listeners)\r\n            return 0;\r\n        if (listeners.fn)\r\n            return 1;\r\n        return listeners.length;\r\n    };\r\n    Events.prototype.emit = function (event) {\r\n        var _a, _b;\r\n        var args = [];\r\n        for (var _i = 1; _i < arguments.length; _i++) {\r\n            args[_i - 1] = arguments[_i];\r\n        }\r\n        if (!this._events.has(event))\r\n            return false;\r\n        var listeners = this._events.get(event);\r\n        var i;\r\n        if (listeners.fn) {\r\n            if (listeners.once)\r\n                this.removeListener(event, listeners.fn, undefined, true);\r\n            return (_a = listeners.fn).call.apply(_a, __spreadArray([listeners.context], args)), true;\r\n        }\r\n        else {\r\n            var length_1 = listeners.length;\r\n            for (i = 0; i < length_1; i++) {\r\n                if (listeners[i].once)\r\n                    this.removeListener(event, listeners[i].fn, undefined, true);\r\n                (_b = listeners[i].fn).call.apply(_b, __spreadArray([listeners[i].context], args));\r\n            }\r\n        }\r\n        return true;\r\n    };\r\n    Events.prototype.on = function (event, fn, context) {\r\n        return addListener(this, event, fn, context, false);\r\n    };\r\n    Events.prototype.once = function (event, fn, context) {\r\n        return addListener(this, event, fn, context, true);\r\n    };\r\n    Events.prototype.removeListener = function (event, fn, context, once) {\r\n        if (!this._events.has(event))\r\n            return this;\r\n        if (!fn) {\r\n            clearEvent(this, event);\r\n            return this;\r\n        }\r\n        var listeners = this._events.get(event);\r\n        if (listeners.fn) {\r\n            if (listeners.fn === fn && (!once || listeners.once) && (!context || listeners.context === context)) {\r\n                clearEvent(this, event);\r\n            }\r\n        }\r\n        else {\r\n            for (var i = 0, events = [], length = listeners.length; i < length; i++) {\r\n                if (listeners[i].fn !== fn || (once && !listeners[i].once) || (context && listeners[i].context !== context)) {\r\n                    events.push(listeners[i]);\r\n                }\r\n            }\r\n            // Reset the array, or remove it completely if we have no more listeners.\r\n            if (events.length)\r\n                this._events.set(event, events.length === 1 ? events[0] : events);\r\n            else\r\n                clearEvent(this, event);\r\n        }\r\n        return this;\r\n    };\r\n    Events.prototype.removeAllListeners = function (event) {\r\n        if (event) {\r\n            if (this._events.delete(event))\r\n                clearEvent(this, event);\r\n        }\r\n        else {\r\n            this._events = new Map();\r\n            this._eventsCount = 0;\r\n        }\r\n        return this;\r\n    };\r\n    Object.defineProperty(Events.prototype, \"off\", {\r\n        // alias\r\n        get: function () {\r\n            return this.removeListener;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Events.prototype, \"addListener\", {\r\n        // alias\r\n        get: function () {\r\n            return this.on;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    return Events;\r\n}());\r\nexports.Events = Events;\r\n/** TESTING SECTION */\r\n// type Colors = 'red' | 'blue' | 'yellow'\r\n// interface EventMap {\r\n//   signal: () => void\r\n//   error: (err: string) => void\r\n//   something: (a: number, b: { colors?: Colors[] }, c: [number, number, string]) => void\r\n// }\r\n// const test = new Events<EventMap>()\r\n// const listener: EventListener<EventMap, 'something'> = (a, b, c) => {\r\n//   console.log(a, b.colors, c)\r\n// }\r\n// test.on('something', listener)\r\n// setTimeout(() => {\r\n//   test.removeListener('something', listener)\r\n// }, 5000)\r\n// test.once('error', err => {\r\n//   console.log('error:', err)\r\n// })\r\n// console.log(test.eventNames())\r\n// test.emit('error', 'ok')\r\n// test.emit('error', 'failed')\r\n// test.emit('something', 1234, { colors: ['blue'] }, [3, 3, 'k'])\r\n//# sourceMappingURL=index.js.map","\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.VERSION = void 0;\r\n// THIS IS AN AUTOGENERATED FILE. DO NOT EDIT THIS FILE DIRECTLY.\r\nexports.VERSION = \"0.0.5\";\r\n//# sourceMappingURL=version.js.map","\"use strict\";\r\n/**\r\n * @package      npmjs.com/package/@yandeu/events (events.min.js)\r\n *\r\n * @author       Arnout Kazemier (https://github.com/3rd-Eden)\r\n * @copyright    Copyright (c) 2014 Arnout Kazemier\r\n * @license      {@link https://github.com/primus/eventemitter3/blob/master/LICENSE|MIT}\r\n *\r\n * @author       Yannick Deubel (https://github.com/yandeu)\r\n * @copyright    Copyright (c) 2021 Yannick Deubel; Project Url: https://github.com/yandeu/events\r\n * @license      {@link https://github.com/yandeu/events/blob/master/LICENSE|MIT}\r\n */\r\nvar __spreadArray = (this && this.__spreadArray) || function (to, from) {\r\n    for (var i = 0, il = from.length, j = to.length; i < il; i++, j++)\r\n        to[j] = from[i];\r\n    return to;\r\n};\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.Events = void 0;\r\nvar version_1 = require(\"./version\");\r\nvar EE = /** @class */ (function () {\r\n    function EE(fn, context, once) {\r\n        if (once === void 0) { once = false; }\r\n        this.fn = fn;\r\n        this.context = context;\r\n        this.once = once;\r\n    }\r\n    return EE;\r\n}());\r\nvar addListener = function (emitter, event, fn, context, once) {\r\n    if (typeof fn !== 'function') {\r\n        throw new TypeError('The listener must be a function');\r\n    }\r\n    var listener = new EE(fn, context || emitter, once);\r\n    if (!emitter._events.has(event))\r\n        emitter._events.set(event, listener), emitter._eventsCount++;\r\n    else if (!emitter._events.get(event).fn)\r\n        emitter._events.get(event).push(listener);\r\n    else\r\n        emitter._events.set(event, [emitter._events.get(event), listener]);\r\n    return emitter;\r\n};\r\nvar clearEvent = function (emitter, event) {\r\n    if (--emitter._eventsCount === 0)\r\n        emitter._events = new Map();\r\n    else\r\n        emitter._events.delete(event);\r\n};\r\nvar Events = /** @class */ (function () {\r\n    function Events() {\r\n        this._events = new Map();\r\n        this._eventsCount = 0;\r\n    }\r\n    Object.defineProperty(Events, \"VERSION\", {\r\n        get: function () {\r\n            return version_1.VERSION;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Events.prototype.eventNames = function () {\r\n        return Array.from(this._events.keys());\r\n    };\r\n    Events.prototype.listeners = function (event) {\r\n        var handlers = this._events.get(event);\r\n        if (!handlers)\r\n            return [];\r\n        if (handlers.fn)\r\n            return [handlers.fn];\r\n        for (var i = 0, l = handlers.length, ee = new Array(l); i < l; i++) {\r\n            ee[i] = handlers[i].fn;\r\n        }\r\n        return ee;\r\n    };\r\n    Events.prototype.listenerCount = function (event) {\r\n        var listeners = this._events.get(event);\r\n        if (!listeners)\r\n            return 0;\r\n        if (listeners.fn)\r\n            return 1;\r\n        return listeners.length;\r\n    };\r\n    Events.prototype.emit = function (event) {\r\n        var _a, _b;\r\n        var args = [];\r\n        for (var _i = 1; _i < arguments.length; _i++) {\r\n            args[_i - 1] = arguments[_i];\r\n        }\r\n        if (!this._events.has(event))\r\n            return false;\r\n        var listeners = this._events.get(event);\r\n        var i;\r\n        if (listeners.fn) {\r\n            if (listeners.once)\r\n                this.removeListener(event, listeners.fn, undefined, true);\r\n            return (_a = listeners.fn).call.apply(_a, __spreadArray([listeners.context], args)), true;\r\n        }\r\n        else {\r\n            var length_1 = listeners.length;\r\n            for (i = 0; i < length_1; i++) {\r\n                if (listeners[i].once)\r\n                    this.removeListener(event, listeners[i].fn, undefined, true);\r\n                (_b = listeners[i].fn).call.apply(_b, __spreadArray([listeners[i].context], args));\r\n            }\r\n        }\r\n        return true;\r\n    };\r\n    Events.prototype.on = function (event, fn, context) {\r\n        return addListener(this, event, fn, context, false);\r\n    };\r\n    Events.prototype.once = function (event, fn, context) {\r\n        return addListener(this, event, fn, context, true);\r\n    };\r\n    Events.prototype.removeListener = function (event, fn, context, once) {\r\n        if (!this._events.has(event))\r\n            return this;\r\n        if (!fn) {\r\n            clearEvent(this, event);\r\n            return this;\r\n        }\r\n        var listeners = this._events.get(event);\r\n        if (listeners.fn) {\r\n            if (listeners.fn === fn && (!once || listeners.once) && (!context || listeners.context === context)) {\r\n                clearEvent(this, event);\r\n            }\r\n        }\r\n        else {\r\n            for (var i = 0, events = [], length = listeners.length; i < length; i++) {\r\n                if (listeners[i].fn !== fn || (once && !listeners[i].once) || (context && listeners[i].context !== context)) {\r\n                    events.push(listeners[i]);\r\n                }\r\n            }\r\n            // Reset the array, or remove it completely if we have no more listeners.\r\n            if (events.length)\r\n                this._events.set(event, events.length === 1 ? events[0] : events);\r\n            else\r\n                clearEvent(this, event);\r\n        }\r\n        return this;\r\n    };\r\n    Events.prototype.removeAllListeners = function (event) {\r\n        if (event) {\r\n            if (this._events.delete(event))\r\n                clearEvent(this, event);\r\n        }\r\n        else {\r\n            this._events = new Map();\r\n            this._eventsCount = 0;\r\n        }\r\n        return this;\r\n    };\r\n    Object.defineProperty(Events.prototype, \"off\", {\r\n        // alias\r\n        get: function () {\r\n            return this.removeListener;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Events.prototype, \"addListener\", {\r\n        // alias\r\n        get: function () {\r\n            return this.on;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    return Events;\r\n}());\r\nexports.Events = Events;\r\n/** TESTING SECTION */\r\n// type Colors = 'red' | 'blue' | 'yellow'\r\n// interface EventMap {\r\n//   signal: () => void\r\n//   error: (err: string) => void\r\n//   something: (a: number, b: { colors?: Colors[] }, c: [number, number, string]) => void\r\n// }\r\n// const test = new Events<EventMap>()\r\n// const listener: EventListener<EventMap, 'something'> = (a, b, c) => {\r\n//   console.log(a, b.colors, c)\r\n// }\r\n// test.on('something', listener)\r\n// setTimeout(() => {\r\n//   test.removeListener('something', listener)\r\n// }, 5000)\r\n// test.once('error', err => {\r\n//   console.log('error:', err)\r\n// })\r\n// console.log(test.eventNames())\r\n// test.emit('error', 'ok')\r\n// test.emit('error', 'failed')\r\n// test.emit('something', 1234, { colors: ['blue'] }, [3, 3, 'k'])\r\n//# sourceMappingURL=index.js.map","\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.VERSION = void 0;\r\n// THIS IS AN AUTOGENERATED FILE. DO NOT EDIT THIS FILE DIRECTLY.\r\nexports.VERSION = \"0.0.5\";\r\n//# sourceMappingURL=version.js.map","module.exports = __WEBPACK_EXTERNAL_MODULE__626__;","module.exports = __WEBPACK_EXTERNAL_MODULE__428__;","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","import {\n\tBox3,\n\tBufferAttribute,\n\tBufferGeometry,\n\tColor,\n\tEventDispatcher,\n\tFloat32BufferAttribute,\n\tMatrix3,\n\tMatrix4,\n\tMathUtils,\n\tObject3D,\n\tSphere,\n\tVector2,\n\tVector3\n} from 'three';\n\nconst _m1 = new Matrix4();\nconst _obj = new Object3D();\nconst _offset = new Vector3();\n\nclass Geometry extends EventDispatcher {\n\n\tconstructor() {\n\n\t\tsuper();\n\n\t\tthis.uuid = MathUtils.generateUUID();\n\n\t\tthis.name = '';\n\t\tthis.type = 'Geometry';\n\n\t\tthis.vertices = [];\n\t\tthis.colors = [];\n\t\tthis.faces = [];\n\t\tthis.faceVertexUvs = [[]];\n\n\t\tthis.morphTargets = [];\n\t\tthis.morphNormals = [];\n\n\t\tthis.skinWeights = [];\n\t\tthis.skinIndices = [];\n\n\t\tthis.lineDistances = [];\n\n\t\tthis.boundingBox = null;\n\t\tthis.boundingSphere = null;\n\n\t\t// update flags\n\n\t\tthis.elementsNeedUpdate = false;\n\t\tthis.verticesNeedUpdate = false;\n\t\tthis.uvsNeedUpdate = false;\n\t\tthis.normalsNeedUpdate = false;\n\t\tthis.colorsNeedUpdate = false;\n\t\tthis.lineDistancesNeedUpdate = false;\n\t\tthis.groupsNeedUpdate = false;\n\n\t}\n\n\tapplyMatrix4( matrix ) {\n\n\t\tconst normalMatrix = new Matrix3().getNormalMatrix( matrix );\n\n\t\tfor ( let i = 0, il = this.vertices.length; i < il; i ++ ) {\n\n\t\t\tconst vertex = this.vertices[ i ];\n\t\t\tvertex.applyMatrix4( matrix );\n\n\t\t}\n\n\t\tfor ( let i = 0, il = this.faces.length; i < il; i ++ ) {\n\n\t\t\tconst face = this.faces[ i ];\n\t\t\tface.normal.applyMatrix3( normalMatrix ).normalize();\n\n\t\t\tfor ( let j = 0, jl = face.vertexNormals.length; j < jl; j ++ ) {\n\n\t\t\t\tface.vertexNormals[ j ].applyMatrix3( normalMatrix ).normalize();\n\n\t\t\t}\n\n\t\t}\n\n\t\tif ( this.boundingBox !== null ) {\n\n\t\t\tthis.computeBoundingBox();\n\n\t\t}\n\n\t\tif ( this.boundingSphere !== null ) {\n\n\t\t\tthis.computeBoundingSphere();\n\n\t\t}\n\n\t\tthis.verticesNeedUpdate = true;\n\t\tthis.normalsNeedUpdate = true;\n\n\t\treturn this;\n\n\t}\n\n\trotateX( angle ) {\n\n\t\t// rotate geometry around world x-axis\n\n\t\t_m1.makeRotationX( angle );\n\n\t\tthis.applyMatrix4( _m1 );\n\n\t\treturn this;\n\n\t}\n\n\trotateY( angle ) {\n\n\t\t// rotate geometry around world y-axis\n\n\t\t_m1.makeRotationY( angle );\n\n\t\tthis.applyMatrix4( _m1 );\n\n\t\treturn this;\n\n\t}\n\n\trotateZ( angle ) {\n\n\t\t// rotate geometry around world z-axis\n\n\t\t_m1.makeRotationZ( angle );\n\n\t\tthis.applyMatrix4( _m1 );\n\n\t\treturn this;\n\n\t}\n\n\ttranslate( x, y, z ) {\n\n\t\t// translate geometry\n\n\t\t_m1.makeTranslation( x, y, z );\n\n\t\tthis.applyMatrix4( _m1 );\n\n\t\treturn this;\n\n\t}\n\n\tscale( x, y, z ) {\n\n\t\t// scale geometry\n\n\t\t_m1.makeScale( x, y, z );\n\n\t\tthis.applyMatrix4( _m1 );\n\n\t\treturn this;\n\n\t}\n\n\tlookAt( vector ) {\n\n\t\t_obj.lookAt( vector );\n\n\t\t_obj.updateMatrix();\n\n\t\tthis.applyMatrix4( _obj.matrix );\n\n\t\treturn this;\n\n\t}\n\n\tfromBufferGeometry( geometry ) {\n\n\t\tconst scope = this;\n\n\t\tconst index = geometry.index !== null ? geometry.index : undefined;\n\t\tconst attributes = geometry.attributes;\n\n\t\tif ( attributes.position === undefined ) {\n\n\t\t\tconsole.error( 'THREE.Geometry.fromBufferGeometry(): Position attribute required for conversion.' );\n\t\t\treturn this;\n\n\t\t}\n\n\t\tconst position = attributes.position;\n\t\tconst normal = attributes.normal;\n\t\tconst color = attributes.color;\n\t\tconst uv = attributes.uv;\n\t\tconst uv2 = attributes.uv2;\n\n\t\tif ( uv2 !== undefined ) this.faceVertexUvs[ 1 ] = [];\n\n\t\tfor ( let i = 0; i < position.count; i ++ ) {\n\n\t\t\tscope.vertices.push( new Vector3().fromBufferAttribute( position, i ) );\n\n\t\t\tif ( color !== undefined ) {\n\n\t\t\t\tscope.colors.push( new Color().fromBufferAttribute( color, i ) );\n\n\t\t\t}\n\n\t\t}\n\n\t\tfunction addFace( a, b, c, materialIndex ) {\n\n\t\t\tconst vertexColors = ( color === undefined ) ? [] : [\n\t\t\t\tscope.colors[ a ].clone(),\n\t\t\t\tscope.colors[ b ].clone(),\n\t\t\t\tscope.colors[ c ].clone()\n\t\t\t];\n\n\t\t\tconst vertexNormals = ( normal === undefined ) ? [] : [\n\t\t\t\tnew Vector3().fromBufferAttribute( normal, a ),\n\t\t\t\tnew Vector3().fromBufferAttribute( normal, b ),\n\t\t\t\tnew Vector3().fromBufferAttribute( normal, c )\n\t\t\t];\n\n\t\t\tconst face = new Face3( a, b, c, vertexNormals, vertexColors, materialIndex );\n\n\t\t\tscope.faces.push( face );\n\n\t\t\tif ( uv !== undefined ) {\n\n\t\t\t\tscope.faceVertexUvs[ 0 ].push( [\n\t\t\t\t\tnew Vector2().fromBufferAttribute( uv, a ),\n\t\t\t\t\tnew Vector2().fromBufferAttribute( uv, b ),\n\t\t\t\t\tnew Vector2().fromBufferAttribute( uv, c )\n\t\t\t\t] );\n\n\t\t\t}\n\n\t\t\tif ( uv2 !== undefined ) {\n\n\t\t\t\tscope.faceVertexUvs[ 1 ].push( [\n\t\t\t\t\tnew Vector2().fromBufferAttribute( uv2, a ),\n\t\t\t\t\tnew Vector2().fromBufferAttribute( uv2, b ),\n\t\t\t\t\tnew Vector2().fromBufferAttribute( uv2, c )\n\t\t\t\t] );\n\n\t\t\t}\n\n\t\t}\n\n\t\tconst groups = geometry.groups;\n\n\t\tif ( groups.length > 0 ) {\n\n\t\t\tfor ( let i = 0; i < groups.length; i ++ ) {\n\n\t\t\t\tconst group = groups[ i ];\n\n\t\t\t\tconst start = group.start;\n\t\t\t\tconst count = group.count;\n\n\t\t\t\tfor ( let j = start, jl = start + count; j < jl; j += 3 ) {\n\n\t\t\t\t\tif ( index !== undefined ) {\n\n\t\t\t\t\t\taddFace( index.getX( j ), index.getX( j + 1 ), index.getX( j + 2 ), group.materialIndex );\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\taddFace( j, j + 1, j + 2, group.materialIndex );\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t} else {\n\n\t\t\tif ( index !== undefined ) {\n\n\t\t\t\tfor ( let i = 0; i < index.count; i += 3 ) {\n\n\t\t\t\t\taddFace( index.getX( i ), index.getX( i + 1 ), index.getX( i + 2 ) );\n\n\t\t\t\t}\n\n\t\t\t} else {\n\n\t\t\t\tfor ( let i = 0; i < position.count; i += 3 ) {\n\n\t\t\t\t\taddFace( i, i + 1, i + 2 );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\tthis.computeFaceNormals();\n\n\t\tif ( geometry.boundingBox !== null ) {\n\n\t\t\tthis.boundingBox = geometry.boundingBox.clone();\n\n\t\t}\n\n\t\tif ( geometry.boundingSphere !== null ) {\n\n\t\t\tthis.boundingSphere = geometry.boundingSphere.clone();\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tcenter() {\n\n\t\tthis.computeBoundingBox();\n\n\t\tthis.boundingBox.getCenter( _offset ).negate();\n\n\t\tthis.translate( _offset.x, _offset.y, _offset.z );\n\n\t\treturn this;\n\n\t}\n\n\tnormalize() {\n\n\t\tthis.computeBoundingSphere();\n\n\t\tconst center = this.boundingSphere.center;\n\t\tconst radius = this.boundingSphere.radius;\n\n\t\tconst s = radius === 0 ? 1 : 1.0 / radius;\n\n\t\tconst matrix = new Matrix4();\n\t\tmatrix.set(\n\t\t\ts, 0, 0, - s * center.x,\n\t\t\t0, s, 0, - s * center.y,\n\t\t\t0, 0, s, - s * center.z,\n\t\t\t0, 0, 0, 1\n\t\t);\n\n\t\tthis.applyMatrix4( matrix );\n\n\t\treturn this;\n\n\t}\n\n\tcomputeFaceNormals() {\n\n\t\tconst cb = new Vector3(), ab = new Vector3();\n\n\t\tfor ( let f = 0, fl = this.faces.length; f < fl; f ++ ) {\n\n\t\t\tconst face = this.faces[ f ];\n\n\t\t\tconst vA = this.vertices[ face.a ];\n\t\t\tconst vB = this.vertices[ face.b ];\n\t\t\tconst vC = this.vertices[ face.c ];\n\n\t\t\tcb.subVectors( vC, vB );\n\t\t\tab.subVectors( vA, vB );\n\t\t\tcb.cross( ab );\n\n\t\t\tcb.normalize();\n\n\t\t\tface.normal.copy( cb );\n\n\t\t}\n\n\t}\n\n\tcomputeVertexNormals( areaWeighted = true ) {\n\n\t\tconst vertices = new Array( this.vertices.length );\n\n\t\tfor ( let v = 0, vl = this.vertices.length; v < vl; v ++ ) {\n\n\t\t\tvertices[ v ] = new Vector3();\n\n\t\t}\n\n\t\tif ( areaWeighted ) {\n\n\t\t\t// vertex normals weighted by triangle areas\n\t\t\t// http://www.iquilezles.org/www/articles/normals/normals.htm\n\n\t\t\tconst cb = new Vector3(), ab = new Vector3();\n\n\t\t\tfor ( let f = 0, fl = this.faces.length; f < fl; f ++ ) {\n\n\t\t\t\tconst face = this.faces[ f ];\n\n\t\t\t\tconst vA = this.vertices[ face.a ];\n\t\t\t\tconst vB = this.vertices[ face.b ];\n\t\t\t\tconst vC = this.vertices[ face.c ];\n\n\t\t\t\tcb.subVectors( vC, vB );\n\t\t\t\tab.subVectors( vA, vB );\n\t\t\t\tcb.cross( ab );\n\n\t\t\t\tvertices[ face.a ].add( cb );\n\t\t\t\tvertices[ face.b ].add( cb );\n\t\t\t\tvertices[ face.c ].add( cb );\n\n\t\t\t}\n\n\t\t} else {\n\n\t\t\tthis.computeFaceNormals();\n\n\t\t\tfor ( let f = 0, fl = this.faces.length; f < fl; f ++ ) {\n\n\t\t\t\tconst face = this.faces[ f ];\n\n\t\t\t\tvertices[ face.a ].add( face.normal );\n\t\t\t\tvertices[ face.b ].add( face.normal );\n\t\t\t\tvertices[ face.c ].add( face.normal );\n\n\t\t\t}\n\n\t\t}\n\n\t\tfor ( let v = 0, vl = this.vertices.length; v < vl; v ++ ) {\n\n\t\t\tvertices[ v ].normalize();\n\n\t\t}\n\n\t\tfor ( let f = 0, fl = this.faces.length; f < fl; f ++ ) {\n\n\t\t\tconst face = this.faces[ f ];\n\n\t\t\tconst vertexNormals = face.vertexNormals;\n\n\t\t\tif ( vertexNormals.length === 3 ) {\n\n\t\t\t\tvertexNormals[ 0 ].copy( vertices[ face.a ] );\n\t\t\t\tvertexNormals[ 1 ].copy( vertices[ face.b ] );\n\t\t\t\tvertexNormals[ 2 ].copy( vertices[ face.c ] );\n\n\t\t\t} else {\n\n\t\t\t\tvertexNormals[ 0 ] = vertices[ face.a ].clone();\n\t\t\t\tvertexNormals[ 1 ] = vertices[ face.b ].clone();\n\t\t\t\tvertexNormals[ 2 ] = vertices[ face.c ].clone();\n\n\t\t\t}\n\n\t\t}\n\n\t\tif ( this.faces.length > 0 ) {\n\n\t\t\tthis.normalsNeedUpdate = true;\n\n\t\t}\n\n\t}\n\n\tcomputeFlatVertexNormals() {\n\n\t\tthis.computeFaceNormals();\n\n\t\tfor ( let f = 0, fl = this.faces.length; f < fl; f ++ ) {\n\n\t\t\tconst face = this.faces[ f ];\n\n\t\t\tconst vertexNormals = face.vertexNormals;\n\n\t\t\tif ( vertexNormals.length === 3 ) {\n\n\t\t\t\tvertexNormals[ 0 ].copy( face.normal );\n\t\t\t\tvertexNormals[ 1 ].copy( face.normal );\n\t\t\t\tvertexNormals[ 2 ].copy( face.normal );\n\n\t\t\t} else {\n\n\t\t\t\tvertexNormals[ 0 ] = face.normal.clone();\n\t\t\t\tvertexNormals[ 1 ] = face.normal.clone();\n\t\t\t\tvertexNormals[ 2 ] = face.normal.clone();\n\n\t\t\t}\n\n\t\t}\n\n\t\tif ( this.faces.length > 0 ) {\n\n\t\t\tthis.normalsNeedUpdate = true;\n\n\t\t}\n\n\t}\n\n\tcomputeMorphNormals() {\n\n\t\t// save original normals\n\t\t// - create temp variables on first access\n\t\t//   otherwise just copy (for faster repeated calls)\n\n\t\tfor ( let f = 0, fl = this.faces.length; f < fl; f ++ ) {\n\n\t\t\tconst face = this.faces[ f ];\n\n\t\t\tif ( ! face.__originalFaceNormal ) {\n\n\t\t\t\tface.__originalFaceNormal = face.normal.clone();\n\n\t\t\t} else {\n\n\t\t\t\tface.__originalFaceNormal.copy( face.normal );\n\n\t\t\t}\n\n\t\t\tif ( ! face.__originalVertexNormals ) face.__originalVertexNormals = [];\n\n\t\t\tfor ( let i = 0, il = face.vertexNormals.length; i < il; i ++ ) {\n\n\t\t\t\tif ( ! face.__originalVertexNormals[ i ] ) {\n\n\t\t\t\t\tface.__originalVertexNormals[ i ] = face.vertexNormals[ i ].clone();\n\n\t\t\t\t} else {\n\n\t\t\t\t\tface.__originalVertexNormals[ i ].copy( face.vertexNormals[ i ] );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\t// use temp geometry to compute face and vertex normals for each morph\n\n\t\tconst tmpGeo = new Geometry();\n\t\ttmpGeo.faces = this.faces;\n\n\t\tfor ( let i = 0, il = this.morphTargets.length; i < il; i ++ ) {\n\n\t\t\t// create on first access\n\n\t\t\tif ( ! this.morphNormals[ i ] ) {\n\n\t\t\t\tthis.morphNormals[ i ] = {};\n\t\t\t\tthis.morphNormals[ i ].faceNormals = [];\n\t\t\t\tthis.morphNormals[ i ].vertexNormals = [];\n\n\t\t\t\tconst dstNormalsFace = this.morphNormals[ i ].faceNormals;\n\t\t\t\tconst dstNormalsVertex = this.morphNormals[ i ].vertexNormals;\n\n\t\t\t\tfor ( let f = 0, fl = this.faces.length; f < fl; f ++ ) {\n\n\t\t\t\t\tconst faceNormal = new Vector3();\n\t\t\t\t\tconst vertexNormals = { a: new Vector3(), b: new Vector3(), c: new Vector3() };\n\n\t\t\t\t\tdstNormalsFace.push( faceNormal );\n\t\t\t\t\tdstNormalsVertex.push( vertexNormals );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tconst morphNormals = this.morphNormals[ i ];\n\n\t\t\t// set vertices to morph target\n\n\t\t\ttmpGeo.vertices = this.morphTargets[ i ].vertices;\n\n\t\t\t// compute morph normals\n\n\t\t\ttmpGeo.computeFaceNormals();\n\t\t\ttmpGeo.computeVertexNormals();\n\n\t\t\t// store morph normals\n\n\t\t\tfor ( let f = 0, fl = this.faces.length; f < fl; f ++ ) {\n\n\t\t\t\tconst face = this.faces[ f ];\n\n\t\t\t\tconst faceNormal = morphNormals.faceNormals[ f ];\n\t\t\t\tconst vertexNormals = morphNormals.vertexNormals[ f ];\n\n\t\t\t\tfaceNormal.copy( face.normal );\n\n\t\t\t\tvertexNormals.a.copy( face.vertexNormals[ 0 ] );\n\t\t\t\tvertexNormals.b.copy( face.vertexNormals[ 1 ] );\n\t\t\t\tvertexNormals.c.copy( face.vertexNormals[ 2 ] );\n\n\t\t\t}\n\n\t\t}\n\n\t\t// restore original normals\n\n\t\tfor ( let f = 0, fl = this.faces.length; f < fl; f ++ ) {\n\n\t\t\tconst face = this.faces[ f ];\n\n\t\t\tface.normal = face.__originalFaceNormal;\n\t\t\tface.vertexNormals = face.__originalVertexNormals;\n\n\t\t}\n\n\t}\n\n\tcomputeBoundingBox() {\n\n\t\tif ( this.boundingBox === null ) {\n\n\t\t\tthis.boundingBox = new Box3();\n\n\t\t}\n\n\t\tthis.boundingBox.setFromPoints( this.vertices );\n\n\t}\n\n\tcomputeBoundingSphere() {\n\n\t\tif ( this.boundingSphere === null ) {\n\n\t\t\tthis.boundingSphere = new Sphere();\n\n\t\t}\n\n\t\tthis.boundingSphere.setFromPoints( this.vertices );\n\n\t}\n\n\tmerge( geometry, matrix, materialIndexOffset = 0 ) {\n\n\t\tif ( ! ( geometry && geometry.isGeometry ) ) {\n\n\t\t\tconsole.error( 'THREE.Geometry.merge(): geometry not an instance of THREE.Geometry.', geometry );\n\t\t\treturn;\n\n\t\t}\n\n\t\tlet normalMatrix;\n\t\tconst vertexOffset = this.vertices.length,\n\t\t\tvertices1 = this.vertices,\n\t\t\tvertices2 = geometry.vertices,\n\t\t\tfaces1 = this.faces,\n\t\t\tfaces2 = geometry.faces,\n\t\t\tcolors1 = this.colors,\n\t\t\tcolors2 = geometry.colors;\n\n\t\tif ( matrix !== undefined ) {\n\n\t\t\tnormalMatrix = new Matrix3().getNormalMatrix( matrix );\n\n\t\t}\n\n\t\t// vertices\n\n\t\tfor ( let i = 0, il = vertices2.length; i < il; i ++ ) {\n\n\t\t\tconst vertex = vertices2[ i ];\n\n\t\t\tconst vertexCopy = vertex.clone();\n\n\t\t\tif ( matrix !== undefined ) vertexCopy.applyMatrix4( matrix );\n\n\t\t\tvertices1.push( vertexCopy );\n\n\t\t}\n\n\t\t// colors\n\n\t\tfor ( let i = 0, il = colors2.length; i < il; i ++ ) {\n\n\t\t\tcolors1.push( colors2[ i ].clone() );\n\n\t\t}\n\n\t\t// faces\n\n\t\tfor ( let i = 0, il = faces2.length; i < il; i ++ ) {\n\n\t\t\tconst face = faces2[ i ];\n\t\t\tlet normal, color;\n\t\t\tconst faceVertexNormals = face.vertexNormals,\n\t\t\t\tfaceVertexColors = face.vertexColors;\n\n\t\t\tconst faceCopy = new Face3( face.a + vertexOffset, face.b + vertexOffset, face.c + vertexOffset );\n\t\t\tfaceCopy.normal.copy( face.normal );\n\n\t\t\tif ( normalMatrix !== undefined ) {\n\n\t\t\t\tfaceCopy.normal.applyMatrix3( normalMatrix ).normalize();\n\n\t\t\t}\n\n\t\t\tfor ( let j = 0, jl = faceVertexNormals.length; j < jl; j ++ ) {\n\n\t\t\t\tnormal = faceVertexNormals[ j ].clone();\n\n\t\t\t\tif ( normalMatrix !== undefined ) {\n\n\t\t\t\t\tnormal.applyMatrix3( normalMatrix ).normalize();\n\n\t\t\t\t}\n\n\t\t\t\tfaceCopy.vertexNormals.push( normal );\n\n\t\t\t}\n\n\t\t\tfaceCopy.color.copy( face.color );\n\n\t\t\tfor ( let j = 0, jl = faceVertexColors.length; j < jl; j ++ ) {\n\n\t\t\t\tcolor = faceVertexColors[ j ];\n\t\t\t\tfaceCopy.vertexColors.push( color.clone() );\n\n\t\t\t}\n\n\t\t\tfaceCopy.materialIndex = face.materialIndex + materialIndexOffset;\n\n\t\t\tfaces1.push( faceCopy );\n\n\t\t}\n\n\t\t// uvs\n\n\t\tfor ( let i = 0, il = geometry.faceVertexUvs.length; i < il; i ++ ) {\n\n\t\t\tconst faceVertexUvs2 = geometry.faceVertexUvs[ i ];\n\n\t\t\tif ( this.faceVertexUvs[ i ] === undefined ) this.faceVertexUvs[ i ] = [];\n\n\t\t\tfor ( let j = 0, jl = faceVertexUvs2.length; j < jl; j ++ ) {\n\n\t\t\t\tconst uvs2 = faceVertexUvs2[ j ], uvsCopy = [];\n\n\t\t\t\tfor ( let k = 0, kl = uvs2.length; k < kl; k ++ ) {\n\n\t\t\t\t\tuvsCopy.push( uvs2[ k ].clone() );\n\n\t\t\t\t}\n\n\t\t\t\tthis.faceVertexUvs[ i ].push( uvsCopy );\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\tmergeMesh( mesh ) {\n\n\t\tif ( ! ( mesh && mesh.isMesh ) ) {\n\n\t\t\tconsole.error( 'THREE.Geometry.mergeMesh(): mesh not an instance of THREE.Mesh.', mesh );\n\t\t\treturn;\n\n\t\t}\n\n\t\tif ( mesh.matrixAutoUpdate ) mesh.updateMatrix();\n\n\t\tthis.merge( mesh.geometry, mesh.matrix );\n\n\t}\n\n\t/*\n\t * Checks for duplicate vertices with hashmap.\n\t * Duplicated vertices are removed\n\t * and faces' vertices are updated.\n\t */\n\n\tmergeVertices( precisionPoints = 4 ) {\n\n\t\tconst verticesMap = {}; // Hashmap for looking up vertices by position coordinates (and making sure they are unique)\n\t\tconst unique = [], changes = [];\n\n\t\tconst precision = Math.pow( 10, precisionPoints );\n\n\t\tfor ( let i = 0, il = this.vertices.length; i < il; i ++ ) {\n\n\t\t\tconst v = this.vertices[ i ];\n\t\t\tconst key = Math.round( v.x * precision ) + '_' + Math.round( v.y * precision ) + '_' + Math.round( v.z * precision );\n\n\t\t\tif ( verticesMap[ key ] === undefined ) {\n\n\t\t\t\tverticesMap[ key ] = i;\n\t\t\t\tunique.push( this.vertices[ i ] );\n\t\t\t\tchanges[ i ] = unique.length - 1;\n\n\t\t\t} else {\n\n\t\t\t\t//console.log('Duplicate vertex found. ', i, ' could be using ', verticesMap[key]);\n\t\t\t\tchanges[ i ] = changes[ verticesMap[ key ] ];\n\n\t\t\t}\n\n\t\t}\n\n\n\t\t// if faces are completely degenerate after merging vertices, we\n\t\t// have to remove them from the geometry.\n\t\tconst faceIndicesToRemove = [];\n\n\t\tfor ( let i = 0, il = this.faces.length; i < il; i ++ ) {\n\n\t\t\tconst face = this.faces[ i ];\n\n\t\t\tface.a = changes[ face.a ];\n\t\t\tface.b = changes[ face.b ];\n\t\t\tface.c = changes[ face.c ];\n\n\t\t\tconst indices = [ face.a, face.b, face.c ];\n\n\t\t\t// if any duplicate vertices are found in a Face3\n\t\t\t// we have to remove the face as nothing can be saved\n\t\t\tfor ( let n = 0; n < 3; n ++ ) {\n\n\t\t\t\tif ( indices[ n ] === indices[ ( n + 1 ) % 3 ] ) {\n\n\t\t\t\t\tfaceIndicesToRemove.push( i );\n\t\t\t\t\tbreak;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\tfor ( let i = faceIndicesToRemove.length - 1; i >= 0; i -- ) {\n\n\t\t\tconst idx = faceIndicesToRemove[ i ];\n\n\t\t\tthis.faces.splice( idx, 1 );\n\n\t\t\tfor ( let j = 0, jl = this.faceVertexUvs.length; j < jl; j ++ ) {\n\n\t\t\t\tthis.faceVertexUvs[ j ].splice( idx, 1 );\n\n\t\t\t}\n\n\t\t}\n\n\t\t// Use unique set of vertices\n\n\t\tconst diff = this.vertices.length - unique.length;\n\t\tthis.vertices = unique;\n\t\treturn diff;\n\n\t}\n\n\tsetFromPoints( points ) {\n\n\t\tthis.vertices = [];\n\n\t\tfor ( let i = 0, l = points.length; i < l; i ++ ) {\n\n\t\t\tconst point = points[ i ];\n\t\t\tthis.vertices.push( new Vector3( point.x, point.y, point.z || 0 ) );\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tsortFacesByMaterialIndex() {\n\n\t\tconst faces = this.faces;\n\t\tconst length = faces.length;\n\n\t\t// tag faces\n\n\t\tfor ( let i = 0; i < length; i ++ ) {\n\n\t\t\tfaces[ i ]._id = i;\n\n\t\t}\n\n\t\t// sort faces\n\n\t\tfunction materialIndexSort( a, b ) {\n\n\t\t\treturn a.materialIndex - b.materialIndex;\n\n\t\t}\n\n\t\tfaces.sort( materialIndexSort );\n\n\t\t// sort uvs\n\n\t\tconst uvs1 = this.faceVertexUvs[ 0 ];\n\t\tconst uvs2 = this.faceVertexUvs[ 1 ];\n\n\t\tlet newUvs1, newUvs2;\n\n\t\tif ( uvs1 && uvs1.length === length ) newUvs1 = [];\n\t\tif ( uvs2 && uvs2.length === length ) newUvs2 = [];\n\n\t\tfor ( let i = 0; i < length; i ++ ) {\n\n\t\t\tconst id = faces[ i ]._id;\n\n\t\t\tif ( newUvs1 ) newUvs1.push( uvs1[ id ] );\n\t\t\tif ( newUvs2 ) newUvs2.push( uvs2[ id ] );\n\n\t\t}\n\n\t\tif ( newUvs1 ) this.faceVertexUvs[ 0 ] = newUvs1;\n\t\tif ( newUvs2 ) this.faceVertexUvs[ 1 ] = newUvs2;\n\n\t}\n\n\ttoJSON() {\n\n\t\tconst data = {\n\t\t\tmetadata: {\n\t\t\t\tversion: 4.5,\n\t\t\t\ttype: 'Geometry',\n\t\t\t\tgenerator: 'Geometry.toJSON'\n\t\t\t}\n\t\t};\n\n\t\t// standard Geometry serialization\n\n\t\tdata.uuid = this.uuid;\n\t\tdata.type = this.type;\n\t\tif ( this.name !== '' ) data.name = this.name;\n\n\t\tif ( this.parameters !== undefined ) {\n\n\t\t\tconst parameters = this.parameters;\n\n\t\t\tfor ( const key in parameters ) {\n\n\t\t\t\tif ( parameters[ key ] !== undefined ) data[ key ] = parameters[ key ];\n\n\t\t\t}\n\n\t\t\treturn data;\n\n\t\t}\n\n\t\tconst vertices = [];\n\n\t\tfor ( let i = 0; i < this.vertices.length; i ++ ) {\n\n\t\t\tconst vertex = this.vertices[ i ];\n\t\t\tvertices.push( vertex.x, vertex.y, vertex.z );\n\n\t\t}\n\n\t\tconst faces = [];\n\t\tconst normals = [];\n\t\tconst normalsHash = {};\n\t\tconst colors = [];\n\t\tconst colorsHash = {};\n\t\tconst uvs = [];\n\t\tconst uvsHash = {};\n\n\t\tfor ( let i = 0; i < this.faces.length; i ++ ) {\n\n\t\t\tconst face = this.faces[ i ];\n\n\t\t\tconst hasMaterial = true;\n\t\t\tconst hasFaceUv = false; // deprecated\n\t\t\tconst hasFaceVertexUv = this.faceVertexUvs[ 0 ][ i ] !== undefined;\n\t\t\tconst hasFaceNormal = face.normal.length() > 0;\n\t\t\tconst hasFaceVertexNormal = face.vertexNormals.length > 0;\n\t\t\tconst hasFaceColor = face.color.r !== 1 || face.color.g !== 1 || face.color.b !== 1;\n\t\t\tconst hasFaceVertexColor = face.vertexColors.length > 0;\n\n\t\t\tlet faceType = 0;\n\n\t\t\tfaceType = setBit( faceType, 0, 0 ); // isQuad\n\t\t\tfaceType = setBit( faceType, 1, hasMaterial );\n\t\t\tfaceType = setBit( faceType, 2, hasFaceUv );\n\t\t\tfaceType = setBit( faceType, 3, hasFaceVertexUv );\n\t\t\tfaceType = setBit( faceType, 4, hasFaceNormal );\n\t\t\tfaceType = setBit( faceType, 5, hasFaceVertexNormal );\n\t\t\tfaceType = setBit( faceType, 6, hasFaceColor );\n\t\t\tfaceType = setBit( faceType, 7, hasFaceVertexColor );\n\n\t\t\tfaces.push( faceType );\n\t\t\tfaces.push( face.a, face.b, face.c );\n\t\t\tfaces.push( face.materialIndex );\n\n\t\t\tif ( hasFaceVertexUv ) {\n\n\t\t\t\tconst faceVertexUvs = this.faceVertexUvs[ 0 ][ i ];\n\n\t\t\t\tfaces.push(\n\t\t\t\t\tgetUvIndex( faceVertexUvs[ 0 ] ),\n\t\t\t\t\tgetUvIndex( faceVertexUvs[ 1 ] ),\n\t\t\t\t\tgetUvIndex( faceVertexUvs[ 2 ] )\n\t\t\t\t);\n\n\t\t\t}\n\n\t\t\tif ( hasFaceNormal ) {\n\n\t\t\t\tfaces.push( getNormalIndex( face.normal ) );\n\n\t\t\t}\n\n\t\t\tif ( hasFaceVertexNormal ) {\n\n\t\t\t\tconst vertexNormals = face.vertexNormals;\n\n\t\t\t\tfaces.push(\n\t\t\t\t\tgetNormalIndex( vertexNormals[ 0 ] ),\n\t\t\t\t\tgetNormalIndex( vertexNormals[ 1 ] ),\n\t\t\t\t\tgetNormalIndex( vertexNormals[ 2 ] )\n\t\t\t\t);\n\n\t\t\t}\n\n\t\t\tif ( hasFaceColor ) {\n\n\t\t\t\tfaces.push( getColorIndex( face.color ) );\n\n\t\t\t}\n\n\t\t\tif ( hasFaceVertexColor ) {\n\n\t\t\t\tconst vertexColors = face.vertexColors;\n\n\t\t\t\tfaces.push(\n\t\t\t\t\tgetColorIndex( vertexColors[ 0 ] ),\n\t\t\t\t\tgetColorIndex( vertexColors[ 1 ] ),\n\t\t\t\t\tgetColorIndex( vertexColors[ 2 ] )\n\t\t\t\t);\n\n\t\t\t}\n\n\t\t}\n\n\t\tfunction setBit( value, position, enabled ) {\n\n\t\t\treturn enabled ? value | ( 1 << position ) : value & ( ~ ( 1 << position ) );\n\n\t\t}\n\n\t\tfunction getNormalIndex( normal ) {\n\n\t\t\tconst hash = normal.x.toString() + normal.y.toString() + normal.z.toString();\n\n\t\t\tif ( normalsHash[ hash ] !== undefined ) {\n\n\t\t\t\treturn normalsHash[ hash ];\n\n\t\t\t}\n\n\t\t\tnormalsHash[ hash ] = normals.length / 3;\n\t\t\tnormals.push( normal.x, normal.y, normal.z );\n\n\t\t\treturn normalsHash[ hash ];\n\n\t\t}\n\n\t\tfunction getColorIndex( color ) {\n\n\t\t\tconst hash = color.r.toString() + color.g.toString() + color.b.toString();\n\n\t\t\tif ( colorsHash[ hash ] !== undefined ) {\n\n\t\t\t\treturn colorsHash[ hash ];\n\n\t\t\t}\n\n\t\t\tcolorsHash[ hash ] = colors.length;\n\t\t\tcolors.push( color.getHex() );\n\n\t\t\treturn colorsHash[ hash ];\n\n\t\t}\n\n\t\tfunction getUvIndex( uv ) {\n\n\t\t\tconst hash = uv.x.toString() + uv.y.toString();\n\n\t\t\tif ( uvsHash[ hash ] !== undefined ) {\n\n\t\t\t\treturn uvsHash[ hash ];\n\n\t\t\t}\n\n\t\t\tuvsHash[ hash ] = uvs.length / 2;\n\t\t\tuvs.push( uv.x, uv.y );\n\n\t\t\treturn uvsHash[ hash ];\n\n\t\t}\n\n\t\tdata.data = {};\n\n\t\tdata.data.vertices = vertices;\n\t\tdata.data.normals = normals;\n\t\tif ( colors.length > 0 ) data.data.colors = colors;\n\t\tif ( uvs.length > 0 ) data.data.uvs = [ uvs ]; // temporal backward compatibility\n\t\tdata.data.faces = faces;\n\n\t\treturn data;\n\n\t}\n\n\tclone() {\n\n\t\t/*\n\t\t // Handle primitives\n\n\t\t const parameters = this.parameters;\n\n\t\t if ( parameters !== undefined ) {\n\n\t\t const values = [];\n\n\t\t for ( const key in parameters ) {\n\n\t\t values.push( parameters[ key ] );\n\n\t\t }\n\n\t\t const geometry = Object.create( this.constructor.prototype );\n\t\t this.constructor.apply( geometry, values );\n\t\t return geometry;\n\n\t\t }\n\n\t\t return new this.constructor().copy( this );\n\t\t */\n\n\t\treturn new Geometry().copy( this );\n\n\t}\n\n\tcopy( source ) {\n\n\t\t// reset\n\n\t\tthis.vertices = [];\n\t\tthis.colors = [];\n\t\tthis.faces = [];\n\t\tthis.faceVertexUvs = [[]];\n\t\tthis.morphTargets = [];\n\t\tthis.morphNormals = [];\n\t\tthis.skinWeights = [];\n\t\tthis.skinIndices = [];\n\t\tthis.lineDistances = [];\n\t\tthis.boundingBox = null;\n\t\tthis.boundingSphere = null;\n\n\t\t// name\n\n\t\tthis.name = source.name;\n\n\t\t// vertices\n\n\t\tconst vertices = source.vertices;\n\n\t\tfor ( let i = 0, il = vertices.length; i < il; i ++ ) {\n\n\t\t\tthis.vertices.push( vertices[ i ].clone() );\n\n\t\t}\n\n\t\t// colors\n\n\t\tconst colors = source.colors;\n\n\t\tfor ( let i = 0, il = colors.length; i < il; i ++ ) {\n\n\t\t\tthis.colors.push( colors[ i ].clone() );\n\n\t\t}\n\n\t\t// faces\n\n\t\tconst faces = source.faces;\n\n\t\tfor ( let i = 0, il = faces.length; i < il; i ++ ) {\n\n\t\t\tthis.faces.push( faces[ i ].clone() );\n\n\t\t}\n\n\t\t// face vertex uvs\n\n\t\tfor ( let i = 0, il = source.faceVertexUvs.length; i < il; i ++ ) {\n\n\t\t\tconst faceVertexUvs = source.faceVertexUvs[ i ];\n\n\t\t\tif ( this.faceVertexUvs[ i ] === undefined ) {\n\n\t\t\t\tthis.faceVertexUvs[ i ] = [];\n\n\t\t\t}\n\n\t\t\tfor ( let j = 0, jl = faceVertexUvs.length; j < jl; j ++ ) {\n\n\t\t\t\tconst uvs = faceVertexUvs[ j ], uvsCopy = [];\n\n\t\t\t\tfor ( let k = 0, kl = uvs.length; k < kl; k ++ ) {\n\n\t\t\t\t\tconst uv = uvs[ k ];\n\n\t\t\t\t\tuvsCopy.push( uv.clone() );\n\n\t\t\t\t}\n\n\t\t\t\tthis.faceVertexUvs[ i ].push( uvsCopy );\n\n\t\t\t}\n\n\t\t}\n\n\t\t// morph targets\n\n\t\tconst morphTargets = source.morphTargets;\n\n\t\tfor ( let i = 0, il = morphTargets.length; i < il; i ++ ) {\n\n\t\t\tconst morphTarget = {};\n\t\t\tmorphTarget.name = morphTargets[ i ].name;\n\n\t\t\t// vertices\n\n\t\t\tif ( morphTargets[ i ].vertices !== undefined ) {\n\n\t\t\t\tmorphTarget.vertices = [];\n\n\t\t\t\tfor ( let j = 0, jl = morphTargets[ i ].vertices.length; j < jl; j ++ ) {\n\n\t\t\t\t\tmorphTarget.vertices.push( morphTargets[ i ].vertices[ j ].clone() );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\t// normals\n\n\t\t\tif ( morphTargets[ i ].normals !== undefined ) {\n\n\t\t\t\tmorphTarget.normals = [];\n\n\t\t\t\tfor ( let j = 0, jl = morphTargets[ i ].normals.length; j < jl; j ++ ) {\n\n\t\t\t\t\tmorphTarget.normals.push( morphTargets[ i ].normals[ j ].clone() );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tthis.morphTargets.push( morphTarget );\n\n\t\t}\n\n\t\t// morph normals\n\n\t\tconst morphNormals = source.morphNormals;\n\n\t\tfor ( let i = 0, il = morphNormals.length; i < il; i ++ ) {\n\n\t\t\tconst morphNormal = {};\n\n\t\t\t// vertex normals\n\n\t\t\tif ( morphNormals[ i ].vertexNormals !== undefined ) {\n\n\t\t\t\tmorphNormal.vertexNormals = [];\n\n\t\t\t\tfor ( let j = 0, jl = morphNormals[ i ].vertexNormals.length; j < jl; j ++ ) {\n\n\t\t\t\t\tconst srcVertexNormal = morphNormals[ i ].vertexNormals[ j ];\n\t\t\t\t\tconst destVertexNormal = {};\n\n\t\t\t\t\tdestVertexNormal.a = srcVertexNormal.a.clone();\n\t\t\t\t\tdestVertexNormal.b = srcVertexNormal.b.clone();\n\t\t\t\t\tdestVertexNormal.c = srcVertexNormal.c.clone();\n\n\t\t\t\t\tmorphNormal.vertexNormals.push( destVertexNormal );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\t// face normals\n\n\t\t\tif ( morphNormals[ i ].faceNormals !== undefined ) {\n\n\t\t\t\tmorphNormal.faceNormals = [];\n\n\t\t\t\tfor ( let j = 0, jl = morphNormals[ i ].faceNormals.length; j < jl; j ++ ) {\n\n\t\t\t\t\tmorphNormal.faceNormals.push( morphNormals[ i ].faceNormals[ j ].clone() );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tthis.morphNormals.push( morphNormal );\n\n\t\t}\n\n\t\t// skin weights\n\n\t\tconst skinWeights = source.skinWeights;\n\n\t\tfor ( let i = 0, il = skinWeights.length; i < il; i ++ ) {\n\n\t\t\tthis.skinWeights.push( skinWeights[ i ].clone() );\n\n\t\t}\n\n\t\t// skin indices\n\n\t\tconst skinIndices = source.skinIndices;\n\n\t\tfor ( let i = 0, il = skinIndices.length; i < il; i ++ ) {\n\n\t\t\tthis.skinIndices.push( skinIndices[ i ].clone() );\n\n\t\t}\n\n\t\t// line distances\n\n\t\tconst lineDistances = source.lineDistances;\n\n\t\tfor ( let i = 0, il = lineDistances.length; i < il; i ++ ) {\n\n\t\t\tthis.lineDistances.push( lineDistances[ i ] );\n\n\t\t}\n\n\t\t// bounding box\n\n\t\tconst boundingBox = source.boundingBox;\n\n\t\tif ( boundingBox !== null ) {\n\n\t\t\tthis.boundingBox = boundingBox.clone();\n\n\t\t}\n\n\t\t// bounding sphere\n\n\t\tconst boundingSphere = source.boundingSphere;\n\n\t\tif ( boundingSphere !== null ) {\n\n\t\t\tthis.boundingSphere = boundingSphere.clone();\n\n\t\t}\n\n\t\t// update flags\n\n\t\tthis.elementsNeedUpdate = source.elementsNeedUpdate;\n\t\tthis.verticesNeedUpdate = source.verticesNeedUpdate;\n\t\tthis.uvsNeedUpdate = source.uvsNeedUpdate;\n\t\tthis.normalsNeedUpdate = source.normalsNeedUpdate;\n\t\tthis.colorsNeedUpdate = source.colorsNeedUpdate;\n\t\tthis.lineDistancesNeedUpdate = source.lineDistancesNeedUpdate;\n\t\tthis.groupsNeedUpdate = source.groupsNeedUpdate;\n\n\t\treturn this;\n\n\t}\n\n\ttoBufferGeometry() {\n\n\t\tconst geometry = new DirectGeometry().fromGeometry( this );\n\n\t\tconst buffergeometry = new BufferGeometry();\n\n\t\tconst positions = new Float32Array( geometry.vertices.length * 3 );\n\t\tbuffergeometry.setAttribute( 'position', new BufferAttribute( positions, 3 ).copyVector3sArray( geometry.vertices ) );\n\n\t\tif ( geometry.normals.length > 0 ) {\n\n\t\t\tconst normals = new Float32Array( geometry.normals.length * 3 );\n\t\t\tbuffergeometry.setAttribute( 'normal', new BufferAttribute( normals, 3 ).copyVector3sArray( geometry.normals ) );\n\n\t\t}\n\n\t\tif ( geometry.colors.length > 0 ) {\n\n\t\t\tconst colors = new Float32Array( geometry.colors.length * 3 );\n\t\t\tbuffergeometry.setAttribute( 'color', new BufferAttribute( colors, 3 ).copyColorsArray( geometry.colors ) );\n\n\t\t}\n\n\t\tif ( geometry.uvs.length > 0 ) {\n\n\t\t\tconst uvs = new Float32Array( geometry.uvs.length * 2 );\n\t\t\tbuffergeometry.setAttribute( 'uv', new BufferAttribute( uvs, 2 ).copyVector2sArray( geometry.uvs ) );\n\n\t\t}\n\n\t\tif ( geometry.uvs2.length > 0 ) {\n\n\t\t\tconst uvs2 = new Float32Array( geometry.uvs2.length * 2 );\n\t\t\tbuffergeometry.setAttribute( 'uv2', new BufferAttribute( uvs2, 2 ).copyVector2sArray( geometry.uvs2 ) );\n\n\t\t}\n\n\t\t// groups\n\n\t\tbuffergeometry.groups = geometry.groups;\n\n\t\t// morphs\n\n\t\tfor ( const name in geometry.morphTargets ) {\n\n\t\t\tconst array = [];\n\t\t\tconst morphTargets = geometry.morphTargets[ name ];\n\n\t\t\tfor ( let i = 0, l = morphTargets.length; i < l; i ++ ) {\n\n\t\t\t\tconst morphTarget = morphTargets[ i ];\n\n\t\t\t\tconst attribute = new Float32BufferAttribute( morphTarget.data.length * 3, 3 );\n\t\t\t\tattribute.name = morphTarget.name;\n\n\t\t\t\tarray.push( attribute.copyVector3sArray( morphTarget.data ) );\n\n\t\t\t}\n\n\t\t\tbuffergeometry.morphAttributes[ name ] = array;\n\n\t\t}\n\n\t\t// skinning\n\n\t\tif ( geometry.skinIndices.length > 0 ) {\n\n\t\t\tconst skinIndices = new Float32BufferAttribute( geometry.skinIndices.length * 4, 4 );\n\t\t\tbuffergeometry.setAttribute( 'skinIndex', skinIndices.copyVector4sArray( geometry.skinIndices ) );\n\n\t\t}\n\n\t\tif ( geometry.skinWeights.length > 0 ) {\n\n\t\t\tconst skinWeights = new Float32BufferAttribute( geometry.skinWeights.length * 4, 4 );\n\t\t\tbuffergeometry.setAttribute( 'skinWeight', skinWeights.copyVector4sArray( geometry.skinWeights ) );\n\n\t\t}\n\n\t\t//\n\n\t\tif ( geometry.boundingSphere !== null ) {\n\n\t\t\tbuffergeometry.boundingSphere = geometry.boundingSphere.clone();\n\n\t\t}\n\n\t\tif ( geometry.boundingBox !== null ) {\n\n\t\t\tbuffergeometry.boundingBox = geometry.boundingBox.clone();\n\n\t\t}\n\n\t\treturn buffergeometry;\n\n\t}\n\n\tcomputeTangents() {\n\n\t\tconsole.error( 'THREE.Geometry: .computeTangents() has been removed.' );\n\n\t}\n\n\tcomputeLineDistances() {\n\n\t\tconsole.error( 'THREE.Geometry: .computeLineDistances() has been removed. Use THREE.Line.computeLineDistances() instead.' );\n\n\t}\n\n\tapplyMatrix( matrix ) {\n\n\t\tconsole.warn( 'THREE.Geometry: .applyMatrix() has been renamed to .applyMatrix4().' );\n\t\treturn this.applyMatrix4( matrix );\n\n\t}\n\n\tdispose() {\n\n\t\tthis.dispatchEvent( { type: 'dispose' } );\n\n\t}\n\n\tstatic createBufferGeometryFromObject( object ) {\n\n\t\tlet buffergeometry = new BufferGeometry();\n\n\t\tconst geometry = object.geometry;\n\n\t\tif ( object.isPoints || object.isLine ) {\n\n\t\t\tconst positions = new Float32BufferAttribute( geometry.vertices.length * 3, 3 );\n\t\t\tconst colors = new Float32BufferAttribute( geometry.colors.length * 3, 3 );\n\n\t\t\tbuffergeometry.setAttribute( 'position', positions.copyVector3sArray( geometry.vertices ) );\n\t\t\tbuffergeometry.setAttribute( 'color', colors.copyColorsArray( geometry.colors ) );\n\n\t\t\tif ( geometry.lineDistances && geometry.lineDistances.length === geometry.vertices.length ) {\n\n\t\t\t\tconst lineDistances = new Float32BufferAttribute( geometry.lineDistances.length, 1 );\n\n\t\t\t\tbuffergeometry.setAttribute( 'lineDistance', lineDistances.copyArray( geometry.lineDistances ) );\n\n\t\t\t}\n\n\t\t\tif ( geometry.boundingSphere !== null ) {\n\n\t\t\t\tbuffergeometry.boundingSphere = geometry.boundingSphere.clone();\n\n\t\t\t}\n\n\t\t\tif ( geometry.boundingBox !== null ) {\n\n\t\t\t\tbuffergeometry.boundingBox = geometry.boundingBox.clone();\n\n\t\t\t}\n\n\t\t} else if ( object.isMesh ) {\n\n\t\t\tbuffergeometry = geometry.toBufferGeometry();\n\n\t\t}\n\n\t\treturn buffergeometry;\n\n\t}\n\n}\n\nGeometry.prototype.isGeometry = true;\n\nclass DirectGeometry {\n\n\tconstructor() {\n\n\t\tthis.vertices = [];\n\t\tthis.normals = [];\n\t\tthis.colors = [];\n\t\tthis.uvs = [];\n\t\tthis.uvs2 = [];\n\n\t\tthis.groups = [];\n\n\t\tthis.morphTargets = {};\n\n\t\tthis.skinWeights = [];\n\t\tthis.skinIndices = [];\n\n\t\t// this.lineDistances = [];\n\n\t\tthis.boundingBox = null;\n\t\tthis.boundingSphere = null;\n\n\t\t// update flags\n\n\t\tthis.verticesNeedUpdate = false;\n\t\tthis.normalsNeedUpdate = false;\n\t\tthis.colorsNeedUpdate = false;\n\t\tthis.uvsNeedUpdate = false;\n\t\tthis.groupsNeedUpdate = false;\n\n\t}\n\n\tcomputeGroups( geometry ) {\n\n\t\tconst groups = [];\n\n\t\tlet group, i;\n\t\tlet materialIndex = undefined;\n\n\t\tconst faces = geometry.faces;\n\n\t\tfor ( i = 0; i < faces.length; i ++ ) {\n\n\t\t\tconst face = faces[ i ];\n\n\t\t\t// materials\n\n\t\t\tif ( face.materialIndex !== materialIndex ) {\n\n\t\t\t\tmaterialIndex = face.materialIndex;\n\n\t\t\t\tif ( group !== undefined ) {\n\n\t\t\t\t\tgroup.count = ( i * 3 ) - group.start;\n\t\t\t\t\tgroups.push( group );\n\n\t\t\t\t}\n\n\t\t\t\tgroup = {\n\t\t\t\t\tstart: i * 3,\n\t\t\t\t\tmaterialIndex: materialIndex\n\t\t\t\t};\n\n\t\t\t}\n\n\t\t}\n\n\t\tif ( group !== undefined ) {\n\n\t\t\tgroup.count = ( i * 3 ) - group.start;\n\t\t\tgroups.push( group );\n\n\t\t}\n\n\t\tthis.groups = groups;\n\n\t}\n\n\tfromGeometry( geometry ) {\n\n\t\tconst faces = geometry.faces;\n\t\tconst vertices = geometry.vertices;\n\t\tconst faceVertexUvs = geometry.faceVertexUvs;\n\n\t\tconst hasFaceVertexUv = faceVertexUvs[ 0 ] && faceVertexUvs[ 0 ].length > 0;\n\t\tconst hasFaceVertexUv2 = faceVertexUvs[ 1 ] && faceVertexUvs[ 1 ].length > 0;\n\n\t\t// morphs\n\n\t\tconst morphTargets = geometry.morphTargets;\n\t\tconst morphTargetsLength = morphTargets.length;\n\n\t\tlet morphTargetsPosition;\n\n\t\tif ( morphTargetsLength > 0 ) {\n\n\t\t\tmorphTargetsPosition = [];\n\n\t\t\tfor ( let i = 0; i < morphTargetsLength; i ++ ) {\n\n\t\t\t\tmorphTargetsPosition[ i ] = {\n\t\t\t\t\tname: morphTargets[ i ].name,\n\t\t\t\t \tdata: []\n\t\t\t\t};\n\n\t\t\t}\n\n\t\t\tthis.morphTargets.position = morphTargetsPosition;\n\n\t\t}\n\n\t\tconst morphNormals = geometry.morphNormals;\n\t\tconst morphNormalsLength = morphNormals.length;\n\n\t\tlet morphTargetsNormal;\n\n\t\tif ( morphNormalsLength > 0 ) {\n\n\t\t\tmorphTargetsNormal = [];\n\n\t\t\tfor ( let i = 0; i < morphNormalsLength; i ++ ) {\n\n\t\t\t\tmorphTargetsNormal[ i ] = {\n\t\t\t\t\tname: morphNormals[ i ].name,\n\t\t\t\t \tdata: []\n\t\t\t\t};\n\n\t\t\t}\n\n\t\t\tthis.morphTargets.normal = morphTargetsNormal;\n\n\t\t}\n\n\t\t// skins\n\n\t\tconst skinIndices = geometry.skinIndices;\n\t\tconst skinWeights = geometry.skinWeights;\n\n\t\tconst hasSkinIndices = skinIndices.length === vertices.length;\n\t\tconst hasSkinWeights = skinWeights.length === vertices.length;\n\n\t\t//\n\n\t\tif ( vertices.length > 0 && faces.length === 0 ) {\n\n\t\t\tconsole.error( 'THREE.DirectGeometry: Faceless geometries are not supported.' );\n\n\t\t}\n\n\t\tfor ( let i = 0; i < faces.length; i ++ ) {\n\n\t\t\tconst face = faces[ i ];\n\n\t\t\tthis.vertices.push( vertices[ face.a ], vertices[ face.b ], vertices[ face.c ] );\n\n\t\t\tconst vertexNormals = face.vertexNormals;\n\n\t\t\tif ( vertexNormals.length === 3 ) {\n\n\t\t\t\tthis.normals.push( vertexNormals[ 0 ], vertexNormals[ 1 ], vertexNormals[ 2 ] );\n\n\t\t\t} else {\n\n\t\t\t\tconst normal = face.normal;\n\n\t\t\t\tthis.normals.push( normal, normal, normal );\n\n\t\t\t}\n\n\t\t\tconst vertexColors = face.vertexColors;\n\n\t\t\tif ( vertexColors.length === 3 ) {\n\n\t\t\t\tthis.colors.push( vertexColors[ 0 ], vertexColors[ 1 ], vertexColors[ 2 ] );\n\n\t\t\t} else {\n\n\t\t\t\tconst color = face.color;\n\n\t\t\t\tthis.colors.push( color, color, color );\n\n\t\t\t}\n\n\t\t\tif ( hasFaceVertexUv === true ) {\n\n\t\t\t\tconst vertexUvs = faceVertexUvs[ 0 ][ i ];\n\n\t\t\t\tif ( vertexUvs !== undefined ) {\n\n\t\t\t\t\tthis.uvs.push( vertexUvs[ 0 ], vertexUvs[ 1 ], vertexUvs[ 2 ] );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tconsole.warn( 'THREE.DirectGeometry.fromGeometry(): Undefined vertexUv ', i );\n\n\t\t\t\t\tthis.uvs.push( new Vector2(), new Vector2(), new Vector2() );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tif ( hasFaceVertexUv2 === true ) {\n\n\t\t\t\tconst vertexUvs = faceVertexUvs[ 1 ][ i ];\n\n\t\t\t\tif ( vertexUvs !== undefined ) {\n\n\t\t\t\t\tthis.uvs2.push( vertexUvs[ 0 ], vertexUvs[ 1 ], vertexUvs[ 2 ] );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tconsole.warn( 'THREE.DirectGeometry.fromGeometry(): Undefined vertexUv2 ', i );\n\n\t\t\t\t\tthis.uvs2.push( new Vector2(), new Vector2(), new Vector2() );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\t// morphs\n\n\t\t\tfor ( let j = 0; j < morphTargetsLength; j ++ ) {\n\n\t\t\t\tconst morphTarget = morphTargets[ j ].vertices;\n\n\t\t\t\tmorphTargetsPosition[ j ].data.push( morphTarget[ face.a ], morphTarget[ face.b ], morphTarget[ face.c ] );\n\n\t\t\t}\n\n\t\t\tfor ( let j = 0; j < morphNormalsLength; j ++ ) {\n\n\t\t\t\tconst morphNormal = morphNormals[ j ].vertexNormals[ i ];\n\n\t\t\t\tmorphTargetsNormal[ j ].data.push( morphNormal.a, morphNormal.b, morphNormal.c );\n\n\t\t\t}\n\n\t\t\t// skins\n\n\t\t\tif ( hasSkinIndices ) {\n\n\t\t\t\tthis.skinIndices.push( skinIndices[ face.a ], skinIndices[ face.b ], skinIndices[ face.c ] );\n\n\t\t\t}\n\n\t\t\tif ( hasSkinWeights ) {\n\n\t\t\t\tthis.skinWeights.push( skinWeights[ face.a ], skinWeights[ face.b ], skinWeights[ face.c ] );\n\n\t\t\t}\n\n\t\t}\n\n\t\tthis.computeGroups( geometry );\n\n\t\tthis.verticesNeedUpdate = geometry.verticesNeedUpdate;\n\t\tthis.normalsNeedUpdate = geometry.normalsNeedUpdate;\n\t\tthis.colorsNeedUpdate = geometry.colorsNeedUpdate;\n\t\tthis.uvsNeedUpdate = geometry.uvsNeedUpdate;\n\t\tthis.groupsNeedUpdate = geometry.groupsNeedUpdate;\n\n\t\tif ( geometry.boundingSphere !== null ) {\n\n\t\t\tthis.boundingSphere = geometry.boundingSphere.clone();\n\n\t\t}\n\n\t\tif ( geometry.boundingBox !== null ) {\n\n\t\t\tthis.boundingBox = geometry.boundingBox.clone();\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n}\n\nclass Face3 {\n\n\tconstructor( a, b, c, normal, color, materialIndex = 0 ) {\n\n\t\tthis.a = a;\n\t\tthis.b = b;\n\t\tthis.c = c;\n\n\t\tthis.normal = ( normal && normal.isVector3 ) ? normal : new Vector3();\n\t\tthis.vertexNormals = Array.isArray( normal ) ? normal : [];\n\n\t\tthis.color = ( color && color.isColor ) ? color : new Color();\n\t\tthis.vertexColors = Array.isArray( color ) ? color : [];\n\n\t\tthis.materialIndex = materialIndex;\n\n\t}\n\n\tclone() {\n\n\t\treturn new this.constructor().copy( this );\n\n\t}\n\n\tcopy( source ) {\n\n\t\tthis.a = source.a;\n\t\tthis.b = source.b;\n\t\tthis.c = source.c;\n\n\t\tthis.normal.copy( source.normal );\n\t\tthis.color.copy( source.color );\n\n\t\tthis.materialIndex = source.materialIndex;\n\n\t\tfor ( let i = 0, il = source.vertexNormals.length; i < il; i ++ ) {\n\n\t\t\tthis.vertexNormals[ i ] = source.vertexNormals[ i ].clone();\n\n\t\t}\n\n\t\tfor ( let i = 0, il = source.vertexColors.length; i < il; i ++ ) {\n\n\t\t\tthis.vertexColors[ i ] = source.vertexColors[ i ].clone();\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n}\n\nexport { Face3, Geometry };\n","import { Color, Vector3 } from 'three';\r\nclass Face3 {\r\n    constructor(a, b, c, normal, color, materialIndex = 0) {\r\n        this.a = a;\r\n        this.b = b;\r\n        this.c = c;\r\n        this.normal = normal && normal.isVector3 ? normal : new Vector3();\r\n        this.vertexNormals = Array.isArray(normal) ? normal : [];\r\n        this.color = color && color.isColor ? color : new Color();\r\n        this.vertexColors = Array.isArray(color) ? color : [];\r\n        this.materialIndex = materialIndex;\r\n    }\r\n    clone() {\r\n        // @ts-ignore\r\n        return new this.constructor().copy(this);\r\n    }\r\n    copy(source) {\r\n        this.a = source.a;\r\n        this.b = source.b;\r\n        this.c = source.c;\r\n        this.normal.copy(source.normal);\r\n        this.color.copy(source.color);\r\n        this.materialIndex = source.materialIndex;\r\n        for (let i = 0, il = source.vertexNormals.length; i < il; i++) {\r\n            this.vertexNormals[i] = source.vertexNormals[i].clone();\r\n        }\r\n        for (let i = 0, il = source.vertexColors.length; i < il; i++) {\r\n            this.vertexColors[i] = source.vertexColors[i].clone();\r\n        }\r\n        return this;\r\n    }\r\n}\r\nexport { Face3 };\r\n//# sourceMappingURL=face3.js.map","import {\n\tBox2,\n\tBufferGeometry,\n\tFileLoader,\n\tFloat32BufferAttribute,\n\tLoader,\n\tMatrix3,\n\tPath,\n\tShape,\n\tShapePath,\n\tShapeUtils,\n\tVector2,\n\tVector3\n} from 'three';\n\nclass SVGLoader extends Loader {\n\n\tconstructor( manager ) {\n\n\t\tsuper( manager );\n\n\t\t// Default dots per inch\n\t\tthis.defaultDPI = 90;\n\n\t\t// Accepted units: 'mm', 'cm', 'in', 'pt', 'pc', 'px'\n\t\tthis.defaultUnit = 'px';\n\n\t}\n\n\tload( url, onLoad, onProgress, onError ) {\n\n\t\tconst scope = this;\n\n\t\tconst loader = new FileLoader( scope.manager );\n\t\tloader.setPath( scope.path );\n\t\tloader.setRequestHeader( scope.requestHeader );\n\t\tloader.setWithCredentials( scope.withCredentials );\n\t\tloader.load( url, function ( text ) {\n\n\t\t\ttry {\n\n\t\t\t\tonLoad( scope.parse( text ) );\n\n\t\t\t} catch ( e ) {\n\n\t\t\t\tif ( onError ) {\n\n\t\t\t\t\tonError( e );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tconsole.error( e );\n\n\t\t\t\t}\n\n\t\t\t\tscope.manager.itemError( url );\n\n\t\t\t}\n\n\t\t}, onProgress, onError );\n\n\t}\n\n\tparse( text ) {\n\n\t\tconst scope = this;\n\n\t\tfunction parseNode( node, style ) {\n\n\t\t\tif ( node.nodeType !== 1 ) return;\n\n\t\t\tconst transform = getNodeTransform( node );\n\n\t\t\tlet traverseChildNodes = true;\n\n\t\t\tlet path = null;\n\n\t\t\tswitch ( node.nodeName ) {\n\n\t\t\t\tcase 'svg':\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'style':\n\t\t\t\t\tparseCSSStylesheet( node );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'g':\n\t\t\t\t\tstyle = parseStyle( node, style );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'path':\n\t\t\t\t\tstyle = parseStyle( node, style );\n\t\t\t\t\tif ( node.hasAttribute( 'd' ) ) path = parsePathNode( node );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'rect':\n\t\t\t\t\tstyle = parseStyle( node, style );\n\t\t\t\t\tpath = parseRectNode( node );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'polygon':\n\t\t\t\t\tstyle = parseStyle( node, style );\n\t\t\t\t\tpath = parsePolygonNode( node );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'polyline':\n\t\t\t\t\tstyle = parseStyle( node, style );\n\t\t\t\t\tpath = parsePolylineNode( node );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'circle':\n\t\t\t\t\tstyle = parseStyle( node, style );\n\t\t\t\t\tpath = parseCircleNode( node );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'ellipse':\n\t\t\t\t\tstyle = parseStyle( node, style );\n\t\t\t\t\tpath = parseEllipseNode( node );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'line':\n\t\t\t\t\tstyle = parseStyle( node, style );\n\t\t\t\t\tpath = parseLineNode( node );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'defs':\n\t\t\t\t\ttraverseChildNodes = false;\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'use':\n\t\t\t\t\tstyle = parseStyle( node, style );\n\t\t\t\t\tconst usedNodeId = node.href.baseVal.substring( 1 );\n\t\t\t\t\tconst usedNode = node.viewportElement.getElementById( usedNodeId );\n\t\t\t\t\tif ( usedNode ) {\n\n\t\t\t\t\t\tparseNode( usedNode, style );\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\tconsole.warn( 'SVGLoader: \\'use node\\' references non-existent node id: ' + usedNodeId );\n\n\t\t\t\t\t}\n\n\t\t\t\t\tbreak;\n\n\t\t\t\tdefault:\n\t\t\t\t\t// console.log( node );\n\n\t\t\t}\n\n\t\t\tif ( path ) {\n\n\t\t\t\tif ( style.fill !== undefined && style.fill !== 'none' ) {\n\n\t\t\t\t\tpath.color.setStyle( style.fill );\n\n\t\t\t\t}\n\n\t\t\t\ttransformPath( path, currentTransform );\n\n\t\t\t\tpaths.push( path );\n\n\t\t\t\tpath.userData = { node: node, style: style };\n\n\t\t\t}\n\n\t\t\tif ( traverseChildNodes ) {\n\n\t\t\t\tconst nodes = node.childNodes;\n\n\t\t\t\tfor ( let i = 0; i < nodes.length; i ++ ) {\n\n\t\t\t\t\tparseNode( nodes[ i ], style );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tif ( transform ) {\n\n\t\t\t\ttransformStack.pop();\n\n\t\t\t\tif ( transformStack.length > 0 ) {\n\n\t\t\t\t\tcurrentTransform.copy( transformStack[ transformStack.length - 1 ] );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tcurrentTransform.identity();\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\tfunction parsePathNode( node ) {\n\n\t\t\tconst path = new ShapePath();\n\n\t\t\tconst point = new Vector2();\n\t\t\tconst control = new Vector2();\n\n\t\t\tconst firstPoint = new Vector2();\n\t\t\tlet isFirstPoint = true;\n\t\t\tlet doSetFirstPoint = false;\n\n\t\t\tconst d = node.getAttribute( 'd' );\n\n\t\t\t// console.log( d );\n\n\t\t\tconst commands = d.match( /[a-df-z][^a-df-z]*/ig );\n\n\t\t\tfor ( let i = 0, l = commands.length; i < l; i ++ ) {\n\n\t\t\t\tconst command = commands[ i ];\n\n\t\t\t\tconst type = command.charAt( 0 );\n\t\t\t\tconst data = command.substr( 1 ).trim();\n\n\t\t\t\tif ( isFirstPoint === true ) {\n\n\t\t\t\t\tdoSetFirstPoint = true;\n\t\t\t\t\tisFirstPoint = false;\n\n\t\t\t\t}\n\n\t\t\t\tlet numbers;\n\n\t\t\t\tswitch ( type ) {\n\n\t\t\t\t\tcase 'M':\n\t\t\t\t\t\tnumbers = parseFloats( data );\n\t\t\t\t\t\tfor ( let j = 0, jl = numbers.length; j < jl; j += 2 ) {\n\n\t\t\t\t\t\t\tpoint.x = numbers[ j + 0 ];\n\t\t\t\t\t\t\tpoint.y = numbers[ j + 1 ];\n\t\t\t\t\t\t\tcontrol.x = point.x;\n\t\t\t\t\t\t\tcontrol.y = point.y;\n\n\t\t\t\t\t\t\tif ( j === 0 ) {\n\n\t\t\t\t\t\t\t\tpath.moveTo( point.x, point.y );\n\n\t\t\t\t\t\t\t} else {\n\n\t\t\t\t\t\t\t\tpath.lineTo( point.x, point.y );\n\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tif ( j === 0 && doSetFirstPoint === true ) firstPoint.copy( point );\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase 'H':\n\t\t\t\t\t\tnumbers = parseFloats( data );\n\n\t\t\t\t\t\tfor ( let j = 0, jl = numbers.length; j < jl; j ++ ) {\n\n\t\t\t\t\t\t\tpoint.x = numbers[ j ];\n\t\t\t\t\t\t\tcontrol.x = point.x;\n\t\t\t\t\t\t\tcontrol.y = point.y;\n\t\t\t\t\t\t\tpath.lineTo( point.x, point.y );\n\n\t\t\t\t\t\t\tif ( j === 0 && doSetFirstPoint === true ) firstPoint.copy( point );\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase 'V':\n\t\t\t\t\t\tnumbers = parseFloats( data );\n\n\t\t\t\t\t\tfor ( let j = 0, jl = numbers.length; j < jl; j ++ ) {\n\n\t\t\t\t\t\t\tpoint.y = numbers[ j ];\n\t\t\t\t\t\t\tcontrol.x = point.x;\n\t\t\t\t\t\t\tcontrol.y = point.y;\n\t\t\t\t\t\t\tpath.lineTo( point.x, point.y );\n\n\t\t\t\t\t\t\tif ( j === 0 && doSetFirstPoint === true ) firstPoint.copy( point );\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase 'L':\n\t\t\t\t\t\tnumbers = parseFloats( data );\n\n\t\t\t\t\t\tfor ( let j = 0, jl = numbers.length; j < jl; j += 2 ) {\n\n\t\t\t\t\t\t\tpoint.x = numbers[ j + 0 ];\n\t\t\t\t\t\t\tpoint.y = numbers[ j + 1 ];\n\t\t\t\t\t\t\tcontrol.x = point.x;\n\t\t\t\t\t\t\tcontrol.y = point.y;\n\t\t\t\t\t\t\tpath.lineTo( point.x, point.y );\n\n\t\t\t\t\t\t\tif ( j === 0 && doSetFirstPoint === true ) firstPoint.copy( point );\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase 'C':\n\t\t\t\t\t\tnumbers = parseFloats( data );\n\n\t\t\t\t\t\tfor ( let j = 0, jl = numbers.length; j < jl; j += 6 ) {\n\n\t\t\t\t\t\t\tpath.bezierCurveTo(\n\t\t\t\t\t\t\t\tnumbers[ j + 0 ],\n\t\t\t\t\t\t\t\tnumbers[ j + 1 ],\n\t\t\t\t\t\t\t\tnumbers[ j + 2 ],\n\t\t\t\t\t\t\t\tnumbers[ j + 3 ],\n\t\t\t\t\t\t\t\tnumbers[ j + 4 ],\n\t\t\t\t\t\t\t\tnumbers[ j + 5 ]\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\tcontrol.x = numbers[ j + 2 ];\n\t\t\t\t\t\t\tcontrol.y = numbers[ j + 3 ];\n\t\t\t\t\t\t\tpoint.x = numbers[ j + 4 ];\n\t\t\t\t\t\t\tpoint.y = numbers[ j + 5 ];\n\n\t\t\t\t\t\t\tif ( j === 0 && doSetFirstPoint === true ) firstPoint.copy( point );\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase 'S':\n\t\t\t\t\t\tnumbers = parseFloats( data );\n\n\t\t\t\t\t\tfor ( let j = 0, jl = numbers.length; j < jl; j += 4 ) {\n\n\t\t\t\t\t\t\tpath.bezierCurveTo(\n\t\t\t\t\t\t\t\tgetReflection( point.x, control.x ),\n\t\t\t\t\t\t\t\tgetReflection( point.y, control.y ),\n\t\t\t\t\t\t\t\tnumbers[ j + 0 ],\n\t\t\t\t\t\t\t\tnumbers[ j + 1 ],\n\t\t\t\t\t\t\t\tnumbers[ j + 2 ],\n\t\t\t\t\t\t\t\tnumbers[ j + 3 ]\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\tcontrol.x = numbers[ j + 0 ];\n\t\t\t\t\t\t\tcontrol.y = numbers[ j + 1 ];\n\t\t\t\t\t\t\tpoint.x = numbers[ j + 2 ];\n\t\t\t\t\t\t\tpoint.y = numbers[ j + 3 ];\n\n\t\t\t\t\t\t\tif ( j === 0 && doSetFirstPoint === true ) firstPoint.copy( point );\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase 'Q':\n\t\t\t\t\t\tnumbers = parseFloats( data );\n\n\t\t\t\t\t\tfor ( let j = 0, jl = numbers.length; j < jl; j += 4 ) {\n\n\t\t\t\t\t\t\tpath.quadraticCurveTo(\n\t\t\t\t\t\t\t\tnumbers[ j + 0 ],\n\t\t\t\t\t\t\t\tnumbers[ j + 1 ],\n\t\t\t\t\t\t\t\tnumbers[ j + 2 ],\n\t\t\t\t\t\t\t\tnumbers[ j + 3 ]\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\tcontrol.x = numbers[ j + 0 ];\n\t\t\t\t\t\t\tcontrol.y = numbers[ j + 1 ];\n\t\t\t\t\t\t\tpoint.x = numbers[ j + 2 ];\n\t\t\t\t\t\t\tpoint.y = numbers[ j + 3 ];\n\n\t\t\t\t\t\t\tif ( j === 0 && doSetFirstPoint === true ) firstPoint.copy( point );\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase 'T':\n\t\t\t\t\t\tnumbers = parseFloats( data );\n\n\t\t\t\t\t\tfor ( let j = 0, jl = numbers.length; j < jl; j += 2 ) {\n\n\t\t\t\t\t\t\tconst rx = getReflection( point.x, control.x );\n\t\t\t\t\t\t\tconst ry = getReflection( point.y, control.y );\n\t\t\t\t\t\t\tpath.quadraticCurveTo(\n\t\t\t\t\t\t\t\trx,\n\t\t\t\t\t\t\t\try,\n\t\t\t\t\t\t\t\tnumbers[ j + 0 ],\n\t\t\t\t\t\t\t\tnumbers[ j + 1 ]\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\tcontrol.x = rx;\n\t\t\t\t\t\t\tcontrol.y = ry;\n\t\t\t\t\t\t\tpoint.x = numbers[ j + 0 ];\n\t\t\t\t\t\t\tpoint.y = numbers[ j + 1 ];\n\n\t\t\t\t\t\t\tif ( j === 0 && doSetFirstPoint === true ) firstPoint.copy( point );\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase 'A':\n\t\t\t\t\t\tnumbers = parseFloats( data, [ 3, 4 ], 7 );\n\n\t\t\t\t\t\tfor ( let j = 0, jl = numbers.length; j < jl; j += 7 ) {\n\n\t\t\t\t\t\t\t// skip command if start point == end point\n\t\t\t\t\t\t\tif ( numbers[ j + 5 ] == point.x && numbers[ j + 6 ] == point.y ) continue;\n\n\t\t\t\t\t\t\tconst start = point.clone();\n\t\t\t\t\t\t\tpoint.x = numbers[ j + 5 ];\n\t\t\t\t\t\t\tpoint.y = numbers[ j + 6 ];\n\t\t\t\t\t\t\tcontrol.x = point.x;\n\t\t\t\t\t\t\tcontrol.y = point.y;\n\t\t\t\t\t\t\tparseArcCommand(\n\t\t\t\t\t\t\t\tpath, numbers[ j ], numbers[ j + 1 ], numbers[ j + 2 ], numbers[ j + 3 ], numbers[ j + 4 ], start, point\n\t\t\t\t\t\t\t);\n\n\t\t\t\t\t\t\tif ( j === 0 && doSetFirstPoint === true ) firstPoint.copy( point );\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase 'm':\n\t\t\t\t\t\tnumbers = parseFloats( data );\n\n\t\t\t\t\t\tfor ( let j = 0, jl = numbers.length; j < jl; j += 2 ) {\n\n\t\t\t\t\t\t\tpoint.x += numbers[ j + 0 ];\n\t\t\t\t\t\t\tpoint.y += numbers[ j + 1 ];\n\t\t\t\t\t\t\tcontrol.x = point.x;\n\t\t\t\t\t\t\tcontrol.y = point.y;\n\n\t\t\t\t\t\t\tif ( j === 0 ) {\n\n\t\t\t\t\t\t\t\tpath.moveTo( point.x, point.y );\n\n\t\t\t\t\t\t\t} else {\n\n\t\t\t\t\t\t\t\tpath.lineTo( point.x, point.y );\n\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tif ( j === 0 && doSetFirstPoint === true ) firstPoint.copy( point );\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase 'h':\n\t\t\t\t\t\tnumbers = parseFloats( data );\n\n\t\t\t\t\t\tfor ( let j = 0, jl = numbers.length; j < jl; j ++ ) {\n\n\t\t\t\t\t\t\tpoint.x += numbers[ j ];\n\t\t\t\t\t\t\tcontrol.x = point.x;\n\t\t\t\t\t\t\tcontrol.y = point.y;\n\t\t\t\t\t\t\tpath.lineTo( point.x, point.y );\n\n\t\t\t\t\t\t\tif ( j === 0 && doSetFirstPoint === true ) firstPoint.copy( point );\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase 'v':\n\t\t\t\t\t\tnumbers = parseFloats( data );\n\n\t\t\t\t\t\tfor ( let j = 0, jl = numbers.length; j < jl; j ++ ) {\n\n\t\t\t\t\t\t\tpoint.y += numbers[ j ];\n\t\t\t\t\t\t\tcontrol.x = point.x;\n\t\t\t\t\t\t\tcontrol.y = point.y;\n\t\t\t\t\t\t\tpath.lineTo( point.x, point.y );\n\n\t\t\t\t\t\t\tif ( j === 0 && doSetFirstPoint === true ) firstPoint.copy( point );\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase 'l':\n\t\t\t\t\t\tnumbers = parseFloats( data );\n\n\t\t\t\t\t\tfor ( let j = 0, jl = numbers.length; j < jl; j += 2 ) {\n\n\t\t\t\t\t\t\tpoint.x += numbers[ j + 0 ];\n\t\t\t\t\t\t\tpoint.y += numbers[ j + 1 ];\n\t\t\t\t\t\t\tcontrol.x = point.x;\n\t\t\t\t\t\t\tcontrol.y = point.y;\n\t\t\t\t\t\t\tpath.lineTo( point.x, point.y );\n\n\t\t\t\t\t\t\tif ( j === 0 && doSetFirstPoint === true ) firstPoint.copy( point );\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase 'c':\n\t\t\t\t\t\tnumbers = parseFloats( data );\n\n\t\t\t\t\t\tfor ( let j = 0, jl = numbers.length; j < jl; j += 6 ) {\n\n\t\t\t\t\t\t\tpath.bezierCurveTo(\n\t\t\t\t\t\t\t\tpoint.x + numbers[ j + 0 ],\n\t\t\t\t\t\t\t\tpoint.y + numbers[ j + 1 ],\n\t\t\t\t\t\t\t\tpoint.x + numbers[ j + 2 ],\n\t\t\t\t\t\t\t\tpoint.y + numbers[ j + 3 ],\n\t\t\t\t\t\t\t\tpoint.x + numbers[ j + 4 ],\n\t\t\t\t\t\t\t\tpoint.y + numbers[ j + 5 ]\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\tcontrol.x = point.x + numbers[ j + 2 ];\n\t\t\t\t\t\t\tcontrol.y = point.y + numbers[ j + 3 ];\n\t\t\t\t\t\t\tpoint.x += numbers[ j + 4 ];\n\t\t\t\t\t\t\tpoint.y += numbers[ j + 5 ];\n\n\t\t\t\t\t\t\tif ( j === 0 && doSetFirstPoint === true ) firstPoint.copy( point );\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase 's':\n\t\t\t\t\t\tnumbers = parseFloats( data );\n\n\t\t\t\t\t\tfor ( let j = 0, jl = numbers.length; j < jl; j += 4 ) {\n\n\t\t\t\t\t\t\tpath.bezierCurveTo(\n\t\t\t\t\t\t\t\tgetReflection( point.x, control.x ),\n\t\t\t\t\t\t\t\tgetReflection( point.y, control.y ),\n\t\t\t\t\t\t\t\tpoint.x + numbers[ j + 0 ],\n\t\t\t\t\t\t\t\tpoint.y + numbers[ j + 1 ],\n\t\t\t\t\t\t\t\tpoint.x + numbers[ j + 2 ],\n\t\t\t\t\t\t\t\tpoint.y + numbers[ j + 3 ]\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\tcontrol.x = point.x + numbers[ j + 0 ];\n\t\t\t\t\t\t\tcontrol.y = point.y + numbers[ j + 1 ];\n\t\t\t\t\t\t\tpoint.x += numbers[ j + 2 ];\n\t\t\t\t\t\t\tpoint.y += numbers[ j + 3 ];\n\n\t\t\t\t\t\t\tif ( j === 0 && doSetFirstPoint === true ) firstPoint.copy( point );\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase 'q':\n\t\t\t\t\t\tnumbers = parseFloats( data );\n\n\t\t\t\t\t\tfor ( let j = 0, jl = numbers.length; j < jl; j += 4 ) {\n\n\t\t\t\t\t\t\tpath.quadraticCurveTo(\n\t\t\t\t\t\t\t\tpoint.x + numbers[ j + 0 ],\n\t\t\t\t\t\t\t\tpoint.y + numbers[ j + 1 ],\n\t\t\t\t\t\t\t\tpoint.x + numbers[ j + 2 ],\n\t\t\t\t\t\t\t\tpoint.y + numbers[ j + 3 ]\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\tcontrol.x = point.x + numbers[ j + 0 ];\n\t\t\t\t\t\t\tcontrol.y = point.y + numbers[ j + 1 ];\n\t\t\t\t\t\t\tpoint.x += numbers[ j + 2 ];\n\t\t\t\t\t\t\tpoint.y += numbers[ j + 3 ];\n\n\t\t\t\t\t\t\tif ( j === 0 && doSetFirstPoint === true ) firstPoint.copy( point );\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase 't':\n\t\t\t\t\t\tnumbers = parseFloats( data );\n\n\t\t\t\t\t\tfor ( let j = 0, jl = numbers.length; j < jl; j += 2 ) {\n\n\t\t\t\t\t\t\tconst rx = getReflection( point.x, control.x );\n\t\t\t\t\t\t\tconst ry = getReflection( point.y, control.y );\n\t\t\t\t\t\t\tpath.quadraticCurveTo(\n\t\t\t\t\t\t\t\trx,\n\t\t\t\t\t\t\t\try,\n\t\t\t\t\t\t\t\tpoint.x + numbers[ j + 0 ],\n\t\t\t\t\t\t\t\tpoint.y + numbers[ j + 1 ]\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\tcontrol.x = rx;\n\t\t\t\t\t\t\tcontrol.y = ry;\n\t\t\t\t\t\t\tpoint.x = point.x + numbers[ j + 0 ];\n\t\t\t\t\t\t\tpoint.y = point.y + numbers[ j + 1 ];\n\n\t\t\t\t\t\t\tif ( j === 0 && doSetFirstPoint === true ) firstPoint.copy( point );\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase 'a':\n\t\t\t\t\t\tnumbers = parseFloats( data, [ 3, 4 ], 7 );\n\n\t\t\t\t\t\tfor ( let j = 0, jl = numbers.length; j < jl; j += 7 ) {\n\n\t\t\t\t\t\t\t// skip command if no displacement\n\t\t\t\t\t\t\tif ( numbers[ j + 5 ] == 0 && numbers[ j + 6 ] == 0 ) continue;\n\n\t\t\t\t\t\t\tconst start = point.clone();\n\t\t\t\t\t\t\tpoint.x += numbers[ j + 5 ];\n\t\t\t\t\t\t\tpoint.y += numbers[ j + 6 ];\n\t\t\t\t\t\t\tcontrol.x = point.x;\n\t\t\t\t\t\t\tcontrol.y = point.y;\n\t\t\t\t\t\t\tparseArcCommand(\n\t\t\t\t\t\t\t\tpath, numbers[ j ], numbers[ j + 1 ], numbers[ j + 2 ], numbers[ j + 3 ], numbers[ j + 4 ], start, point\n\t\t\t\t\t\t\t);\n\n\t\t\t\t\t\t\tif ( j === 0 && doSetFirstPoint === true ) firstPoint.copy( point );\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase 'Z':\n\t\t\t\t\tcase 'z':\n\t\t\t\t\t\tpath.currentPath.autoClose = true;\n\n\t\t\t\t\t\tif ( path.currentPath.curves.length > 0 ) {\n\n\t\t\t\t\t\t\t// Reset point to beginning of Path\n\t\t\t\t\t\t\tpoint.copy( firstPoint );\n\t\t\t\t\t\t\tpath.currentPath.currentPoint.copy( point );\n\t\t\t\t\t\t\tisFirstPoint = true;\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tdefault:\n\t\t\t\t\t\tconsole.warn( command );\n\n\t\t\t\t}\n\n\t\t\t\t// console.log( type, parseFloats( data ), parseFloats( data ).length  )\n\n\t\t\t\tdoSetFirstPoint = false;\n\n\t\t\t}\n\n\t\t\treturn path;\n\n\t\t}\n\n\t\tfunction parseCSSStylesheet( node ) {\n\n\t\t\tif ( ! node.sheet || ! node.sheet.cssRules || ! node.sheet.cssRules.length ) return;\n\n\t\t\tfor ( let i = 0; i < node.sheet.cssRules.length; i ++ ) {\n\n\t\t\t\tconst stylesheet = node.sheet.cssRules[ i ];\n\n\t\t\t\tif ( stylesheet.type !== 1 ) continue;\n\n\t\t\t\tconst selectorList = stylesheet.selectorText\n\t\t\t\t\t.split( /,/gm )\n\t\t\t\t\t.filter( Boolean )\n\t\t\t\t\t.map( i => i.trim() );\n\n\t\t\t\tfor ( let j = 0; j < selectorList.length; j ++ ) {\n\n\t\t\t\t\tstylesheets[ selectorList[ j ] ] = Object.assign(\n\t\t\t\t\t\tstylesheets[ selectorList[ j ] ] || {},\n\t\t\t\t\t\tstylesheet.style\n\t\t\t\t\t);\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\t/**\n\t\t * https://www.w3.org/TR/SVG/implnote.html#ArcImplementationNotes\n\t\t * https://mortoray.com/2017/02/16/rendering-an-svg-elliptical-arc-as-bezier-curves/ Appendix: Endpoint to center arc conversion\n\t\t * From\n\t\t * rx ry x-axis-rotation large-arc-flag sweep-flag x y\n\t\t * To\n\t\t * aX, aY, xRadius, yRadius, aStartAngle, aEndAngle, aClockwise, aRotation\n\t\t */\n\n\t\tfunction parseArcCommand( path, rx, ry, x_axis_rotation, large_arc_flag, sweep_flag, start, end ) {\n\n\t\t\tif ( rx == 0 || ry == 0 ) {\n\n\t\t\t\t// draw a line if either of the radii == 0\n\t\t\t\tpath.lineTo( end.x, end.y );\n\t\t\t\treturn;\n\n\t\t\t}\n\n\t\t\tx_axis_rotation = x_axis_rotation * Math.PI / 180;\n\n\t\t\t// Ensure radii are positive\n\t\t\trx = Math.abs( rx );\n\t\t\try = Math.abs( ry );\n\n\t\t\t// Compute (x1', y1')\n\t\t\tconst dx2 = ( start.x - end.x ) / 2.0;\n\t\t\tconst dy2 = ( start.y - end.y ) / 2.0;\n\t\t\tconst x1p = Math.cos( x_axis_rotation ) * dx2 + Math.sin( x_axis_rotation ) * dy2;\n\t\t\tconst y1p = - Math.sin( x_axis_rotation ) * dx2 + Math.cos( x_axis_rotation ) * dy2;\n\n\t\t\t// Compute (cx', cy')\n\t\t\tlet rxs = rx * rx;\n\t\t\tlet rys = ry * ry;\n\t\t\tconst x1ps = x1p * x1p;\n\t\t\tconst y1ps = y1p * y1p;\n\n\t\t\t// Ensure radii are large enough\n\t\t\tconst cr = x1ps / rxs + y1ps / rys;\n\n\t\t\tif ( cr > 1 ) {\n\n\t\t\t\t// scale up rx,ry equally so cr == 1\n\t\t\t\tconst s = Math.sqrt( cr );\n\t\t\t\trx = s * rx;\n\t\t\t\try = s * ry;\n\t\t\t\trxs = rx * rx;\n\t\t\t\trys = ry * ry;\n\n\t\t\t}\n\n\t\t\tconst dq = ( rxs * y1ps + rys * x1ps );\n\t\t\tconst pq = ( rxs * rys - dq ) / dq;\n\t\t\tlet q = Math.sqrt( Math.max( 0, pq ) );\n\t\t\tif ( large_arc_flag === sweep_flag ) q = - q;\n\t\t\tconst cxp = q * rx * y1p / ry;\n\t\t\tconst cyp = - q * ry * x1p / rx;\n\n\t\t\t// Step 3: Compute (cx, cy) from (cx', cy')\n\t\t\tconst cx = Math.cos( x_axis_rotation ) * cxp - Math.sin( x_axis_rotation ) * cyp + ( start.x + end.x ) / 2;\n\t\t\tconst cy = Math.sin( x_axis_rotation ) * cxp + Math.cos( x_axis_rotation ) * cyp + ( start.y + end.y ) / 2;\n\n\t\t\t// Step 4: Compute 1 and \n\t\t\tconst theta = svgAngle( 1, 0, ( x1p - cxp ) / rx, ( y1p - cyp ) / ry );\n\t\t\tconst delta = svgAngle( ( x1p - cxp ) / rx, ( y1p - cyp ) / ry, ( - x1p - cxp ) / rx, ( - y1p - cyp ) / ry ) % ( Math.PI * 2 );\n\n\t\t\tpath.currentPath.absellipse( cx, cy, rx, ry, theta, theta + delta, sweep_flag === 0, x_axis_rotation );\n\n\t\t}\n\n\t\tfunction svgAngle( ux, uy, vx, vy ) {\n\n\t\t\tconst dot = ux * vx + uy * vy;\n\t\t\tconst len = Math.sqrt( ux * ux + uy * uy ) * Math.sqrt( vx * vx + vy * vy );\n\t\t\tlet ang = Math.acos( Math.max( - 1, Math.min( 1, dot / len ) ) ); // floating point precision, slightly over values appear\n\t\t\tif ( ( ux * vy - uy * vx ) < 0 ) ang = - ang;\n\t\t\treturn ang;\n\n\t\t}\n\n\t\t/*\n\t\t* According to https://www.w3.org/TR/SVG/shapes.html#RectElementRXAttribute\n\t\t* rounded corner should be rendered to elliptical arc, but bezier curve does the job well enough\n\t\t*/\n\t\tfunction parseRectNode( node ) {\n\n\t\t\tconst x = parseFloatWithUnits( node.getAttribute( 'x' ) || 0 );\n\t\t\tconst y = parseFloatWithUnits( node.getAttribute( 'y' ) || 0 );\n\t\t\tconst rx = parseFloatWithUnits( node.getAttribute( 'rx' ) || 0 );\n\t\t\tconst ry = parseFloatWithUnits( node.getAttribute( 'ry' ) || 0 );\n\t\t\tconst w = parseFloatWithUnits( node.getAttribute( 'width' ) );\n\t\t\tconst h = parseFloatWithUnits( node.getAttribute( 'height' ) );\n\n\t\t\tconst path = new ShapePath();\n\t\t\tpath.moveTo( x + 2 * rx, y );\n\t\t\tpath.lineTo( x + w - 2 * rx, y );\n\t\t\tif ( rx !== 0 || ry !== 0 ) path.bezierCurveTo( x + w, y, x + w, y, x + w, y + 2 * ry );\n\t\t\tpath.lineTo( x + w, y + h - 2 * ry );\n\t\t\tif ( rx !== 0 || ry !== 0 ) path.bezierCurveTo( x + w, y + h, x + w, y + h, x + w - 2 * rx, y + h );\n\t\t\tpath.lineTo( x + 2 * rx, y + h );\n\n\t\t\tif ( rx !== 0 || ry !== 0 ) {\n\n\t\t\t\tpath.bezierCurveTo( x, y + h, x, y + h, x, y + h - 2 * ry );\n\n\t\t\t}\n\n\t\t\tpath.lineTo( x, y + 2 * ry );\n\n\t\t\tif ( rx !== 0 || ry !== 0 ) {\n\n\t\t\t\tpath.bezierCurveTo( x, y, x, y, x + 2 * rx, y );\n\n\t\t\t}\n\n\t\t\treturn path;\n\n\t\t}\n\n\t\tfunction parsePolygonNode( node ) {\n\n\t\t\tfunction iterator( match, a, b ) {\n\n\t\t\t\tconst x = parseFloatWithUnits( a );\n\t\t\t\tconst y = parseFloatWithUnits( b );\n\n\t\t\t\tif ( index === 0 ) {\n\n\t\t\t\t\tpath.moveTo( x, y );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tpath.lineTo( x, y );\n\n\t\t\t\t}\n\n\t\t\t\tindex ++;\n\n\t\t\t}\n\n\t\t\tconst regex = /(-?[\\d\\.?]+)[,|\\s](-?[\\d\\.?]+)/g;\n\n\t\t\tconst path = new ShapePath();\n\n\t\t\tlet index = 0;\n\n\t\t\tnode.getAttribute( 'points' ).replace( regex, iterator );\n\n\t\t\tpath.currentPath.autoClose = true;\n\n\t\t\treturn path;\n\n\t\t}\n\n\t\tfunction parsePolylineNode( node ) {\n\n\t\t\tfunction iterator( match, a, b ) {\n\n\t\t\t\tconst x = parseFloatWithUnits( a );\n\t\t\t\tconst y = parseFloatWithUnits( b );\n\n\t\t\t\tif ( index === 0 ) {\n\n\t\t\t\t\tpath.moveTo( x, y );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tpath.lineTo( x, y );\n\n\t\t\t\t}\n\n\t\t\t\tindex ++;\n\n\t\t\t}\n\n\t\t\tconst regex = /(-?[\\d\\.?]+)[,|\\s](-?[\\d\\.?]+)/g;\n\n\t\t\tconst path = new ShapePath();\n\n\t\t\tlet index = 0;\n\n\t\t\tnode.getAttribute( 'points' ).replace( regex, iterator );\n\n\t\t\tpath.currentPath.autoClose = false;\n\n\t\t\treturn path;\n\n\t\t}\n\n\t\tfunction parseCircleNode( node ) {\n\n\t\t\tconst x = parseFloatWithUnits( node.getAttribute( 'cx' ) || 0 );\n\t\t\tconst y = parseFloatWithUnits( node.getAttribute( 'cy' ) || 0 );\n\t\t\tconst r = parseFloatWithUnits( node.getAttribute( 'r' ) || 0 );\n\n\t\t\tconst subpath = new Path();\n\t\t\tsubpath.absarc( x, y, r, 0, Math.PI * 2 );\n\n\t\t\tconst path = new ShapePath();\n\t\t\tpath.subPaths.push( subpath );\n\n\t\t\treturn path;\n\n\t\t}\n\n\t\tfunction parseEllipseNode( node ) {\n\n\t\t\tconst x = parseFloatWithUnits( node.getAttribute( 'cx' ) || 0 );\n\t\t\tconst y = parseFloatWithUnits( node.getAttribute( 'cy' ) || 0 );\n\t\t\tconst rx = parseFloatWithUnits( node.getAttribute( 'rx' ) || 0 );\n\t\t\tconst ry = parseFloatWithUnits( node.getAttribute( 'ry' ) || 0 );\n\n\t\t\tconst subpath = new Path();\n\t\t\tsubpath.absellipse( x, y, rx, ry, 0, Math.PI * 2 );\n\n\t\t\tconst path = new ShapePath();\n\t\t\tpath.subPaths.push( subpath );\n\n\t\t\treturn path;\n\n\t\t}\n\n\t\tfunction parseLineNode( node ) {\n\n\t\t\tconst x1 = parseFloatWithUnits( node.getAttribute( 'x1' ) || 0 );\n\t\t\tconst y1 = parseFloatWithUnits( node.getAttribute( 'y1' ) || 0 );\n\t\t\tconst x2 = parseFloatWithUnits( node.getAttribute( 'x2' ) || 0 );\n\t\t\tconst y2 = parseFloatWithUnits( node.getAttribute( 'y2' ) || 0 );\n\n\t\t\tconst path = new ShapePath();\n\t\t\tpath.moveTo( x1, y1 );\n\t\t\tpath.lineTo( x2, y2 );\n\t\t\tpath.currentPath.autoClose = false;\n\n\t\t\treturn path;\n\n\t\t}\n\n\t\t//\n\n\t\tfunction parseStyle( node, style ) {\n\n\t\t\tstyle = Object.assign( {}, style ); // clone style\n\n\t\t\tlet stylesheetStyles = {};\n\n\t\t\tif ( node.hasAttribute( 'class' ) ) {\n\n\t\t\t\tconst classSelectors = node.getAttribute( 'class' )\n\t\t\t\t\t.split( /\\s/ )\n\t\t\t\t\t.filter( Boolean )\n\t\t\t\t\t.map( i => i.trim() );\n\n\t\t\t\tfor ( let i = 0; i < classSelectors.length; i ++ ) {\n\n\t\t\t\t\tstylesheetStyles = Object.assign( stylesheetStyles, stylesheets[ '.' + classSelectors[ i ] ] );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tif ( node.hasAttribute( 'id' ) ) {\n\n\t\t\t\tstylesheetStyles = Object.assign( stylesheetStyles, stylesheets[ '#' + node.getAttribute( 'id' ) ] );\n\n\t\t\t}\n\n\t\t\tfunction addStyle( svgName, jsName, adjustFunction ) {\n\n\t\t\t\tif ( adjustFunction === undefined ) adjustFunction = function copy( v ) {\n\n\t\t\t\t\tif ( v.startsWith( 'url' ) ) console.warn( 'SVGLoader: url access in attributes is not implemented.' );\n\n\t\t\t\t\treturn v;\n\n\t\t\t\t};\n\n\t\t\t\tif ( node.hasAttribute( svgName ) ) style[ jsName ] = adjustFunction( node.getAttribute( svgName ) );\n\t\t\t\tif ( stylesheetStyles[ svgName ] ) style[ jsName ] = adjustFunction( stylesheetStyles[ svgName ] );\n\t\t\t\tif ( node.style && node.style[ svgName ] !== '' ) style[ jsName ] = adjustFunction( node.style[ svgName ] );\n\n\t\t\t}\n\n\t\t\tfunction clamp( v ) {\n\n\t\t\t\treturn Math.max( 0, Math.min( 1, parseFloatWithUnits( v ) ) );\n\n\t\t\t}\n\n\t\t\tfunction positive( v ) {\n\n\t\t\t\treturn Math.max( 0, parseFloatWithUnits( v ) );\n\n\t\t\t}\n\n\t\t\taddStyle( 'fill', 'fill' );\n\t\t\taddStyle( 'fill-opacity', 'fillOpacity', clamp );\n\t\t\taddStyle( 'opacity', 'opacity', clamp );\n\t\t\taddStyle( 'stroke', 'stroke' );\n\t\t\taddStyle( 'stroke-opacity', 'strokeOpacity', clamp );\n\t\t\taddStyle( 'stroke-width', 'strokeWidth', positive );\n\t\t\taddStyle( 'stroke-linejoin', 'strokeLineJoin' );\n\t\t\taddStyle( 'stroke-linecap', 'strokeLineCap' );\n\t\t\taddStyle( 'stroke-miterlimit', 'strokeMiterLimit', positive );\n\t\t\taddStyle( 'visibility', 'visibility' );\n\n\t\t\treturn style;\n\n\t\t}\n\n\t\t// http://www.w3.org/TR/SVG11/implnote.html#PathElementImplementationNotes\n\n\t\tfunction getReflection( a, b ) {\n\n\t\t\treturn a - ( b - a );\n\n\t\t}\n\n\t\t// from https://github.com/ppvg/svg-numbers (MIT License)\n\n\t\tfunction parseFloats( input, flags, stride ) {\n\n\t\t\tif ( typeof input !== 'string' ) {\n\n\t\t\t\tthrow new TypeError( 'Invalid input: ' + typeof input );\n\n\t\t\t}\n\n\t\t\t// Character groups\n\t\t\tconst RE = {\n\t\t\t\tSEPARATOR: /[ \\t\\r\\n\\,.\\-+]/,\n\t\t\t\tWHITESPACE: /[ \\t\\r\\n]/,\n\t\t\t\tDIGIT: /[\\d]/,\n\t\t\t\tSIGN: /[-+]/,\n\t\t\t\tPOINT: /\\./,\n\t\t\t\tCOMMA: /,/,\n\t\t\t\tEXP: /e/i,\n\t\t\t\tFLAGS: /[01]/\n\t\t\t};\n\n\t\t\t// States\n\t\t\tconst SEP = 0;\n\t\t\tconst INT = 1;\n\t\t\tconst FLOAT = 2;\n\t\t\tconst EXP = 3;\n\n\t\t\tlet state = SEP;\n\t\t\tlet seenComma = true;\n\t\t\tlet number = '', exponent = '';\n\t\t\tconst result = [];\n\n\t\t\tfunction throwSyntaxError( current, i, partial ) {\n\n\t\t\t\tconst error = new SyntaxError( 'Unexpected character \"' + current + '\" at index ' + i + '.' );\n\t\t\t\terror.partial = partial;\n\t\t\t\tthrow error;\n\n\t\t\t}\n\n\t\t\tfunction newNumber() {\n\n\t\t\t\tif ( number !== '' ) {\n\n\t\t\t\t\tif ( exponent === '' ) result.push( Number( number ) );\n\t\t\t\t\telse result.push( Number( number ) * Math.pow( 10, Number( exponent ) ) );\n\n\t\t\t\t}\n\n\t\t\t\tnumber = '';\n\t\t\t\texponent = '';\n\n\t\t\t}\n\n\t\t\tlet current;\n\t\t\tconst length = input.length;\n\n\t\t\tfor ( let i = 0; i < length; i ++ ) {\n\n\t\t\t\tcurrent = input[ i ];\n\n\t\t\t\t// check for flags\n\t\t\t\tif ( Array.isArray( flags ) && flags.includes( result.length % stride ) && RE.FLAGS.test( current ) ) {\n\n\t\t\t\t\tstate = INT;\n\t\t\t\t\tnumber = current;\n\t\t\t\t\tnewNumber();\n\t\t\t\t\tcontinue;\n\n\t\t\t\t}\n\n\t\t\t\t// parse until next number\n\t\t\t\tif ( state === SEP ) {\n\n\t\t\t\t\t// eat whitespace\n\t\t\t\t\tif ( RE.WHITESPACE.test( current ) ) {\n\n\t\t\t\t\t\tcontinue;\n\n\t\t\t\t\t}\n\n\t\t\t\t\t// start new number\n\t\t\t\t\tif ( RE.DIGIT.test( current ) || RE.SIGN.test( current ) ) {\n\n\t\t\t\t\t\tstate = INT;\n\t\t\t\t\t\tnumber = current;\n\t\t\t\t\t\tcontinue;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( RE.POINT.test( current ) ) {\n\n\t\t\t\t\t\tstate = FLOAT;\n\t\t\t\t\t\tnumber = current;\n\t\t\t\t\t\tcontinue;\n\n\t\t\t\t\t}\n\n\t\t\t\t\t// throw on double commas (e.g. \"1, , 2\")\n\t\t\t\t\tif ( RE.COMMA.test( current ) ) {\n\n\t\t\t\t\t\tif ( seenComma ) {\n\n\t\t\t\t\t\t\tthrowSyntaxError( current, i, result );\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tseenComma = true;\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\t// parse integer part\n\t\t\t\tif ( state === INT ) {\n\n\t\t\t\t\tif ( RE.DIGIT.test( current ) ) {\n\n\t\t\t\t\t\tnumber += current;\n\t\t\t\t\t\tcontinue;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( RE.POINT.test( current ) ) {\n\n\t\t\t\t\t\tnumber += current;\n\t\t\t\t\t\tstate = FLOAT;\n\t\t\t\t\t\tcontinue;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( RE.EXP.test( current ) ) {\n\n\t\t\t\t\t\tstate = EXP;\n\t\t\t\t\t\tcontinue;\n\n\t\t\t\t\t}\n\n\t\t\t\t\t// throw on double signs (\"-+1\"), but not on sign as separator (\"-1-2\")\n\t\t\t\t\tif ( RE.SIGN.test( current )\n\t\t\t\t\t\t\t&& number.length === 1\n\t\t\t\t\t\t\t&& RE.SIGN.test( number[ 0 ] ) ) {\n\n\t\t\t\t\t\tthrowSyntaxError( current, i, result );\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\t// parse decimal part\n\t\t\t\tif ( state === FLOAT ) {\n\n\t\t\t\t\tif ( RE.DIGIT.test( current ) ) {\n\n\t\t\t\t\t\tnumber += current;\n\t\t\t\t\t\tcontinue;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( RE.EXP.test( current ) ) {\n\n\t\t\t\t\t\tstate = EXP;\n\t\t\t\t\t\tcontinue;\n\n\t\t\t\t\t}\n\n\t\t\t\t\t// throw on double decimal points (e.g. \"1..2\")\n\t\t\t\t\tif ( RE.POINT.test( current ) && number[ number.length - 1 ] === '.' ) {\n\n\t\t\t\t\t\tthrowSyntaxError( current, i, result );\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\t// parse exponent part\n\t\t\t\tif ( state === EXP ) {\n\n\t\t\t\t\tif ( RE.DIGIT.test( current ) ) {\n\n\t\t\t\t\t\texponent += current;\n\t\t\t\t\t\tcontinue;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( RE.SIGN.test( current ) ) {\n\n\t\t\t\t\t\tif ( exponent === '' ) {\n\n\t\t\t\t\t\t\texponent += current;\n\t\t\t\t\t\t\tcontinue;\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif ( exponent.length === 1 && RE.SIGN.test( exponent ) ) {\n\n\t\t\t\t\t\t\tthrowSyntaxError( current, i, result );\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\n\t\t\t\t// end of number\n\t\t\t\tif ( RE.WHITESPACE.test( current ) ) {\n\n\t\t\t\t\tnewNumber();\n\t\t\t\t\tstate = SEP;\n\t\t\t\t\tseenComma = false;\n\n\t\t\t\t} else if ( RE.COMMA.test( current ) ) {\n\n\t\t\t\t\tnewNumber();\n\t\t\t\t\tstate = SEP;\n\t\t\t\t\tseenComma = true;\n\n\t\t\t\t} else if ( RE.SIGN.test( current ) ) {\n\n\t\t\t\t\tnewNumber();\n\t\t\t\t\tstate = INT;\n\t\t\t\t\tnumber = current;\n\n\t\t\t\t} else if ( RE.POINT.test( current ) ) {\n\n\t\t\t\t\tnewNumber();\n\t\t\t\t\tstate = FLOAT;\n\t\t\t\t\tnumber = current;\n\n\t\t\t\t} else {\n\n\t\t\t\t\tthrowSyntaxError( current, i, result );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\t// add the last number found (if any)\n\t\t\tnewNumber();\n\n\t\t\treturn result;\n\n\t\t}\n\n\t\t// Units\n\n\t\tconst units = [ 'mm', 'cm', 'in', 'pt', 'pc', 'px' ];\n\n\t\t// Conversion: [ fromUnit ][ toUnit ] (-1 means dpi dependent)\n\t\tconst unitConversion = {\n\n\t\t\t'mm': {\n\t\t\t\t'mm': 1,\n\t\t\t\t'cm': 0.1,\n\t\t\t\t'in': 1 / 25.4,\n\t\t\t\t'pt': 72 / 25.4,\n\t\t\t\t'pc': 6 / 25.4,\n\t\t\t\t'px': - 1\n\t\t\t},\n\t\t\t'cm': {\n\t\t\t\t'mm': 10,\n\t\t\t\t'cm': 1,\n\t\t\t\t'in': 1 / 2.54,\n\t\t\t\t'pt': 72 / 2.54,\n\t\t\t\t'pc': 6 / 2.54,\n\t\t\t\t'px': - 1\n\t\t\t},\n\t\t\t'in': {\n\t\t\t\t'mm': 25.4,\n\t\t\t\t'cm': 2.54,\n\t\t\t\t'in': 1,\n\t\t\t\t'pt': 72,\n\t\t\t\t'pc': 6,\n\t\t\t\t'px': - 1\n\t\t\t},\n\t\t\t'pt': {\n\t\t\t\t'mm': 25.4 / 72,\n\t\t\t\t'cm': 2.54 / 72,\n\t\t\t\t'in': 1 / 72,\n\t\t\t\t'pt': 1,\n\t\t\t\t'pc': 6 / 72,\n\t\t\t\t'px': - 1\n\t\t\t},\n\t\t\t'pc': {\n\t\t\t\t'mm': 25.4 / 6,\n\t\t\t\t'cm': 2.54 / 6,\n\t\t\t\t'in': 1 / 6,\n\t\t\t\t'pt': 72 / 6,\n\t\t\t\t'pc': 1,\n\t\t\t\t'px': - 1\n\t\t\t},\n\t\t\t'px': {\n\t\t\t\t'px': 1\n\t\t\t}\n\n\t\t};\n\n\t\tfunction parseFloatWithUnits( string ) {\n\n\t\t\tlet theUnit = 'px';\n\n\t\t\tif ( typeof string === 'string' || string instanceof String ) {\n\n\t\t\t\tfor ( let i = 0, n = units.length; i < n; i ++ ) {\n\n\t\t\t\t\tconst u = units[ i ];\n\n\t\t\t\t\tif ( string.endsWith( u ) ) {\n\n\t\t\t\t\t\ttheUnit = u;\n\t\t\t\t\t\tstring = string.substring( 0, string.length - u.length );\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tlet scale = undefined;\n\n\t\t\tif ( theUnit === 'px' && scope.defaultUnit !== 'px' ) {\n\n\t\t\t\t// Conversion scale from  pixels to inches, then to default units\n\n\t\t\t\tscale = unitConversion[ 'in' ][ scope.defaultUnit ] / scope.defaultDPI;\n\n\t\t\t} else {\n\n\t\t\t\tscale = unitConversion[ theUnit ][ scope.defaultUnit ];\n\n\t\t\t\tif ( scale < 0 ) {\n\n\t\t\t\t\t// Conversion scale to pixels\n\n\t\t\t\t\tscale = unitConversion[ theUnit ][ 'in' ] * scope.defaultDPI;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\treturn scale * parseFloat( string );\n\n\t\t}\n\n\t\t// Transforms\n\n\t\tfunction getNodeTransform( node ) {\n\n\t\t\tif ( ! ( node.hasAttribute( 'transform' ) || ( node.nodeName === 'use' && ( node.hasAttribute( 'x' ) || node.hasAttribute( 'y' ) ) ) ) ) {\n\n\t\t\t\treturn null;\n\n\t\t\t}\n\n\t\t\tconst transform = parseNodeTransform( node );\n\n\t\t\tif ( transformStack.length > 0 ) {\n\n\t\t\t\ttransform.premultiply( transformStack[ transformStack.length - 1 ] );\n\n\t\t\t}\n\n\t\t\tcurrentTransform.copy( transform );\n\t\t\ttransformStack.push( transform );\n\n\t\t\treturn transform;\n\n\t\t}\n\n\t\tfunction parseNodeTransform( node ) {\n\n\t\t\tconst transform = new Matrix3();\n\t\t\tconst currentTransform = tempTransform0;\n\n\t\t\tif ( node.nodeName === 'use' && ( node.hasAttribute( 'x' ) || node.hasAttribute( 'y' ) ) ) {\n\n\t\t\t\tconst tx = parseFloatWithUnits( node.getAttribute( 'x' ) );\n\t\t\t\tconst ty = parseFloatWithUnits( node.getAttribute( 'y' ) );\n\n\t\t\t\ttransform.translate( tx, ty );\n\n\t\t\t}\n\n\t\t\tif ( node.hasAttribute( 'transform' ) ) {\n\n\t\t\t\tconst transformsTexts = node.getAttribute( 'transform' ).split( ')' );\n\n\t\t\t\tfor ( let tIndex = transformsTexts.length - 1; tIndex >= 0; tIndex -- ) {\n\n\t\t\t\t\tconst transformText = transformsTexts[ tIndex ].trim();\n\n\t\t\t\t\tif ( transformText === '' ) continue;\n\n\t\t\t\t\tconst openParPos = transformText.indexOf( '(' );\n\t\t\t\t\tconst closeParPos = transformText.length;\n\n\t\t\t\t\tif ( openParPos > 0 && openParPos < closeParPos ) {\n\n\t\t\t\t\t\tconst transformType = transformText.substr( 0, openParPos );\n\n\t\t\t\t\t\tconst array = parseFloats( transformText.substr( openParPos + 1, closeParPos - openParPos - 1 ) );\n\n\t\t\t\t\t\tcurrentTransform.identity();\n\n\t\t\t\t\t\tswitch ( transformType ) {\n\n\t\t\t\t\t\t\tcase 'translate':\n\n\t\t\t\t\t\t\t\tif ( array.length >= 1 ) {\n\n\t\t\t\t\t\t\t\t\tconst tx = array[ 0 ];\n\t\t\t\t\t\t\t\t\tlet ty = tx;\n\n\t\t\t\t\t\t\t\t\tif ( array.length >= 2 ) {\n\n\t\t\t\t\t\t\t\t\t\tty = array[ 1 ];\n\n\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\tcurrentTransform.translate( tx, ty );\n\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\t\tcase 'rotate':\n\n\t\t\t\t\t\t\t\tif ( array.length >= 1 ) {\n\n\t\t\t\t\t\t\t\t\tlet angle = 0;\n\t\t\t\t\t\t\t\t\tlet cx = 0;\n\t\t\t\t\t\t\t\t\tlet cy = 0;\n\n\t\t\t\t\t\t\t\t\t// Angle\n\t\t\t\t\t\t\t\t\tangle = - array[ 0 ] * Math.PI / 180;\n\n\t\t\t\t\t\t\t\t\tif ( array.length >= 3 ) {\n\n\t\t\t\t\t\t\t\t\t\t// Center x, y\n\t\t\t\t\t\t\t\t\t\tcx = array[ 1 ];\n\t\t\t\t\t\t\t\t\t\tcy = array[ 2 ];\n\n\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\t// Rotate around center (cx, cy)\n\t\t\t\t\t\t\t\t\ttempTransform1.identity().translate( - cx, - cy );\n\t\t\t\t\t\t\t\t\ttempTransform2.identity().rotate( angle );\n\t\t\t\t\t\t\t\t\ttempTransform3.multiplyMatrices( tempTransform2, tempTransform1 );\n\t\t\t\t\t\t\t\t\ttempTransform1.identity().translate( cx, cy );\n\t\t\t\t\t\t\t\t\tcurrentTransform.multiplyMatrices( tempTransform1, tempTransform3 );\n\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\t\tcase 'scale':\n\n\t\t\t\t\t\t\t\tif ( array.length >= 1 ) {\n\n\t\t\t\t\t\t\t\t\tconst scaleX = array[ 0 ];\n\t\t\t\t\t\t\t\t\tlet scaleY = scaleX;\n\n\t\t\t\t\t\t\t\t\tif ( array.length >= 2 ) {\n\n\t\t\t\t\t\t\t\t\t\tscaleY = array[ 1 ];\n\n\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\tcurrentTransform.scale( scaleX, scaleY );\n\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\t\tcase 'skewX':\n\n\t\t\t\t\t\t\t\tif ( array.length === 1 ) {\n\n\t\t\t\t\t\t\t\t\tcurrentTransform.set(\n\t\t\t\t\t\t\t\t\t\t1, Math.tan( array[ 0 ] * Math.PI / 180 ), 0,\n\t\t\t\t\t\t\t\t\t\t0, 1, 0,\n\t\t\t\t\t\t\t\t\t\t0, 0, 1\n\t\t\t\t\t\t\t\t\t);\n\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\t\tcase 'skewY':\n\n\t\t\t\t\t\t\t\tif ( array.length === 1 ) {\n\n\t\t\t\t\t\t\t\t\tcurrentTransform.set(\n\t\t\t\t\t\t\t\t\t\t1, 0, 0,\n\t\t\t\t\t\t\t\t\t\tMath.tan( array[ 0 ] * Math.PI / 180 ), 1, 0,\n\t\t\t\t\t\t\t\t\t\t0, 0, 1\n\t\t\t\t\t\t\t\t\t);\n\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\t\tcase 'matrix':\n\n\t\t\t\t\t\t\t\tif ( array.length === 6 ) {\n\n\t\t\t\t\t\t\t\t\tcurrentTransform.set(\n\t\t\t\t\t\t\t\t\t\tarray[ 0 ], array[ 2 ], array[ 4 ],\n\t\t\t\t\t\t\t\t\t\tarray[ 1 ], array[ 3 ], array[ 5 ],\n\t\t\t\t\t\t\t\t\t\t0, 0, 1\n\t\t\t\t\t\t\t\t\t);\n\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t\ttransform.premultiply( currentTransform );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\treturn transform;\n\n\t\t}\n\n\t\tfunction transformPath( path, m ) {\n\n\t\t\tfunction transfVec2( v2 ) {\n\n\t\t\t\ttempV3.set( v2.x, v2.y, 1 ).applyMatrix3( m );\n\n\t\t\t\tv2.set( tempV3.x, tempV3.y );\n\n\t\t\t}\n\n\t\t\tconst isRotated = isTransformRotated( m );\n\n\t\t\tconst subPaths = path.subPaths;\n\n\t\t\tfor ( let i = 0, n = subPaths.length; i < n; i ++ ) {\n\n\t\t\t\tconst subPath = subPaths[ i ];\n\t\t\t\tconst curves = subPath.curves;\n\n\t\t\t\tfor ( let j = 0; j < curves.length; j ++ ) {\n\n\t\t\t\t\tconst curve = curves[ j ];\n\n\t\t\t\t\tif ( curve.isLineCurve ) {\n\n\t\t\t\t\t\ttransfVec2( curve.v1 );\n\t\t\t\t\t\ttransfVec2( curve.v2 );\n\n\t\t\t\t\t} else if ( curve.isCubicBezierCurve ) {\n\n\t\t\t\t\t\ttransfVec2( curve.v0 );\n\t\t\t\t\t\ttransfVec2( curve.v1 );\n\t\t\t\t\t\ttransfVec2( curve.v2 );\n\t\t\t\t\t\ttransfVec2( curve.v3 );\n\n\t\t\t\t\t} else if ( curve.isQuadraticBezierCurve ) {\n\n\t\t\t\t\t\ttransfVec2( curve.v0 );\n\t\t\t\t\t\ttransfVec2( curve.v1 );\n\t\t\t\t\t\ttransfVec2( curve.v2 );\n\n\t\t\t\t\t} else if ( curve.isEllipseCurve ) {\n\n\t\t\t\t\t\tif ( isRotated ) {\n\n\t\t\t\t\t\t\tconsole.warn( 'SVGLoader: Elliptic arc or ellipse rotation or skewing is not implemented.' );\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\ttempV2.set( curve.aX, curve.aY );\n\t\t\t\t\t\ttransfVec2( tempV2 );\n\t\t\t\t\t\tcurve.aX = tempV2.x;\n\t\t\t\t\t\tcurve.aY = tempV2.y;\n\n\t\t\t\t\t\tcurve.xRadius *= getTransformScaleX( m );\n\t\t\t\t\t\tcurve.yRadius *= getTransformScaleY( m );\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\tfunction isTransformRotated( m ) {\n\n\t\t\treturn m.elements[ 1 ] !== 0 || m.elements[ 3 ] !== 0;\n\n\t\t}\n\n\t\tfunction getTransformScaleX( m ) {\n\n\t\t\tconst te = m.elements;\n\t\t\treturn Math.sqrt( te[ 0 ] * te[ 0 ] + te[ 1 ] * te[ 1 ] );\n\n\t\t}\n\n\t\tfunction getTransformScaleY( m ) {\n\n\t\t\tconst te = m.elements;\n\t\t\treturn Math.sqrt( te[ 3 ] * te[ 3 ] + te[ 4 ] * te[ 4 ] );\n\n\t\t}\n\n\t\t//\n\n\t\tconst paths = [];\n\t\tconst stylesheets = {};\n\n\t\tconst transformStack = [];\n\n\t\tconst tempTransform0 = new Matrix3();\n\t\tconst tempTransform1 = new Matrix3();\n\t\tconst tempTransform2 = new Matrix3();\n\t\tconst tempTransform3 = new Matrix3();\n\t\tconst tempV2 = new Vector2();\n\t\tconst tempV3 = new Vector3();\n\n\t\tconst currentTransform = new Matrix3();\n\n\t\tconst xml = new DOMParser().parseFromString( text, 'image/svg+xml' ); // application/xml\n\n\t\tparseNode( xml.documentElement, {\n\t\t\tfill: '#000',\n\t\t\tfillOpacity: 1,\n\t\t\tstrokeOpacity: 1,\n\t\t\tstrokeWidth: 1,\n\t\t\tstrokeLineJoin: 'miter',\n\t\t\tstrokeLineCap: 'butt',\n\t\t\tstrokeMiterLimit: 4\n\t\t} );\n\n\t\tconst data = { paths: paths, xml: xml.documentElement };\n\n\t\t// console.log( paths );\n\t\treturn data;\n\n\t}\n\n\tstatic createShapes( shapePath ) {\n\n\t\t// Param shapePath: a shapepath as returned by the parse function of this class\n\t\t// Returns Shape object\n\n\t\tconst BIGNUMBER = 999999999;\n\n\t\tconst IntersectionLocationType = {\n\t\t\tORIGIN: 0,\n\t\t\tDESTINATION: 1,\n\t\t\tBETWEEN: 2,\n\t\t\tLEFT: 3,\n\t\t\tRIGHT: 4,\n\t\t\tBEHIND: 5,\n\t\t\tBEYOND: 6\n\t\t};\n\n\t\tconst classifyResult = {\n\t\t\tloc: IntersectionLocationType.ORIGIN,\n\t\t\tt: 0\n\t\t};\n\n\t\tfunction findEdgeIntersection( a0, a1, b0, b1 ) {\n\n\t\t\tconst x1 = a0.x;\n\t\t\tconst x2 = a1.x;\n\t\t\tconst x3 = b0.x;\n\t\t\tconst x4 = b1.x;\n\t\t\tconst y1 = a0.y;\n\t\t\tconst y2 = a1.y;\n\t\t\tconst y3 = b0.y;\n\t\t\tconst y4 = b1.y;\n\t\t\tconst nom1 = ( x4 - x3 ) * ( y1 - y3 ) - ( y4 - y3 ) * ( x1 - x3 );\n\t\t\tconst nom2 = ( x2 - x1 ) * ( y1 - y3 ) - ( y2 - y1 ) * ( x1 - x3 );\n\t\t\tconst denom = ( y4 - y3 ) * ( x2 - x1 ) - ( x4 - x3 ) * ( y2 - y1 );\n\t\t\tconst t1 = nom1 / denom;\n\t\t\tconst t2 = nom2 / denom;\n\n\t\t\tif ( ( ( denom === 0 ) && ( nom1 !== 0 ) ) || ( t1 <= 0 ) || ( t1 >= 1 ) || ( t2 < 0 ) || ( t2 > 1 ) ) {\n\n\t\t\t\t//1. lines are parallel or edges don't intersect\n\n\t\t\t\treturn null;\n\n\t\t\t} else if ( ( nom1 === 0 ) && ( denom === 0 ) ) {\n\n\t\t\t\t//2. lines are colinear\n\n\t\t\t\t//check if endpoints of edge2 (b0-b1) lies on edge1 (a0-a1)\n\t\t\t\tfor ( let i = 0; i < 2; i ++ ) {\n\n\t\t\t\t\tclassifyPoint( i === 0 ? b0 : b1, a0, a1 );\n\t\t\t\t\t//find position of this endpoints relatively to edge1\n\t\t\t\t\tif ( classifyResult.loc == IntersectionLocationType.ORIGIN ) {\n\n\t\t\t\t\t\tconst point = ( i === 0 ? b0 : b1 );\n\t\t\t\t\t\treturn { x: point.x, y: point.y, t: classifyResult.t };\n\n\t\t\t\t\t} else if ( classifyResult.loc == IntersectionLocationType.BETWEEN ) {\n\n\t\t\t\t\t\tconst x = + ( ( x1 + classifyResult.t * ( x2 - x1 ) ).toPrecision( 10 ) );\n\t\t\t\t\t\tconst y = + ( ( y1 + classifyResult.t * ( y2 - y1 ) ).toPrecision( 10 ) );\n\t\t\t\t\t\treturn { x: x, y: y, t: classifyResult.t, };\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\treturn null;\n\n\t\t\t} else {\n\n\t\t\t\t//3. edges intersect\n\n\t\t\t\tfor ( let i = 0; i < 2; i ++ ) {\n\n\t\t\t\t\tclassifyPoint( i === 0 ? b0 : b1, a0, a1 );\n\n\t\t\t\t\tif ( classifyResult.loc == IntersectionLocationType.ORIGIN ) {\n\n\t\t\t\t\t\tconst point = ( i === 0 ? b0 : b1 );\n\t\t\t\t\t\treturn { x: point.x, y: point.y, t: classifyResult.t };\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\tconst x = + ( ( x1 + t1 * ( x2 - x1 ) ).toPrecision( 10 ) );\n\t\t\t\tconst y = + ( ( y1 + t1 * ( y2 - y1 ) ).toPrecision( 10 ) );\n\t\t\t\treturn { x: x, y: y, t: t1 };\n\n\t\t\t}\n\n\t\t}\n\n\t\tfunction classifyPoint( p, edgeStart, edgeEnd ) {\n\n\t\t\tconst ax = edgeEnd.x - edgeStart.x;\n\t\t\tconst ay = edgeEnd.y - edgeStart.y;\n\t\t\tconst bx = p.x - edgeStart.x;\n\t\t\tconst by = p.y - edgeStart.y;\n\t\t\tconst sa = ax * by - bx * ay;\n\n\t\t\tif ( ( p.x === edgeStart.x ) && ( p.y === edgeStart.y ) ) {\n\n\t\t\t\tclassifyResult.loc = IntersectionLocationType.ORIGIN;\n\t\t\t\tclassifyResult.t = 0;\n\t\t\t\treturn;\n\n\t\t\t}\n\n\t\t\tif ( ( p.x === edgeEnd.x ) && ( p.y === edgeEnd.y ) ) {\n\n\t\t\t\tclassifyResult.loc = IntersectionLocationType.DESTINATION;\n\t\t\t\tclassifyResult.t = 1;\n\t\t\t\treturn;\n\n\t\t\t}\n\n\t\t\tif ( sa < - Number.EPSILON ) {\n\n\t\t\t\tclassifyResult.loc = IntersectionLocationType.LEFT;\n\t\t\t\treturn;\n\n\t\t\t}\n\n\t\t\tif ( sa > Number.EPSILON ) {\n\n\t\t\t\tclassifyResult.loc = IntersectionLocationType.RIGHT;\n\t\t\t\treturn;\n\n\n\t\t\t}\n\n\t\t\tif ( ( ( ax * bx ) < 0 ) || ( ( ay * by ) < 0 ) ) {\n\n\t\t\t\tclassifyResult.loc = IntersectionLocationType.BEHIND;\n\t\t\t\treturn;\n\n\t\t\t}\n\n\t\t\tif ( ( Math.sqrt( ax * ax + ay * ay ) ) < ( Math.sqrt( bx * bx + by * by ) ) ) {\n\n\t\t\t\tclassifyResult.loc = IntersectionLocationType.BEYOND;\n\t\t\t\treturn;\n\n\t\t\t}\n\n\t\t\tlet t;\n\n\t\t\tif ( ax !== 0 ) {\n\n\t\t\t\tt = bx / ax;\n\n\t\t\t} else {\n\n\t\t\t\tt = by / ay;\n\n\t\t\t}\n\n\t\t\tclassifyResult.loc = IntersectionLocationType.BETWEEN;\n\t\t\tclassifyResult.t = t;\n\n\t\t}\n\n\t\tfunction getIntersections( path1, path2 ) {\n\n\t\t\tconst intersectionsRaw = [];\n\t\t\tconst intersections = [];\n\n\t\t\tfor ( let index = 1; index < path1.length; index ++ ) {\n\n\t\t\t\tconst path1EdgeStart = path1[ index - 1 ];\n\t\t\t\tconst path1EdgeEnd = path1[ index ];\n\n\t\t\t\tfor ( let index2 = 1; index2 < path2.length; index2 ++ ) {\n\n\t\t\t\t\tconst path2EdgeStart = path2[ index2 - 1 ];\n\t\t\t\t\tconst path2EdgeEnd = path2[ index2 ];\n\n\t\t\t\t\tconst intersection = findEdgeIntersection( path1EdgeStart, path1EdgeEnd, path2EdgeStart, path2EdgeEnd );\n\n\t\t\t\t\tif ( intersection !== null && intersectionsRaw.find( i => i.t <= intersection.t + Number.EPSILON && i.t >= intersection.t - Number.EPSILON ) === undefined ) {\n\n\t\t\t\t\t\tintersectionsRaw.push( intersection );\n\t\t\t\t\t\tintersections.push( new Vector2( intersection.x, intersection.y ) );\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\treturn intersections;\n\n\t\t}\n\n\t\tfunction getScanlineIntersections( scanline, boundingBox, paths ) {\n\n\t\t\tconst center = new Vector2();\n\t\t\tboundingBox.getCenter( center );\n\n\t\t\tconst allIntersections = [];\n\n\t\t\tpaths.forEach( path => {\n\n\t\t\t\t// check if the center of the bounding box is in the bounding box of the paths.\n\t\t\t\t// this is a pruning method to limit the search of intersections in paths that can't envelop of the current path.\n\t\t\t\t// if a path envelops another path. The center of that oter path, has to be inside the bounding box of the enveloping path.\n\t\t\t\tif ( path.boundingBox.containsPoint( center ) ) {\n\n\t\t\t\t\tconst intersections = getIntersections( scanline, path.points );\n\n\t\t\t\t\tintersections.forEach( p => {\n\n\t\t\t\t\t\tallIntersections.push( { identifier: path.identifier, isCW: path.isCW, point: p } );\n\n\t\t\t\t\t} );\n\n\t\t\t\t}\n\n\t\t\t} );\n\n\t\t\tallIntersections.sort( ( i1, i2 ) => {\n\n\t\t\t\treturn i1.point.x - i2.point.x;\n\n\t\t\t} );\n\n\t\t\treturn allIntersections;\n\n\t\t}\n\n\t\tfunction isHoleTo( simplePath, allPaths, scanlineMinX, scanlineMaxX, _fillRule ) {\n\n\t\t\tif ( _fillRule === null || _fillRule === undefined || _fillRule === '' ) {\n\n\t\t\t\t_fillRule = 'nonzero';\n\n\t\t\t}\n\n\t\t\tconst centerBoundingBox = new Vector2();\n\t\t\tsimplePath.boundingBox.getCenter( centerBoundingBox );\n\n\t\t\tconst scanline = [ new Vector2( scanlineMinX, centerBoundingBox.y ), new Vector2( scanlineMaxX, centerBoundingBox.y ) ];\n\n\t\t\tconst scanlineIntersections = getScanlineIntersections( scanline, simplePath.boundingBox, allPaths );\n\n\t\t\tscanlineIntersections.sort( ( i1, i2 ) => {\n\n\t\t\t\treturn i1.point.x - i2.point.x;\n\n\t\t\t} );\n\n\t\t\tconst baseIntersections = [];\n\t\t\tconst otherIntersections = [];\n\n\t\t\tscanlineIntersections.forEach( i => {\n\n\t\t\t\tif ( i.identifier === simplePath.identifier ) {\n\n\t\t\t\t\tbaseIntersections.push( i );\n\n\t\t\t\t} else {\n\n\t\t\t\t\totherIntersections.push( i );\n\n\t\t\t\t}\n\n\t\t\t} );\n\n\t\t\tconst firstXOfPath = baseIntersections[ 0 ].point.x;\n\n\t\t\t// build up the path hierarchy\n\t\t\tconst stack = [];\n\t\t\tlet i = 0;\n\n\t\t\twhile ( i < otherIntersections.length && otherIntersections[ i ].point.x < firstXOfPath ) {\n\n\t\t\t\tif ( stack.length > 0 && stack[ stack.length - 1 ] === otherIntersections[ i ].identifier ) {\n\n\t\t\t\t\tstack.pop();\n\n\t\t\t\t} else {\n\n\t\t\t\t\tstack.push( otherIntersections[ i ].identifier );\n\n\t\t\t\t}\n\n\t\t\t\ti ++;\n\n\t\t\t}\n\n\t\t\tstack.push( simplePath.identifier );\n\n\t\t\tif ( _fillRule === 'evenodd' ) {\n\n\t\t\t\tconst isHole = stack.length % 2 === 0 ? true : false;\n\t\t\t\tconst isHoleFor = stack[ stack.length - 2 ];\n\n\t\t\t\treturn { identifier: simplePath.identifier, isHole: isHole, for: isHoleFor };\n\n\t\t\t} else if ( _fillRule === 'nonzero' ) {\n\n\t\t\t\t// check if path is a hole by counting the amount of paths with alternating rotations it has to cross.\n\t\t\t\tlet isHole = true;\n\t\t\t\tlet isHoleFor = null;\n\t\t\t\tlet lastCWValue = null;\n\n\t\t\t\tfor ( let i = 0; i < stack.length; i ++ ) {\n\n\t\t\t\t\tconst identifier = stack[ i ];\n\t\t\t\t\tif ( isHole ) {\n\n\t\t\t\t\t\tlastCWValue = allPaths[ identifier ].isCW;\n\t\t\t\t\t\tisHole = false;\n\t\t\t\t\t\tisHoleFor = identifier;\n\n\t\t\t\t\t} else if ( lastCWValue !== allPaths[ identifier ].isCW ) {\n\n\t\t\t\t\t\tlastCWValue = allPaths[ identifier ].isCW;\n\t\t\t\t\t\tisHole = true;\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\treturn { identifier: simplePath.identifier, isHole: isHole, for: isHoleFor };\n\n\t\t\t} else {\n\n\t\t\t\tconsole.warn( 'fill-rule: \"' + _fillRule + '\" is currently not implemented.' );\n\n\t\t\t}\n\n\t\t}\n\n\t\t// check for self intersecting paths\n\t\t// TODO\n\n\t\t// check intersecting paths\n\t\t// TODO\n\n\t\t// prepare paths for hole detection\n\t\tlet identifier = 0;\n\n\t\tlet scanlineMinX = BIGNUMBER;\n\t\tlet scanlineMaxX = - BIGNUMBER;\n\n\t\tlet simplePaths = shapePath.subPaths.map( p => {\n\n\t\t\tconst points = p.getPoints();\n\t\t\tlet maxY = - BIGNUMBER;\n\t\t\tlet minY = BIGNUMBER;\n\t\t\tlet maxX = - BIGNUMBER;\n\t\t\tlet minX = BIGNUMBER;\n\n\t      \t//points.forEach(p => p.y *= -1);\n\n\t\t\tfor ( let i = 0; i < points.length; i ++ ) {\n\n\t\t\t\tconst p = points[ i ];\n\n\t\t\t\tif ( p.y > maxY ) {\n\n\t\t\t\t\tmaxY = p.y;\n\n\t\t\t\t}\n\n\t\t\t\tif ( p.y < minY ) {\n\n\t\t\t\t\tminY = p.y;\n\n\t\t\t\t}\n\n\t\t\t\tif ( p.x > maxX ) {\n\n\t\t\t\t\tmaxX = p.x;\n\n\t\t\t\t}\n\n\t\t\t\tif ( p.x < minX ) {\n\n\t\t\t\t\tminX = p.x;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\t//\n\t\t\tif ( scanlineMaxX <= maxX ) {\n\n\t\t\t\tscanlineMaxX = maxX + 1;\n\n\t\t\t}\n\n\t\t\tif ( scanlineMinX >= minX ) {\n\n\t\t\t\tscanlineMinX = minX - 1;\n\n\t\t\t}\n\n\t\t\treturn { points: points, isCW: ShapeUtils.isClockWise( points ), identifier: identifier ++, boundingBox: new Box2( new Vector2( minX, minY ), new Vector2( maxX, maxY ) ) };\n\n\t\t} );\n\n\t\tsimplePaths = simplePaths.filter( sp => sp.points.length > 1 );\n\n\t\t// check if path is solid or a hole\n\t\tconst isAHole = simplePaths.map( p => isHoleTo( p, simplePaths, scanlineMinX, scanlineMaxX, shapePath.userData.style.fillRule ) );\n\n\n\t\tconst shapesToReturn = [];\n\t\tsimplePaths.forEach( p => {\n\n\t\t\tconst amIAHole = isAHole[ p.identifier ];\n\n\t\t\tif ( ! amIAHole.isHole ) {\n\n\t\t\t\tconst shape = new Shape( p.points );\n\t\t\t\tconst holes = isAHole.filter( h => h.isHole && h.for === p.identifier );\n\t\t\t\tholes.forEach( h => {\n\n\t\t\t\t\tconst path = simplePaths[ h.identifier ];\n\t\t\t\t\tshape.holes.push( new Path( path.points ) );\n\n\t\t\t\t} );\n\t\t\t\tshapesToReturn.push( shape );\n\n\t\t\t}\n\n\t\t} );\n\n\t\treturn shapesToReturn;\n\n\t}\n\n\tstatic getStrokeStyle( width, color, lineJoin, lineCap, miterLimit ) {\n\n\t\t// Param width: Stroke width\n\t\t// Param color: As returned by THREE.Color.getStyle()\n\t\t// Param lineJoin: One of \"round\", \"bevel\", \"miter\" or \"miter-limit\"\n\t\t// Param lineCap: One of \"round\", \"square\" or \"butt\"\n\t\t// Param miterLimit: Maximum join length, in multiples of the \"width\" parameter (join is truncated if it exceeds that distance)\n\t\t// Returns style object\n\n\t\twidth = width !== undefined ? width : 1;\n\t\tcolor = color !== undefined ? color : '#000';\n\t\tlineJoin = lineJoin !== undefined ? lineJoin : 'miter';\n\t\tlineCap = lineCap !== undefined ? lineCap : 'butt';\n\t\tmiterLimit = miterLimit !== undefined ? miterLimit : 4;\n\n\t\treturn {\n\t\t\tstrokeColor: color,\n\t\t\tstrokeWidth: width,\n\t\t\tstrokeLineJoin: lineJoin,\n\t\t\tstrokeLineCap: lineCap,\n\t\t\tstrokeMiterLimit: miterLimit\n\t\t};\n\n\t}\n\n\tstatic pointsToStroke( points, style, arcDivisions, minDistance ) {\n\n\t\t// Generates a stroke with some witdh around the given path.\n\t\t// The path can be open or closed (last point equals to first point)\n\t\t// Param points: Array of Vector2D (the path). Minimum 2 points.\n\t\t// Param style: Object with SVG properties as returned by SVGLoader.getStrokeStyle(), or SVGLoader.parse() in the path.userData.style object\n\t\t// Params arcDivisions: Arc divisions for round joins and endcaps. (Optional)\n\t\t// Param minDistance: Points closer to this distance will be merged. (Optional)\n\t\t// Returns BufferGeometry with stroke triangles (In plane z = 0). UV coordinates are generated ('u' along path. 'v' across it, from left to right)\n\n\t\tconst vertices = [];\n\t\tconst normals = [];\n\t\tconst uvs = [];\n\n\t\tif ( SVGLoader.pointsToStrokeWithBuffers( points, style, arcDivisions, minDistance, vertices, normals, uvs ) === 0 ) {\n\n\t\t\treturn null;\n\n\t\t}\n\n\t\tconst geometry = new BufferGeometry();\n\t\tgeometry.setAttribute( 'position', new Float32BufferAttribute( vertices, 3 ) );\n\t\tgeometry.setAttribute( 'normal', new Float32BufferAttribute( normals, 3 ) );\n\t\tgeometry.setAttribute( 'uv', new Float32BufferAttribute( uvs, 2 ) );\n\n\t\treturn geometry;\n\n\t}\n\n\tstatic pointsToStrokeWithBuffers( points, style, arcDivisions, minDistance, vertices, normals, uvs, vertexOffset ) {\n\n\t\t// This function can be called to update existing arrays or buffers.\n\t\t// Accepts same parameters as pointsToStroke, plus the buffers and optional offset.\n\t\t// Param vertexOffset: Offset vertices to start writing in the buffers (3 elements/vertex for vertices and normals, and 2 elements/vertex for uvs)\n\t\t// Returns number of written vertices / normals / uvs pairs\n\t\t// if 'vertices' parameter is undefined no triangles will be generated, but the returned vertices count will still be valid (useful to preallocate the buffers)\n\t\t// 'normals' and 'uvs' buffers are optional\n\n\t\tconst tempV2_1 = new Vector2();\n\t\tconst tempV2_2 = new Vector2();\n\t\tconst tempV2_3 = new Vector2();\n\t\tconst tempV2_4 = new Vector2();\n\t\tconst tempV2_5 = new Vector2();\n\t\tconst tempV2_6 = new Vector2();\n\t\tconst tempV2_7 = new Vector2();\n\t\tconst lastPointL = new Vector2();\n\t\tconst lastPointR = new Vector2();\n\t\tconst point0L = new Vector2();\n\t\tconst point0R = new Vector2();\n\t\tconst currentPointL = new Vector2();\n\t\tconst currentPointR = new Vector2();\n\t\tconst nextPointL = new Vector2();\n\t\tconst nextPointR = new Vector2();\n\t\tconst innerPoint = new Vector2();\n\t\tconst outerPoint = new Vector2();\n\n\t\tarcDivisions = arcDivisions !== undefined ? arcDivisions : 12;\n\t\tminDistance = minDistance !== undefined ? minDistance : 0.001;\n\t\tvertexOffset = vertexOffset !== undefined ? vertexOffset : 0;\n\n\t\t// First ensure there are no duplicated points\n\t\tpoints = removeDuplicatedPoints( points );\n\n\t\tconst numPoints = points.length;\n\n\t\tif ( numPoints < 2 ) return 0;\n\n\t\tconst isClosed = points[ 0 ].equals( points[ numPoints - 1 ] );\n\n\t\tlet currentPoint;\n\t\tlet previousPoint = points[ 0 ];\n\t\tlet nextPoint;\n\n\t\tconst strokeWidth2 = style.strokeWidth / 2;\n\n\t\tconst deltaU = 1 / ( numPoints - 1 );\n\t\tlet u0 = 0, u1;\n\n\t\tlet innerSideModified;\n\t\tlet joinIsOnLeftSide;\n\t\tlet isMiter;\n\t\tlet initialJoinIsOnLeftSide = false;\n\n\t\tlet numVertices = 0;\n\t\tlet currentCoordinate = vertexOffset * 3;\n\t\tlet currentCoordinateUV = vertexOffset * 2;\n\n\t\t// Get initial left and right stroke points\n\t\tgetNormal( points[ 0 ], points[ 1 ], tempV2_1 ).multiplyScalar( strokeWidth2 );\n\t\tlastPointL.copy( points[ 0 ] ).sub( tempV2_1 );\n\t\tlastPointR.copy( points[ 0 ] ).add( tempV2_1 );\n\t\tpoint0L.copy( lastPointL );\n\t\tpoint0R.copy( lastPointR );\n\n\t\tfor ( let iPoint = 1; iPoint < numPoints; iPoint ++ ) {\n\n\t\t\tcurrentPoint = points[ iPoint ];\n\n\t\t\t// Get next point\n\t\t\tif ( iPoint === numPoints - 1 ) {\n\n\t\t\t\tif ( isClosed ) {\n\n\t\t\t\t\t// Skip duplicated initial point\n\t\t\t\t\tnextPoint = points[ 1 ];\n\n\t\t\t\t} else nextPoint = undefined;\n\n\t\t\t} else {\n\n\t\t\t\tnextPoint = points[ iPoint + 1 ];\n\n\t\t\t}\n\n\t\t\t// Normal of previous segment in tempV2_1\n\t\t\tconst normal1 = tempV2_1;\n\t\t\tgetNormal( previousPoint, currentPoint, normal1 );\n\n\t\t\ttempV2_3.copy( normal1 ).multiplyScalar( strokeWidth2 );\n\t\t\tcurrentPointL.copy( currentPoint ).sub( tempV2_3 );\n\t\t\tcurrentPointR.copy( currentPoint ).add( tempV2_3 );\n\n\t\t\tu1 = u0 + deltaU;\n\n\t\t\tinnerSideModified = false;\n\n\t\t\tif ( nextPoint !== undefined ) {\n\n\t\t\t\t// Normal of next segment in tempV2_2\n\t\t\t\tgetNormal( currentPoint, nextPoint, tempV2_2 );\n\n\t\t\t\ttempV2_3.copy( tempV2_2 ).multiplyScalar( strokeWidth2 );\n\t\t\t\tnextPointL.copy( currentPoint ).sub( tempV2_3 );\n\t\t\t\tnextPointR.copy( currentPoint ).add( tempV2_3 );\n\n\t\t\t\tjoinIsOnLeftSide = true;\n\t\t\t\ttempV2_3.subVectors( nextPoint, previousPoint );\n\t\t\t\tif ( normal1.dot( tempV2_3 ) < 0 ) {\n\n\t\t\t\t\tjoinIsOnLeftSide = false;\n\n\t\t\t\t}\n\n\t\t\t\tif ( iPoint === 1 ) initialJoinIsOnLeftSide = joinIsOnLeftSide;\n\n\t\t\t\ttempV2_3.subVectors( nextPoint, currentPoint );\n\t\t\t\ttempV2_3.normalize();\n\t\t\t\tconst dot = Math.abs( normal1.dot( tempV2_3 ) );\n\n\t\t\t\t// If path is straight, don't create join\n\t\t\t\tif ( dot !== 0 ) {\n\n\t\t\t\t\t// Compute inner and outer segment intersections\n\t\t\t\t\tconst miterSide = strokeWidth2 / dot;\n\t\t\t\t\ttempV2_3.multiplyScalar( - miterSide );\n\t\t\t\t\ttempV2_4.subVectors( currentPoint, previousPoint );\n\t\t\t\t\ttempV2_5.copy( tempV2_4 ).setLength( miterSide ).add( tempV2_3 );\n\t\t\t\t\tinnerPoint.copy( tempV2_5 ).negate();\n\t\t\t\t\tconst miterLength2 = tempV2_5.length();\n\t\t\t\t\tconst segmentLengthPrev = tempV2_4.length();\n\t\t\t\t\ttempV2_4.divideScalar( segmentLengthPrev );\n\t\t\t\t\ttempV2_6.subVectors( nextPoint, currentPoint );\n\t\t\t\t\tconst segmentLengthNext = tempV2_6.length();\n\t\t\t\t\ttempV2_6.divideScalar( segmentLengthNext );\n\t\t\t\t\t// Check that previous and next segments doesn't overlap with the innerPoint of intersection\n\t\t\t\t\tif ( tempV2_4.dot( innerPoint ) < segmentLengthPrev && tempV2_6.dot( innerPoint ) < segmentLengthNext ) {\n\n\t\t\t\t\t\tinnerSideModified = true;\n\n\t\t\t\t\t}\n\n\t\t\t\t\touterPoint.copy( tempV2_5 ).add( currentPoint );\n\t\t\t\t\tinnerPoint.add( currentPoint );\n\n\t\t\t\t\tisMiter = false;\n\n\t\t\t\t\tif ( innerSideModified ) {\n\n\t\t\t\t\t\tif ( joinIsOnLeftSide ) {\n\n\t\t\t\t\t\t\tnextPointR.copy( innerPoint );\n\t\t\t\t\t\t\tcurrentPointR.copy( innerPoint );\n\n\t\t\t\t\t\t} else {\n\n\t\t\t\t\t\t\tnextPointL.copy( innerPoint );\n\t\t\t\t\t\t\tcurrentPointL.copy( innerPoint );\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\t// The segment triangles are generated here if there was overlapping\n\n\t\t\t\t\t\tmakeSegmentTriangles();\n\n\t\t\t\t\t}\n\n\t\t\t\t\tswitch ( style.strokeLineJoin ) {\n\n\t\t\t\t\t\tcase 'bevel':\n\n\t\t\t\t\t\t\tmakeSegmentWithBevelJoin( joinIsOnLeftSide, innerSideModified, u1 );\n\n\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\tcase 'round':\n\n\t\t\t\t\t\t\t// Segment triangles\n\n\t\t\t\t\t\t\tcreateSegmentTrianglesWithMiddleSection( joinIsOnLeftSide, innerSideModified );\n\n\t\t\t\t\t\t\t// Join triangles\n\n\t\t\t\t\t\t\tif ( joinIsOnLeftSide ) {\n\n\t\t\t\t\t\t\t\tmakeCircularSector( currentPoint, currentPointL, nextPointL, u1, 0 );\n\n\t\t\t\t\t\t\t} else {\n\n\t\t\t\t\t\t\t\tmakeCircularSector( currentPoint, nextPointR, currentPointR, u1, 1 );\n\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\tcase 'miter':\n\t\t\t\t\t\tcase 'miter-clip':\n\t\t\t\t\t\tdefault:\n\n\t\t\t\t\t\t\tconst miterFraction = ( strokeWidth2 * style.strokeMiterLimit ) / miterLength2;\n\n\t\t\t\t\t\t\tif ( miterFraction < 1 ) {\n\n\t\t\t\t\t\t\t\t// The join miter length exceeds the miter limit\n\n\t\t\t\t\t\t\t\tif ( style.strokeLineJoin !== 'miter-clip' ) {\n\n\t\t\t\t\t\t\t\t\tmakeSegmentWithBevelJoin( joinIsOnLeftSide, innerSideModified, u1 );\n\t\t\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\t\t\t} else {\n\n\t\t\t\t\t\t\t\t\t// Segment triangles\n\n\t\t\t\t\t\t\t\t\tcreateSegmentTrianglesWithMiddleSection( joinIsOnLeftSide, innerSideModified );\n\n\t\t\t\t\t\t\t\t\t// Miter-clip join triangles\n\n\t\t\t\t\t\t\t\t\tif ( joinIsOnLeftSide ) {\n\n\t\t\t\t\t\t\t\t\t\ttempV2_6.subVectors( outerPoint, currentPointL ).multiplyScalar( miterFraction ).add( currentPointL );\n\t\t\t\t\t\t\t\t\t\ttempV2_7.subVectors( outerPoint, nextPointL ).multiplyScalar( miterFraction ).add( nextPointL );\n\n\t\t\t\t\t\t\t\t\t\taddVertex( currentPointL, u1, 0 );\n\t\t\t\t\t\t\t\t\t\taddVertex( tempV2_6, u1, 0 );\n\t\t\t\t\t\t\t\t\t\taddVertex( currentPoint, u1, 0.5 );\n\n\t\t\t\t\t\t\t\t\t\taddVertex( currentPoint, u1, 0.5 );\n\t\t\t\t\t\t\t\t\t\taddVertex( tempV2_6, u1, 0 );\n\t\t\t\t\t\t\t\t\t\taddVertex( tempV2_7, u1, 0 );\n\n\t\t\t\t\t\t\t\t\t\taddVertex( currentPoint, u1, 0.5 );\n\t\t\t\t\t\t\t\t\t\taddVertex( tempV2_7, u1, 0 );\n\t\t\t\t\t\t\t\t\t\taddVertex( nextPointL, u1, 0 );\n\n\t\t\t\t\t\t\t\t\t} else {\n\n\t\t\t\t\t\t\t\t\t\ttempV2_6.subVectors( outerPoint, currentPointR ).multiplyScalar( miterFraction ).add( currentPointR );\n\t\t\t\t\t\t\t\t\t\ttempV2_7.subVectors( outerPoint, nextPointR ).multiplyScalar( miterFraction ).add( nextPointR );\n\n\t\t\t\t\t\t\t\t\t\taddVertex( currentPointR, u1, 1 );\n\t\t\t\t\t\t\t\t\t\taddVertex( tempV2_6, u1, 1 );\n\t\t\t\t\t\t\t\t\t\taddVertex( currentPoint, u1, 0.5 );\n\n\t\t\t\t\t\t\t\t\t\taddVertex( currentPoint, u1, 0.5 );\n\t\t\t\t\t\t\t\t\t\taddVertex( tempV2_6, u1, 1 );\n\t\t\t\t\t\t\t\t\t\taddVertex( tempV2_7, u1, 1 );\n\n\t\t\t\t\t\t\t\t\t\taddVertex( currentPoint, u1, 0.5 );\n\t\t\t\t\t\t\t\t\t\taddVertex( tempV2_7, u1, 1 );\n\t\t\t\t\t\t\t\t\t\taddVertex( nextPointR, u1, 1 );\n\n\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t} else {\n\n\t\t\t\t\t\t\t\t// Miter join segment triangles\n\n\t\t\t\t\t\t\t\tif ( innerSideModified ) {\n\n\t\t\t\t\t\t\t\t\t// Optimized segment + join triangles\n\n\t\t\t\t\t\t\t\t\tif ( joinIsOnLeftSide ) {\n\n\t\t\t\t\t\t\t\t\t\taddVertex( lastPointR, u0, 1 );\n\t\t\t\t\t\t\t\t\t\taddVertex( lastPointL, u0, 0 );\n\t\t\t\t\t\t\t\t\t\taddVertex( outerPoint, u1, 0 );\n\n\t\t\t\t\t\t\t\t\t\taddVertex( lastPointR, u0, 1 );\n\t\t\t\t\t\t\t\t\t\taddVertex( outerPoint, u1, 0 );\n\t\t\t\t\t\t\t\t\t\taddVertex( innerPoint, u1, 1 );\n\n\t\t\t\t\t\t\t\t\t} else {\n\n\t\t\t\t\t\t\t\t\t\taddVertex( lastPointR, u0, 1 );\n\t\t\t\t\t\t\t\t\t\taddVertex( lastPointL, u0, 0 );\n\t\t\t\t\t\t\t\t\t\taddVertex( outerPoint, u1, 1 );\n\n\t\t\t\t\t\t\t\t\t\taddVertex( lastPointL, u0, 0 );\n\t\t\t\t\t\t\t\t\t\taddVertex( innerPoint, u1, 0 );\n\t\t\t\t\t\t\t\t\t\taddVertex( outerPoint, u1, 1 );\n\n\t\t\t\t\t\t\t\t\t}\n\n\n\t\t\t\t\t\t\t\t\tif ( joinIsOnLeftSide ) {\n\n\t\t\t\t\t\t\t\t\t\tnextPointL.copy( outerPoint );\n\n\t\t\t\t\t\t\t\t\t} else {\n\n\t\t\t\t\t\t\t\t\t\tnextPointR.copy( outerPoint );\n\n\t\t\t\t\t\t\t\t\t}\n\n\n\t\t\t\t\t\t\t\t} else {\n\n\t\t\t\t\t\t\t\t\t// Add extra miter join triangles\n\n\t\t\t\t\t\t\t\t\tif ( joinIsOnLeftSide ) {\n\n\t\t\t\t\t\t\t\t\t\taddVertex( currentPointL, u1, 0 );\n\t\t\t\t\t\t\t\t\t\taddVertex( outerPoint, u1, 0 );\n\t\t\t\t\t\t\t\t\t\taddVertex( currentPoint, u1, 0.5 );\n\n\t\t\t\t\t\t\t\t\t\taddVertex( currentPoint, u1, 0.5 );\n\t\t\t\t\t\t\t\t\t\taddVertex( outerPoint, u1, 0 );\n\t\t\t\t\t\t\t\t\t\taddVertex( nextPointL, u1, 0 );\n\n\t\t\t\t\t\t\t\t\t} else {\n\n\t\t\t\t\t\t\t\t\t\taddVertex( currentPointR, u1, 1 );\n\t\t\t\t\t\t\t\t\t\taddVertex( outerPoint, u1, 1 );\n\t\t\t\t\t\t\t\t\t\taddVertex( currentPoint, u1, 0.5 );\n\n\t\t\t\t\t\t\t\t\t\taddVertex( currentPoint, u1, 0.5 );\n\t\t\t\t\t\t\t\t\t\taddVertex( outerPoint, u1, 1 );\n\t\t\t\t\t\t\t\t\t\taddVertex( nextPointR, u1, 1 );\n\n\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\tisMiter = true;\n\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t}\n\n\t\t\t\t} else {\n\n\t\t\t\t\t// The segment triangles are generated here when two consecutive points are collinear\n\n\t\t\t\t\tmakeSegmentTriangles();\n\n\t\t\t\t}\n\n\t\t\t} else {\n\n\t\t\t\t// The segment triangles are generated here if it is the ending segment\n\n\t\t\t\tmakeSegmentTriangles();\n\n\t\t\t}\n\n\t\t\tif ( ! isClosed && iPoint === numPoints - 1 ) {\n\n\t\t\t\t// Start line endcap\n\t\t\t\taddCapGeometry( points[ 0 ], point0L, point0R, joinIsOnLeftSide, true, u0 );\n\n\t\t\t}\n\n\t\t\t// Increment loop variables\n\n\t\t\tu0 = u1;\n\n\t\t\tpreviousPoint = currentPoint;\n\n\t\t\tlastPointL.copy( nextPointL );\n\t\t\tlastPointR.copy( nextPointR );\n\n\t\t}\n\n\t\tif ( ! isClosed ) {\n\n\t\t\t// Ending line endcap\n\t\t\taddCapGeometry( currentPoint, currentPointL, currentPointR, joinIsOnLeftSide, false, u1 );\n\n\t\t} else if ( innerSideModified && vertices ) {\n\n\t\t\t// Modify path first segment vertices to adjust to the segments inner and outer intersections\n\n\t\t\tlet lastOuter = outerPoint;\n\t\t\tlet lastInner = innerPoint;\n\n\t\t\tif ( initialJoinIsOnLeftSide !== joinIsOnLeftSide ) {\n\n\t\t\t\tlastOuter = innerPoint;\n\t\t\t\tlastInner = outerPoint;\n\n\t\t\t}\n\n\t\t\tif ( joinIsOnLeftSide ) {\n\n\t\t\t\tif ( isMiter || initialJoinIsOnLeftSide ) {\n\n\t\t\t\t\tlastInner.toArray( vertices, 0 * 3 );\n\t\t\t\t\tlastInner.toArray( vertices, 3 * 3 );\n\n\t\t\t\t\tif ( isMiter ) {\n\n\t\t\t\t\t\tlastOuter.toArray( vertices, 1 * 3 );\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t} else {\n\n\t\t\t\tif ( isMiter || ! initialJoinIsOnLeftSide ) {\n\n\t\t\t\t\tlastInner.toArray( vertices, 1 * 3 );\n\t\t\t\t\tlastInner.toArray( vertices, 3 * 3 );\n\n\t\t\t\t\tif ( isMiter ) {\n\n\t\t\t\t\t\tlastOuter.toArray( vertices, 0 * 3 );\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn numVertices;\n\n\t\t// -- End of algorithm\n\n\t\t// -- Functions\n\n\t\tfunction getNormal( p1, p2, result ) {\n\n\t\t\tresult.subVectors( p2, p1 );\n\t\t\treturn result.set( - result.y, result.x ).normalize();\n\n\t\t}\n\n\t\tfunction addVertex( position, u, v ) {\n\n\t\t\tif ( vertices ) {\n\n\t\t\t\tvertices[ currentCoordinate ] = position.x;\n\t\t\t\tvertices[ currentCoordinate + 1 ] = position.y;\n\t\t\t\tvertices[ currentCoordinate + 2 ] = 0;\n\n\t\t\t\tif ( normals ) {\n\n\t\t\t\t\tnormals[ currentCoordinate ] = 0;\n\t\t\t\t\tnormals[ currentCoordinate + 1 ] = 0;\n\t\t\t\t\tnormals[ currentCoordinate + 2 ] = 1;\n\n\t\t\t\t}\n\n\t\t\t\tcurrentCoordinate += 3;\n\n\t\t\t\tif ( uvs ) {\n\n\t\t\t\t\tuvs[ currentCoordinateUV ] = u;\n\t\t\t\t\tuvs[ currentCoordinateUV + 1 ] = v;\n\n\t\t\t\t\tcurrentCoordinateUV += 2;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tnumVertices += 3;\n\n\t\t}\n\n\t\tfunction makeCircularSector( center, p1, p2, u, v ) {\n\n\t\t\t// param p1, p2: Points in the circle arc.\n\t\t\t// p1 and p2 are in clockwise direction.\n\n\t\t\ttempV2_1.copy( p1 ).sub( center ).normalize();\n\t\t\ttempV2_2.copy( p2 ).sub( center ).normalize();\n\n\t\t\tlet angle = Math.PI;\n\t\t\tconst dot = tempV2_1.dot( tempV2_2 );\n\t\t\tif ( Math.abs( dot ) < 1 ) angle = Math.abs( Math.acos( dot ) );\n\n\t\t\tangle /= arcDivisions;\n\n\t\t\ttempV2_3.copy( p1 );\n\n\t\t\tfor ( let i = 0, il = arcDivisions - 1; i < il; i ++ ) {\n\n\t\t\t\ttempV2_4.copy( tempV2_3 ).rotateAround( center, angle );\n\n\t\t\t\taddVertex( tempV2_3, u, v );\n\t\t\t\taddVertex( tempV2_4, u, v );\n\t\t\t\taddVertex( center, u, 0.5 );\n\n\t\t\t\ttempV2_3.copy( tempV2_4 );\n\n\t\t\t}\n\n\t\t\taddVertex( tempV2_4, u, v );\n\t\t\taddVertex( p2, u, v );\n\t\t\taddVertex( center, u, 0.5 );\n\n\t\t}\n\n\t\tfunction makeSegmentTriangles() {\n\n\t\t\taddVertex( lastPointR, u0, 1 );\n\t\t\taddVertex( lastPointL, u0, 0 );\n\t\t\taddVertex( currentPointL, u1, 0 );\n\n\t\t\taddVertex( lastPointR, u0, 1 );\n\t\t\taddVertex( currentPointL, u1, 1 );\n\t\t\taddVertex( currentPointR, u1, 0 );\n\n\t\t}\n\n\t\tfunction makeSegmentWithBevelJoin( joinIsOnLeftSide, innerSideModified, u ) {\n\n\t\t\tif ( innerSideModified ) {\n\n\t\t\t\t// Optimized segment + bevel triangles\n\n\t\t\t\tif ( joinIsOnLeftSide ) {\n\n\t\t\t\t\t// Path segments triangles\n\n\t\t\t\t\taddVertex( lastPointR, u0, 1 );\n\t\t\t\t\taddVertex( lastPointL, u0, 0 );\n\t\t\t\t\taddVertex( currentPointL, u1, 0 );\n\n\t\t\t\t\taddVertex( lastPointR, u0, 1 );\n\t\t\t\t\taddVertex( currentPointL, u1, 0 );\n\t\t\t\t\taddVertex( innerPoint, u1, 1 );\n\n\t\t\t\t\t// Bevel join triangle\n\n\t\t\t\t\taddVertex( currentPointL, u, 0 );\n\t\t\t\t\taddVertex( nextPointL, u, 0 );\n\t\t\t\t\taddVertex( innerPoint, u, 0.5 );\n\n\t\t\t\t} else {\n\n\t\t\t\t\t// Path segments triangles\n\n\t\t\t\t\taddVertex( lastPointR, u0, 1 );\n\t\t\t\t\taddVertex( lastPointL, u0, 0 );\n\t\t\t\t\taddVertex( currentPointR, u1, 1 );\n\n\t\t\t\t\taddVertex( lastPointL, u0, 0 );\n\t\t\t\t\taddVertex( innerPoint, u1, 0 );\n\t\t\t\t\taddVertex( currentPointR, u1, 1 );\n\n\t\t\t\t\t// Bevel join triangle\n\n\t\t\t\t\taddVertex( currentPointR, u, 1 );\n\t\t\t\t\taddVertex( nextPointR, u, 0 );\n\t\t\t\t\taddVertex( innerPoint, u, 0.5 );\n\n\t\t\t\t}\n\n\t\t\t} else {\n\n\t\t\t\t// Bevel join triangle. The segment triangles are done in the main loop\n\n\t\t\t\tif ( joinIsOnLeftSide ) {\n\n\t\t\t\t\taddVertex( currentPointL, u, 0 );\n\t\t\t\t\taddVertex( nextPointL, u, 0 );\n\t\t\t\t\taddVertex( currentPoint, u, 0.5 );\n\n\t\t\t\t} else {\n\n\t\t\t\t\taddVertex( currentPointR, u, 1 );\n\t\t\t\t\taddVertex( nextPointR, u, 0 );\n\t\t\t\t\taddVertex( currentPoint, u, 0.5 );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\tfunction createSegmentTrianglesWithMiddleSection( joinIsOnLeftSide, innerSideModified ) {\n\n\t\t\tif ( innerSideModified ) {\n\n\t\t\t\tif ( joinIsOnLeftSide ) {\n\n\t\t\t\t\taddVertex( lastPointR, u0, 1 );\n\t\t\t\t\taddVertex( lastPointL, u0, 0 );\n\t\t\t\t\taddVertex( currentPointL, u1, 0 );\n\n\t\t\t\t\taddVertex( lastPointR, u0, 1 );\n\t\t\t\t\taddVertex( currentPointL, u1, 0 );\n\t\t\t\t\taddVertex( innerPoint, u1, 1 );\n\n\t\t\t\t\taddVertex( currentPointL, u0, 0 );\n\t\t\t\t\taddVertex( currentPoint, u1, 0.5 );\n\t\t\t\t\taddVertex( innerPoint, u1, 1 );\n\n\t\t\t\t\taddVertex( currentPoint, u1, 0.5 );\n\t\t\t\t\taddVertex( nextPointL, u0, 0 );\n\t\t\t\t\taddVertex( innerPoint, u1, 1 );\n\n\t\t\t\t} else {\n\n\t\t\t\t\taddVertex( lastPointR, u0, 1 );\n\t\t\t\t\taddVertex( lastPointL, u0, 0 );\n\t\t\t\t\taddVertex( currentPointR, u1, 1 );\n\n\t\t\t\t\taddVertex( lastPointL, u0, 0 );\n\t\t\t\t\taddVertex( innerPoint, u1, 0 );\n\t\t\t\t\taddVertex( currentPointR, u1, 1 );\n\n\t\t\t\t\taddVertex( currentPointR, u0, 1 );\n\t\t\t\t\taddVertex( innerPoint, u1, 0 );\n\t\t\t\t\taddVertex( currentPoint, u1, 0.5 );\n\n\t\t\t\t\taddVertex( currentPoint, u1, 0.5 );\n\t\t\t\t\taddVertex( innerPoint, u1, 0 );\n\t\t\t\t\taddVertex( nextPointR, u0, 1 );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\tfunction addCapGeometry( center, p1, p2, joinIsOnLeftSide, start, u ) {\n\n\t\t\t// param center: End point of the path\n\t\t\t// param p1, p2: Left and right cap points\n\n\t\t\tswitch ( style.strokeLineCap ) {\n\n\t\t\t\tcase 'round':\n\n\t\t\t\t\tif ( start ) {\n\n\t\t\t\t\t\tmakeCircularSector( center, p2, p1, u, 0.5 );\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\tmakeCircularSector( center, p1, p2, u, 0.5 );\n\n\t\t\t\t\t}\n\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'square':\n\n\t\t\t\t\tif ( start ) {\n\n\t\t\t\t\t\ttempV2_1.subVectors( p1, center );\n\t\t\t\t\t\ttempV2_2.set( tempV2_1.y, - tempV2_1.x );\n\n\t\t\t\t\t\ttempV2_3.addVectors( tempV2_1, tempV2_2 ).add( center );\n\t\t\t\t\t\ttempV2_4.subVectors( tempV2_2, tempV2_1 ).add( center );\n\n\t\t\t\t\t\t// Modify already existing vertices\n\t\t\t\t\t\tif ( joinIsOnLeftSide ) {\n\n\t\t\t\t\t\t\ttempV2_3.toArray( vertices, 1 * 3 );\n\t\t\t\t\t\t\ttempV2_4.toArray( vertices, 0 * 3 );\n\t\t\t\t\t\t\ttempV2_4.toArray( vertices, 3 * 3 );\n\n\t\t\t\t\t\t} else {\n\n\t\t\t\t\t\t\ttempV2_3.toArray( vertices, 1 * 3 );\n\t\t\t\t\t\t\ttempV2_3.toArray( vertices, 3 * 3 );\n\t\t\t\t\t\t\ttempV2_4.toArray( vertices, 0 * 3 );\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\ttempV2_1.subVectors( p2, center );\n\t\t\t\t\t\ttempV2_2.set( tempV2_1.y, - tempV2_1.x );\n\n\t\t\t\t\t\ttempV2_3.addVectors( tempV2_1, tempV2_2 ).add( center );\n\t\t\t\t\t\ttempV2_4.subVectors( tempV2_2, tempV2_1 ).add( center );\n\n\t\t\t\t\t\tconst vl = vertices.length;\n\n\t\t\t\t\t\t// Modify already existing vertices\n\t\t\t\t\t\tif ( joinIsOnLeftSide ) {\n\n\t\t\t\t\t\t\ttempV2_3.toArray( vertices, vl - 1 * 3 );\n\t\t\t\t\t\t\ttempV2_4.toArray( vertices, vl - 2 * 3 );\n\t\t\t\t\t\t\ttempV2_4.toArray( vertices, vl - 4 * 3 );\n\n\t\t\t\t\t\t} else {\n\n\t\t\t\t\t\t\ttempV2_3.toArray( vertices, vl - 2 * 3 );\n\t\t\t\t\t\t\ttempV2_4.toArray( vertices, vl - 1 * 3 );\n\t\t\t\t\t\t\ttempV2_4.toArray( vertices, vl - 4 * 3 );\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'butt':\n\t\t\t\tdefault:\n\n\t\t\t\t\t// Nothing to do here\n\t\t\t\t\tbreak;\n\n\t\t\t}\n\n\t\t}\n\n\t\tfunction removeDuplicatedPoints( points ) {\n\n\t\t\t// Creates a new array if necessary with duplicated points removed.\n\t\t\t// This does not remove duplicated initial and ending points of a closed path.\n\n\t\t\tlet dupPoints = false;\n\t\t\tfor ( let i = 1, n = points.length - 1; i < n; i ++ ) {\n\n\t\t\t\tif ( points[ i ].distanceTo( points[ i + 1 ] ) < minDistance ) {\n\n\t\t\t\t\tdupPoints = true;\n\t\t\t\t\tbreak;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tif ( ! dupPoints ) return points;\n\n\t\t\tconst newPoints = [];\n\t\t\tnewPoints.push( points[ 0 ] );\n\n\t\t\tfor ( let i = 1, n = points.length - 1; i < n; i ++ ) {\n\n\t\t\t\tif ( points[ i ].distanceTo( points[ i + 1 ] ) >= minDistance ) {\n\n\t\t\t\t\tnewPoints.push( points[ i ] );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tnewPoints.push( points[ points.length - 1 ] );\n\n\t\t\treturn newPoints;\n\n\t\t}\n\n\t}\n\n\n}\n\nexport { SVGLoader };\n","// copied from https://github.com/mrdoob/three.js/blob/670b1e9e85356d98efa4c702e93c85dd52f01e1e/src/core/DirectGeometry.js\r\nimport { Vector2 } from 'three';\r\nexport class DirectGeometry {\r\n    constructor() {\r\n        this.vertices = [];\r\n        this.normals = [];\r\n        this.colors = [];\r\n        this.uvs = [];\r\n        this.uvs2 = [];\r\n        this.groups = [];\r\n        this.morphTargets = {};\r\n        this.skinWeights = [];\r\n        this.skinIndices = [];\r\n        // lineDistances = [];\r\n        this.boundingBox = null;\r\n        this.boundingSphere = null;\r\n        // update flags\r\n        this.verticesNeedUpdate = false;\r\n        this.normalsNeedUpdate = false;\r\n        this.colorsNeedUpdate = false;\r\n        this.uvsNeedUpdate = false;\r\n        this.groupsNeedUpdate = false;\r\n    }\r\n    computeGroups(geometry) {\r\n        const groups = [];\r\n        let group, i;\r\n        let materialIndex = undefined;\r\n        const faces = geometry.faces;\r\n        for (i = 0; i < faces.length; i++) {\r\n            const face = faces[i];\r\n            // materials\r\n            if (face.materialIndex !== materialIndex) {\r\n                materialIndex = face.materialIndex;\r\n                if (group !== undefined) {\r\n                    group.count = i * 3 - group.start;\r\n                    groups.push(group);\r\n                }\r\n                group = {\r\n                    start: i * 3,\r\n                    materialIndex: materialIndex\r\n                };\r\n            }\r\n        }\r\n        if (group !== undefined) {\r\n            group.count = i * 3 - group.start;\r\n            groups.push(group);\r\n        }\r\n        this.groups = groups;\r\n    }\r\n    fromGeometry(geometry) {\r\n        const faces = geometry.faces;\r\n        const vertices = geometry.vertices;\r\n        const faceVertexUvs = geometry.faceVertexUvs;\r\n        const hasFaceVertexUv = faceVertexUvs[0] && faceVertexUvs[0].length > 0;\r\n        const hasFaceVertexUv2 = faceVertexUvs[1] && faceVertexUvs[1].length > 0;\r\n        // morphs\r\n        const morphTargets = geometry.morphTargets;\r\n        const morphTargetsLength = morphTargets.length;\r\n        let morphTargetsPosition;\r\n        if (morphTargetsLength > 0) {\r\n            morphTargetsPosition = [];\r\n            for (let i = 0; i < morphTargetsLength; i++) {\r\n                morphTargetsPosition[i] = {\r\n                    name: morphTargets[i].name,\r\n                    data: []\r\n                };\r\n            }\r\n            this.morphTargets.position = morphTargetsPosition;\r\n        }\r\n        const morphNormals = geometry.morphNormals;\r\n        const morphNormalsLength = morphNormals.length;\r\n        let morphTargetsNormal;\r\n        if (morphNormalsLength > 0) {\r\n            morphTargetsNormal = [];\r\n            for (let i = 0; i < morphNormalsLength; i++) {\r\n                morphTargetsNormal[i] = {\r\n                    name: morphNormals[i].name,\r\n                    data: []\r\n                };\r\n            }\r\n            this.morphTargets.normal = morphTargetsNormal;\r\n        }\r\n        // skins\r\n        const skinIndices = geometry.skinIndices;\r\n        const skinWeights = geometry.skinWeights;\r\n        const hasSkinIndices = skinIndices.length === vertices.length;\r\n        const hasSkinWeights = skinWeights.length === vertices.length;\r\n        //\r\n        if (vertices.length > 0 && faces.length === 0) {\r\n            console.error('THREE.DirectGeometry: Faceless geometries are not supported.');\r\n        }\r\n        for (let i = 0; i < faces.length; i++) {\r\n            const face = faces[i];\r\n            this.vertices.push(vertices[face.a], vertices[face.b], vertices[face.c]);\r\n            const vertexNormals = face.vertexNormals;\r\n            if (vertexNormals.length === 3) {\r\n                this.normals.push(vertexNormals[0], vertexNormals[1], vertexNormals[2]);\r\n            }\r\n            else {\r\n                const normal = face.normal;\r\n                this.normals.push(normal, normal, normal);\r\n            }\r\n            const vertexColors = face.vertexColors;\r\n            if (vertexColors.length === 3) {\r\n                this.colors.push(vertexColors[0], vertexColors[1], vertexColors[2]);\r\n            }\r\n            else {\r\n                const color = face.color;\r\n                this.colors.push(color, color, color);\r\n            }\r\n            if (hasFaceVertexUv === true) {\r\n                const vertexUvs = faceVertexUvs[0][i];\r\n                if (vertexUvs !== undefined) {\r\n                    this.uvs.push(vertexUvs[0], vertexUvs[1], vertexUvs[2]);\r\n                }\r\n                else {\r\n                    console.warn('THREE.DirectGeometry.fromGeometry(): Undefined vertexUv ', i);\r\n                    this.uvs.push(new Vector2(), new Vector2(), new Vector2());\r\n                }\r\n            }\r\n            if (hasFaceVertexUv2 === true) {\r\n                const vertexUvs = faceVertexUvs[1][i];\r\n                if (vertexUvs !== undefined) {\r\n                    this.uvs2.push(vertexUvs[0], vertexUvs[1], vertexUvs[2]);\r\n                }\r\n                else {\r\n                    console.warn('THREE.DirectGeometry.fromGeometry(): Undefined vertexUv2 ', i);\r\n                    this.uvs2.push(new Vector2(), new Vector2(), new Vector2());\r\n                }\r\n            }\r\n            // morphs\r\n            for (let j = 0; j < morphTargetsLength; j++) {\r\n                const morphTarget = morphTargets[j].vertices;\r\n                morphTargetsPosition[j].data.push(morphTarget[face.a], morphTarget[face.b], morphTarget[face.c]);\r\n            }\r\n            for (let j = 0; j < morphNormalsLength; j++) {\r\n                const morphNormal = morphNormals[j].vertexNormals[i];\r\n                morphTargetsNormal[j].data.push(morphNormal.a, morphNormal.b, morphNormal.c);\r\n            }\r\n            // skins\r\n            if (hasSkinIndices) {\r\n                // @ts-expect-error\r\n                this.skinIndices.push(skinIndices[face.a], skinIndices[face.b], skinIndices[face.c]);\r\n            }\r\n            if (hasSkinWeights) {\r\n                // @ts-expect-error\r\n                this.skinWeights.push(skinWeights[face.a], skinWeights[face.b], skinWeights[face.c]);\r\n            }\r\n        }\r\n        this.computeGroups(geometry);\r\n        this.verticesNeedUpdate = geometry.verticesNeedUpdate;\r\n        this.normalsNeedUpdate = geometry.normalsNeedUpdate;\r\n        this.colorsNeedUpdate = geometry.colorsNeedUpdate;\r\n        this.uvsNeedUpdate = geometry.uvsNeedUpdate;\r\n        this.groupsNeedUpdate = geometry.groupsNeedUpdate;\r\n        if (geometry.boundingSphere !== null) {\r\n            this.boundingSphere = geometry.boundingSphere.clone();\r\n        }\r\n        if (geometry.boundingBox !== null) {\r\n            this.boundingBox = geometry.boundingBox.clone();\r\n        }\r\n        return this;\r\n    }\r\n}\r\n//# sourceMappingURL=_directGeometry.js.map","// copied from https://github.com/mrdoob/three.js/blob/670b1e9e85356d98efa4c702e93c85dd52f01e1e/src/core/BufferGeometry.js\r\nimport { BufferAttribute, Float32BufferAttribute } from 'three';\r\nimport { DirectGeometry } from './_directGeometry';\r\nexport const fromGeometry = (buffer, geometry) => {\r\n    const directGeometry = new DirectGeometry().fromGeometry(geometry);\r\n    return fromDirectGeometry(buffer, directGeometry);\r\n};\r\nconst fromDirectGeometry = (buffer, geometry) => {\r\n    var _a, _b;\r\n    const positions = new Float32Array(geometry.vertices.length * 3);\r\n    buffer.setAttribute('position', new BufferAttribute(positions, 3).copyVector3sArray(geometry.vertices));\r\n    if (geometry.normals.length > 0) {\r\n        const normals = new Float32Array(geometry.normals.length * 3);\r\n        buffer.setAttribute('normal', new BufferAttribute(normals, 3).copyVector3sArray(geometry.normals));\r\n    }\r\n    if (geometry.colors.length > 0) {\r\n        const colors = new Float32Array(geometry.colors.length * 3);\r\n        buffer.setAttribute('color', new BufferAttribute(colors, 3).copyColorsArray(geometry.colors));\r\n    }\r\n    if (geometry.uvs.length > 0) {\r\n        const uvs = new Float32Array(geometry.uvs.length * 2);\r\n        buffer.setAttribute('uv', new BufferAttribute(uvs, 2).copyVector2sArray(geometry.uvs));\r\n    }\r\n    if (geometry.uvs2.length > 0) {\r\n        const uvs2 = new Float32Array(geometry.uvs2.length * 2);\r\n        buffer.setAttribute('uv2', new BufferAttribute(uvs2, 2).copyVector2sArray(geometry.uvs2));\r\n    }\r\n    // groups\r\n    buffer.groups = geometry.groups;\r\n    // morphs\r\n    for (const name in geometry.morphTargets) {\r\n        const array = [];\r\n        const morphTargets = geometry.morphTargets[name];\r\n        for (let i = 0, l = morphTargets.length; i < l; i++) {\r\n            const morphTarget = morphTargets[i];\r\n            const attribute = new Float32BufferAttribute(morphTarget.data.length * 3, 3);\r\n            attribute.name = morphTarget.name;\r\n            array.push(attribute.copyVector3sArray(morphTarget.data));\r\n        }\r\n        buffer.morphAttributes[name] = array;\r\n    }\r\n    // skinning\r\n    if (geometry.skinIndices.length > 0) {\r\n        const skinIndices = new Float32BufferAttribute(geometry.skinIndices.length * 4, 4);\r\n        buffer.setAttribute('skinIndex', skinIndices.copyVector4sArray(geometry.skinIndices));\r\n    }\r\n    if (geometry.skinWeights.length > 0) {\r\n        const skinWeights = new Float32BufferAttribute(geometry.skinWeights.length * 4, 4);\r\n        buffer.setAttribute('skinWeight', skinWeights.copyVector4sArray(geometry.skinWeights));\r\n    }\r\n    //\r\n    if (geometry.boundingSphere !== null) {\r\n        // @ts-expect-error\r\n        buffer.boundingSphere = (_a = geometry.boundingSphere) === null || _a === void 0 ? void 0 : _a.clone();\r\n    }\r\n    if (geometry.boundingBox !== null) {\r\n        // @ts-expect-error\r\n        buffer.boundingBox = (_b = geometry.boundingBox) === null || _b === void 0 ? void 0 : _b.clone();\r\n    }\r\n    return buffer;\r\n};\r\n//# sourceMappingURL=_fromGeometry.js.map","import { Geometry } from 'three/examples/jsm/deprecated/Geometry';\r\nimport { BufferGeometry, Mesh, MeshBasicMaterial, PlaneBufferGeometry, Raycaster, Vector2, Vector3 } from 'three';\r\nimport { SVGLoader } from 'three/examples/jsm/loaders/SVGLoader';\r\nimport { fromGeometry } from '../csg/_fromGeometry';\r\n/**\r\n * @author       Yannick Deubel (https://github.com/yandeu)\r\n * @copyright    Copyright (c) 2020 Yannick Deubel; Project Url: https://github.com/enable3d/enable3d\r\n * @license      {@link https://github.com/enable3d/enable3d/blob/master/LICENSE|GNU GPLv3}\r\n */\r\nexport default class Transform {\r\n    constructor(camera, renderer) {\r\n        this.camera = camera;\r\n        this.renderer = renderer;\r\n    }\r\n    static geometryToBufferGeometry(geometry) {\r\n        if (geometry.isGeometry)\r\n            return fromGeometry(new BufferGeometry(), geometry);\r\n        else\r\n            return geometry;\r\n    }\r\n    static bufferGeometryToGeometry(bufferGeometry) {\r\n        if (bufferGeometry.isBufferGeometry)\r\n            return new Geometry().fromBufferGeometry(bufferGeometry);\r\n        else\r\n            return bufferGeometry;\r\n    }\r\n    /**\r\n     * Transforms your svg files to paths.\r\n     */\r\n    fromSVGtoShape(svg, isCCW = false, noHoles) {\r\n        if (svg) {\r\n            const svgLoader = new SVGLoader();\r\n            const shapes = [];\r\n            svgLoader.parse(svg).paths.forEach(path => {\r\n                path.toShapes(isCCW, noHoles).forEach(shape => {\r\n                    shapes.push(shape);\r\n                });\r\n            });\r\n            return shapes;\r\n        }\r\n        return [];\r\n    }\r\n    from3dto2d(position) {\r\n        const vector3 = new Vector3(position.x, position.y, position.z);\r\n        const canvas = this.renderer.domElement;\r\n        // map to normalized device coordinate (NDC) space\r\n        this.camera.updateMatrixWorld();\r\n        vector3.project(this.camera);\r\n        // map to 2D screen space\r\n        const x = Math.round((vector3.x + 1) * (canvas.width / 2));\r\n        const y = Math.round((-vector3.y + 1) * (canvas.height / 2));\r\n        return new Vector2(x, y);\r\n    }\r\n    /**\r\n     *\r\n     * @param x X coordinate in normalized device coordinate (NDC) (-1 to +1).\r\n     * @param y Y coordinate in normalized device coordinate (NDC) (-1 to +1).\r\n     * @param distanceFromCamera The distance from the camera.\r\n     */\r\n    from2dto3d(x, y, distanceFromCamera) {\r\n        var _a;\r\n        // initialize temporary variables\r\n        if (!this.tmpPlane) {\r\n            const geo = new PlaneBufferGeometry(10000, 10000);\r\n            const mat = new MeshBasicMaterial({ transparent: true, opacity: 0.25 });\r\n            this.tmpPlane = new Mesh(geo, mat);\r\n            this.tmpPlane.name = '_tmp_raycast_plane';\r\n        }\r\n        if (!this.tmpRaycaster)\r\n            this.tmpRaycaster = new Raycaster();\r\n        if (!this.tmpVector3)\r\n            this.tmpVector3 = new Vector3();\r\n        // holds the position we want to return later\r\n        let position;\r\n        // add plane parallel to camera\r\n        this.tmpPlane.setRotationFromEuler(this.camera.rotation);\r\n        const p = this.camera.position;\r\n        this.tmpPlane.position.set(p.x, p.y, p.z);\r\n        // adjust the distance of the plane\r\n        this.camera.getWorldDirection(this.tmpVector3);\r\n        this.tmpPlane.position.add(this.tmpVector3.clone().multiplyScalar(distanceFromCamera));\r\n        this.tmpPlane.updateMatrix();\r\n        this.tmpPlane.updateMatrixWorld(true);\r\n        // raycast\r\n        this.tmpRaycaster.setFromCamera({ x, y }, this.camera);\r\n        // check intersection with plane\r\n        const intersects = this.tmpRaycaster.intersectObjects([this.tmpPlane]);\r\n        if (((_a = intersects[0]) === null || _a === void 0 ? void 0 : _a.object.name) === '_tmp_raycast_plane')\r\n            position = intersects[0].point;\r\n        return position;\r\n    }\r\n}\r\n//# sourceMappingURL=transform.js.map","/* eslint-disable no-case-declarations */\r\n/* eslint-disable constructor-super */\r\n/* eslint-disable no-this-before-super */\r\n/**\r\n * @author       Evan Wallace (http://madebyevan.com/))\r\n * @copyright    Copyright (c) 2011 Evan Wallace\r\n * @license      MIT license\r\n *\r\n * @author       manthrax (https://github.com/manthrax)\r\n *\r\n * @author       Jiro-Digital (https://github.com/Jiro-Digital)\r\n * @copyright    Copyright (c) 2020 Jiro Digital Ltd\r\n * @license      {@link https://github.com/Jiro-Digital/three-csg-ts/blob/master/LICENSE|MIT}\r\n *\r\n * @author       Yannick Deubel (https://github.com/yandeu)\r\n * @copyright    Copyright (c) 2021 Yannick Deubel; Project Url: https://github.com/enable3d/enable3d\r\n * @license      {@link https://github.com/enable3d/enable3d/blob/master/LICENSE|GNU GPLv3}\r\n */\r\n// TODO(yandeu) Replace this CSG lib with one that works natively with Buffer Geometries.\r\n// Originally copied from https://github.com/Hi-Level/three-csg (now https://github.com/Jiro-Digital/three-csg-ts)\r\n// which is a typescript rewrite of https://github.com/manthrax/THREE-CSGMesh\r\n// which as originally written by Copyright (c) 2011 Evan Wallace (http://madebyevan.com/), under the MIT license.\r\nimport { Geometry } from 'three/examples/jsm/deprecated/Geometry';\r\nimport { Face3 } from '@enable3d/three-wrapper/dist/deprecated/face3';\r\nimport { Matrix3, Matrix4, Mesh, REVISION, Vector3 } from 'three';\r\nimport Transform from '../plugins/transform';\r\n/**\r\n * CSG wrapper for enable3d\r\n *\r\n * The CSG library does not support buffer geometries.\r\n * Means we first make sure we are dealing with geometries\r\n * and then transform them back to buffer geometries.\r\n */\r\nclass CSGWrapper {\r\n    static toGeometry(meshA, meshB) {\r\n        meshA.geometry = Transform.bufferGeometryToGeometry(meshA.geometry);\r\n        meshB.geometry = Transform.bufferGeometryToGeometry(meshB.geometry);\r\n    }\r\n    static toBufferGeometry(meshC) {\r\n        meshC.geometry = Transform.geometryToBufferGeometry(meshC.geometry);\r\n    }\r\n    static union(meshA, meshB) {\r\n        this.toGeometry(meshA, meshB);\r\n        const meshC = this.doCSG(meshA, meshB, 'union');\r\n        this.toBufferGeometry(meshC);\r\n        return meshC;\r\n    }\r\n    static subtract(meshA, meshB) {\r\n        this.toGeometry(meshA, meshB);\r\n        const meshC = this.doCSG(meshA, meshB, 'subtract');\r\n        this.toBufferGeometry(meshC);\r\n        return meshC;\r\n    }\r\n    static intersect(meshA, meshB) {\r\n        this.toGeometry(meshA, meshB);\r\n        const meshC = this.doCSG(meshA, meshB, 'intersect');\r\n        this.toBufferGeometry(meshC);\r\n        return meshC;\r\n    }\r\n    static doCSG(meshA, meshB, operation) {\r\n        meshA.updateMatrix();\r\n        meshB.updateMatrix();\r\n        const bspA = CSG.fromMesh(meshA);\r\n        const bspB = CSG.fromMesh(meshB);\r\n        const bspC = bspA[operation](bspB);\r\n        const result = CSG.toMesh(bspC, meshA.matrix);\r\n        return result;\r\n    }\r\n}\r\nexport { CSGWrapper as CSG };\r\n/**\r\n * CSG (Constructive Solid Geometry) library for three.js with Typescript support.\r\n * Holds a binary space partition tree representing a 3D solid. Two solids can\r\n * be combined using the `union()`, `subtract()`, and `intersect()` methods.\r\n */\r\nclass CSG {\r\n    constructor() {\r\n        this.polygons = [];\r\n    }\r\n    static fromPolygons(polygons) {\r\n        const csg = new CSG();\r\n        csg.polygons = polygons;\r\n        return csg;\r\n    }\r\n    static fromGeometry(geom) {\r\n        if (geom.isBufferGeometry) {\r\n            geom = new Geometry().fromBufferGeometry(geom);\r\n        }\r\n        const fs = geom.faces;\r\n        const vs = geom.vertices;\r\n        const polys = [];\r\n        const fm = ['a', 'b', 'c'];\r\n        for (let i = 0; i < fs.length; i++) {\r\n            const f = fs[i];\r\n            const vertices = [];\r\n            for (let j = 0; j < 3; j++) {\r\n                const uvs = geom.faceVertexUvs[0][i] !== undefined && geom.faceVertexUvs[0][i][j] !== undefined\r\n                    ? geom.faceVertexUvs[0][i][j]\r\n                    : undefined;\r\n                vertices.push(new Vertex(vs[f[fm[j]]], f.vertexNormals[j], uvs));\r\n            }\r\n            polys.push(new Polygon(vertices));\r\n        }\r\n        return CSG.fromPolygons(polys);\r\n    }\r\n    static fromMesh(mesh) {\r\n        const csg = CSG.fromGeometry(mesh.geometry);\r\n        CSG._tmpm3.getNormalMatrix(mesh.matrix);\r\n        for (const p of csg.polygons) {\r\n            for (const v of p.vertices) {\r\n                v.pos.applyMatrix4(mesh.matrix);\r\n                v.normal.applyMatrix3(CSG._tmpm3);\r\n            }\r\n        }\r\n        return csg;\r\n    }\r\n    static toMesh(csg, toMatrix) {\r\n        const geom = new Geometry();\r\n        const ps = csg.polygons;\r\n        const vs = geom.vertices;\r\n        const fvuv = geom.faceVertexUvs[0];\r\n        for (const p of ps) {\r\n            const pvs = p.vertices;\r\n            const v0 = vs.length;\r\n            const pvlen = pvs.length;\r\n            for (const pv of pvs) {\r\n                vs.push(new Vector3().copy(pv.pos));\r\n            }\r\n            for (let j = 3; j <= pvlen; j++) {\r\n                const fc = new Face3(v0, v0 + j - 2, v0 + j - 1);\r\n                const fuv = [];\r\n                fvuv.push(fuv);\r\n                const fnml = fc.vertexNormals;\r\n                fnml.push(new Vector3().copy(pvs[0].normal));\r\n                fnml.push(new Vector3().copy(pvs[j - 2].normal));\r\n                fnml.push(new Vector3().copy(pvs[j - 1].normal));\r\n                // check for uv property\r\n                if (pvs[0].uv && pvs[j - 2].uv && pvs[j - 1].uv) {\r\n                    fuv.push(new Vector3().copy(pvs[0].uv));\r\n                    fuv.push(new Vector3().copy(pvs[j - 2].uv));\r\n                    fuv.push(new Vector3().copy(pvs[j - 1].uv));\r\n                }\r\n                fc.normal = new Vector3().copy(p.plane.normal);\r\n                geom.faces.push(fc);\r\n            }\r\n        }\r\n        // compatibility fix for three.js >= r123 (Dezember 2020)\r\n        const inv = \r\n        // @ts-ignore\r\n        parseInt(REVISION) >= 123\r\n            ? new Matrix4().copy(toMatrix).invert()\r\n            : new Matrix4().getInverse(toMatrix);\r\n        geom.applyMatrix4(inv);\r\n        geom.verticesNeedUpdate = geom.elementsNeedUpdate = geom.normalsNeedUpdate = true;\r\n        geom.computeBoundingSphere();\r\n        geom.computeBoundingBox();\r\n        // @ts-expect-error\r\n        const m = new Mesh(geom);\r\n        m.matrix.copy(toMatrix);\r\n        m.matrix.decompose(m.position, m.rotation, m.scale);\r\n        m.updateMatrixWorld();\r\n        return m;\r\n    }\r\n    static iEval(tokens, _index = 0) {\r\n        var _a;\r\n        if (typeof tokens === 'string') {\r\n            CSG.currentOp = tokens;\r\n        }\r\n        else if (tokens instanceof Array) {\r\n            for (const token of tokens) {\r\n                CSG.iEval(token, 0);\r\n            }\r\n        }\r\n        else if (typeof tokens === 'object') {\r\n            const op = CSG.currentOp;\r\n            tokens.updateMatrix();\r\n            tokens.updateMatrixWorld();\r\n            if (!CSG.sourceMesh) {\r\n                CSG.currentPrim = CSG.fromMesh((CSG.sourceMesh = tokens));\r\n            }\r\n            else {\r\n                CSG.nextPrim = CSG.fromMesh(tokens);\r\n                CSG.currentPrim = CSG.currentPrim[op](CSG.nextPrim);\r\n            }\r\n            if (CSG.doRemove)\r\n                (_a = tokens === null || tokens === void 0 ? void 0 : tokens.parent) === null || _a === void 0 ? void 0 : _a.remove(tokens);\r\n        } // union,subtract,intersect,inverse\r\n    }\r\n    static eval(tokens, doRemove) {\r\n        // [['add',mesh,mesh,mesh,mesh],['sub',mesh,mesh,mesh,mesh]]\r\n        // @ts-ignore\r\n        delete CSG.currentOp;\r\n        // @ts-ignore\r\n        delete CSG.sourceMesh;\r\n        CSG.doRemove = doRemove;\r\n        CSG.iEval(tokens);\r\n        const result = CSG.toMesh(CSG.currentPrim, CSG.sourceMesh.matrix);\r\n        result.material = CSG.sourceMesh.material;\r\n        result.castShadow = result.receiveShadow = true;\r\n        return result;\r\n    }\r\n    clone() {\r\n        const csg = new CSG();\r\n        csg.polygons = this.polygons.map(p => {\r\n            return p.clone();\r\n        });\r\n        return csg;\r\n    }\r\n    toPolygons() {\r\n        return this.polygons;\r\n    }\r\n    union(csg) {\r\n        const a = new Node(this.clone().polygons);\r\n        const b = new Node(csg.clone().polygons);\r\n        a.clipTo(b);\r\n        b.clipTo(a);\r\n        b.invert();\r\n        b.clipTo(a);\r\n        b.invert();\r\n        a.build(b.allPolygons());\r\n        return CSG.fromPolygons(a.allPolygons());\r\n    }\r\n    subtract(csg) {\r\n        const a = new Node(this.clone().polygons);\r\n        const b = new Node(csg.clone().polygons);\r\n        a.invert();\r\n        a.clipTo(b);\r\n        b.clipTo(a);\r\n        b.invert();\r\n        b.clipTo(a);\r\n        b.invert();\r\n        a.build(b.allPolygons());\r\n        a.invert();\r\n        return CSG.fromPolygons(a.allPolygons());\r\n    }\r\n    intersect(csg) {\r\n        const a = new Node(this.clone().polygons);\r\n        const b = new Node(csg.clone().polygons);\r\n        a.invert();\r\n        b.clipTo(a);\r\n        b.invert();\r\n        a.clipTo(b);\r\n        b.clipTo(a);\r\n        a.build(b.allPolygons());\r\n        a.invert();\r\n        return CSG.fromPolygons(a.allPolygons());\r\n    }\r\n    inverse() {\r\n        const csg = this.clone();\r\n        csg.polygons.map(p => {\r\n            p.flip();\r\n        });\r\n        return csg;\r\n    }\r\n}\r\nCSG._tmpm3 = new Matrix3();\r\n/**\r\n * Represents a 3D vector.\r\n */\r\nclass Vector extends Vector3 {\r\n    constructor(x, y, z) {\r\n        if (arguments.length === 3) {\r\n            super(x, y, z);\r\n        }\r\n        else if (Array.isArray(x)) {\r\n            super(x[0], x[1], x[2]);\r\n        }\r\n        else if (typeof x === 'object') {\r\n            // @ts-ignore\r\n            this.copy(x);\r\n        }\r\n        else {\r\n            throw new Error('Invalid constructor to vector');\r\n        }\r\n    }\r\n    clone() {\r\n        return new Vector(this.x, this.y, this.z);\r\n    }\r\n    negated() {\r\n        return this.clone().multiplyScalar(-1);\r\n    }\r\n    plus(a) {\r\n        return this.clone().add(a);\r\n    }\r\n    minus(a) {\r\n        return this.clone().sub(a);\r\n    }\r\n    times(a) {\r\n        return this.clone().multiplyScalar(a);\r\n    }\r\n    dividedBy(a) {\r\n        return this.clone().divideScalar(a);\r\n    }\r\n    lerp(a, t) {\r\n        return this.plus(a.minus(this).times(t));\r\n    }\r\n    unit() {\r\n        return this.dividedBy(this.length());\r\n    }\r\n    // @ts-ignore\r\n    cross(a, w) {\r\n        return Vector3.prototype.cross.call(this.clone(), a);\r\n    }\r\n}\r\n/**\r\n * Represents a vertex of a polygon. Use your own vertex class instead of this\r\n * one to provide additional features like texture coordinates and vertex\r\n * colors. Custom vertex classes need to provide a `pos` property and `clone()`,\r\n * `flip()`, and `interpolate()` methods that behave analogous to the ones\r\n * defined by `CSG.Vertex`. This class provides `normal` so convenience\r\n * functions like `CSG.sphere()` can return a smooth vertex normal, but `normal`\r\n * is not used anywhere else.\r\n */\r\nclass Vertex {\r\n    constructor(pos, normal, uv) {\r\n        this.pos = new Vector(pos.x, pos.y, pos.z);\r\n        this.normal = new Vector(normal.x, normal.y, normal.z);\r\n        if (uv)\r\n            this.uv = new Vector(uv.x, uv.y, uv.z);\r\n    }\r\n    clone() {\r\n        return new Vertex(this.pos.clone(), this.normal.clone(), this.uv ? this.uv.clone() : undefined);\r\n    }\r\n    // Invert all orientation-specific data (e.g. vertex normal). Called when the\r\n    // orientation of a polygon is flipped.\r\n    flip() {\r\n        this.normal = this.normal.negated();\r\n    }\r\n    // Create a new vertex between this vertex and `other` by linearly\r\n    // interpolating all properties using a parameter of `t`. Subclasses should\r\n    // override this to interpolate additional properties.\r\n    interpolate(other, t) {\r\n        return new Vertex(this.pos.lerp(other.pos, t), this.normal.lerp(other.normal, t), this.uv ? this.uv.lerp(other.uv, t) : undefined);\r\n    }\r\n}\r\n/**\r\n * Represents a plane in 3D space.\r\n */\r\nclass Plane {\r\n    constructor(normal, w) {\r\n        this.normal = normal;\r\n        this.w = w;\r\n    }\r\n    static fromPoints(a, b, c) {\r\n        const n = b\r\n            .minus(a)\r\n            .cross(c.minus(a))\r\n            // @ts-ignore\r\n            .unit();\r\n        return new Plane(n, n.dot(a));\r\n    }\r\n    clone() {\r\n        return new Plane(this.normal.clone(), this.w);\r\n    }\r\n    flip() {\r\n        this.normal = this.normal.negated();\r\n        this.w = -this.w;\r\n    }\r\n    // Split `polygon` by this plane if needed, then put the polygon or polygon\r\n    // fragments in the appropriate lists. Coplanar polygons go into either\r\n    // `coplanarFront` or `coplanarBack` depending on their orientation with\r\n    // respect to this plane. Polygons in front or in back of this plane go into\r\n    // either `front` or `back`.\r\n    splitPolygon(polygon, coplanarFront, coplanarBack, front, back) {\r\n        const COPLANAR = 0;\r\n        const FRONT = 1;\r\n        const BACK = 2;\r\n        const SPANNING = 3;\r\n        // Classify each point as well as the entire polygon into one of the above\r\n        // four classes.\r\n        let polygonType = 0;\r\n        const types = [];\r\n        for (const vertex of polygon.vertices) {\r\n            const t = this.normal.dot(vertex.pos) - this.w;\r\n            const type = t < -Plane.EPSILON ? BACK : t > Plane.EPSILON ? FRONT : COPLANAR;\r\n            polygonType |= type;\r\n            types.push(type);\r\n        }\r\n        // Put the polygon in the correct list, splitting it when necessary.\r\n        switch (polygonType) {\r\n            case COPLANAR:\r\n                if (this.normal.dot(polygon.plane.normal) > 0)\r\n                    coplanarFront.push(polygon);\r\n                else\r\n                    coplanarBack.push(polygon);\r\n                break;\r\n            case FRONT:\r\n                front.push(polygon);\r\n                break;\r\n            case BACK:\r\n                back.push(polygon);\r\n                break;\r\n            case SPANNING:\r\n                const f = [];\r\n                const b = [];\r\n                for (let i = 0; i < polygon.vertices.length; i++) {\r\n                    const j = (i + 1) % polygon.vertices.length;\r\n                    const ti = types[i];\r\n                    const tj = types[j];\r\n                    const vi = polygon.vertices[i];\r\n                    const vj = polygon.vertices[j];\r\n                    if (ti !== BACK) {\r\n                        f.push(vi);\r\n                    }\r\n                    if (ti !== FRONT) {\r\n                        b.push(ti !== BACK ? vi.clone() : vi);\r\n                    }\r\n                    if ((ti | tj) === SPANNING) {\r\n                        const t = (this.w - this.normal.dot(vi.pos)) / this.normal.dot(vj.pos.minus(vi.pos));\r\n                        const v = vi.interpolate(vj, t);\r\n                        f.push(v);\r\n                        b.push(v.clone());\r\n                    }\r\n                }\r\n                if (f.length >= 3) {\r\n                    front.push(new Polygon(f, polygon.shared));\r\n                }\r\n                if (b.length >= 3) {\r\n                    back.push(new Polygon(b, polygon.shared));\r\n                }\r\n                break;\r\n        }\r\n    }\r\n}\r\n// the tolerance used by `splitPolygon()` to decide if a\r\n// point is on the plane.\r\nPlane.EPSILON = 1e-5;\r\n/**\r\n * Represents a convex polygon. The vertices used to initialize a polygon must\r\n * be coplanar and form a convex loop. They do not have to be `Vertex`\r\n * instances but they must behave similarly (duck typing can be used for\r\n * customization).\r\n *\r\n * Each convex polygon has a `shared` property, which is shared between all\r\n * polygons that are clones of each other or were split from the same polygon.\r\n * This can be used to define per-polygon properties (such as surface color).\r\n */\r\nclass Polygon {\r\n    constructor(vertices, shared = null) {\r\n        this.vertices = vertices;\r\n        this.shared = shared;\r\n        this.plane = Plane.fromPoints(vertices[0].pos, vertices[1].pos, vertices[2].pos);\r\n    }\r\n    clone() {\r\n        const vertices = this.vertices.map(v => {\r\n            return v.clone();\r\n        });\r\n        return new Polygon(vertices, this.shared);\r\n    }\r\n    flip() {\r\n        this.vertices.reverse().map(v => {\r\n            v.flip();\r\n        });\r\n        this.plane.flip();\r\n    }\r\n}\r\n/**\r\n * Holds a node in a BSP tree. A BSP tree is built from a collection of polygons\r\n * by picking a polygon to split along. That polygon (and all other coplanar\r\n * polygons) are added directly to that node and the other polygons are added to\r\n * the front and/or back subtrees. This is not a leafy BSP tree since there is\r\n * no distinction between internal and leaf nodes.\r\n */\r\nclass Node {\r\n    constructor(polygons) {\r\n        // @ts-ignore\r\n        delete this.plane;\r\n        // @ts-ignore\r\n        delete this.front;\r\n        // @ts-ignore\r\n        delete this.back;\r\n        this.polygons = [];\r\n        if (polygons) {\r\n            this.build(polygons);\r\n        }\r\n    }\r\n    clone() {\r\n        const node = new Node();\r\n        node.plane = this.plane && this.plane.clone();\r\n        node.front = this.front && this.front.clone();\r\n        node.back = this.back && this.back.clone();\r\n        node.polygons = this.polygons.map(p => {\r\n            return p.clone();\r\n        });\r\n        return node;\r\n    }\r\n    // Convert solid space to empty space and empty space to solid space.\r\n    invert() {\r\n        for (const polygon of this.polygons) {\r\n            polygon.flip();\r\n        }\r\n        this.plane.flip();\r\n        if (this.front) {\r\n            this.front.invert();\r\n        }\r\n        if (this.back) {\r\n            this.back.invert();\r\n        }\r\n        const temp = this.front;\r\n        this.front = this.back;\r\n        this.back = temp;\r\n    }\r\n    // Recursively remove all polygons in `polygons` that are inside this BSP\r\n    // tree.\r\n    clipPolygons(polygons) {\r\n        if (!this.plane) {\r\n            return polygons.slice();\r\n        }\r\n        let front = [];\r\n        let back = [];\r\n        for (const polygon of polygons) {\r\n            this.plane.splitPolygon(polygon, front, back, front, back);\r\n        }\r\n        if (this.front) {\r\n            front = this.front.clipPolygons(front);\r\n        }\r\n        back = this.back ? this.back.clipPolygons(back) : [];\r\n        return front.concat(back);\r\n    }\r\n    // Remove all polygons in this BSP tree that are inside the other BSP tree\r\n    // `bsp`.\r\n    clipTo(bsp) {\r\n        this.polygons = bsp.clipPolygons(this.polygons);\r\n        if (this.front) {\r\n            this.front.clipTo(bsp);\r\n        }\r\n        if (this.back) {\r\n            this.back.clipTo(bsp);\r\n        }\r\n    }\r\n    // Return a list of all polygons in this BSP tree.\r\n    allPolygons() {\r\n        let polygons = this.polygons.slice();\r\n        if (this.front) {\r\n            polygons = polygons.concat(this.front.allPolygons());\r\n        }\r\n        if (this.back) {\r\n            polygons = polygons.concat(this.back.allPolygons());\r\n        }\r\n        return polygons;\r\n    }\r\n    // Build a BSP tree out of `polygons`. When called on an existing tree, the\r\n    // new polygons are filtered down to the bottom of the tree and become new\r\n    // nodes there. Each set of polygons is partitioned using the first polygon\r\n    // (no heuristic is used to pick a good split).\r\n    build(polygons) {\r\n        if (!polygons.length) {\r\n            return;\r\n        }\r\n        if (!this.plane) {\r\n            this.plane = polygons[0].plane.clone();\r\n        }\r\n        const front = [];\r\n        const back = [];\r\n        for (const polygon of polygons) {\r\n            this.plane.splitPolygon(polygon, this.polygons, this.polygons, front, back);\r\n        }\r\n        if (front.length) {\r\n            if (!this.front) {\r\n                this.front = new Node();\r\n            }\r\n            this.front.build(front);\r\n        }\r\n        if (back.length) {\r\n            if (!this.back) {\r\n                this.back = new Node();\r\n            }\r\n            this.back.build(back);\r\n        }\r\n    }\r\n}\r\n//# sourceMappingURL=index.js.map","/*!\nfflate - fast JavaScript compression/decompression\n<https://101arrowz.github.io/fflate>\nLicensed under MIT. https://github.com/101arrowz/fflate/blob/master/LICENSE\nversion 0.6.9\n*/\n\n// DEFLATE is a complex format; to read this code, you should probably check the RFC first:\n// https://tools.ietf.org/html/rfc1951\n// You may also wish to take a look at the guide I made about this program:\n// https://gist.github.com/101arrowz/253f31eb5abc3d9275ab943003ffecad\n// Some of the following code is similar to that of UZIP.js:\n// https://github.com/photopea/UZIP.js\n// However, the vast majority of the codebase has diverged from UZIP.js to increase performance and reduce bundle size.\n// Sometimes 0 will appear where -1 would be more appropriate. This is because using a uint\n// is better for memory in most engines (I *think*).\nvar ch2 = {};\nvar durl = function (c) { return URL.createObjectURL(new Blob([c], { type: 'text/javascript' })); };\nvar cwk = function (u) { return new Worker(u); };\ntry {\n    URL.revokeObjectURL(durl(''));\n}\ncatch (e) {\n    // We're in Deno or a very old browser\n    durl = function (c) { return 'data:application/javascript;charset=UTF-8,' + encodeURI(c); };\n    // If Deno, this is necessary; if not, this changes nothing\n    cwk = function (u) { return new Worker(u, { type: 'module' }); };\n}\nvar wk = (function (c, id, msg, transfer, cb) {\n    var w = cwk(ch2[id] || (ch2[id] = durl(c)));\n    w.onerror = function (e) { return cb(e.error, null); };\n    w.onmessage = function (e) { return cb(null, e.data); };\n    w.postMessage(msg, transfer);\n    return w;\n});\n\n// aliases for shorter compressed code (most minifers don't do this)\nvar u8 = Uint8Array, u16 = Uint16Array, u32 = Uint32Array;\n// fixed length extra bits\nvar fleb = new u8([0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 2, 2, 2, 2, 3, 3, 3, 3, 4, 4, 4, 4, 5, 5, 5, 5, 0, /* unused */ 0, 0, /* impossible */ 0]);\n// fixed distance extra bits\n// see fleb note\nvar fdeb = new u8([0, 0, 0, 0, 1, 1, 2, 2, 3, 3, 4, 4, 5, 5, 6, 6, 7, 7, 8, 8, 9, 9, 10, 10, 11, 11, 12, 12, 13, 13, /* unused */ 0, 0]);\n// code length index map\nvar clim = new u8([16, 17, 18, 0, 8, 7, 9, 6, 10, 5, 11, 4, 12, 3, 13, 2, 14, 1, 15]);\n// get base, reverse index map from extra bits\nvar freb = function (eb, start) {\n    var b = new u16(31);\n    for (var i = 0; i < 31; ++i) {\n        b[i] = start += 1 << eb[i - 1];\n    }\n    // numbers here are at max 18 bits\n    var r = new u32(b[30]);\n    for (var i = 1; i < 30; ++i) {\n        for (var j = b[i]; j < b[i + 1]; ++j) {\n            r[j] = ((j - b[i]) << 5) | i;\n        }\n    }\n    return [b, r];\n};\nvar _a = freb(fleb, 2), fl = _a[0], revfl = _a[1];\n// we can ignore the fact that the other numbers are wrong; they never happen anyway\nfl[28] = 258, revfl[258] = 28;\nvar _b = freb(fdeb, 0), fd = _b[0], revfd = _b[1];\n// map of value to reverse (assuming 16 bits)\nvar rev = new u16(32768);\nfor (var i = 0; i < 32768; ++i) {\n    // reverse table algorithm from SO\n    var x = ((i & 0xAAAA) >>> 1) | ((i & 0x5555) << 1);\n    x = ((x & 0xCCCC) >>> 2) | ((x & 0x3333) << 2);\n    x = ((x & 0xF0F0) >>> 4) | ((x & 0x0F0F) << 4);\n    rev[i] = (((x & 0xFF00) >>> 8) | ((x & 0x00FF) << 8)) >>> 1;\n}\n// create huffman tree from u8 \"map\": index -> code length for code index\n// mb (max bits) must be at most 15\n// TODO: optimize/split up?\nvar hMap = (function (cd, mb, r) {\n    var s = cd.length;\n    // index\n    var i = 0;\n    // u16 \"map\": index -> # of codes with bit length = index\n    var l = new u16(mb);\n    // length of cd must be 288 (total # of codes)\n    for (; i < s; ++i)\n        ++l[cd[i] - 1];\n    // u16 \"map\": index -> minimum code for bit length = index\n    var le = new u16(mb);\n    for (i = 0; i < mb; ++i) {\n        le[i] = (le[i - 1] + l[i - 1]) << 1;\n    }\n    var co;\n    if (r) {\n        // u16 \"map\": index -> number of actual bits, symbol for code\n        co = new u16(1 << mb);\n        // bits to remove for reverser\n        var rvb = 15 - mb;\n        for (i = 0; i < s; ++i) {\n            // ignore 0 lengths\n            if (cd[i]) {\n                // num encoding both symbol and bits read\n                var sv = (i << 4) | cd[i];\n                // free bits\n                var r_1 = mb - cd[i];\n                // start value\n                var v = le[cd[i] - 1]++ << r_1;\n                // m is end value\n                for (var m = v | ((1 << r_1) - 1); v <= m; ++v) {\n                    // every 16 bit value starting with the code yields the same result\n                    co[rev[v] >>> rvb] = sv;\n                }\n            }\n        }\n    }\n    else {\n        co = new u16(s);\n        for (i = 0; i < s; ++i) {\n            if (cd[i]) {\n                co[i] = rev[le[cd[i] - 1]++] >>> (15 - cd[i]);\n            }\n        }\n    }\n    return co;\n});\n// fixed length tree\nvar flt = new u8(288);\nfor (var i = 0; i < 144; ++i)\n    flt[i] = 8;\nfor (var i = 144; i < 256; ++i)\n    flt[i] = 9;\nfor (var i = 256; i < 280; ++i)\n    flt[i] = 7;\nfor (var i = 280; i < 288; ++i)\n    flt[i] = 8;\n// fixed distance tree\nvar fdt = new u8(32);\nfor (var i = 0; i < 32; ++i)\n    fdt[i] = 5;\n// fixed length map\nvar flm = /*#__PURE__*/ hMap(flt, 9, 0), flrm = /*#__PURE__*/ hMap(flt, 9, 1);\n// fixed distance map\nvar fdm = /*#__PURE__*/ hMap(fdt, 5, 0), fdrm = /*#__PURE__*/ hMap(fdt, 5, 1);\n// find max of array\nvar max = function (a) {\n    var m = a[0];\n    for (var i = 1; i < a.length; ++i) {\n        if (a[i] > m)\n            m = a[i];\n    }\n    return m;\n};\n// read d, starting at bit p and mask with m\nvar bits = function (d, p, m) {\n    var o = (p / 8) | 0;\n    return ((d[o] | (d[o + 1] << 8)) >> (p & 7)) & m;\n};\n// read d, starting at bit p continuing for at least 16 bits\nvar bits16 = function (d, p) {\n    var o = (p / 8) | 0;\n    return ((d[o] | (d[o + 1] << 8) | (d[o + 2] << 16)) >> (p & 7));\n};\n// get end of byte\nvar shft = function (p) { return ((p / 8) | 0) + (p & 7 && 1); };\n// typed array slice - allows garbage collector to free original reference,\n// while being more compatible than .slice\nvar slc = function (v, s, e) {\n    if (s == null || s < 0)\n        s = 0;\n    if (e == null || e > v.length)\n        e = v.length;\n    // can't use .constructor in case user-supplied\n    var n = new (v instanceof u16 ? u16 : v instanceof u32 ? u32 : u8)(e - s);\n    n.set(v.subarray(s, e));\n    return n;\n};\n// expands raw DEFLATE data\nvar inflt = function (dat, buf, st) {\n    // source length\n    var sl = dat.length;\n    if (!sl || (st && !st.l && sl < 5))\n        return buf || new u8(0);\n    // have to estimate size\n    var noBuf = !buf || st;\n    // no state\n    var noSt = !st || st.i;\n    if (!st)\n        st = {};\n    // Assumes roughly 33% compression ratio average\n    if (!buf)\n        buf = new u8(sl * 3);\n    // ensure buffer can fit at least l elements\n    var cbuf = function (l) {\n        var bl = buf.length;\n        // need to increase size to fit\n        if (l > bl) {\n            // Double or set to necessary, whichever is greater\n            var nbuf = new u8(Math.max(bl * 2, l));\n            nbuf.set(buf);\n            buf = nbuf;\n        }\n    };\n    //  last chunk         bitpos           bytes\n    var final = st.f || 0, pos = st.p || 0, bt = st.b || 0, lm = st.l, dm = st.d, lbt = st.m, dbt = st.n;\n    // total bits\n    var tbts = sl * 8;\n    do {\n        if (!lm) {\n            // BFINAL - this is only 1 when last chunk is next\n            st.f = final = bits(dat, pos, 1);\n            // type: 0 = no compression, 1 = fixed huffman, 2 = dynamic huffman\n            var type = bits(dat, pos + 1, 3);\n            pos += 3;\n            if (!type) {\n                // go to end of byte boundary\n                var s = shft(pos) + 4, l = dat[s - 4] | (dat[s - 3] << 8), t = s + l;\n                if (t > sl) {\n                    if (noSt)\n                        throw 'unexpected EOF';\n                    break;\n                }\n                // ensure size\n                if (noBuf)\n                    cbuf(bt + l);\n                // Copy over uncompressed data\n                buf.set(dat.subarray(s, t), bt);\n                // Get new bitpos, update byte count\n                st.b = bt += l, st.p = pos = t * 8;\n                continue;\n            }\n            else if (type == 1)\n                lm = flrm, dm = fdrm, lbt = 9, dbt = 5;\n            else if (type == 2) {\n                //  literal                            lengths\n                var hLit = bits(dat, pos, 31) + 257, hcLen = bits(dat, pos + 10, 15) + 4;\n                var tl = hLit + bits(dat, pos + 5, 31) + 1;\n                pos += 14;\n                // length+distance tree\n                var ldt = new u8(tl);\n                // code length tree\n                var clt = new u8(19);\n                for (var i = 0; i < hcLen; ++i) {\n                    // use index map to get real code\n                    clt[clim[i]] = bits(dat, pos + i * 3, 7);\n                }\n                pos += hcLen * 3;\n                // code lengths bits\n                var clb = max(clt), clbmsk = (1 << clb) - 1;\n                // code lengths map\n                var clm = hMap(clt, clb, 1);\n                for (var i = 0; i < tl;) {\n                    var r = clm[bits(dat, pos, clbmsk)];\n                    // bits read\n                    pos += r & 15;\n                    // symbol\n                    var s = r >>> 4;\n                    // code length to copy\n                    if (s < 16) {\n                        ldt[i++] = s;\n                    }\n                    else {\n                        //  copy   count\n                        var c = 0, n = 0;\n                        if (s == 16)\n                            n = 3 + bits(dat, pos, 3), pos += 2, c = ldt[i - 1];\n                        else if (s == 17)\n                            n = 3 + bits(dat, pos, 7), pos += 3;\n                        else if (s == 18)\n                            n = 11 + bits(dat, pos, 127), pos += 7;\n                        while (n--)\n                            ldt[i++] = c;\n                    }\n                }\n                //    length tree                 distance tree\n                var lt = ldt.subarray(0, hLit), dt = ldt.subarray(hLit);\n                // max length bits\n                lbt = max(lt);\n                // max dist bits\n                dbt = max(dt);\n                lm = hMap(lt, lbt, 1);\n                dm = hMap(dt, dbt, 1);\n            }\n            else\n                throw 'invalid block type';\n            if (pos > tbts) {\n                if (noSt)\n                    throw 'unexpected EOF';\n                break;\n            }\n        }\n        // Make sure the buffer can hold this + the largest possible addition\n        // Maximum chunk size (practically, theoretically infinite) is 2^17;\n        if (noBuf)\n            cbuf(bt + 131072);\n        var lms = (1 << lbt) - 1, dms = (1 << dbt) - 1;\n        var lpos = pos;\n        for (;; lpos = pos) {\n            // bits read, code\n            var c = lm[bits16(dat, pos) & lms], sym = c >>> 4;\n            pos += c & 15;\n            if (pos > tbts) {\n                if (noSt)\n                    throw 'unexpected EOF';\n                break;\n            }\n            if (!c)\n                throw 'invalid length/literal';\n            if (sym < 256)\n                buf[bt++] = sym;\n            else if (sym == 256) {\n                lpos = pos, lm = null;\n                break;\n            }\n            else {\n                var add = sym - 254;\n                // no extra bits needed if less\n                if (sym > 264) {\n                    // index\n                    var i = sym - 257, b = fleb[i];\n                    add = bits(dat, pos, (1 << b) - 1) + fl[i];\n                    pos += b;\n                }\n                // dist\n                var d = dm[bits16(dat, pos) & dms], dsym = d >>> 4;\n                if (!d)\n                    throw 'invalid distance';\n                pos += d & 15;\n                var dt = fd[dsym];\n                if (dsym > 3) {\n                    var b = fdeb[dsym];\n                    dt += bits16(dat, pos) & ((1 << b) - 1), pos += b;\n                }\n                if (pos > tbts) {\n                    if (noSt)\n                        throw 'unexpected EOF';\n                    break;\n                }\n                if (noBuf)\n                    cbuf(bt + 131072);\n                var end = bt + add;\n                for (; bt < end; bt += 4) {\n                    buf[bt] = buf[bt - dt];\n                    buf[bt + 1] = buf[bt + 1 - dt];\n                    buf[bt + 2] = buf[bt + 2 - dt];\n                    buf[bt + 3] = buf[bt + 3 - dt];\n                }\n                bt = end;\n            }\n        }\n        st.l = lm, st.p = lpos, st.b = bt;\n        if (lm)\n            final = 1, st.m = lbt, st.d = dm, st.n = dbt;\n    } while (!final);\n    return bt == buf.length ? buf : slc(buf, 0, bt);\n};\n// starting at p, write the minimum number of bits that can hold v to d\nvar wbits = function (d, p, v) {\n    v <<= p & 7;\n    var o = (p / 8) | 0;\n    d[o] |= v;\n    d[o + 1] |= v >>> 8;\n};\n// starting at p, write the minimum number of bits (>8) that can hold v to d\nvar wbits16 = function (d, p, v) {\n    v <<= p & 7;\n    var o = (p / 8) | 0;\n    d[o] |= v;\n    d[o + 1] |= v >>> 8;\n    d[o + 2] |= v >>> 16;\n};\n// creates code lengths from a frequency table\nvar hTree = function (d, mb) {\n    // Need extra info to make a tree\n    var t = [];\n    for (var i = 0; i < d.length; ++i) {\n        if (d[i])\n            t.push({ s: i, f: d[i] });\n    }\n    var s = t.length;\n    var t2 = t.slice();\n    if (!s)\n        return [et, 0];\n    if (s == 1) {\n        var v = new u8(t[0].s + 1);\n        v[t[0].s] = 1;\n        return [v, 1];\n    }\n    t.sort(function (a, b) { return a.f - b.f; });\n    // after i2 reaches last ind, will be stopped\n    // freq must be greater than largest possible number of symbols\n    t.push({ s: -1, f: 25001 });\n    var l = t[0], r = t[1], i0 = 0, i1 = 1, i2 = 2;\n    t[0] = { s: -1, f: l.f + r.f, l: l, r: r };\n    // efficient algorithm from UZIP.js\n    // i0 is lookbehind, i2 is lookahead - after processing two low-freq\n    // symbols that combined have high freq, will start processing i2 (high-freq,\n    // non-composite) symbols instead\n    // see https://reddit.com/r/photopea/comments/ikekht/uzipjs_questions/\n    while (i1 != s - 1) {\n        l = t[t[i0].f < t[i2].f ? i0++ : i2++];\n        r = t[i0 != i1 && t[i0].f < t[i2].f ? i0++ : i2++];\n        t[i1++] = { s: -1, f: l.f + r.f, l: l, r: r };\n    }\n    var maxSym = t2[0].s;\n    for (var i = 1; i < s; ++i) {\n        if (t2[i].s > maxSym)\n            maxSym = t2[i].s;\n    }\n    // code lengths\n    var tr = new u16(maxSym + 1);\n    // max bits in tree\n    var mbt = ln(t[i1 - 1], tr, 0);\n    if (mbt > mb) {\n        // more algorithms from UZIP.js\n        // TODO: find out how this code works (debt)\n        //  ind    debt\n        var i = 0, dt = 0;\n        //    left            cost\n        var lft = mbt - mb, cst = 1 << lft;\n        t2.sort(function (a, b) { return tr[b.s] - tr[a.s] || a.f - b.f; });\n        for (; i < s; ++i) {\n            var i2_1 = t2[i].s;\n            if (tr[i2_1] > mb) {\n                dt += cst - (1 << (mbt - tr[i2_1]));\n                tr[i2_1] = mb;\n            }\n            else\n                break;\n        }\n        dt >>>= lft;\n        while (dt > 0) {\n            var i2_2 = t2[i].s;\n            if (tr[i2_2] < mb)\n                dt -= 1 << (mb - tr[i2_2]++ - 1);\n            else\n                ++i;\n        }\n        for (; i >= 0 && dt; --i) {\n            var i2_3 = t2[i].s;\n            if (tr[i2_3] == mb) {\n                --tr[i2_3];\n                ++dt;\n            }\n        }\n        mbt = mb;\n    }\n    return [new u8(tr), mbt];\n};\n// get the max length and assign length codes\nvar ln = function (n, l, d) {\n    return n.s == -1\n        ? Math.max(ln(n.l, l, d + 1), ln(n.r, l, d + 1))\n        : (l[n.s] = d);\n};\n// length codes generation\nvar lc = function (c) {\n    var s = c.length;\n    // Note that the semicolon was intentional\n    while (s && !c[--s])\n        ;\n    var cl = new u16(++s);\n    //  ind      num         streak\n    var cli = 0, cln = c[0], cls = 1;\n    var w = function (v) { cl[cli++] = v; };\n    for (var i = 1; i <= s; ++i) {\n        if (c[i] == cln && i != s)\n            ++cls;\n        else {\n            if (!cln && cls > 2) {\n                for (; cls > 138; cls -= 138)\n                    w(32754);\n                if (cls > 2) {\n                    w(cls > 10 ? ((cls - 11) << 5) | 28690 : ((cls - 3) << 5) | 12305);\n                    cls = 0;\n                }\n            }\n            else if (cls > 3) {\n                w(cln), --cls;\n                for (; cls > 6; cls -= 6)\n                    w(8304);\n                if (cls > 2)\n                    w(((cls - 3) << 5) | 8208), cls = 0;\n            }\n            while (cls--)\n                w(cln);\n            cls = 1;\n            cln = c[i];\n        }\n    }\n    return [cl.subarray(0, cli), s];\n};\n// calculate the length of output from tree, code lengths\nvar clen = function (cf, cl) {\n    var l = 0;\n    for (var i = 0; i < cl.length; ++i)\n        l += cf[i] * cl[i];\n    return l;\n};\n// writes a fixed block\n// returns the new bit pos\nvar wfblk = function (out, pos, dat) {\n    // no need to write 00 as type: TypedArray defaults to 0\n    var s = dat.length;\n    var o = shft(pos + 2);\n    out[o] = s & 255;\n    out[o + 1] = s >>> 8;\n    out[o + 2] = out[o] ^ 255;\n    out[o + 3] = out[o + 1] ^ 255;\n    for (var i = 0; i < s; ++i)\n        out[o + i + 4] = dat[i];\n    return (o + 4 + s) * 8;\n};\n// writes a block\nvar wblk = function (dat, out, final, syms, lf, df, eb, li, bs, bl, p) {\n    wbits(out, p++, final);\n    ++lf[256];\n    var _a = hTree(lf, 15), dlt = _a[0], mlb = _a[1];\n    var _b = hTree(df, 15), ddt = _b[0], mdb = _b[1];\n    var _c = lc(dlt), lclt = _c[0], nlc = _c[1];\n    var _d = lc(ddt), lcdt = _d[0], ndc = _d[1];\n    var lcfreq = new u16(19);\n    for (var i = 0; i < lclt.length; ++i)\n        lcfreq[lclt[i] & 31]++;\n    for (var i = 0; i < lcdt.length; ++i)\n        lcfreq[lcdt[i] & 31]++;\n    var _e = hTree(lcfreq, 7), lct = _e[0], mlcb = _e[1];\n    var nlcc = 19;\n    for (; nlcc > 4 && !lct[clim[nlcc - 1]]; --nlcc)\n        ;\n    var flen = (bl + 5) << 3;\n    var ftlen = clen(lf, flt) + clen(df, fdt) + eb;\n    var dtlen = clen(lf, dlt) + clen(df, ddt) + eb + 14 + 3 * nlcc + clen(lcfreq, lct) + (2 * lcfreq[16] + 3 * lcfreq[17] + 7 * lcfreq[18]);\n    if (flen <= ftlen && flen <= dtlen)\n        return wfblk(out, p, dat.subarray(bs, bs + bl));\n    var lm, ll, dm, dl;\n    wbits(out, p, 1 + (dtlen < ftlen)), p += 2;\n    if (dtlen < ftlen) {\n        lm = hMap(dlt, mlb, 0), ll = dlt, dm = hMap(ddt, mdb, 0), dl = ddt;\n        var llm = hMap(lct, mlcb, 0);\n        wbits(out, p, nlc - 257);\n        wbits(out, p + 5, ndc - 1);\n        wbits(out, p + 10, nlcc - 4);\n        p += 14;\n        for (var i = 0; i < nlcc; ++i)\n            wbits(out, p + 3 * i, lct[clim[i]]);\n        p += 3 * nlcc;\n        var lcts = [lclt, lcdt];\n        for (var it = 0; it < 2; ++it) {\n            var clct = lcts[it];\n            for (var i = 0; i < clct.length; ++i) {\n                var len = clct[i] & 31;\n                wbits(out, p, llm[len]), p += lct[len];\n                if (len > 15)\n                    wbits(out, p, (clct[i] >>> 5) & 127), p += clct[i] >>> 12;\n            }\n        }\n    }\n    else {\n        lm = flm, ll = flt, dm = fdm, dl = fdt;\n    }\n    for (var i = 0; i < li; ++i) {\n        if (syms[i] > 255) {\n            var len = (syms[i] >>> 18) & 31;\n            wbits16(out, p, lm[len + 257]), p += ll[len + 257];\n            if (len > 7)\n                wbits(out, p, (syms[i] >>> 23) & 31), p += fleb[len];\n            var dst = syms[i] & 31;\n            wbits16(out, p, dm[dst]), p += dl[dst];\n            if (dst > 3)\n                wbits16(out, p, (syms[i] >>> 5) & 8191), p += fdeb[dst];\n        }\n        else {\n            wbits16(out, p, lm[syms[i]]), p += ll[syms[i]];\n        }\n    }\n    wbits16(out, p, lm[256]);\n    return p + ll[256];\n};\n// deflate options (nice << 13) | chain\nvar deo = /*#__PURE__*/ new u32([65540, 131080, 131088, 131104, 262176, 1048704, 1048832, 2114560, 2117632]);\n// empty\nvar et = /*#__PURE__*/ new u8(0);\n// compresses data into a raw DEFLATE buffer\nvar dflt = function (dat, lvl, plvl, pre, post, lst) {\n    var s = dat.length;\n    var o = new u8(pre + s + 5 * (1 + Math.ceil(s / 7000)) + post);\n    // writing to this writes to the output buffer\n    var w = o.subarray(pre, o.length - post);\n    var pos = 0;\n    if (!lvl || s < 8) {\n        for (var i = 0; i <= s; i += 65535) {\n            // end\n            var e = i + 65535;\n            if (e < s) {\n                // write full block\n                pos = wfblk(w, pos, dat.subarray(i, e));\n            }\n            else {\n                // write final block\n                w[i] = lst;\n                pos = wfblk(w, pos, dat.subarray(i, s));\n            }\n        }\n    }\n    else {\n        var opt = deo[lvl - 1];\n        var n = opt >>> 13, c = opt & 8191;\n        var msk_1 = (1 << plvl) - 1;\n        //    prev 2-byte val map    curr 2-byte val map\n        var prev = new u16(32768), head = new u16(msk_1 + 1);\n        var bs1_1 = Math.ceil(plvl / 3), bs2_1 = 2 * bs1_1;\n        var hsh = function (i) { return (dat[i] ^ (dat[i + 1] << bs1_1) ^ (dat[i + 2] << bs2_1)) & msk_1; };\n        // 24576 is an arbitrary number of maximum symbols per block\n        // 424 buffer for last block\n        var syms = new u32(25000);\n        // length/literal freq   distance freq\n        var lf = new u16(288), df = new u16(32);\n        //  l/lcnt  exbits  index  l/lind  waitdx  bitpos\n        var lc_1 = 0, eb = 0, i = 0, li = 0, wi = 0, bs = 0;\n        for (; i < s; ++i) {\n            // hash value\n            // deopt when i > s - 3 - at end, deopt acceptable\n            var hv = hsh(i);\n            // index mod 32768    previous index mod\n            var imod = i & 32767, pimod = head[hv];\n            prev[imod] = pimod;\n            head[hv] = imod;\n            // We always should modify head and prev, but only add symbols if\n            // this data is not yet processed (\"wait\" for wait index)\n            if (wi <= i) {\n                // bytes remaining\n                var rem = s - i;\n                if ((lc_1 > 7000 || li > 24576) && rem > 423) {\n                    pos = wblk(dat, w, 0, syms, lf, df, eb, li, bs, i - bs, pos);\n                    li = lc_1 = eb = 0, bs = i;\n                    for (var j = 0; j < 286; ++j)\n                        lf[j] = 0;\n                    for (var j = 0; j < 30; ++j)\n                        df[j] = 0;\n                }\n                //  len    dist   chain\n                var l = 2, d = 0, ch_1 = c, dif = (imod - pimod) & 32767;\n                if (rem > 2 && hv == hsh(i - dif)) {\n                    var maxn = Math.min(n, rem) - 1;\n                    var maxd = Math.min(32767, i);\n                    // max possible length\n                    // not capped at dif because decompressors implement \"rolling\" index population\n                    var ml = Math.min(258, rem);\n                    while (dif <= maxd && --ch_1 && imod != pimod) {\n                        if (dat[i + l] == dat[i + l - dif]) {\n                            var nl = 0;\n                            for (; nl < ml && dat[i + nl] == dat[i + nl - dif]; ++nl)\n                                ;\n                            if (nl > l) {\n                                l = nl, d = dif;\n                                // break out early when we reach \"nice\" (we are satisfied enough)\n                                if (nl > maxn)\n                                    break;\n                                // now, find the rarest 2-byte sequence within this\n                                // length of literals and search for that instead.\n                                // Much faster than just using the start\n                                var mmd = Math.min(dif, nl - 2);\n                                var md = 0;\n                                for (var j = 0; j < mmd; ++j) {\n                                    var ti = (i - dif + j + 32768) & 32767;\n                                    var pti = prev[ti];\n                                    var cd = (ti - pti + 32768) & 32767;\n                                    if (cd > md)\n                                        md = cd, pimod = ti;\n                                }\n                            }\n                        }\n                        // check the previous match\n                        imod = pimod, pimod = prev[imod];\n                        dif += (imod - pimod + 32768) & 32767;\n                    }\n                }\n                // d will be nonzero only when a match was found\n                if (d) {\n                    // store both dist and len data in one Uint32\n                    // Make sure this is recognized as a len/dist with 28th bit (2^28)\n                    syms[li++] = 268435456 | (revfl[l] << 18) | revfd[d];\n                    var lin = revfl[l] & 31, din = revfd[d] & 31;\n                    eb += fleb[lin] + fdeb[din];\n                    ++lf[257 + lin];\n                    ++df[din];\n                    wi = i + l;\n                    ++lc_1;\n                }\n                else {\n                    syms[li++] = dat[i];\n                    ++lf[dat[i]];\n                }\n            }\n        }\n        pos = wblk(dat, w, lst, syms, lf, df, eb, li, bs, i - bs, pos);\n        // this is the easiest way to avoid needing to maintain state\n        if (!lst && pos & 7)\n            pos = wfblk(w, pos + 1, et);\n    }\n    return slc(o, 0, pre + shft(pos) + post);\n};\n// CRC32 table\nvar crct = /*#__PURE__*/ (function () {\n    var t = new u32(256);\n    for (var i = 0; i < 256; ++i) {\n        var c = i, k = 9;\n        while (--k)\n            c = ((c & 1) && 0xEDB88320) ^ (c >>> 1);\n        t[i] = c;\n    }\n    return t;\n})();\n// CRC32\nvar crc = function () {\n    var c = -1;\n    return {\n        p: function (d) {\n            // closures have awful performance\n            var cr = c;\n            for (var i = 0; i < d.length; ++i)\n                cr = crct[(cr & 255) ^ d[i]] ^ (cr >>> 8);\n            c = cr;\n        },\n        d: function () { return ~c; }\n    };\n};\n// Alder32\nvar adler = function () {\n    var a = 1, b = 0;\n    return {\n        p: function (d) {\n            // closures have awful performance\n            var n = a, m = b;\n            var l = d.length;\n            for (var i = 0; i != l;) {\n                var e = Math.min(i + 2655, l);\n                for (; i < e; ++i)\n                    m += n += d[i];\n                n = (n & 65535) + 15 * (n >> 16), m = (m & 65535) + 15 * (m >> 16);\n            }\n            a = n, b = m;\n        },\n        d: function () {\n            a %= 65521, b %= 65521;\n            return (a & 255) << 24 | (a >>> 8) << 16 | (b & 255) << 8 | (b >>> 8);\n        }\n    };\n};\n;\n// deflate with opts\nvar dopt = function (dat, opt, pre, post, st) {\n    return dflt(dat, opt.level == null ? 6 : opt.level, opt.mem == null ? Math.ceil(Math.max(8, Math.min(13, Math.log(dat.length))) * 1.5) : (12 + opt.mem), pre, post, !st);\n};\n// Walmart object spread\nvar mrg = function (a, b) {\n    var o = {};\n    for (var k in a)\n        o[k] = a[k];\n    for (var k in b)\n        o[k] = b[k];\n    return o;\n};\n// worker clone\n// This is possibly the craziest part of the entire codebase, despite how simple it may seem.\n// The only parameter to this function is a closure that returns an array of variables outside of the function scope.\n// We're going to try to figure out the variable names used in the closure as strings because that is crucial for workerization.\n// We will return an object mapping of true variable name to value (basically, the current scope as a JS object).\n// The reason we can't just use the original variable names is minifiers mangling the toplevel scope.\n// This took me three weeks to figure out how to do.\nvar wcln = function (fn, fnStr, td) {\n    var dt = fn();\n    var st = fn.toString();\n    var ks = st.slice(st.indexOf('[') + 1, st.lastIndexOf(']')).replace(/ /g, '').split(',');\n    for (var i = 0; i < dt.length; ++i) {\n        var v = dt[i], k = ks[i];\n        if (typeof v == 'function') {\n            fnStr += ';' + k + '=';\n            var st_1 = v.toString();\n            if (v.prototype) {\n                // for global objects\n                if (st_1.indexOf('[native code]') != -1) {\n                    var spInd = st_1.indexOf(' ', 8) + 1;\n                    fnStr += st_1.slice(spInd, st_1.indexOf('(', spInd));\n                }\n                else {\n                    fnStr += st_1;\n                    for (var t in v.prototype)\n                        fnStr += ';' + k + '.prototype.' + t + '=' + v.prototype[t].toString();\n                }\n            }\n            else\n                fnStr += st_1;\n        }\n        else\n            td[k] = v;\n    }\n    return [fnStr, td];\n};\nvar ch = [];\n// clone bufs\nvar cbfs = function (v) {\n    var tl = [];\n    for (var k in v) {\n        if (v[k] instanceof u8 || v[k] instanceof u16 || v[k] instanceof u32)\n            tl.push((v[k] = new v[k].constructor(v[k])).buffer);\n    }\n    return tl;\n};\n// use a worker to execute code\nvar wrkr = function (fns, init, id, cb) {\n    var _a;\n    if (!ch[id]) {\n        var fnStr = '', td_1 = {}, m = fns.length - 1;\n        for (var i = 0; i < m; ++i)\n            _a = wcln(fns[i], fnStr, td_1), fnStr = _a[0], td_1 = _a[1];\n        ch[id] = wcln(fns[m], fnStr, td_1);\n    }\n    var td = mrg({}, ch[id][1]);\n    return wk(ch[id][0] + ';onmessage=function(e){for(var k in e.data)self[k]=e.data[k];onmessage=' + init.toString() + '}', id, td, cbfs(td), cb);\n};\n// base async inflate fn\nvar bInflt = function () { return [u8, u16, u32, fleb, fdeb, clim, fl, fd, flrm, fdrm, rev, hMap, max, bits, bits16, shft, slc, inflt, inflateSync, pbf, gu8]; };\nvar bDflt = function () { return [u8, u16, u32, fleb, fdeb, clim, revfl, revfd, flm, flt, fdm, fdt, rev, deo, et, hMap, wbits, wbits16, hTree, ln, lc, clen, wfblk, wblk, shft, slc, dflt, dopt, deflateSync, pbf]; };\n// gzip extra\nvar gze = function () { return [gzh, gzhl, wbytes, crc, crct]; };\n// gunzip extra\nvar guze = function () { return [gzs, gzl]; };\n// zlib extra\nvar zle = function () { return [zlh, wbytes, adler]; };\n// unzlib extra\nvar zule = function () { return [zlv]; };\n// post buf\nvar pbf = function (msg) { return postMessage(msg, [msg.buffer]); };\n// get u8\nvar gu8 = function (o) { return o && o.size && new u8(o.size); };\n// async helper\nvar cbify = function (dat, opts, fns, init, id, cb) {\n    var w = wrkr(fns, init, id, function (err, dat) {\n        w.terminate();\n        cb(err, dat);\n    });\n    w.postMessage([dat, opts], opts.consume ? [dat.buffer] : []);\n    return function () { w.terminate(); };\n};\n// auto stream\nvar astrm = function (strm) {\n    strm.ondata = function (dat, final) { return postMessage([dat, final], [dat.buffer]); };\n    return function (ev) { return strm.push(ev.data[0], ev.data[1]); };\n};\n// async stream attach\nvar astrmify = function (fns, strm, opts, init, id) {\n    var t;\n    var w = wrkr(fns, init, id, function (err, dat) {\n        if (err)\n            w.terminate(), strm.ondata.call(strm, err);\n        else {\n            if (dat[1])\n                w.terminate();\n            strm.ondata.call(strm, err, dat[0], dat[1]);\n        }\n    });\n    w.postMessage(opts);\n    strm.push = function (d, f) {\n        if (t)\n            throw 'stream finished';\n        if (!strm.ondata)\n            throw 'no stream handler';\n        w.postMessage([d, t = f], [d.buffer]);\n    };\n    strm.terminate = function () { w.terminate(); };\n};\n// read 2 bytes\nvar b2 = function (d, b) { return d[b] | (d[b + 1] << 8); };\n// read 4 bytes\nvar b4 = function (d, b) { return (d[b] | (d[b + 1] << 8) | (d[b + 2] << 16) | (d[b + 3] << 24)) >>> 0; };\nvar b8 = function (d, b) { return b4(d, b) + (b4(d, b + 4) * 4294967296); };\n// write bytes\nvar wbytes = function (d, b, v) {\n    for (; v; ++b)\n        d[b] = v, v >>>= 8;\n};\n// gzip header\nvar gzh = function (c, o) {\n    var fn = o.filename;\n    c[0] = 31, c[1] = 139, c[2] = 8, c[8] = o.level < 2 ? 4 : o.level == 9 ? 2 : 0, c[9] = 3; // assume Unix\n    if (o.mtime != 0)\n        wbytes(c, 4, Math.floor(new Date(o.mtime || Date.now()) / 1000));\n    if (fn) {\n        c[3] = 8;\n        for (var i = 0; i <= fn.length; ++i)\n            c[i + 10] = fn.charCodeAt(i);\n    }\n};\n// gzip footer: -8 to -4 = CRC, -4 to -0 is length\n// gzip start\nvar gzs = function (d) {\n    if (d[0] != 31 || d[1] != 139 || d[2] != 8)\n        throw 'invalid gzip data';\n    var flg = d[3];\n    var st = 10;\n    if (flg & 4)\n        st += d[10] | (d[11] << 8) + 2;\n    for (var zs = (flg >> 3 & 1) + (flg >> 4 & 1); zs > 0; zs -= !d[st++])\n        ;\n    return st + (flg & 2);\n};\n// gzip length\nvar gzl = function (d) {\n    var l = d.length;\n    return ((d[l - 4] | d[l - 3] << 8 | d[l - 2] << 16) | (d[l - 1] << 24)) >>> 0;\n};\n// gzip header length\nvar gzhl = function (o) { return 10 + ((o.filename && (o.filename.length + 1)) || 0); };\n// zlib header\nvar zlh = function (c, o) {\n    var lv = o.level, fl = lv == 0 ? 0 : lv < 6 ? 1 : lv == 9 ? 3 : 2;\n    c[0] = 120, c[1] = (fl << 6) | (fl ? (32 - 2 * fl) : 1);\n};\n// zlib valid\nvar zlv = function (d) {\n    if ((d[0] & 15) != 8 || (d[0] >>> 4) > 7 || ((d[0] << 8 | d[1]) % 31))\n        throw 'invalid zlib data';\n    if (d[1] & 32)\n        throw 'invalid zlib data: preset dictionaries not supported';\n};\nfunction AsyncCmpStrm(opts, cb) {\n    if (!cb && typeof opts == 'function')\n        cb = opts, opts = {};\n    this.ondata = cb;\n    return opts;\n}\n// zlib footer: -4 to -0 is Adler32\n/**\n * Streaming DEFLATE compression\n */\nvar Deflate = /*#__PURE__*/ (function () {\n    function Deflate(opts, cb) {\n        if (!cb && typeof opts == 'function')\n            cb = opts, opts = {};\n        this.ondata = cb;\n        this.o = opts || {};\n    }\n    Deflate.prototype.p = function (c, f) {\n        this.ondata(dopt(c, this.o, 0, 0, !f), f);\n    };\n    /**\n     * Pushes a chunk to be deflated\n     * @param chunk The chunk to push\n     * @param final Whether this is the last chunk\n     */\n    Deflate.prototype.push = function (chunk, final) {\n        if (this.d)\n            throw 'stream finished';\n        if (!this.ondata)\n            throw 'no stream handler';\n        this.d = final;\n        this.p(chunk, final || false);\n    };\n    return Deflate;\n}());\nexport { Deflate };\n/**\n * Asynchronous streaming DEFLATE compression\n */\nvar AsyncDeflate = /*#__PURE__*/ (function () {\n    function AsyncDeflate(opts, cb) {\n        astrmify([\n            bDflt,\n            function () { return [astrm, Deflate]; }\n        ], this, AsyncCmpStrm.call(this, opts, cb), function (ev) {\n            var strm = new Deflate(ev.data);\n            onmessage = astrm(strm);\n        }, 6);\n    }\n    return AsyncDeflate;\n}());\nexport { AsyncDeflate };\nexport function deflate(data, opts, cb) {\n    if (!cb)\n        cb = opts, opts = {};\n    if (typeof cb != 'function')\n        throw 'no callback';\n    return cbify(data, opts, [\n        bDflt,\n    ], function (ev) { return pbf(deflateSync(ev.data[0], ev.data[1])); }, 0, cb);\n}\n/**\n * Compresses data with DEFLATE without any wrapper\n * @param data The data to compress\n * @param opts The compression options\n * @returns The deflated version of the data\n */\nexport function deflateSync(data, opts) {\n    return dopt(data, opts || {}, 0, 0);\n}\n/**\n * Streaming DEFLATE decompression\n */\nvar Inflate = /*#__PURE__*/ (function () {\n    /**\n     * Creates an inflation stream\n     * @param cb The callback to call whenever data is inflated\n     */\n    function Inflate(cb) {\n        this.s = {};\n        this.p = new u8(0);\n        this.ondata = cb;\n    }\n    Inflate.prototype.e = function (c) {\n        if (this.d)\n            throw 'stream finished';\n        if (!this.ondata)\n            throw 'no stream handler';\n        var l = this.p.length;\n        var n = new u8(l + c.length);\n        n.set(this.p), n.set(c, l), this.p = n;\n    };\n    Inflate.prototype.c = function (final) {\n        this.d = this.s.i = final || false;\n        var bts = this.s.b;\n        var dt = inflt(this.p, this.o, this.s);\n        this.ondata(slc(dt, bts, this.s.b), this.d);\n        this.o = slc(dt, this.s.b - 32768), this.s.b = this.o.length;\n        this.p = slc(this.p, (this.s.p / 8) | 0), this.s.p &= 7;\n    };\n    /**\n     * Pushes a chunk to be inflated\n     * @param chunk The chunk to push\n     * @param final Whether this is the final chunk\n     */\n    Inflate.prototype.push = function (chunk, final) {\n        this.e(chunk), this.c(final);\n    };\n    return Inflate;\n}());\nexport { Inflate };\n/**\n * Asynchronous streaming DEFLATE decompression\n */\nvar AsyncInflate = /*#__PURE__*/ (function () {\n    /**\n     * Creates an asynchronous inflation stream\n     * @param cb The callback to call whenever data is deflated\n     */\n    function AsyncInflate(cb) {\n        this.ondata = cb;\n        astrmify([\n            bInflt,\n            function () { return [astrm, Inflate]; }\n        ], this, 0, function () {\n            var strm = new Inflate();\n            onmessage = astrm(strm);\n        }, 7);\n    }\n    return AsyncInflate;\n}());\nexport { AsyncInflate };\nexport function inflate(data, opts, cb) {\n    if (!cb)\n        cb = opts, opts = {};\n    if (typeof cb != 'function')\n        throw 'no callback';\n    return cbify(data, opts, [\n        bInflt\n    ], function (ev) { return pbf(inflateSync(ev.data[0], gu8(ev.data[1]))); }, 1, cb);\n}\n/**\n * Expands DEFLATE data with no wrapper\n * @param data The data to decompress\n * @param out Where to write the data. Saves memory if you know the decompressed size and provide an output buffer of that length.\n * @returns The decompressed version of the data\n */\nexport function inflateSync(data, out) {\n    return inflt(data, out);\n}\n// before you yell at me for not just using extends, my reason is that TS inheritance is hard to workerize.\n/**\n * Streaming GZIP compression\n */\nvar Gzip = /*#__PURE__*/ (function () {\n    function Gzip(opts, cb) {\n        this.c = crc();\n        this.l = 0;\n        this.v = 1;\n        Deflate.call(this, opts, cb);\n    }\n    /**\n     * Pushes a chunk to be GZIPped\n     * @param chunk The chunk to push\n     * @param final Whether this is the last chunk\n     */\n    Gzip.prototype.push = function (chunk, final) {\n        Deflate.prototype.push.call(this, chunk, final);\n    };\n    Gzip.prototype.p = function (c, f) {\n        this.c.p(c);\n        this.l += c.length;\n        var raw = dopt(c, this.o, this.v && gzhl(this.o), f && 8, !f);\n        if (this.v)\n            gzh(raw, this.o), this.v = 0;\n        if (f)\n            wbytes(raw, raw.length - 8, this.c.d()), wbytes(raw, raw.length - 4, this.l);\n        this.ondata(raw, f);\n    };\n    return Gzip;\n}());\nexport { Gzip };\n/**\n * Asynchronous streaming GZIP compression\n */\nvar AsyncGzip = /*#__PURE__*/ (function () {\n    function AsyncGzip(opts, cb) {\n        astrmify([\n            bDflt,\n            gze,\n            function () { return [astrm, Deflate, Gzip]; }\n        ], this, AsyncCmpStrm.call(this, opts, cb), function (ev) {\n            var strm = new Gzip(ev.data);\n            onmessage = astrm(strm);\n        }, 8);\n    }\n    return AsyncGzip;\n}());\nexport { AsyncGzip };\nexport function gzip(data, opts, cb) {\n    if (!cb)\n        cb = opts, opts = {};\n    if (typeof cb != 'function')\n        throw 'no callback';\n    return cbify(data, opts, [\n        bDflt,\n        gze,\n        function () { return [gzipSync]; }\n    ], function (ev) { return pbf(gzipSync(ev.data[0], ev.data[1])); }, 2, cb);\n}\n/**\n * Compresses data with GZIP\n * @param data The data to compress\n * @param opts The compression options\n * @returns The gzipped version of the data\n */\nexport function gzipSync(data, opts) {\n    if (!opts)\n        opts = {};\n    var c = crc(), l = data.length;\n    c.p(data);\n    var d = dopt(data, opts, gzhl(opts), 8), s = d.length;\n    return gzh(d, opts), wbytes(d, s - 8, c.d()), wbytes(d, s - 4, l), d;\n}\n/**\n * Streaming GZIP decompression\n */\nvar Gunzip = /*#__PURE__*/ (function () {\n    /**\n     * Creates a GUNZIP stream\n     * @param cb The callback to call whenever data is inflated\n     */\n    function Gunzip(cb) {\n        this.v = 1;\n        Inflate.call(this, cb);\n    }\n    /**\n     * Pushes a chunk to be GUNZIPped\n     * @param chunk The chunk to push\n     * @param final Whether this is the last chunk\n     */\n    Gunzip.prototype.push = function (chunk, final) {\n        Inflate.prototype.e.call(this, chunk);\n        if (this.v) {\n            var s = this.p.length > 3 ? gzs(this.p) : 4;\n            if (s >= this.p.length && !final)\n                return;\n            this.p = this.p.subarray(s), this.v = 0;\n        }\n        if (final) {\n            if (this.p.length < 8)\n                throw 'invalid gzip stream';\n            this.p = this.p.subarray(0, -8);\n        }\n        // necessary to prevent TS from using the closure value\n        // This allows for workerization to function correctly\n        Inflate.prototype.c.call(this, final);\n    };\n    return Gunzip;\n}());\nexport { Gunzip };\n/**\n * Asynchronous streaming GZIP decompression\n */\nvar AsyncGunzip = /*#__PURE__*/ (function () {\n    /**\n     * Creates an asynchronous GUNZIP stream\n     * @param cb The callback to call whenever data is deflated\n     */\n    function AsyncGunzip(cb) {\n        this.ondata = cb;\n        astrmify([\n            bInflt,\n            guze,\n            function () { return [astrm, Inflate, Gunzip]; }\n        ], this, 0, function () {\n            var strm = new Gunzip();\n            onmessage = astrm(strm);\n        }, 9);\n    }\n    return AsyncGunzip;\n}());\nexport { AsyncGunzip };\nexport function gunzip(data, opts, cb) {\n    if (!cb)\n        cb = opts, opts = {};\n    if (typeof cb != 'function')\n        throw 'no callback';\n    return cbify(data, opts, [\n        bInflt,\n        guze,\n        function () { return [gunzipSync]; }\n    ], function (ev) { return pbf(gunzipSync(ev.data[0])); }, 3, cb);\n}\n/**\n * Expands GZIP data\n * @param data The data to decompress\n * @param out Where to write the data. GZIP already encodes the output size, so providing this doesn't save memory.\n * @returns The decompressed version of the data\n */\nexport function gunzipSync(data, out) {\n    return inflt(data.subarray(gzs(data), -8), out || new u8(gzl(data)));\n}\n/**\n * Streaming Zlib compression\n */\nvar Zlib = /*#__PURE__*/ (function () {\n    function Zlib(opts, cb) {\n        this.c = adler();\n        this.v = 1;\n        Deflate.call(this, opts, cb);\n    }\n    /**\n     * Pushes a chunk to be zlibbed\n     * @param chunk The chunk to push\n     * @param final Whether this is the last chunk\n     */\n    Zlib.prototype.push = function (chunk, final) {\n        Deflate.prototype.push.call(this, chunk, final);\n    };\n    Zlib.prototype.p = function (c, f) {\n        this.c.p(c);\n        var raw = dopt(c, this.o, this.v && 2, f && 4, !f);\n        if (this.v)\n            zlh(raw, this.o), this.v = 0;\n        if (f)\n            wbytes(raw, raw.length - 4, this.c.d());\n        this.ondata(raw, f);\n    };\n    return Zlib;\n}());\nexport { Zlib };\n/**\n * Asynchronous streaming Zlib compression\n */\nvar AsyncZlib = /*#__PURE__*/ (function () {\n    function AsyncZlib(opts, cb) {\n        astrmify([\n            bDflt,\n            zle,\n            function () { return [astrm, Deflate, Zlib]; }\n        ], this, AsyncCmpStrm.call(this, opts, cb), function (ev) {\n            var strm = new Zlib(ev.data);\n            onmessage = astrm(strm);\n        }, 10);\n    }\n    return AsyncZlib;\n}());\nexport { AsyncZlib };\nexport function zlib(data, opts, cb) {\n    if (!cb)\n        cb = opts, opts = {};\n    if (typeof cb != 'function')\n        throw 'no callback';\n    return cbify(data, opts, [\n        bDflt,\n        zle,\n        function () { return [zlibSync]; }\n    ], function (ev) { return pbf(zlibSync(ev.data[0], ev.data[1])); }, 4, cb);\n}\n/**\n * Compress data with Zlib\n * @param data The data to compress\n * @param opts The compression options\n * @returns The zlib-compressed version of the data\n */\nexport function zlibSync(data, opts) {\n    if (!opts)\n        opts = {};\n    var a = adler();\n    a.p(data);\n    var d = dopt(data, opts, 2, 4);\n    return zlh(d, opts), wbytes(d, d.length - 4, a.d()), d;\n}\n/**\n * Streaming Zlib decompression\n */\nvar Unzlib = /*#__PURE__*/ (function () {\n    /**\n     * Creates a Zlib decompression stream\n     * @param cb The callback to call whenever data is inflated\n     */\n    function Unzlib(cb) {\n        this.v = 1;\n        Inflate.call(this, cb);\n    }\n    /**\n     * Pushes a chunk to be unzlibbed\n     * @param chunk The chunk to push\n     * @param final Whether this is the last chunk\n     */\n    Unzlib.prototype.push = function (chunk, final) {\n        Inflate.prototype.e.call(this, chunk);\n        if (this.v) {\n            if (this.p.length < 2 && !final)\n                return;\n            this.p = this.p.subarray(2), this.v = 0;\n        }\n        if (final) {\n            if (this.p.length < 4)\n                throw 'invalid zlib stream';\n            this.p = this.p.subarray(0, -4);\n        }\n        // necessary to prevent TS from using the closure value\n        // This allows for workerization to function correctly\n        Inflate.prototype.c.call(this, final);\n    };\n    return Unzlib;\n}());\nexport { Unzlib };\n/**\n * Asynchronous streaming Zlib decompression\n */\nvar AsyncUnzlib = /*#__PURE__*/ (function () {\n    /**\n     * Creates an asynchronous Zlib decompression stream\n     * @param cb The callback to call whenever data is deflated\n     */\n    function AsyncUnzlib(cb) {\n        this.ondata = cb;\n        astrmify([\n            bInflt,\n            zule,\n            function () { return [astrm, Inflate, Unzlib]; }\n        ], this, 0, function () {\n            var strm = new Unzlib();\n            onmessage = astrm(strm);\n        }, 11);\n    }\n    return AsyncUnzlib;\n}());\nexport { AsyncUnzlib };\nexport function unzlib(data, opts, cb) {\n    if (!cb)\n        cb = opts, opts = {};\n    if (typeof cb != 'function')\n        throw 'no callback';\n    return cbify(data, opts, [\n        bInflt,\n        zule,\n        function () { return [unzlibSync]; }\n    ], function (ev) { return pbf(unzlibSync(ev.data[0], gu8(ev.data[1]))); }, 5, cb);\n}\n/**\n * Expands Zlib data\n * @param data The data to decompress\n * @param out Where to write the data. Saves memory if you know the decompressed size and provide an output buffer of that length.\n * @returns The decompressed version of the data\n */\nexport function unzlibSync(data, out) {\n    return inflt((zlv(data), data.subarray(2, -4)), out);\n}\n// Default algorithm for compression (used because having a known output size allows faster decompression)\nexport { gzip as compress, AsyncGzip as AsyncCompress };\n// Default algorithm for compression (used because having a known output size allows faster decompression)\nexport { gzipSync as compressSync, Gzip as Compress };\n/**\n * Streaming GZIP, Zlib, or raw DEFLATE decompression\n */\nvar Decompress = /*#__PURE__*/ (function () {\n    /**\n     * Creates a decompression stream\n     * @param cb The callback to call whenever data is decompressed\n     */\n    function Decompress(cb) {\n        this.G = Gunzip;\n        this.I = Inflate;\n        this.Z = Unzlib;\n        this.ondata = cb;\n    }\n    /**\n     * Pushes a chunk to be decompressed\n     * @param chunk The chunk to push\n     * @param final Whether this is the last chunk\n     */\n    Decompress.prototype.push = function (chunk, final) {\n        if (!this.ondata)\n            throw 'no stream handler';\n        if (!this.s) {\n            if (this.p && this.p.length) {\n                var n = new u8(this.p.length + chunk.length);\n                n.set(this.p), n.set(chunk, this.p.length);\n            }\n            else\n                this.p = chunk;\n            if (this.p.length > 2) {\n                var _this_1 = this;\n                var cb = function () { _this_1.ondata.apply(_this_1, arguments); };\n                this.s = (this.p[0] == 31 && this.p[1] == 139 && this.p[2] == 8)\n                    ? new this.G(cb)\n                    : ((this.p[0] & 15) != 8 || (this.p[0] >> 4) > 7 || ((this.p[0] << 8 | this.p[1]) % 31))\n                        ? new this.I(cb)\n                        : new this.Z(cb);\n                this.s.push(this.p, final);\n                this.p = null;\n            }\n        }\n        else\n            this.s.push(chunk, final);\n    };\n    return Decompress;\n}());\nexport { Decompress };\n/**\n * Asynchronous streaming GZIP, Zlib, or raw DEFLATE decompression\n */\nvar AsyncDecompress = /*#__PURE__*/ (function () {\n    /**\n   * Creates an asynchronous decompression stream\n   * @param cb The callback to call whenever data is decompressed\n   */\n    function AsyncDecompress(cb) {\n        this.G = AsyncGunzip;\n        this.I = AsyncInflate;\n        this.Z = AsyncUnzlib;\n        this.ondata = cb;\n    }\n    /**\n     * Pushes a chunk to be decompressed\n     * @param chunk The chunk to push\n     * @param final Whether this is the last chunk\n     */\n    AsyncDecompress.prototype.push = function (chunk, final) {\n        Decompress.prototype.push.call(this, chunk, final);\n    };\n    return AsyncDecompress;\n}());\nexport { AsyncDecompress };\nexport function decompress(data, opts, cb) {\n    if (!cb)\n        cb = opts, opts = {};\n    if (typeof cb != 'function')\n        throw 'no callback';\n    return (data[0] == 31 && data[1] == 139 && data[2] == 8)\n        ? gunzip(data, opts, cb)\n        : ((data[0] & 15) != 8 || (data[0] >> 4) > 7 || ((data[0] << 8 | data[1]) % 31))\n            ? inflate(data, opts, cb)\n            : unzlib(data, opts, cb);\n}\n/**\n * Expands compressed GZIP, Zlib, or raw DEFLATE data, automatically detecting the format\n * @param data The data to decompress\n * @param out Where to write the data. Saves memory if you know the decompressed size and provide an output buffer of that length.\n * @returns The decompressed version of the data\n */\nexport function decompressSync(data, out) {\n    return (data[0] == 31 && data[1] == 139 && data[2] == 8)\n        ? gunzipSync(data, out)\n        : ((data[0] & 15) != 8 || (data[0] >> 4) > 7 || ((data[0] << 8 | data[1]) % 31))\n            ? inflateSync(data, out)\n            : unzlibSync(data, out);\n}\n// flatten a directory structure\nvar fltn = function (d, p, t, o) {\n    for (var k in d) {\n        var val = d[k], n = p + k;\n        if (val instanceof u8)\n            t[n] = [val, o];\n        else if (Array.isArray(val))\n            t[n] = [val[0], mrg(o, val[1])];\n        else\n            fltn(val, n + '/', t, o);\n    }\n};\n// text encoder\nvar te = typeof TextEncoder != 'undefined' && /*#__PURE__*/ new TextEncoder();\n// text decoder\nvar td = typeof TextDecoder != 'undefined' && /*#__PURE__*/ new TextDecoder();\n// text decoder stream\nvar tds = 0;\ntry {\n    td.decode(et, { stream: true });\n    tds = 1;\n}\ncatch (e) { }\n// decode UTF8\nvar dutf8 = function (d) {\n    for (var r = '', i = 0;;) {\n        var c = d[i++];\n        var eb = (c > 127) + (c > 223) + (c > 239);\n        if (i + eb > d.length)\n            return [r, slc(d, i - 1)];\n        if (!eb)\n            r += String.fromCharCode(c);\n        else if (eb == 3) {\n            c = ((c & 15) << 18 | (d[i++] & 63) << 12 | (d[i++] & 63) << 6 | (d[i++] & 63)) - 65536,\n                r += String.fromCharCode(55296 | (c >> 10), 56320 | (c & 1023));\n        }\n        else if (eb & 1)\n            r += String.fromCharCode((c & 31) << 6 | (d[i++] & 63));\n        else\n            r += String.fromCharCode((c & 15) << 12 | (d[i++] & 63) << 6 | (d[i++] & 63));\n    }\n};\n/**\n * Streaming UTF-8 decoding\n */\nvar DecodeUTF8 = /*#__PURE__*/ (function () {\n    /**\n     * Creates a UTF-8 decoding stream\n     * @param cb The callback to call whenever data is decoded\n     */\n    function DecodeUTF8(cb) {\n        this.ondata = cb;\n        if (tds)\n            this.t = new TextDecoder();\n        else\n            this.p = et;\n    }\n    /**\n     * Pushes a chunk to be decoded from UTF-8 binary\n     * @param chunk The chunk to push\n     * @param final Whether this is the last chunk\n     */\n    DecodeUTF8.prototype.push = function (chunk, final) {\n        if (!this.ondata)\n            throw 'no callback';\n        final = !!final;\n        if (this.t) {\n            this.ondata(this.t.decode(chunk, { stream: true }), final);\n            if (final) {\n                if (this.t.decode().length)\n                    throw 'invalid utf-8 data';\n                this.t = null;\n            }\n            return;\n        }\n        if (!this.p)\n            throw 'stream finished';\n        var dat = new u8(this.p.length + chunk.length);\n        dat.set(this.p);\n        dat.set(chunk, this.p.length);\n        var _a = dutf8(dat), ch = _a[0], np = _a[1];\n        if (final) {\n            if (np.length)\n                throw 'invalid utf-8 data';\n            this.p = null;\n        }\n        else\n            this.p = np;\n        this.ondata(ch, final);\n    };\n    return DecodeUTF8;\n}());\nexport { DecodeUTF8 };\n/**\n * Streaming UTF-8 encoding\n */\nvar EncodeUTF8 = /*#__PURE__*/ (function () {\n    /**\n     * Creates a UTF-8 decoding stream\n     * @param cb The callback to call whenever data is encoded\n     */\n    function EncodeUTF8(cb) {\n        this.ondata = cb;\n    }\n    /**\n     * Pushes a chunk to be encoded to UTF-8\n     * @param chunk The string data to push\n     * @param final Whether this is the last chunk\n     */\n    EncodeUTF8.prototype.push = function (chunk, final) {\n        if (!this.ondata)\n            throw 'no callback';\n        if (this.d)\n            throw 'stream finished';\n        this.ondata(strToU8(chunk), this.d = final || false);\n    };\n    return EncodeUTF8;\n}());\nexport { EncodeUTF8 };\n/**\n * Converts a string into a Uint8Array for use with compression/decompression methods\n * @param str The string to encode\n * @param latin1 Whether or not to interpret the data as Latin-1. This should\n *               not need to be true unless decoding a binary string.\n * @returns The string encoded in UTF-8/Latin-1 binary\n */\nexport function strToU8(str, latin1) {\n    if (latin1) {\n        var ar_1 = new u8(str.length);\n        for (var i = 0; i < str.length; ++i)\n            ar_1[i] = str.charCodeAt(i);\n        return ar_1;\n    }\n    if (te)\n        return te.encode(str);\n    var l = str.length;\n    var ar = new u8(str.length + (str.length >> 1));\n    var ai = 0;\n    var w = function (v) { ar[ai++] = v; };\n    for (var i = 0; i < l; ++i) {\n        if (ai + 5 > ar.length) {\n            var n = new u8(ai + 8 + ((l - i) << 1));\n            n.set(ar);\n            ar = n;\n        }\n        var c = str.charCodeAt(i);\n        if (c < 128 || latin1)\n            w(c);\n        else if (c < 2048)\n            w(192 | (c >> 6)), w(128 | (c & 63));\n        else if (c > 55295 && c < 57344)\n            c = 65536 + (c & 1023 << 10) | (str.charCodeAt(++i) & 1023),\n                w(240 | (c >> 18)), w(128 | ((c >> 12) & 63)), w(128 | ((c >> 6) & 63)), w(128 | (c & 63));\n        else\n            w(224 | (c >> 12)), w(128 | ((c >> 6) & 63)), w(128 | (c & 63));\n    }\n    return slc(ar, 0, ai);\n}\n/**\n * Converts a Uint8Array to a string\n * @param dat The data to decode to string\n * @param latin1 Whether or not to interpret the data as Latin-1. This should\n *               not need to be true unless encoding to binary string.\n * @returns The original UTF-8/Latin-1 string\n */\nexport function strFromU8(dat, latin1) {\n    if (latin1) {\n        var r = '';\n        for (var i = 0; i < dat.length; i += 16384)\n            r += String.fromCharCode.apply(null, dat.subarray(i, i + 16384));\n        return r;\n    }\n    else if (td)\n        return td.decode(dat);\n    else {\n        var _a = dutf8(dat), out = _a[0], ext = _a[1];\n        if (ext.length)\n            throw 'invalid utf-8 data';\n        return out;\n    }\n}\n;\n// deflate bit flag\nvar dbf = function (l) { return l == 1 ? 3 : l < 6 ? 2 : l == 9 ? 1 : 0; };\n// skip local zip header\nvar slzh = function (d, b) { return b + 30 + b2(d, b + 26) + b2(d, b + 28); };\n// read zip header\nvar zh = function (d, b, z) {\n    var fnl = b2(d, b + 28), fn = strFromU8(d.subarray(b + 46, b + 46 + fnl), !(b2(d, b + 8) & 2048)), es = b + 46 + fnl, bs = b4(d, b + 20);\n    var _a = z && bs == 4294967295 ? z64e(d, es) : [bs, b4(d, b + 24), b4(d, b + 42)], sc = _a[0], su = _a[1], off = _a[2];\n    return [b2(d, b + 10), sc, su, fn, es + b2(d, b + 30) + b2(d, b + 32), off];\n};\n// read zip64 extra field\nvar z64e = function (d, b) {\n    for (; b2(d, b) != 1; b += 4 + b2(d, b + 2))\n        ;\n    return [b8(d, b + 12), b8(d, b + 4), b8(d, b + 20)];\n};\n// extra field length\nvar exfl = function (ex) {\n    var le = 0;\n    if (ex) {\n        for (var k in ex) {\n            var l = ex[k].length;\n            if (l > 65535)\n                throw 'extra field too long';\n            le += l + 4;\n        }\n    }\n    return le;\n};\n// write zip header\nvar wzh = function (d, b, f, fn, u, c, ce, co) {\n    var fl = fn.length, ex = f.extra, col = co && co.length;\n    var exl = exfl(ex);\n    wbytes(d, b, ce != null ? 0x2014B50 : 0x4034B50), b += 4;\n    if (ce != null)\n        d[b++] = 20, d[b++] = f.os;\n    d[b] = 20, b += 2; // spec compliance? what's that?\n    d[b++] = (f.flag << 1) | (c == null && 8), d[b++] = u && 8;\n    d[b++] = f.compression & 255, d[b++] = f.compression >> 8;\n    var dt = new Date(f.mtime == null ? Date.now() : f.mtime), y = dt.getFullYear() - 1980;\n    if (y < 0 || y > 119)\n        throw 'date not in range 1980-2099';\n    wbytes(d, b, (y << 25) | ((dt.getMonth() + 1) << 21) | (dt.getDate() << 16) | (dt.getHours() << 11) | (dt.getMinutes() << 5) | (dt.getSeconds() >>> 1)), b += 4;\n    if (c != null) {\n        wbytes(d, b, f.crc);\n        wbytes(d, b + 4, c);\n        wbytes(d, b + 8, f.size);\n    }\n    wbytes(d, b + 12, fl);\n    wbytes(d, b + 14, exl), b += 16;\n    if (ce != null) {\n        wbytes(d, b, col);\n        wbytes(d, b + 6, f.attrs);\n        wbytes(d, b + 10, ce), b += 14;\n    }\n    d.set(fn, b);\n    b += fl;\n    if (exl) {\n        for (var k in ex) {\n            var exf = ex[k], l = exf.length;\n            wbytes(d, b, +k);\n            wbytes(d, b + 2, l);\n            d.set(exf, b + 4), b += 4 + l;\n        }\n    }\n    if (col)\n        d.set(co, b), b += col;\n    return b;\n};\n// write zip footer (end of central directory)\nvar wzf = function (o, b, c, d, e) {\n    wbytes(o, b, 0x6054B50); // skip disk\n    wbytes(o, b + 8, c);\n    wbytes(o, b + 10, c);\n    wbytes(o, b + 12, d);\n    wbytes(o, b + 16, e);\n};\n/**\n * A pass-through stream to keep data uncompressed in a ZIP archive.\n */\nvar ZipPassThrough = /*#__PURE__*/ (function () {\n    /**\n     * Creates a pass-through stream that can be added to ZIP archives\n     * @param filename The filename to associate with this data stream\n     */\n    function ZipPassThrough(filename) {\n        this.filename = filename;\n        this.c = crc();\n        this.size = 0;\n        this.compression = 0;\n    }\n    /**\n     * Processes a chunk and pushes to the output stream. You can override this\n     * method in a subclass for custom behavior, but by default this passes\n     * the data through. You must call this.ondata(err, chunk, final) at some\n     * point in this method.\n     * @param chunk The chunk to process\n     * @param final Whether this is the last chunk\n     */\n    ZipPassThrough.prototype.process = function (chunk, final) {\n        this.ondata(null, chunk, final);\n    };\n    /**\n     * Pushes a chunk to be added. If you are subclassing this with a custom\n     * compression algorithm, note that you must push data from the source\n     * file only, pre-compression.\n     * @param chunk The chunk to push\n     * @param final Whether this is the last chunk\n     */\n    ZipPassThrough.prototype.push = function (chunk, final) {\n        if (!this.ondata)\n            throw 'no callback - add to ZIP archive before pushing';\n        this.c.p(chunk);\n        this.size += chunk.length;\n        if (final)\n            this.crc = this.c.d();\n        this.process(chunk, final || false);\n    };\n    return ZipPassThrough;\n}());\nexport { ZipPassThrough };\n// I don't extend because TypeScript extension adds 1kB of runtime bloat\n/**\n * Streaming DEFLATE compression for ZIP archives. Prefer using AsyncZipDeflate\n * for better performance\n */\nvar ZipDeflate = /*#__PURE__*/ (function () {\n    /**\n     * Creates a DEFLATE stream that can be added to ZIP archives\n     * @param filename The filename to associate with this data stream\n     * @param opts The compression options\n     */\n    function ZipDeflate(filename, opts) {\n        var _this_1 = this;\n        if (!opts)\n            opts = {};\n        ZipPassThrough.call(this, filename);\n        this.d = new Deflate(opts, function (dat, final) {\n            _this_1.ondata(null, dat, final);\n        });\n        this.compression = 8;\n        this.flag = dbf(opts.level);\n    }\n    ZipDeflate.prototype.process = function (chunk, final) {\n        try {\n            this.d.push(chunk, final);\n        }\n        catch (e) {\n            this.ondata(e, null, final);\n        }\n    };\n    /**\n     * Pushes a chunk to be deflated\n     * @param chunk The chunk to push\n     * @param final Whether this is the last chunk\n     */\n    ZipDeflate.prototype.push = function (chunk, final) {\n        ZipPassThrough.prototype.push.call(this, chunk, final);\n    };\n    return ZipDeflate;\n}());\nexport { ZipDeflate };\n/**\n * Asynchronous streaming DEFLATE compression for ZIP archives\n */\nvar AsyncZipDeflate = /*#__PURE__*/ (function () {\n    /**\n     * Creates a DEFLATE stream that can be added to ZIP archives\n     * @param filename The filename to associate with this data stream\n     * @param opts The compression options\n     */\n    function AsyncZipDeflate(filename, opts) {\n        var _this_1 = this;\n        if (!opts)\n            opts = {};\n        ZipPassThrough.call(this, filename);\n        this.d = new AsyncDeflate(opts, function (err, dat, final) {\n            _this_1.ondata(err, dat, final);\n        });\n        this.compression = 8;\n        this.flag = dbf(opts.level);\n        this.terminate = this.d.terminate;\n    }\n    AsyncZipDeflate.prototype.process = function (chunk, final) {\n        this.d.push(chunk, final);\n    };\n    /**\n     * Pushes a chunk to be deflated\n     * @param chunk The chunk to push\n     * @param final Whether this is the last chunk\n     */\n    AsyncZipDeflate.prototype.push = function (chunk, final) {\n        ZipPassThrough.prototype.push.call(this, chunk, final);\n    };\n    return AsyncZipDeflate;\n}());\nexport { AsyncZipDeflate };\n// TODO: Better tree shaking\n/**\n * A zippable archive to which files can incrementally be added\n */\nvar Zip = /*#__PURE__*/ (function () {\n    /**\n     * Creates an empty ZIP archive to which files can be added\n     * @param cb The callback to call whenever data for the generated ZIP archive\n     *           is available\n     */\n    function Zip(cb) {\n        this.ondata = cb;\n        this.u = [];\n        this.d = 1;\n    }\n    /**\n     * Adds a file to the ZIP archive\n     * @param file The file stream to add\n     */\n    Zip.prototype.add = function (file) {\n        var _this_1 = this;\n        if (this.d & 2)\n            throw 'stream finished';\n        var f = strToU8(file.filename), fl = f.length;\n        var com = file.comment, o = com && strToU8(com);\n        var u = fl != file.filename.length || (o && (com.length != o.length));\n        var hl = fl + exfl(file.extra) + 30;\n        if (fl > 65535)\n            throw 'filename too long';\n        var header = new u8(hl);\n        wzh(header, 0, file, f, u);\n        var chks = [header];\n        var pAll = function () {\n            for (var _i = 0, chks_1 = chks; _i < chks_1.length; _i++) {\n                var chk = chks_1[_i];\n                _this_1.ondata(null, chk, false);\n            }\n            chks = [];\n        };\n        var tr = this.d;\n        this.d = 0;\n        var ind = this.u.length;\n        var uf = mrg(file, {\n            f: f,\n            u: u,\n            o: o,\n            t: function () {\n                if (file.terminate)\n                    file.terminate();\n            },\n            r: function () {\n                pAll();\n                if (tr) {\n                    var nxt = _this_1.u[ind + 1];\n                    if (nxt)\n                        nxt.r();\n                    else\n                        _this_1.d = 1;\n                }\n                tr = 1;\n            }\n        });\n        var cl = 0;\n        file.ondata = function (err, dat, final) {\n            if (err) {\n                _this_1.ondata(err, dat, final);\n                _this_1.terminate();\n            }\n            else {\n                cl += dat.length;\n                chks.push(dat);\n                if (final) {\n                    var dd = new u8(16);\n                    wbytes(dd, 0, 0x8074B50);\n                    wbytes(dd, 4, file.crc);\n                    wbytes(dd, 8, cl);\n                    wbytes(dd, 12, file.size);\n                    chks.push(dd);\n                    uf.c = cl, uf.b = hl + cl + 16, uf.crc = file.crc, uf.size = file.size;\n                    if (tr)\n                        uf.r();\n                    tr = 1;\n                }\n                else if (tr)\n                    pAll();\n            }\n        };\n        this.u.push(uf);\n    };\n    /**\n     * Ends the process of adding files and prepares to emit the final chunks.\n     * This *must* be called after adding all desired files for the resulting\n     * ZIP file to work properly.\n     */\n    Zip.prototype.end = function () {\n        var _this_1 = this;\n        if (this.d & 2) {\n            if (this.d & 1)\n                throw 'stream finishing';\n            throw 'stream finished';\n        }\n        if (this.d)\n            this.e();\n        else\n            this.u.push({\n                r: function () {\n                    if (!(_this_1.d & 1))\n                        return;\n                    _this_1.u.splice(-1, 1);\n                    _this_1.e();\n                },\n                t: function () { }\n            });\n        this.d = 3;\n    };\n    Zip.prototype.e = function () {\n        var bt = 0, l = 0, tl = 0;\n        for (var _i = 0, _a = this.u; _i < _a.length; _i++) {\n            var f = _a[_i];\n            tl += 46 + f.f.length + exfl(f.extra) + (f.o ? f.o.length : 0);\n        }\n        var out = new u8(tl + 22);\n        for (var _b = 0, _c = this.u; _b < _c.length; _b++) {\n            var f = _c[_b];\n            wzh(out, bt, f, f.f, f.u, f.c, l, f.o);\n            bt += 46 + f.f.length + exfl(f.extra) + (f.o ? f.o.length : 0), l += f.b;\n        }\n        wzf(out, bt, this.u.length, tl, l);\n        this.ondata(null, out, true);\n        this.d = 2;\n    };\n    /**\n     * A method to terminate any internal workers used by the stream. Subsequent\n     * calls to add() will fail.\n     */\n    Zip.prototype.terminate = function () {\n        for (var _i = 0, _a = this.u; _i < _a.length; _i++) {\n            var f = _a[_i];\n            f.t();\n        }\n        this.d = 2;\n    };\n    return Zip;\n}());\nexport { Zip };\nexport function zip(data, opts, cb) {\n    if (!cb)\n        cb = opts, opts = {};\n    if (typeof cb != 'function')\n        throw 'no callback';\n    var r = {};\n    fltn(data, '', r, opts);\n    var k = Object.keys(r);\n    var lft = k.length, o = 0, tot = 0;\n    var slft = lft, files = new Array(lft);\n    var term = [];\n    var tAll = function () {\n        for (var i = 0; i < term.length; ++i)\n            term[i]();\n    };\n    var cbf = function () {\n        var out = new u8(tot + 22), oe = o, cdl = tot - o;\n        tot = 0;\n        for (var i = 0; i < slft; ++i) {\n            var f = files[i];\n            try {\n                var l = f.c.length;\n                wzh(out, tot, f, f.f, f.u, l);\n                var badd = 30 + f.f.length + exfl(f.extra);\n                var loc = tot + badd;\n                out.set(f.c, loc);\n                wzh(out, o, f, f.f, f.u, l, tot, f.m), o += 16 + badd + (f.m ? f.m.length : 0), tot = loc + l;\n            }\n            catch (e) {\n                return cb(e, null);\n            }\n        }\n        wzf(out, o, files.length, cdl, oe);\n        cb(null, out);\n    };\n    if (!lft)\n        cbf();\n    var _loop_1 = function (i) {\n        var fn = k[i];\n        var _a = r[fn], file = _a[0], p = _a[1];\n        var c = crc(), size = file.length;\n        c.p(file);\n        var f = strToU8(fn), s = f.length;\n        var com = p.comment, m = com && strToU8(com), ms = m && m.length;\n        var exl = exfl(p.extra);\n        var compression = p.level == 0 ? 0 : 8;\n        var cbl = function (e, d) {\n            if (e) {\n                tAll();\n                cb(e, null);\n            }\n            else {\n                var l = d.length;\n                files[i] = mrg(p, {\n                    size: size,\n                    crc: c.d(),\n                    c: d,\n                    f: f,\n                    m: m,\n                    u: s != fn.length || (m && (com.length != ms)),\n                    compression: compression\n                });\n                o += 30 + s + exl + l;\n                tot += 76 + 2 * (s + exl) + (ms || 0) + l;\n                if (!--lft)\n                    cbf();\n            }\n        };\n        if (s > 65535)\n            cbl('filename too long', null);\n        if (!compression)\n            cbl(null, file);\n        else if (size < 160000) {\n            try {\n                cbl(null, deflateSync(file, p));\n            }\n            catch (e) {\n                cbl(e, null);\n            }\n        }\n        else\n            term.push(deflate(file, p, cbl));\n    };\n    // Cannot use lft because it can decrease\n    for (var i = 0; i < slft; ++i) {\n        _loop_1(i);\n    }\n    return tAll;\n}\n/**\n * Synchronously creates a ZIP file. Prefer using `zip` for better performance\n * with more than one file.\n * @param data The directory structure for the ZIP archive\n * @param opts The main options, merged with per-file options\n * @returns The generated ZIP archive\n */\nexport function zipSync(data, opts) {\n    if (!opts)\n        opts = {};\n    var r = {};\n    var files = [];\n    fltn(data, '', r, opts);\n    var o = 0;\n    var tot = 0;\n    for (var fn in r) {\n        var _a = r[fn], file = _a[0], p = _a[1];\n        var compression = p.level == 0 ? 0 : 8;\n        var f = strToU8(fn), s = f.length;\n        var com = p.comment, m = com && strToU8(com), ms = m && m.length;\n        var exl = exfl(p.extra);\n        if (s > 65535)\n            throw 'filename too long';\n        var d = compression ? deflateSync(file, p) : file, l = d.length;\n        var c = crc();\n        c.p(file);\n        files.push(mrg(p, {\n            size: file.length,\n            crc: c.d(),\n            c: d,\n            f: f,\n            m: m,\n            u: s != fn.length || (m && (com.length != ms)),\n            o: o,\n            compression: compression\n        }));\n        o += 30 + s + exl + l;\n        tot += 76 + 2 * (s + exl) + (ms || 0) + l;\n    }\n    var out = new u8(tot + 22), oe = o, cdl = tot - o;\n    for (var i = 0; i < files.length; ++i) {\n        var f = files[i];\n        wzh(out, f.o, f, f.f, f.u, f.c.length);\n        var badd = 30 + f.f.length + exfl(f.extra);\n        out.set(f.c, f.o + badd);\n        wzh(out, o, f, f.f, f.u, f.c.length, f.o, f.m), o += 16 + badd + (f.m ? f.m.length : 0);\n    }\n    wzf(out, o, files.length, cdl, oe);\n    return out;\n}\n/**\n * Streaming pass-through decompression for ZIP archives\n */\nvar UnzipPassThrough = /*#__PURE__*/ (function () {\n    function UnzipPassThrough() {\n    }\n    UnzipPassThrough.prototype.push = function (data, final) {\n        this.ondata(null, data, final);\n    };\n    UnzipPassThrough.compression = 0;\n    return UnzipPassThrough;\n}());\nexport { UnzipPassThrough };\n/**\n * Streaming DEFLATE decompression for ZIP archives. Prefer AsyncZipInflate for\n * better performance.\n */\nvar UnzipInflate = /*#__PURE__*/ (function () {\n    /**\n     * Creates a DEFLATE decompression that can be used in ZIP archives\n     */\n    function UnzipInflate() {\n        var _this_1 = this;\n        this.i = new Inflate(function (dat, final) {\n            _this_1.ondata(null, dat, final);\n        });\n    }\n    UnzipInflate.prototype.push = function (data, final) {\n        try {\n            this.i.push(data, final);\n        }\n        catch (e) {\n            this.ondata(e, data, final);\n        }\n    };\n    UnzipInflate.compression = 8;\n    return UnzipInflate;\n}());\nexport { UnzipInflate };\n/**\n * Asynchronous streaming DEFLATE decompression for ZIP archives\n */\nvar AsyncUnzipInflate = /*#__PURE__*/ (function () {\n    /**\n     * Creates a DEFLATE decompression that can be used in ZIP archives\n     */\n    function AsyncUnzipInflate(_, sz) {\n        var _this_1 = this;\n        if (sz < 320000) {\n            this.i = new Inflate(function (dat, final) {\n                _this_1.ondata(null, dat, final);\n            });\n        }\n        else {\n            this.i = new AsyncInflate(function (err, dat, final) {\n                _this_1.ondata(err, dat, final);\n            });\n            this.terminate = this.i.terminate;\n        }\n    }\n    AsyncUnzipInflate.prototype.push = function (data, final) {\n        if (this.i.terminate)\n            data = slc(data, 0);\n        this.i.push(data, final);\n    };\n    AsyncUnzipInflate.compression = 8;\n    return AsyncUnzipInflate;\n}());\nexport { AsyncUnzipInflate };\n/**\n * A ZIP archive decompression stream that emits files as they are discovered\n */\nvar Unzip = /*#__PURE__*/ (function () {\n    /**\n     * Creates a ZIP decompression stream\n     * @param cb The callback to call whenever a file in the ZIP archive is found\n     */\n    function Unzip(cb) {\n        this.onfile = cb;\n        this.k = [];\n        this.o = {\n            0: UnzipPassThrough\n        };\n        this.p = et;\n    }\n    /**\n     * Pushes a chunk to be unzipped\n     * @param chunk The chunk to push\n     * @param final Whether this is the last chunk\n     */\n    Unzip.prototype.push = function (chunk, final) {\n        var _this_1 = this;\n        if (!this.onfile)\n            throw 'no callback';\n        if (!this.p)\n            throw 'stream finished';\n        if (this.c > 0) {\n            var len = Math.min(this.c, chunk.length);\n            var toAdd = chunk.subarray(0, len);\n            this.c -= len;\n            if (this.d)\n                this.d.push(toAdd, !this.c);\n            else\n                this.k[0].push(toAdd);\n            chunk = chunk.subarray(len);\n            if (chunk.length)\n                return this.push(chunk, final);\n        }\n        else {\n            var f = 0, i = 0, is = void 0, buf = void 0;\n            if (!this.p.length)\n                buf = chunk;\n            else if (!chunk.length)\n                buf = this.p;\n            else {\n                buf = new u8(this.p.length + chunk.length);\n                buf.set(this.p), buf.set(chunk, this.p.length);\n            }\n            var l = buf.length, oc = this.c, add = oc && this.d;\n            var _loop_2 = function () {\n                var _a;\n                var sig = b4(buf, i);\n                if (sig == 0x4034B50) {\n                    f = 1, is = i;\n                    this_1.d = null;\n                    this_1.c = 0;\n                    var bf = b2(buf, i + 6), cmp_1 = b2(buf, i + 8), u = bf & 2048, dd = bf & 8, fnl = b2(buf, i + 26), es = b2(buf, i + 28);\n                    if (l > i + 30 + fnl + es) {\n                        var chks_2 = [];\n                        this_1.k.unshift(chks_2);\n                        f = 2;\n                        var sc_1 = b4(buf, i + 18), su_1 = b4(buf, i + 22);\n                        var fn_1 = strFromU8(buf.subarray(i + 30, i += 30 + fnl), !u);\n                        if (sc_1 == 4294967295) {\n                            _a = dd ? [-2] : z64e(buf, i), sc_1 = _a[0], su_1 = _a[1];\n                        }\n                        else if (dd)\n                            sc_1 = -1;\n                        i += es;\n                        this_1.c = sc_1;\n                        var d_1;\n                        var file_1 = {\n                            name: fn_1,\n                            compression: cmp_1,\n                            start: function () {\n                                if (!file_1.ondata)\n                                    throw 'no callback';\n                                if (!sc_1)\n                                    file_1.ondata(null, et, true);\n                                else {\n                                    var ctr = _this_1.o[cmp_1];\n                                    if (!ctr)\n                                        throw 'unknown compression type ' + cmp_1;\n                                    d_1 = sc_1 < 0 ? new ctr(fn_1) : new ctr(fn_1, sc_1, su_1);\n                                    d_1.ondata = function (err, dat, final) { file_1.ondata(err, dat, final); };\n                                    for (var _i = 0, chks_3 = chks_2; _i < chks_3.length; _i++) {\n                                        var dat = chks_3[_i];\n                                        d_1.push(dat, false);\n                                    }\n                                    if (_this_1.k[0] == chks_2 && _this_1.c)\n                                        _this_1.d = d_1;\n                                    else\n                                        d_1.push(et, true);\n                                }\n                            },\n                            terminate: function () {\n                                if (d_1 && d_1.terminate)\n                                    d_1.terminate();\n                            }\n                        };\n                        if (sc_1 >= 0)\n                            file_1.size = sc_1, file_1.originalSize = su_1;\n                        this_1.onfile(file_1);\n                    }\n                    return \"break\";\n                }\n                else if (oc) {\n                    if (sig == 0x8074B50) {\n                        is = i += 12 + (oc == -2 && 8), f = 3, this_1.c = 0;\n                        return \"break\";\n                    }\n                    else if (sig == 0x2014B50) {\n                        is = i -= 4, f = 3, this_1.c = 0;\n                        return \"break\";\n                    }\n                }\n            };\n            var this_1 = this;\n            for (; i < l - 4; ++i) {\n                var state_1 = _loop_2();\n                if (state_1 === \"break\")\n                    break;\n            }\n            this.p = et;\n            if (oc < 0) {\n                var dat = f ? buf.subarray(0, is - 12 - (oc == -2 && 8) - (b4(buf, is - 16) == 0x8074B50 && 4)) : buf.subarray(0, i);\n                if (add)\n                    add.push(dat, !!f);\n                else\n                    this.k[+(f == 2)].push(dat);\n            }\n            if (f & 2)\n                return this.push(buf.subarray(i), final);\n            this.p = buf.subarray(i);\n        }\n        if (final) {\n            if (this.c)\n                throw 'invalid zip file';\n            this.p = null;\n        }\n    };\n    /**\n     * Registers a decoder with the stream, allowing for files compressed with\n     * the compression type provided to be expanded correctly\n     * @param decoder The decoder constructor\n     */\n    Unzip.prototype.register = function (decoder) {\n        this.o[decoder.compression] = decoder;\n    };\n    return Unzip;\n}());\nexport { Unzip };\n/**\n * Asynchronously decompresses a ZIP archive\n * @param data The raw compressed ZIP file\n * @param cb The callback to call with the decompressed files\n * @returns A function that can be used to immediately terminate the unzipping\n */\nexport function unzip(data, cb) {\n    if (typeof cb != 'function')\n        throw 'no callback';\n    var term = [];\n    var tAll = function () {\n        for (var i = 0; i < term.length; ++i)\n            term[i]();\n    };\n    var files = {};\n    var e = data.length - 22;\n    for (; b4(data, e) != 0x6054B50; --e) {\n        if (!e || data.length - e > 65558) {\n            cb('invalid zip file', null);\n            return;\n        }\n    }\n    ;\n    var lft = b2(data, e + 8);\n    if (!lft)\n        cb(null, {});\n    var c = lft;\n    var o = b4(data, e + 16);\n    var z = o == 4294967295;\n    if (z) {\n        e = b4(data, e - 12);\n        if (b4(data, e) != 0x6064B50) {\n            cb('invalid zip file', null);\n            return;\n        }\n        c = lft = b4(data, e + 32);\n        o = b4(data, e + 48);\n    }\n    var _loop_3 = function (i) {\n        var _a = zh(data, o, z), c_1 = _a[0], sc = _a[1], su = _a[2], fn = _a[3], no = _a[4], off = _a[5], b = slzh(data, off);\n        o = no;\n        var cbl = function (e, d) {\n            if (e) {\n                tAll();\n                cb(e, null);\n            }\n            else {\n                files[fn] = d;\n                if (!--lft)\n                    cb(null, files);\n            }\n        };\n        if (!c_1)\n            cbl(null, slc(data, b, b + sc));\n        else if (c_1 == 8) {\n            var infl = data.subarray(b, b + sc);\n            if (sc < 320000) {\n                try {\n                    cbl(null, inflateSync(infl, new u8(su)));\n                }\n                catch (e) {\n                    cbl(e, null);\n                }\n            }\n            else\n                term.push(inflate(infl, { size: su }, cbl));\n        }\n        else\n            cbl('unknown compression type ' + c_1, null);\n    };\n    for (var i = 0; i < c; ++i) {\n        _loop_3(i);\n    }\n    return tAll;\n}\n/**\n * Synchronously decompresses a ZIP archive. Prefer using `unzip` for better\n * performance with more than one file.\n * @param data The raw compressed ZIP file\n * @returns The decompressed files\n */\nexport function unzipSync(data) {\n    var files = {};\n    var e = data.length - 22;\n    for (; b4(data, e) != 0x6054B50; --e) {\n        if (!e || data.length - e > 65558)\n            throw 'invalid zip file';\n    }\n    ;\n    var c = b2(data, e + 8);\n    if (!c)\n        return {};\n    var o = b4(data, e + 16);\n    var z = o == 4294967295;\n    if (z) {\n        e = b4(data, e - 12);\n        if (b4(data, e) != 0x6064B50)\n            throw 'invalid zip file';\n        c = b4(data, e + 32);\n        o = b4(data, e + 48);\n    }\n    for (var i = 0; i < c; ++i) {\n        var _a = zh(data, o, z), c_2 = _a[0], sc = _a[1], su = _a[2], fn = _a[3], no = _a[4], off = _a[5], b = slzh(data, off);\n        o = no;\n        if (!c_2)\n            files[fn] = slc(data, b, b + sc);\n        else if (c_2 == 8)\n            files[fn] = inflateSync(data.subarray(b, b + sc), new u8(su));\n        else\n            throw 'unknown compression type ' + c_2;\n    }\n    return files;\n}\n","import {\n\tVector3,\n\tVector4\n} from 'three';\n\n/**\n * NURBS utils\n *\n * See NURBSCurve and NURBSSurface.\n **/\n\n\n/**************************************************************\n *\tNURBS Utils\n **************************************************************/\n\nclass NURBSUtils {\n\n\t/*\n\tFinds knot vector span.\n\n\tp : degree\n\tu : parametric value\n\tU : knot vector\n\n\treturns the span\n\t*/\n\tstatic findSpan( p, u, U ) {\n\n\t\tconst n = U.length - p - 1;\n\n\t\tif ( u >= U[ n ] ) {\n\n\t\t\treturn n - 1;\n\n\t\t}\n\n\t\tif ( u <= U[ p ] ) {\n\n\t\t\treturn p;\n\n\t\t}\n\n\t\tlet low = p;\n\t\tlet high = n;\n\t\tlet mid = Math.floor( ( low + high ) / 2 );\n\n\t\twhile ( u < U[ mid ] || u >= U[ mid + 1 ] ) {\n\n\t\t\tif ( u < U[ mid ] ) {\n\n\t\t\t\thigh = mid;\n\n\t\t\t} else {\n\n\t\t\t\tlow = mid;\n\n\t\t\t}\n\n\t\t\tmid = Math.floor( ( low + high ) / 2 );\n\n\t\t}\n\n\t\treturn mid;\n\n\t}\n\n\n\t/*\n\tCalculate basis functions. See The NURBS Book, page 70, algorithm A2.2\n\n\tspan : span in which u lies\n\tu    : parametric point\n\tp    : degree\n\tU    : knot vector\n\n\treturns array[p+1] with basis functions values.\n\t*/\n\tstatic calcBasisFunctions( span, u, p, U ) {\n\n\t\tconst N = [];\n\t\tconst left = [];\n\t\tconst right = [];\n\t\tN[ 0 ] = 1.0;\n\n\t\tfor ( let j = 1; j <= p; ++ j ) {\n\n\t\t\tleft[ j ] = u - U[ span + 1 - j ];\n\t\t\tright[ j ] = U[ span + j ] - u;\n\n\t\t\tlet saved = 0.0;\n\n\t\t\tfor ( let r = 0; r < j; ++ r ) {\n\n\t\t\t\tconst rv = right[ r + 1 ];\n\t\t\t\tconst lv = left[ j - r ];\n\t\t\t\tconst temp = N[ r ] / ( rv + lv );\n\t\t\t\tN[ r ] = saved + rv * temp;\n\t\t\t\tsaved = lv * temp;\n\n\t\t\t }\n\n\t\t\t N[ j ] = saved;\n\n\t\t }\n\n\t\t return N;\n\n\t}\n\n\n\t/*\n\tCalculate B-Spline curve points. See The NURBS Book, page 82, algorithm A3.1.\n\n\tp : degree of B-Spline\n\tU : knot vector\n\tP : control points (x, y, z, w)\n\tu : parametric point\n\n\treturns point for given u\n\t*/\n\tstatic calcBSplinePoint( p, U, P, u ) {\n\n\t\tconst span = this.findSpan( p, u, U );\n\t\tconst N = this.calcBasisFunctions( span, u, p, U );\n\t\tconst C = new Vector4( 0, 0, 0, 0 );\n\n\t\tfor ( let j = 0; j <= p; ++ j ) {\n\n\t\t\tconst point = P[ span - p + j ];\n\t\t\tconst Nj = N[ j ];\n\t\t\tconst wNj = point.w * Nj;\n\t\t\tC.x += point.x * wNj;\n\t\t\tC.y += point.y * wNj;\n\t\t\tC.z += point.z * wNj;\n\t\t\tC.w += point.w * Nj;\n\n\t\t}\n\n\t\treturn C;\n\n\t}\n\n\n\t/*\n\tCalculate basis functions derivatives. See The NURBS Book, page 72, algorithm A2.3.\n\n\tspan : span in which u lies\n\tu    : parametric point\n\tp    : degree\n\tn    : number of derivatives to calculate\n\tU    : knot vector\n\n\treturns array[n+1][p+1] with basis functions derivatives\n\t*/\n\tstatic calcBasisFunctionDerivatives( span, u, p, n, U ) {\n\n\t\tconst zeroArr = [];\n\t\tfor ( let i = 0; i <= p; ++ i )\n\t\t\tzeroArr[ i ] = 0.0;\n\n\t\tconst ders = [];\n\n\t\tfor ( let i = 0; i <= n; ++ i )\n\t\t\tders[ i ] = zeroArr.slice( 0 );\n\n\t\tconst ndu = [];\n\n\t\tfor ( let i = 0; i <= p; ++ i )\n\t\t\tndu[ i ] = zeroArr.slice( 0 );\n\n\t\tndu[ 0 ][ 0 ] = 1.0;\n\n\t\tconst left = zeroArr.slice( 0 );\n\t\tconst right = zeroArr.slice( 0 );\n\n\t\tfor ( let j = 1; j <= p; ++ j ) {\n\n\t\t\tleft[ j ] = u - U[ span + 1 - j ];\n\t\t\tright[ j ] = U[ span + j ] - u;\n\n\t\t\tlet saved = 0.0;\n\n\t\t\tfor ( let r = 0; r < j; ++ r ) {\n\n\t\t\t\tconst rv = right[ r + 1 ];\n\t\t\t\tconst lv = left[ j - r ];\n\t\t\t\tndu[ j ][ r ] = rv + lv;\n\n\t\t\t\tconst temp = ndu[ r ][ j - 1 ] / ndu[ j ][ r ];\n\t\t\t\tndu[ r ][ j ] = saved + rv * temp;\n\t\t\t\tsaved = lv * temp;\n\n\t\t\t}\n\n\t\t\tndu[ j ][ j ] = saved;\n\n\t\t}\n\n\t\tfor ( let j = 0; j <= p; ++ j ) {\n\n\t\t\tders[ 0 ][ j ] = ndu[ j ][ p ];\n\n\t\t}\n\n\t\tfor ( let r = 0; r <= p; ++ r ) {\n\n\t\t\tlet s1 = 0;\n\t\t\tlet s2 = 1;\n\n\t\t\tconst a = [];\n\t\t\tfor ( let i = 0; i <= p; ++ i ) {\n\n\t\t\t\ta[ i ] = zeroArr.slice( 0 );\n\n\t\t\t}\n\n\t\t\ta[ 0 ][ 0 ] = 1.0;\n\n\t\t\tfor ( let k = 1; k <= n; ++ k ) {\n\n\t\t\t\tlet d = 0.0;\n\t\t\t\tconst rk = r - k;\n\t\t\t\tconst pk = p - k;\n\n\t\t\t\tif ( r >= k ) {\n\n\t\t\t\t\ta[ s2 ][ 0 ] = a[ s1 ][ 0 ] / ndu[ pk + 1 ][ rk ];\n\t\t\t\t\td = a[ s2 ][ 0 ] * ndu[ rk ][ pk ];\n\n\t\t\t\t}\n\n\t\t\t\tconst j1 = ( rk >= - 1 ) ? 1 : - rk;\n\t\t\t\tconst j2 = ( r - 1 <= pk ) ? k - 1 : p - r;\n\n\t\t\t\tfor ( let j = j1; j <= j2; ++ j ) {\n\n\t\t\t\t\ta[ s2 ][ j ] = ( a[ s1 ][ j ] - a[ s1 ][ j - 1 ] ) / ndu[ pk + 1 ][ rk + j ];\n\t\t\t\t\td += a[ s2 ][ j ] * ndu[ rk + j ][ pk ];\n\n\t\t\t\t}\n\n\t\t\t\tif ( r <= pk ) {\n\n\t\t\t\t\ta[ s2 ][ k ] = - a[ s1 ][ k - 1 ] / ndu[ pk + 1 ][ r ];\n\t\t\t\t\td += a[ s2 ][ k ] * ndu[ r ][ pk ];\n\n\t\t\t\t}\n\n\t\t\t\tders[ k ][ r ] = d;\n\n\t\t\t\tconst j = s1;\n\t\t\t\ts1 = s2;\n\t\t\t\ts2 = j;\n\n\t\t\t}\n\n\t\t}\n\n\t\tlet r = p;\n\n\t\tfor ( let k = 1; k <= n; ++ k ) {\n\n\t\t\tfor ( let j = 0; j <= p; ++ j ) {\n\n\t\t\t\tders[ k ][ j ] *= r;\n\n\t\t\t}\n\n\t\t\tr *= p - k;\n\n\t\t}\n\n\t\treturn ders;\n\n\t}\n\n\n\t/*\n\t\tCalculate derivatives of a B-Spline. See The NURBS Book, page 93, algorithm A3.2.\n\n\t\tp  : degree\n\t\tU  : knot vector\n\t\tP  : control points\n\t\tu  : Parametric points\n\t\tnd : number of derivatives\n\n\t\treturns array[d+1] with derivatives\n\t\t*/\n\tstatic calcBSplineDerivatives( p, U, P, u, nd ) {\n\n\t\tconst du = nd < p ? nd : p;\n\t\tconst CK = [];\n\t\tconst span = this.findSpan( p, u, U );\n\t\tconst nders = this.calcBasisFunctionDerivatives( span, u, p, du, U );\n\t\tconst Pw = [];\n\n\t\tfor ( let i = 0; i < P.length; ++ i ) {\n\n\t\t\tconst point = P[ i ].clone();\n\t\t\tconst w = point.w;\n\n\t\t\tpoint.x *= w;\n\t\t\tpoint.y *= w;\n\t\t\tpoint.z *= w;\n\n\t\t\tPw[ i ] = point;\n\n\t\t}\n\n\t\tfor ( let k = 0; k <= du; ++ k ) {\n\n\t\t\tconst point = Pw[ span - p ].clone().multiplyScalar( nders[ k ][ 0 ] );\n\n\t\t\tfor ( let j = 1; j <= p; ++ j ) {\n\n\t\t\t\tpoint.add( Pw[ span - p + j ].clone().multiplyScalar( nders[ k ][ j ] ) );\n\n\t\t\t}\n\n\t\t\tCK[ k ] = point;\n\n\t\t}\n\n\t\tfor ( let k = du + 1; k <= nd + 1; ++ k ) {\n\n\t\t\tCK[ k ] = new Vector4( 0, 0, 0 );\n\n\t\t}\n\n\t\treturn CK;\n\n\t}\n\n\n\t/*\n\tCalculate \"K over I\"\n\n\treturns k!/(i!(k-i)!)\n\t*/\n\tstatic calcKoverI( k, i ) {\n\n\t\tlet nom = 1;\n\n\t\tfor ( let j = 2; j <= k; ++ j ) {\n\n\t\t\tnom *= j;\n\n\t\t}\n\n\t\tlet denom = 1;\n\n\t\tfor ( let j = 2; j <= i; ++ j ) {\n\n\t\t\tdenom *= j;\n\n\t\t}\n\n\t\tfor ( let j = 2; j <= k - i; ++ j ) {\n\n\t\t\tdenom *= j;\n\n\t\t}\n\n\t\treturn nom / denom;\n\n\t}\n\n\n\t/*\n\tCalculate derivatives (0-nd) of rational curve. See The NURBS Book, page 127, algorithm A4.2.\n\n\tPders : result of function calcBSplineDerivatives\n\n\treturns array with derivatives for rational curve.\n\t*/\n\tstatic calcRationalCurveDerivatives( Pders ) {\n\n\t\tconst nd = Pders.length;\n\t\tconst Aders = [];\n\t\tconst wders = [];\n\n\t\tfor ( let i = 0; i < nd; ++ i ) {\n\n\t\t\tconst point = Pders[ i ];\n\t\t\tAders[ i ] = new Vector3( point.x, point.y, point.z );\n\t\t\twders[ i ] = point.w;\n\n\t\t}\n\n\t\tconst CK = [];\n\n\t\tfor ( let k = 0; k < nd; ++ k ) {\n\n\t\t\tconst v = Aders[ k ].clone();\n\n\t\t\tfor ( let i = 1; i <= k; ++ i ) {\n\n\t\t\t\tv.sub( CK[ k - i ].clone().multiplyScalar( this.calcKoverI( k, i ) * wders[ i ] ) );\n\n\t\t\t}\n\n\t\t\tCK[ k ] = v.divideScalar( wders[ 0 ] );\n\n\t\t}\n\n\t\treturn CK;\n\n\t}\n\n\n\t/*\n\tCalculate NURBS curve derivatives. See The NURBS Book, page 127, algorithm A4.2.\n\n\tp  : degree\n\tU  : knot vector\n\tP  : control points in homogeneous space\n\tu  : parametric points\n\tnd : number of derivatives\n\n\treturns array with derivatives.\n\t*/\n\tstatic calcNURBSDerivatives( p, U, P, u, nd ) {\n\n\t\tconst Pders = this.calcBSplineDerivatives( p, U, P, u, nd );\n\t\treturn this.calcRationalCurveDerivatives( Pders );\n\n\t}\n\n\n\t/*\n\tCalculate rational B-Spline surface point. See The NURBS Book, page 134, algorithm A4.3.\n\n\tp1, p2 : degrees of B-Spline surface\n\tU1, U2 : knot vectors\n\tP      : control points (x, y, z, w)\n\tu, v   : parametric values\n\n\treturns point for given (u, v)\n\t*/\n\tstatic calcSurfacePoint( p, q, U, V, P, u, v, target ) {\n\n\t\tconst uspan = this.findSpan( p, u, U );\n\t\tconst vspan = this.findSpan( q, v, V );\n\t\tconst Nu = this.calcBasisFunctions( uspan, u, p, U );\n\t\tconst Nv = this.calcBasisFunctions( vspan, v, q, V );\n\t\tconst temp = [];\n\n\t\tfor ( let l = 0; l <= q; ++ l ) {\n\n\t\t\ttemp[ l ] = new Vector4( 0, 0, 0, 0 );\n\t\t\tfor ( let k = 0; k <= p; ++ k ) {\n\n\t\t\t\tconst point = P[ uspan - p + k ][ vspan - q + l ].clone();\n\t\t\t\tconst w = point.w;\n\t\t\t\tpoint.x *= w;\n\t\t\t\tpoint.y *= w;\n\t\t\t\tpoint.z *= w;\n\t\t\t\ttemp[ l ].add( point.multiplyScalar( Nu[ k ] ) );\n\n\t\t\t}\n\n\t\t}\n\n\t\tconst Sw = new Vector4( 0, 0, 0, 0 );\n\t\tfor ( let l = 0; l <= q; ++ l ) {\n\n\t\t\tSw.add( temp[ l ].multiplyScalar( Nv[ l ] ) );\n\n\t\t}\n\n\t\tSw.divideScalar( Sw.w );\n\t\ttarget.set( Sw.x, Sw.y, Sw.z );\n\n\t}\n\n}\n\nexport { NURBSUtils };\n","import {\n\tCurve,\n\tVector3,\n\tVector4\n} from 'three';\nimport { NURBSUtils } from '../curves/NURBSUtils.js';\n\n/**\n * NURBS curve object\n *\n * Derives from Curve, overriding getPoint and getTangent.\n *\n * Implementation is based on (x, y [, z=0 [, w=1]]) control points with w=weight.\n *\n **/\n\nclass NURBSCurve extends Curve {\n\n\tconstructor(\n\t\tdegree,\n\t\tknots /* array of reals */,\n\t\tcontrolPoints /* array of Vector(2|3|4) */,\n\t\tstartKnot /* index in knots */,\n\t\tendKnot /* index in knots */\n\t) {\n\n\t\tsuper();\n\n\t\tthis.degree = degree;\n\t\tthis.knots = knots;\n\t\tthis.controlPoints = [];\n\t\t// Used by periodic NURBS to remove hidden spans\n\t\tthis.startKnot = startKnot || 0;\n\t\tthis.endKnot = endKnot || ( this.knots.length - 1 );\n\n\t\tfor ( let i = 0; i < controlPoints.length; ++ i ) {\n\n\t\t\t// ensure Vector4 for control points\n\t\t\tconst point = controlPoints[ i ];\n\t\t\tthis.controlPoints[ i ] = new Vector4( point.x, point.y, point.z, point.w );\n\n\t\t}\n\n\t}\n\n\tgetPoint( t, optionalTarget = new Vector3() ) {\n\n\t\tconst point = optionalTarget;\n\n\t\tconst u = this.knots[ this.startKnot ] + t * ( this.knots[ this.endKnot ] - this.knots[ this.startKnot ] ); // linear mapping t->u\n\n\t\t// following results in (wx, wy, wz, w) homogeneous point\n\t\tconst hpoint = NURBSUtils.calcBSplinePoint( this.degree, this.knots, this.controlPoints, u );\n\n\t\tif ( hpoint.w !== 1.0 ) {\n\n\t\t\t// project to 3D space: (wx, wy, wz, w) -> (x, y, z, 1)\n\t\t\thpoint.divideScalar( hpoint.w );\n\n\t\t}\n\n\t\treturn point.set( hpoint.x, hpoint.y, hpoint.z );\n\n\t}\n\n\tgetTangent( t, optionalTarget = new Vector3() ) {\n\n\t\tconst tangent = optionalTarget;\n\n\t\tconst u = this.knots[ 0 ] + t * ( this.knots[ this.knots.length - 1 ] - this.knots[ 0 ] );\n\t\tconst ders = NURBSUtils.calcNURBSDerivatives( this.degree, this.knots, this.controlPoints, u, 1 );\n\t\ttangent.copy( ders[ 1 ] ).normalize();\n\n\t\treturn tangent;\n\n\t}\n\n}\n\nexport { NURBSCurve };\n","import {\n\tAmbientLight,\n\tAnimationClip,\n\tBone,\n\tBufferAttribute,\n\tBufferGeometry,\n\tClampToEdgeWrapping,\n\tColor,\n\tDirectionalLight,\n\tEquirectangularReflectionMapping,\n\tEuler,\n\tFileLoader,\n\tFloat32BufferAttribute,\n\tGroup,\n\tLine,\n\tLineBasicMaterial,\n\tLoader,\n\tLoaderUtils,\n\tMathUtils,\n\tMatrix3,\n\tMatrix4,\n\tMesh,\n\tMeshLambertMaterial,\n\tMeshPhongMaterial,\n\tNumberKeyframeTrack,\n\tObject3D,\n\tOrthographicCamera,\n\tPerspectiveCamera,\n\tPointLight,\n\tPropertyBinding,\n\tQuaternion,\n\tQuaternionKeyframeTrack,\n\tRepeatWrapping,\n\tSkeleton,\n\tSkinnedMesh,\n\tSpotLight,\n\tTexture,\n\tTextureLoader,\n\tUint16BufferAttribute,\n\tVector3,\n\tVector4,\n\tVectorKeyframeTrack,\n\tsRGBEncoding\n} from 'three';\nimport * as fflate from '../libs/fflate.module.js';\nimport { NURBSCurve } from '../curves/NURBSCurve.js';\n\n/**\n * Loader loads FBX file and generates Group representing FBX scene.\n * Requires FBX file to be >= 7.0 and in ASCII or >= 6400 in Binary format\n * Versions lower than this may load but will probably have errors\n *\n * Needs Support:\n *  Morph normals / blend shape normals\n *\n * FBX format references:\n * \thttps://wiki.blender.org/index.php/User:Mont29/Foundation/FBX_File_Structure\n * \thttp://help.autodesk.com/view/FBX/2017/ENU/?guid=__cpp_ref_index_html (C++ SDK reference)\n *\n * \tBinary format specification:\n *\t\thttps://code.blender.org/2013/08/fbx-binary-file-format-specification/\n */\n\n\nlet fbxTree;\nlet connections;\nlet sceneGraph;\n\nclass FBXLoader extends Loader {\n\n\tconstructor( manager ) {\n\n\t\tsuper( manager );\n\n\t}\n\n\tload( url, onLoad, onProgress, onError ) {\n\n\t\tconst scope = this;\n\n\t\tconst path = ( scope.path === '' ) ? LoaderUtils.extractUrlBase( url ) : scope.path;\n\n\t\tconst loader = new FileLoader( this.manager );\n\t\tloader.setPath( scope.path );\n\t\tloader.setResponseType( 'arraybuffer' );\n\t\tloader.setRequestHeader( scope.requestHeader );\n\t\tloader.setWithCredentials( scope.withCredentials );\n\n\t\tloader.load( url, function ( buffer ) {\n\n\t\t\ttry {\n\n\t\t\t\tonLoad( scope.parse( buffer, path ) );\n\n\t\t\t} catch ( e ) {\n\n\t\t\t\tif ( onError ) {\n\n\t\t\t\t\tonError( e );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tconsole.error( e );\n\n\t\t\t\t}\n\n\t\t\t\tscope.manager.itemError( url );\n\n\t\t\t}\n\n\t\t}, onProgress, onError );\n\n\t}\n\n\tparse( FBXBuffer, path ) {\n\n\t\tif ( isFbxFormatBinary( FBXBuffer ) ) {\n\n\t\t\tfbxTree = new BinaryParser().parse( FBXBuffer );\n\n\t\t} else {\n\n\t\t\tconst FBXText = convertArrayBufferToString( FBXBuffer );\n\n\t\t\tif ( ! isFbxFormatASCII( FBXText ) ) {\n\n\t\t\t\tthrow new Error( 'THREE.FBXLoader: Unknown format.' );\n\n\t\t\t}\n\n\t\t\tif ( getFbxVersion( FBXText ) < 7000 ) {\n\n\t\t\t\tthrow new Error( 'THREE.FBXLoader: FBX version not supported, FileVersion: ' + getFbxVersion( FBXText ) );\n\n\t\t\t}\n\n\t\t\tfbxTree = new TextParser().parse( FBXText );\n\n\t\t}\n\n\t\t// console.log( fbxTree );\n\n\t\tconst textureLoader = new TextureLoader( this.manager ).setPath( this.resourcePath || path ).setCrossOrigin( this.crossOrigin );\n\n\t\treturn new FBXTreeParser( textureLoader, this.manager ).parse( fbxTree );\n\n\t}\n\n}\n\n// Parse the FBXTree object returned by the BinaryParser or TextParser and return a Group\nclass FBXTreeParser {\n\n\tconstructor( textureLoader, manager ) {\n\n\t\tthis.textureLoader = textureLoader;\n\t\tthis.manager = manager;\n\n\t}\n\n\tparse() {\n\n\t\tconnections = this.parseConnections();\n\n\t\tconst images = this.parseImages();\n\t\tconst textures = this.parseTextures( images );\n\t\tconst materials = this.parseMaterials( textures );\n\t\tconst deformers = this.parseDeformers();\n\t\tconst geometryMap = new GeometryParser().parse( deformers );\n\n\t\tthis.parseScene( deformers, geometryMap, materials );\n\n\t\treturn sceneGraph;\n\n\t}\n\n\t// Parses FBXTree.Connections which holds parent-child connections between objects (e.g. material -> texture, model->geometry )\n\t// and details the connection type\n\tparseConnections() {\n\n\t\tconst connectionMap = new Map();\n\n\t\tif ( 'Connections' in fbxTree ) {\n\n\t\t\tconst rawConnections = fbxTree.Connections.connections;\n\n\t\t\trawConnections.forEach( function ( rawConnection ) {\n\n\t\t\t\tconst fromID = rawConnection[ 0 ];\n\t\t\t\tconst toID = rawConnection[ 1 ];\n\t\t\t\tconst relationship = rawConnection[ 2 ];\n\n\t\t\t\tif ( ! connectionMap.has( fromID ) ) {\n\n\t\t\t\t\tconnectionMap.set( fromID, {\n\t\t\t\t\t\tparents: [],\n\t\t\t\t\t\tchildren: []\n\t\t\t\t\t} );\n\n\t\t\t\t}\n\n\t\t\t\tconst parentRelationship = { ID: toID, relationship: relationship };\n\t\t\t\tconnectionMap.get( fromID ).parents.push( parentRelationship );\n\n\t\t\t\tif ( ! connectionMap.has( toID ) ) {\n\n\t\t\t\t\tconnectionMap.set( toID, {\n\t\t\t\t\t\tparents: [],\n\t\t\t\t\t\tchildren: []\n\t\t\t\t\t} );\n\n\t\t\t\t}\n\n\t\t\t\tconst childRelationship = { ID: fromID, relationship: relationship };\n\t\t\t\tconnectionMap.get( toID ).children.push( childRelationship );\n\n\t\t\t} );\n\n\t\t}\n\n\t\treturn connectionMap;\n\n\t}\n\n\t// Parse FBXTree.Objects.Video for embedded image data\n\t// These images are connected to textures in FBXTree.Objects.Textures\n\t// via FBXTree.Connections.\n\tparseImages() {\n\n\t\tconst images = {};\n\t\tconst blobs = {};\n\n\t\tif ( 'Video' in fbxTree.Objects ) {\n\n\t\t\tconst videoNodes = fbxTree.Objects.Video;\n\n\t\t\tfor ( const nodeID in videoNodes ) {\n\n\t\t\t\tconst videoNode = videoNodes[ nodeID ];\n\n\t\t\t\tconst id = parseInt( nodeID );\n\n\t\t\t\timages[ id ] = videoNode.RelativeFilename || videoNode.Filename;\n\n\t\t\t\t// raw image data is in videoNode.Content\n\t\t\t\tif ( 'Content' in videoNode ) {\n\n\t\t\t\t\tconst arrayBufferContent = ( videoNode.Content instanceof ArrayBuffer ) && ( videoNode.Content.byteLength > 0 );\n\t\t\t\t\tconst base64Content = ( typeof videoNode.Content === 'string' ) && ( videoNode.Content !== '' );\n\n\t\t\t\t\tif ( arrayBufferContent || base64Content ) {\n\n\t\t\t\t\t\tconst image = this.parseImage( videoNodes[ nodeID ] );\n\n\t\t\t\t\t\tblobs[ videoNode.RelativeFilename || videoNode.Filename ] = image;\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\tfor ( const id in images ) {\n\n\t\t\tconst filename = images[ id ];\n\n\t\t\tif ( blobs[ filename ] !== undefined ) images[ id ] = blobs[ filename ];\n\t\t\telse images[ id ] = images[ id ].split( '\\\\' ).pop();\n\n\t\t}\n\n\t\treturn images;\n\n\t}\n\n\t// Parse embedded image data in FBXTree.Video.Content\n\tparseImage( videoNode ) {\n\n\t\tconst content = videoNode.Content;\n\t\tconst fileName = videoNode.RelativeFilename || videoNode.Filename;\n\t\tconst extension = fileName.slice( fileName.lastIndexOf( '.' ) + 1 ).toLowerCase();\n\n\t\tlet type;\n\n\t\tswitch ( extension ) {\n\n\t\t\tcase 'bmp':\n\n\t\t\t\ttype = 'image/bmp';\n\t\t\t\tbreak;\n\n\t\t\tcase 'jpg':\n\t\t\tcase 'jpeg':\n\n\t\t\t\ttype = 'image/jpeg';\n\t\t\t\tbreak;\n\n\t\t\tcase 'png':\n\n\t\t\t\ttype = 'image/png';\n\t\t\t\tbreak;\n\n\t\t\tcase 'tif':\n\n\t\t\t\ttype = 'image/tiff';\n\t\t\t\tbreak;\n\n\t\t\tcase 'tga':\n\n\t\t\t\tif ( this.manager.getHandler( '.tga' ) === null ) {\n\n\t\t\t\t\tconsole.warn( 'FBXLoader: TGA loader not found, skipping ', fileName );\n\n\t\t\t\t}\n\n\t\t\t\ttype = 'image/tga';\n\t\t\t\tbreak;\n\n\t\t\tdefault:\n\n\t\t\t\tconsole.warn( 'FBXLoader: Image type \"' + extension + '\" is not supported.' );\n\t\t\t\treturn;\n\n\t\t}\n\n\t\tif ( typeof content === 'string' ) { // ASCII format\n\n\t\t\treturn 'data:' + type + ';base64,' + content;\n\n\t\t} else { // Binary Format\n\n\t\t\tconst array = new Uint8Array( content );\n\t\t\treturn window.URL.createObjectURL( new Blob( [ array ], { type: type } ) );\n\n\t\t}\n\n\t}\n\n\t// Parse nodes in FBXTree.Objects.Texture\n\t// These contain details such as UV scaling, cropping, rotation etc and are connected\n\t// to images in FBXTree.Objects.Video\n\tparseTextures( images ) {\n\n\t\tconst textureMap = new Map();\n\n\t\tif ( 'Texture' in fbxTree.Objects ) {\n\n\t\t\tconst textureNodes = fbxTree.Objects.Texture;\n\t\t\tfor ( const nodeID in textureNodes ) {\n\n\t\t\t\tconst texture = this.parseTexture( textureNodes[ nodeID ], images );\n\t\t\t\ttextureMap.set( parseInt( nodeID ), texture );\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn textureMap;\n\n\t}\n\n\t// Parse individual node in FBXTree.Objects.Texture\n\tparseTexture( textureNode, images ) {\n\n\t\tconst texture = this.loadTexture( textureNode, images );\n\n\t\ttexture.ID = textureNode.id;\n\n\t\ttexture.name = textureNode.attrName;\n\n\t\tconst wrapModeU = textureNode.WrapModeU;\n\t\tconst wrapModeV = textureNode.WrapModeV;\n\n\t\tconst valueU = wrapModeU !== undefined ? wrapModeU.value : 0;\n\t\tconst valueV = wrapModeV !== undefined ? wrapModeV.value : 0;\n\n\t\t// http://download.autodesk.com/us/fbx/SDKdocs/FBX_SDK_Help/files/fbxsdkref/class_k_fbx_texture.html#889640e63e2e681259ea81061b85143a\n\t\t// 0: repeat(default), 1: clamp\n\n\t\ttexture.wrapS = valueU === 0 ? RepeatWrapping : ClampToEdgeWrapping;\n\t\ttexture.wrapT = valueV === 0 ? RepeatWrapping : ClampToEdgeWrapping;\n\n\t\tif ( 'Scaling' in textureNode ) {\n\n\t\t\tconst values = textureNode.Scaling.value;\n\n\t\t\ttexture.repeat.x = values[ 0 ];\n\t\t\ttexture.repeat.y = values[ 1 ];\n\n\t\t}\n\n\t\treturn texture;\n\n\t}\n\n\t// load a texture specified as a blob or data URI, or via an external URL using TextureLoader\n\tloadTexture( textureNode, images ) {\n\n\t\tlet fileName;\n\n\t\tconst currentPath = this.textureLoader.path;\n\n\t\tconst children = connections.get( textureNode.id ).children;\n\n\t\tif ( children !== undefined && children.length > 0 && images[ children[ 0 ].ID ] !== undefined ) {\n\n\t\t\tfileName = images[ children[ 0 ].ID ];\n\n\t\t\tif ( fileName.indexOf( 'blob:' ) === 0 || fileName.indexOf( 'data:' ) === 0 ) {\n\n\t\t\t\tthis.textureLoader.setPath( undefined );\n\n\t\t\t}\n\n\t\t}\n\n\t\tlet texture;\n\n\t\tconst extension = textureNode.FileName.slice( - 3 ).toLowerCase();\n\n\t\tif ( extension === 'tga' ) {\n\n\t\t\tconst loader = this.manager.getHandler( '.tga' );\n\n\t\t\tif ( loader === null ) {\n\n\t\t\t\tconsole.warn( 'FBXLoader: TGA loader not found, creating placeholder texture for', textureNode.RelativeFilename );\n\t\t\t\ttexture = new Texture();\n\n\t\t\t} else {\n\n\t\t\t\tloader.setPath( this.textureLoader.path );\n\t\t\t\ttexture = loader.load( fileName );\n\n\t\t\t}\n\n\t\t} else if ( extension === 'psd' ) {\n\n\t\t\tconsole.warn( 'FBXLoader: PSD textures are not supported, creating placeholder texture for', textureNode.RelativeFilename );\n\t\t\ttexture = new Texture();\n\n\t\t} else {\n\n\t\t\ttexture = this.textureLoader.load( fileName );\n\n\t\t}\n\n\t\tthis.textureLoader.setPath( currentPath );\n\n\t\treturn texture;\n\n\t}\n\n\t// Parse nodes in FBXTree.Objects.Material\n\tparseMaterials( textureMap ) {\n\n\t\tconst materialMap = new Map();\n\n\t\tif ( 'Material' in fbxTree.Objects ) {\n\n\t\t\tconst materialNodes = fbxTree.Objects.Material;\n\n\t\t\tfor ( const nodeID in materialNodes ) {\n\n\t\t\t\tconst material = this.parseMaterial( materialNodes[ nodeID ], textureMap );\n\n\t\t\t\tif ( material !== null ) materialMap.set( parseInt( nodeID ), material );\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn materialMap;\n\n\t}\n\n\t// Parse single node in FBXTree.Objects.Material\n\t// Materials are connected to texture maps in FBXTree.Objects.Textures\n\t// FBX format currently only supports Lambert and Phong shading models\n\tparseMaterial( materialNode, textureMap ) {\n\n\t\tconst ID = materialNode.id;\n\t\tconst name = materialNode.attrName;\n\t\tlet type = materialNode.ShadingModel;\n\n\t\t// Case where FBX wraps shading model in property object.\n\t\tif ( typeof type === 'object' ) {\n\n\t\t\ttype = type.value;\n\n\t\t}\n\n\t\t// Ignore unused materials which don't have any connections.\n\t\tif ( ! connections.has( ID ) ) return null;\n\n\t\tconst parameters = this.parseParameters( materialNode, textureMap, ID );\n\n\t\tlet material;\n\n\t\tswitch ( type.toLowerCase() ) {\n\n\t\t\tcase 'phong':\n\t\t\t\tmaterial = new MeshPhongMaterial();\n\t\t\t\tbreak;\n\t\t\tcase 'lambert':\n\t\t\t\tmaterial = new MeshLambertMaterial();\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tconsole.warn( 'THREE.FBXLoader: unknown material type \"%s\". Defaulting to MeshPhongMaterial.', type );\n\t\t\t\tmaterial = new MeshPhongMaterial();\n\t\t\t\tbreak;\n\n\t\t}\n\n\t\tmaterial.setValues( parameters );\n\t\tmaterial.name = name;\n\n\t\treturn material;\n\n\t}\n\n\t// Parse FBX material and return parameters suitable for a three.js material\n\t// Also parse the texture map and return any textures associated with the material\n\tparseParameters( materialNode, textureMap, ID ) {\n\n\t\tconst parameters = {};\n\n\t\tif ( materialNode.BumpFactor ) {\n\n\t\t\tparameters.bumpScale = materialNode.BumpFactor.value;\n\n\t\t}\n\n\t\tif ( materialNode.Diffuse ) {\n\n\t\t\tparameters.color = new Color().fromArray( materialNode.Diffuse.value );\n\n\t\t} else if ( materialNode.DiffuseColor && ( materialNode.DiffuseColor.type === 'Color' || materialNode.DiffuseColor.type === 'ColorRGB' ) ) {\n\n\t\t\t// The blender exporter exports diffuse here instead of in materialNode.Diffuse\n\t\t\tparameters.color = new Color().fromArray( materialNode.DiffuseColor.value );\n\n\t\t}\n\n\t\tif ( materialNode.DisplacementFactor ) {\n\n\t\t\tparameters.displacementScale = materialNode.DisplacementFactor.value;\n\n\t\t}\n\n\t\tif ( materialNode.Emissive ) {\n\n\t\t\tparameters.emissive = new Color().fromArray( materialNode.Emissive.value );\n\n\t\t} else if ( materialNode.EmissiveColor && ( materialNode.EmissiveColor.type === 'Color' || materialNode.EmissiveColor.type === 'ColorRGB' ) ) {\n\n\t\t\t// The blender exporter exports emissive color here instead of in materialNode.Emissive\n\t\t\tparameters.emissive = new Color().fromArray( materialNode.EmissiveColor.value );\n\n\t\t}\n\n\t\tif ( materialNode.EmissiveFactor ) {\n\n\t\t\tparameters.emissiveIntensity = parseFloat( materialNode.EmissiveFactor.value );\n\n\t\t}\n\n\t\tif ( materialNode.Opacity ) {\n\n\t\t\tparameters.opacity = parseFloat( materialNode.Opacity.value );\n\n\t\t}\n\n\t\tif ( parameters.opacity < 1.0 ) {\n\n\t\t\tparameters.transparent = true;\n\n\t\t}\n\n\t\tif ( materialNode.ReflectionFactor ) {\n\n\t\t\tparameters.reflectivity = materialNode.ReflectionFactor.value;\n\n\t\t}\n\n\t\tif ( materialNode.Shininess ) {\n\n\t\t\tparameters.shininess = materialNode.Shininess.value;\n\n\t\t}\n\n\t\tif ( materialNode.Specular ) {\n\n\t\t\tparameters.specular = new Color().fromArray( materialNode.Specular.value );\n\n\t\t} else if ( materialNode.SpecularColor && materialNode.SpecularColor.type === 'Color' ) {\n\n\t\t\t// The blender exporter exports specular color here instead of in materialNode.Specular\n\t\t\tparameters.specular = new Color().fromArray( materialNode.SpecularColor.value );\n\n\t\t}\n\n\t\tconst scope = this;\n\t\tconnections.get( ID ).children.forEach( function ( child ) {\n\n\t\t\tconst type = child.relationship;\n\n\t\t\tswitch ( type ) {\n\n\t\t\t\tcase 'Bump':\n\t\t\t\t\tparameters.bumpMap = scope.getTexture( textureMap, child.ID );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'Maya|TEX_ao_map':\n\t\t\t\t\tparameters.aoMap = scope.getTexture( textureMap, child.ID );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'DiffuseColor':\n\t\t\t\tcase 'Maya|TEX_color_map':\n\t\t\t\t\tparameters.map = scope.getTexture( textureMap, child.ID );\n\t\t\t\t\tparameters.map.encoding = sRGBEncoding;\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'DisplacementColor':\n\t\t\t\t\tparameters.displacementMap = scope.getTexture( textureMap, child.ID );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'EmissiveColor':\n\t\t\t\t\tparameters.emissiveMap = scope.getTexture( textureMap, child.ID );\n\t\t\t\t\tparameters.emissiveMap.encoding = sRGBEncoding;\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'NormalMap':\n\t\t\t\tcase 'Maya|TEX_normal_map':\n\t\t\t\t\tparameters.normalMap = scope.getTexture( textureMap, child.ID );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'ReflectionColor':\n\t\t\t\t\tparameters.envMap = scope.getTexture( textureMap, child.ID );\n\t\t\t\t\tparameters.envMap.mapping = EquirectangularReflectionMapping;\n\t\t\t\t\tparameters.envMap.encoding = sRGBEncoding;\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'SpecularColor':\n\t\t\t\t\tparameters.specularMap = scope.getTexture( textureMap, child.ID );\n\t\t\t\t\tparameters.specularMap.encoding = sRGBEncoding;\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'TransparentColor':\n\t\t\t\tcase 'TransparencyFactor':\n\t\t\t\t\tparameters.alphaMap = scope.getTexture( textureMap, child.ID );\n\t\t\t\t\tparameters.transparent = true;\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'AmbientColor':\n\t\t\t\tcase 'ShininessExponent': // AKA glossiness map\n\t\t\t\tcase 'SpecularFactor': // AKA specularLevel\n\t\t\t\tcase 'VectorDisplacementColor': // NOTE: Seems to be a copy of DisplacementColor\n\t\t\t\tdefault:\n\t\t\t\t\tconsole.warn( 'THREE.FBXLoader: %s map is not supported in three.js, skipping texture.', type );\n\t\t\t\t\tbreak;\n\n\t\t\t}\n\n\t\t} );\n\n\t\treturn parameters;\n\n\t}\n\n\t// get a texture from the textureMap for use by a material.\n\tgetTexture( textureMap, id ) {\n\n\t\t// if the texture is a layered texture, just use the first layer and issue a warning\n\t\tif ( 'LayeredTexture' in fbxTree.Objects && id in fbxTree.Objects.LayeredTexture ) {\n\n\t\t\tconsole.warn( 'THREE.FBXLoader: layered textures are not supported in three.js. Discarding all but first layer.' );\n\t\t\tid = connections.get( id ).children[ 0 ].ID;\n\n\t\t}\n\n\t\treturn textureMap.get( id );\n\n\t}\n\n\t// Parse nodes in FBXTree.Objects.Deformer\n\t// Deformer node can contain skinning or Vertex Cache animation data, however only skinning is supported here\n\t// Generates map of Skeleton-like objects for use later when generating and binding skeletons.\n\tparseDeformers() {\n\n\t\tconst skeletons = {};\n\t\tconst morphTargets = {};\n\n\t\tif ( 'Deformer' in fbxTree.Objects ) {\n\n\t\t\tconst DeformerNodes = fbxTree.Objects.Deformer;\n\n\t\t\tfor ( const nodeID in DeformerNodes ) {\n\n\t\t\t\tconst deformerNode = DeformerNodes[ nodeID ];\n\n\t\t\t\tconst relationships = connections.get( parseInt( nodeID ) );\n\n\t\t\t\tif ( deformerNode.attrType === 'Skin' ) {\n\n\t\t\t\t\tconst skeleton = this.parseSkeleton( relationships, DeformerNodes );\n\t\t\t\t\tskeleton.ID = nodeID;\n\n\t\t\t\t\tif ( relationships.parents.length > 1 ) console.warn( 'THREE.FBXLoader: skeleton attached to more than one geometry is not supported.' );\n\t\t\t\t\tskeleton.geometryID = relationships.parents[ 0 ].ID;\n\n\t\t\t\t\tskeletons[ nodeID ] = skeleton;\n\n\t\t\t\t} else if ( deformerNode.attrType === 'BlendShape' ) {\n\n\t\t\t\t\tconst morphTarget = {\n\t\t\t\t\t\tid: nodeID,\n\t\t\t\t\t};\n\n\t\t\t\t\tmorphTarget.rawTargets = this.parseMorphTargets( relationships, DeformerNodes );\n\t\t\t\t\tmorphTarget.id = nodeID;\n\n\t\t\t\t\tif ( relationships.parents.length > 1 ) console.warn( 'THREE.FBXLoader: morph target attached to more than one geometry is not supported.' );\n\n\t\t\t\t\tmorphTargets[ nodeID ] = morphTarget;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn {\n\n\t\t\tskeletons: skeletons,\n\t\t\tmorphTargets: morphTargets,\n\n\t\t};\n\n\t}\n\n\t// Parse single nodes in FBXTree.Objects.Deformer\n\t// The top level skeleton node has type 'Skin' and sub nodes have type 'Cluster'\n\t// Each skin node represents a skeleton and each cluster node represents a bone\n\tparseSkeleton( relationships, deformerNodes ) {\n\n\t\tconst rawBones = [];\n\n\t\trelationships.children.forEach( function ( child ) {\n\n\t\t\tconst boneNode = deformerNodes[ child.ID ];\n\n\t\t\tif ( boneNode.attrType !== 'Cluster' ) return;\n\n\t\t\tconst rawBone = {\n\n\t\t\t\tID: child.ID,\n\t\t\t\tindices: [],\n\t\t\t\tweights: [],\n\t\t\t\ttransformLink: new Matrix4().fromArray( boneNode.TransformLink.a ),\n\t\t\t\t// transform: new Matrix4().fromArray( boneNode.Transform.a ),\n\t\t\t\t// linkMode: boneNode.Mode,\n\n\t\t\t};\n\n\t\t\tif ( 'Indexes' in boneNode ) {\n\n\t\t\t\trawBone.indices = boneNode.Indexes.a;\n\t\t\t\trawBone.weights = boneNode.Weights.a;\n\n\t\t\t}\n\n\t\t\trawBones.push( rawBone );\n\n\t\t} );\n\n\t\treturn {\n\n\t\t\trawBones: rawBones,\n\t\t\tbones: []\n\n\t\t};\n\n\t}\n\n\t// The top level morph deformer node has type \"BlendShape\" and sub nodes have type \"BlendShapeChannel\"\n\tparseMorphTargets( relationships, deformerNodes ) {\n\n\t\tconst rawMorphTargets = [];\n\n\t\tfor ( let i = 0; i < relationships.children.length; i ++ ) {\n\n\t\t\tconst child = relationships.children[ i ];\n\n\t\t\tconst morphTargetNode = deformerNodes[ child.ID ];\n\n\t\t\tconst rawMorphTarget = {\n\n\t\t\t\tname: morphTargetNode.attrName,\n\t\t\t\tinitialWeight: morphTargetNode.DeformPercent,\n\t\t\t\tid: morphTargetNode.id,\n\t\t\t\tfullWeights: morphTargetNode.FullWeights.a\n\n\t\t\t};\n\n\t\t\tif ( morphTargetNode.attrType !== 'BlendShapeChannel' ) return;\n\n\t\t\trawMorphTarget.geoID = connections.get( parseInt( child.ID ) ).children.filter( function ( child ) {\n\n\t\t\t\treturn child.relationship === undefined;\n\n\t\t\t} )[ 0 ].ID;\n\n\t\t\trawMorphTargets.push( rawMorphTarget );\n\n\t\t}\n\n\t\treturn rawMorphTargets;\n\n\t}\n\n\t// create the main Group() to be returned by the loader\n\tparseScene( deformers, geometryMap, materialMap ) {\n\n\t\tsceneGraph = new Group();\n\n\t\tconst modelMap = this.parseModels( deformers.skeletons, geometryMap, materialMap );\n\n\t\tconst modelNodes = fbxTree.Objects.Model;\n\n\t\tconst scope = this;\n\t\tmodelMap.forEach( function ( model ) {\n\n\t\t\tconst modelNode = modelNodes[ model.ID ];\n\t\t\tscope.setLookAtProperties( model, modelNode );\n\n\t\t\tconst parentConnections = connections.get( model.ID ).parents;\n\n\t\t\tparentConnections.forEach( function ( connection ) {\n\n\t\t\t\tconst parent = modelMap.get( connection.ID );\n\t\t\t\tif ( parent !== undefined ) parent.add( model );\n\n\t\t\t} );\n\n\t\t\tif ( model.parent === null ) {\n\n\t\t\t\tsceneGraph.add( model );\n\n\t\t\t}\n\n\n\t\t} );\n\n\t\tthis.bindSkeleton( deformers.skeletons, geometryMap, modelMap );\n\n\t\tthis.createAmbientLight();\n\n\t\tthis.setupMorphMaterials();\n\n\t\tsceneGraph.traverse( function ( node ) {\n\n\t\t\tif ( node.userData.transformData ) {\n\n\t\t\t\tif ( node.parent ) {\n\n\t\t\t\t\tnode.userData.transformData.parentMatrix = node.parent.matrix;\n\t\t\t\t\tnode.userData.transformData.parentMatrixWorld = node.parent.matrixWorld;\n\n\t\t\t\t}\n\n\t\t\t\tconst transform = generateTransform( node.userData.transformData );\n\n\t\t\t\tnode.applyMatrix4( transform );\n\t\t\t\tnode.updateWorldMatrix();\n\n\t\t\t}\n\n\t\t} );\n\n\t\tconst animations = new AnimationParser().parse();\n\n\t\t// if all the models where already combined in a single group, just return that\n\t\tif ( sceneGraph.children.length === 1 && sceneGraph.children[ 0 ].isGroup ) {\n\n\t\t\tsceneGraph.children[ 0 ].animations = animations;\n\t\t\tsceneGraph = sceneGraph.children[ 0 ];\n\n\t\t}\n\n\t\tsceneGraph.animations = animations;\n\n\t}\n\n\t// parse nodes in FBXTree.Objects.Model\n\tparseModels( skeletons, geometryMap, materialMap ) {\n\n\t\tconst modelMap = new Map();\n\t\tconst modelNodes = fbxTree.Objects.Model;\n\n\t\tfor ( const nodeID in modelNodes ) {\n\n\t\t\tconst id = parseInt( nodeID );\n\t\t\tconst node = modelNodes[ nodeID ];\n\t\t\tconst relationships = connections.get( id );\n\n\t\t\tlet model = this.buildSkeleton( relationships, skeletons, id, node.attrName );\n\n\t\t\tif ( ! model ) {\n\n\t\t\t\tswitch ( node.attrType ) {\n\n\t\t\t\t\tcase 'Camera':\n\t\t\t\t\t\tmodel = this.createCamera( relationships );\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'Light':\n\t\t\t\t\t\tmodel = this.createLight( relationships );\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'Mesh':\n\t\t\t\t\t\tmodel = this.createMesh( relationships, geometryMap, materialMap );\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'NurbsCurve':\n\t\t\t\t\t\tmodel = this.createCurve( relationships, geometryMap );\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'LimbNode':\n\t\t\t\t\tcase 'Root':\n\t\t\t\t\t\tmodel = new Bone();\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'Null':\n\t\t\t\t\tdefault:\n\t\t\t\t\t\tmodel = new Group();\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t}\n\n\t\t\t\tmodel.name = node.attrName ? PropertyBinding.sanitizeNodeName( node.attrName ) : '';\n\n\t\t\t\tmodel.ID = id;\n\n\t\t\t}\n\n\t\t\tthis.getTransformData( model, node );\n\t\t\tmodelMap.set( id, model );\n\n\t\t}\n\n\t\treturn modelMap;\n\n\t}\n\n\tbuildSkeleton( relationships, skeletons, id, name ) {\n\n\t\tlet bone = null;\n\n\t\trelationships.parents.forEach( function ( parent ) {\n\n\t\t\tfor ( const ID in skeletons ) {\n\n\t\t\t\tconst skeleton = skeletons[ ID ];\n\n\t\t\t\tskeleton.rawBones.forEach( function ( rawBone, i ) {\n\n\t\t\t\t\tif ( rawBone.ID === parent.ID ) {\n\n\t\t\t\t\t\tconst subBone = bone;\n\t\t\t\t\t\tbone = new Bone();\n\n\t\t\t\t\t\tbone.matrixWorld.copy( rawBone.transformLink );\n\n\t\t\t\t\t\t// set name and id here - otherwise in cases where \"subBone\" is created it will not have a name / id\n\n\t\t\t\t\t\tbone.name = name ? PropertyBinding.sanitizeNodeName( name ) : '';\n\t\t\t\t\t\tbone.ID = id;\n\n\t\t\t\t\t\tskeleton.bones[ i ] = bone;\n\n\t\t\t\t\t\t// In cases where a bone is shared between multiple meshes\n\t\t\t\t\t\t// duplicate the bone here and and it as a child of the first bone\n\t\t\t\t\t\tif ( subBone !== null ) {\n\n\t\t\t\t\t\t\tbone.add( subBone );\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t} );\n\n\t\t\t}\n\n\t\t} );\n\n\t\treturn bone;\n\n\t}\n\n\t// create a PerspectiveCamera or OrthographicCamera\n\tcreateCamera( relationships ) {\n\n\t\tlet model;\n\t\tlet cameraAttribute;\n\n\t\trelationships.children.forEach( function ( child ) {\n\n\t\t\tconst attr = fbxTree.Objects.NodeAttribute[ child.ID ];\n\n\t\t\tif ( attr !== undefined ) {\n\n\t\t\t\tcameraAttribute = attr;\n\n\t\t\t}\n\n\t\t} );\n\n\t\tif ( cameraAttribute === undefined ) {\n\n\t\t\tmodel = new Object3D();\n\n\t\t} else {\n\n\t\t\tlet type = 0;\n\t\t\tif ( cameraAttribute.CameraProjectionType !== undefined && cameraAttribute.CameraProjectionType.value === 1 ) {\n\n\t\t\t\ttype = 1;\n\n\t\t\t}\n\n\t\t\tlet nearClippingPlane = 1;\n\t\t\tif ( cameraAttribute.NearPlane !== undefined ) {\n\n\t\t\t\tnearClippingPlane = cameraAttribute.NearPlane.value / 1000;\n\n\t\t\t}\n\n\t\t\tlet farClippingPlane = 1000;\n\t\t\tif ( cameraAttribute.FarPlane !== undefined ) {\n\n\t\t\t\tfarClippingPlane = cameraAttribute.FarPlane.value / 1000;\n\n\t\t\t}\n\n\n\t\t\tlet width = window.innerWidth;\n\t\t\tlet height = window.innerHeight;\n\n\t\t\tif ( cameraAttribute.AspectWidth !== undefined && cameraAttribute.AspectHeight !== undefined ) {\n\n\t\t\t\twidth = cameraAttribute.AspectWidth.value;\n\t\t\t\theight = cameraAttribute.AspectHeight.value;\n\n\t\t\t}\n\n\t\t\tconst aspect = width / height;\n\n\t\t\tlet fov = 45;\n\t\t\tif ( cameraAttribute.FieldOfView !== undefined ) {\n\n\t\t\t\tfov = cameraAttribute.FieldOfView.value;\n\n\t\t\t}\n\n\t\t\tconst focalLength = cameraAttribute.FocalLength ? cameraAttribute.FocalLength.value : null;\n\n\t\t\tswitch ( type ) {\n\n\t\t\t\tcase 0: // Perspective\n\t\t\t\t\tmodel = new PerspectiveCamera( fov, aspect, nearClippingPlane, farClippingPlane );\n\t\t\t\t\tif ( focalLength !== null ) model.setFocalLength( focalLength );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 1: // Orthographic\n\t\t\t\t\tmodel = new OrthographicCamera( - width / 2, width / 2, height / 2, - height / 2, nearClippingPlane, farClippingPlane );\n\t\t\t\t\tbreak;\n\n\t\t\t\tdefault:\n\t\t\t\t\tconsole.warn( 'THREE.FBXLoader: Unknown camera type ' + type + '.' );\n\t\t\t\t\tmodel = new Object3D();\n\t\t\t\t\tbreak;\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn model;\n\n\t}\n\n\t// Create a DirectionalLight, PointLight or SpotLight\n\tcreateLight( relationships ) {\n\n\t\tlet model;\n\t\tlet lightAttribute;\n\n\t\trelationships.children.forEach( function ( child ) {\n\n\t\t\tconst attr = fbxTree.Objects.NodeAttribute[ child.ID ];\n\n\t\t\tif ( attr !== undefined ) {\n\n\t\t\t\tlightAttribute = attr;\n\n\t\t\t}\n\n\t\t} );\n\n\t\tif ( lightAttribute === undefined ) {\n\n\t\t\tmodel = new Object3D();\n\n\t\t} else {\n\n\t\t\tlet type;\n\n\t\t\t// LightType can be undefined for Point lights\n\t\t\tif ( lightAttribute.LightType === undefined ) {\n\n\t\t\t\ttype = 0;\n\n\t\t\t} else {\n\n\t\t\t\ttype = lightAttribute.LightType.value;\n\n\t\t\t}\n\n\t\t\tlet color = 0xffffff;\n\n\t\t\tif ( lightAttribute.Color !== undefined ) {\n\n\t\t\t\tcolor = new Color().fromArray( lightAttribute.Color.value );\n\n\t\t\t}\n\n\t\t\tlet intensity = ( lightAttribute.Intensity === undefined ) ? 1 : lightAttribute.Intensity.value / 100;\n\n\t\t\t// light disabled\n\t\t\tif ( lightAttribute.CastLightOnObject !== undefined && lightAttribute.CastLightOnObject.value === 0 ) {\n\n\t\t\t\tintensity = 0;\n\n\t\t\t}\n\n\t\t\tlet distance = 0;\n\t\t\tif ( lightAttribute.FarAttenuationEnd !== undefined ) {\n\n\t\t\t\tif ( lightAttribute.EnableFarAttenuation !== undefined && lightAttribute.EnableFarAttenuation.value === 0 ) {\n\n\t\t\t\t\tdistance = 0;\n\n\t\t\t\t} else {\n\n\t\t\t\t\tdistance = lightAttribute.FarAttenuationEnd.value;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\t// TODO: could this be calculated linearly from FarAttenuationStart to FarAttenuationEnd?\n\t\t\tconst decay = 1;\n\n\t\t\tswitch ( type ) {\n\n\t\t\t\tcase 0: // Point\n\t\t\t\t\tmodel = new PointLight( color, intensity, distance, decay );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 1: // Directional\n\t\t\t\t\tmodel = new DirectionalLight( color, intensity );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 2: // Spot\n\t\t\t\t\tlet angle = Math.PI / 3;\n\n\t\t\t\t\tif ( lightAttribute.InnerAngle !== undefined ) {\n\n\t\t\t\t\t\tangle = MathUtils.degToRad( lightAttribute.InnerAngle.value );\n\n\t\t\t\t\t}\n\n\t\t\t\t\tlet penumbra = 0;\n\t\t\t\t\tif ( lightAttribute.OuterAngle !== undefined ) {\n\n\t\t\t\t\t\t// TODO: this is not correct - FBX calculates outer and inner angle in degrees\n\t\t\t\t\t\t// with OuterAngle > InnerAngle && OuterAngle <= Math.PI\n\t\t\t\t\t\t// while three.js uses a penumbra between (0, 1) to attenuate the inner angle\n\t\t\t\t\t\tpenumbra = MathUtils.degToRad( lightAttribute.OuterAngle.value );\n\t\t\t\t\t\tpenumbra = Math.max( penumbra, 1 );\n\n\t\t\t\t\t}\n\n\t\t\t\t\tmodel = new SpotLight( color, intensity, distance, angle, penumbra, decay );\n\t\t\t\t\tbreak;\n\n\t\t\t\tdefault:\n\t\t\t\t\tconsole.warn( 'THREE.FBXLoader: Unknown light type ' + lightAttribute.LightType.value + ', defaulting to a PointLight.' );\n\t\t\t\t\tmodel = new PointLight( color, intensity );\n\t\t\t\t\tbreak;\n\n\t\t\t}\n\n\t\t\tif ( lightAttribute.CastShadows !== undefined && lightAttribute.CastShadows.value === 1 ) {\n\n\t\t\t\tmodel.castShadow = true;\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn model;\n\n\t}\n\n\tcreateMesh( relationships, geometryMap, materialMap ) {\n\n\t\tlet model;\n\t\tlet geometry = null;\n\t\tlet material = null;\n\t\tconst materials = [];\n\n\t\t// get geometry and materials(s) from connections\n\t\trelationships.children.forEach( function ( child ) {\n\n\t\t\tif ( geometryMap.has( child.ID ) ) {\n\n\t\t\t\tgeometry = geometryMap.get( child.ID );\n\n\t\t\t}\n\n\t\t\tif ( materialMap.has( child.ID ) ) {\n\n\t\t\t\tmaterials.push( materialMap.get( child.ID ) );\n\n\t\t\t}\n\n\t\t} );\n\n\t\tif ( materials.length > 1 ) {\n\n\t\t\tmaterial = materials;\n\n\t\t} else if ( materials.length > 0 ) {\n\n\t\t\tmaterial = materials[ 0 ];\n\n\t\t} else {\n\n\t\t\tmaterial = new MeshPhongMaterial( { color: 0xcccccc } );\n\t\t\tmaterials.push( material );\n\n\t\t}\n\n\t\tif ( 'color' in geometry.attributes ) {\n\n\t\t\tmaterials.forEach( function ( material ) {\n\n\t\t\t\tmaterial.vertexColors = true;\n\n\t\t\t} );\n\n\t\t}\n\n\t\tif ( geometry.FBX_Deformer ) {\n\n\t\t\tmodel = new SkinnedMesh( geometry, material );\n\t\t\tmodel.normalizeSkinWeights();\n\n\t\t} else {\n\n\t\t\tmodel = new Mesh( geometry, material );\n\n\t\t}\n\n\t\treturn model;\n\n\t}\n\n\tcreateCurve( relationships, geometryMap ) {\n\n\t\tconst geometry = relationships.children.reduce( function ( geo, child ) {\n\n\t\t\tif ( geometryMap.has( child.ID ) ) geo = geometryMap.get( child.ID );\n\n\t\t\treturn geo;\n\n\t\t}, null );\n\n\t\t// FBX does not list materials for Nurbs lines, so we'll just put our own in here.\n\t\tconst material = new LineBasicMaterial( { color: 0x3300ff, linewidth: 1 } );\n\t\treturn new Line( geometry, material );\n\n\t}\n\n\t// parse the model node for transform data\n\tgetTransformData( model, modelNode ) {\n\n\t\tconst transformData = {};\n\n\t\tif ( 'InheritType' in modelNode ) transformData.inheritType = parseInt( modelNode.InheritType.value );\n\n\t\tif ( 'RotationOrder' in modelNode ) transformData.eulerOrder = getEulerOrder( modelNode.RotationOrder.value );\n\t\telse transformData.eulerOrder = 'ZYX';\n\n\t\tif ( 'Lcl_Translation' in modelNode ) transformData.translation = modelNode.Lcl_Translation.value;\n\n\t\tif ( 'PreRotation' in modelNode ) transformData.preRotation = modelNode.PreRotation.value;\n\t\tif ( 'Lcl_Rotation' in modelNode ) transformData.rotation = modelNode.Lcl_Rotation.value;\n\t\tif ( 'PostRotation' in modelNode ) transformData.postRotation = modelNode.PostRotation.value;\n\n\t\tif ( 'Lcl_Scaling' in modelNode ) transformData.scale = modelNode.Lcl_Scaling.value;\n\n\t\tif ( 'ScalingOffset' in modelNode ) transformData.scalingOffset = modelNode.ScalingOffset.value;\n\t\tif ( 'ScalingPivot' in modelNode ) transformData.scalingPivot = modelNode.ScalingPivot.value;\n\n\t\tif ( 'RotationOffset' in modelNode ) transformData.rotationOffset = modelNode.RotationOffset.value;\n\t\tif ( 'RotationPivot' in modelNode ) transformData.rotationPivot = modelNode.RotationPivot.value;\n\n\t\tmodel.userData.transformData = transformData;\n\n\t}\n\n\tsetLookAtProperties( model, modelNode ) {\n\n\t\tif ( 'LookAtProperty' in modelNode ) {\n\n\t\t\tconst children = connections.get( model.ID ).children;\n\n\t\t\tchildren.forEach( function ( child ) {\n\n\t\t\t\tif ( child.relationship === 'LookAtProperty' ) {\n\n\t\t\t\t\tconst lookAtTarget = fbxTree.Objects.Model[ child.ID ];\n\n\t\t\t\t\tif ( 'Lcl_Translation' in lookAtTarget ) {\n\n\t\t\t\t\t\tconst pos = lookAtTarget.Lcl_Translation.value;\n\n\t\t\t\t\t\t// DirectionalLight, SpotLight\n\t\t\t\t\t\tif ( model.target !== undefined ) {\n\n\t\t\t\t\t\t\tmodel.target.position.fromArray( pos );\n\t\t\t\t\t\t\tsceneGraph.add( model.target );\n\n\t\t\t\t\t\t} else { // Cameras and other Object3Ds\n\n\t\t\t\t\t\t\tmodel.lookAt( new Vector3().fromArray( pos ) );\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t} );\n\n\t\t}\n\n\t}\n\n\tbindSkeleton( skeletons, geometryMap, modelMap ) {\n\n\t\tconst bindMatrices = this.parsePoseNodes();\n\n\t\tfor ( const ID in skeletons ) {\n\n\t\t\tconst skeleton = skeletons[ ID ];\n\n\t\t\tconst parents = connections.get( parseInt( skeleton.ID ) ).parents;\n\n\t\t\tparents.forEach( function ( parent ) {\n\n\t\t\t\tif ( geometryMap.has( parent.ID ) ) {\n\n\t\t\t\t\tconst geoID = parent.ID;\n\t\t\t\t\tconst geoRelationships = connections.get( geoID );\n\n\t\t\t\t\tgeoRelationships.parents.forEach( function ( geoConnParent ) {\n\n\t\t\t\t\t\tif ( modelMap.has( geoConnParent.ID ) ) {\n\n\t\t\t\t\t\t\tconst model = modelMap.get( geoConnParent.ID );\n\n\t\t\t\t\t\t\tmodel.bind( new Skeleton( skeleton.bones ), bindMatrices[ geoConnParent.ID ] );\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t} );\n\n\t\t\t\t}\n\n\t\t\t} );\n\n\t\t}\n\n\t}\n\n\tparsePoseNodes() {\n\n\t\tconst bindMatrices = {};\n\n\t\tif ( 'Pose' in fbxTree.Objects ) {\n\n\t\t\tconst BindPoseNode = fbxTree.Objects.Pose;\n\n\t\t\tfor ( const nodeID in BindPoseNode ) {\n\n\t\t\t\tif ( BindPoseNode[ nodeID ].attrType === 'BindPose' ) {\n\n\t\t\t\t\tconst poseNodes = BindPoseNode[ nodeID ].PoseNode;\n\n\t\t\t\t\tif ( Array.isArray( poseNodes ) ) {\n\n\t\t\t\t\t\tposeNodes.forEach( function ( poseNode ) {\n\n\t\t\t\t\t\t\tbindMatrices[ poseNode.Node ] = new Matrix4().fromArray( poseNode.Matrix.a );\n\n\t\t\t\t\t\t} );\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\tbindMatrices[ poseNodes.Node ] = new Matrix4().fromArray( poseNodes.Matrix.a );\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn bindMatrices;\n\n\t}\n\n\t// Parse ambient color in FBXTree.GlobalSettings - if it's not set to black (default), create an ambient light\n\tcreateAmbientLight() {\n\n\t\tif ( 'GlobalSettings' in fbxTree && 'AmbientColor' in fbxTree.GlobalSettings ) {\n\n\t\t\tconst ambientColor = fbxTree.GlobalSettings.AmbientColor.value;\n\t\t\tconst r = ambientColor[ 0 ];\n\t\t\tconst g = ambientColor[ 1 ];\n\t\t\tconst b = ambientColor[ 2 ];\n\n\t\t\tif ( r !== 0 || g !== 0 || b !== 0 ) {\n\n\t\t\t\tconst color = new Color( r, g, b );\n\t\t\t\tsceneGraph.add( new AmbientLight( color, 1 ) );\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\tsetupMorphMaterials() {\n\n\t\tconst scope = this;\n\t\tsceneGraph.traverse( function ( child ) {\n\n\t\t\tif ( child.isMesh ) {\n\n\t\t\t\tif ( child.geometry.morphAttributes.position && child.geometry.morphAttributes.position.length ) {\n\n\t\t\t\t\tif ( Array.isArray( child.material ) ) {\n\n\t\t\t\t\t\tchild.material.forEach( function ( material, i ) {\n\n\t\t\t\t\t\t\tscope.setupMorphMaterial( child, material, i );\n\n\t\t\t\t\t\t} );\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\tscope.setupMorphMaterial( child, child.material );\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t} );\n\n\t}\n\n\tsetupMorphMaterial( child, material, index ) {\n\n\t\tconst uuid = child.uuid;\n\t\tconst matUuid = material.uuid;\n\n\t\t// if a geometry has morph targets, it cannot share the material with other geometries\n\t\tlet sharedMat = false;\n\n\t\tsceneGraph.traverse( function ( node ) {\n\n\t\t\tif ( node.isMesh ) {\n\n\t\t\t\tif ( Array.isArray( node.material ) ) {\n\n\t\t\t\t\tnode.material.forEach( function ( mat ) {\n\n\t\t\t\t\t\tif ( mat.uuid === matUuid && node.uuid !== uuid ) sharedMat = true;\n\n\t\t\t\t\t} );\n\n\t\t\t\t} else if ( node.material.uuid === matUuid && node.uuid !== uuid ) sharedMat = true;\n\n\t\t\t}\n\n\t\t} );\n\n\t\tif ( sharedMat === true ) {\n\n\t\t\tconst clonedMat = material.clone();\n\t\t\tclonedMat.morphTargets = true;\n\n\t\t\tif ( index === undefined ) child.material = clonedMat;\n\t\t\telse child.material[ index ] = clonedMat;\n\n\t\t} else material.morphTargets = true;\n\n\t}\n\n}\n\n// parse Geometry data from FBXTree and return map of BufferGeometries\nclass GeometryParser {\n\n\t// Parse nodes in FBXTree.Objects.Geometry\n\tparse( deformers ) {\n\n\t\tconst geometryMap = new Map();\n\n\t\tif ( 'Geometry' in fbxTree.Objects ) {\n\n\t\t\tconst geoNodes = fbxTree.Objects.Geometry;\n\n\t\t\tfor ( const nodeID in geoNodes ) {\n\n\t\t\t\tconst relationships = connections.get( parseInt( nodeID ) );\n\t\t\t\tconst geo = this.parseGeometry( relationships, geoNodes[ nodeID ], deformers );\n\n\t\t\t\tgeometryMap.set( parseInt( nodeID ), geo );\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn geometryMap;\n\n\t}\n\n\t// Parse single node in FBXTree.Objects.Geometry\n\tparseGeometry( relationships, geoNode, deformers ) {\n\n\t\tswitch ( geoNode.attrType ) {\n\n\t\t\tcase 'Mesh':\n\t\t\t\treturn this.parseMeshGeometry( relationships, geoNode, deformers );\n\t\t\t\tbreak;\n\n\t\t\tcase 'NurbsCurve':\n\t\t\t\treturn this.parseNurbsGeometry( geoNode );\n\t\t\t\tbreak;\n\n\t\t}\n\n\t}\n\n\t// Parse single node mesh geometry in FBXTree.Objects.Geometry\n\tparseMeshGeometry( relationships, geoNode, deformers ) {\n\n\t\tconst skeletons = deformers.skeletons;\n\t\tconst morphTargets = [];\n\n\t\tconst modelNodes = relationships.parents.map( function ( parent ) {\n\n\t\t\treturn fbxTree.Objects.Model[ parent.ID ];\n\n\t\t} );\n\n\t\t// don't create geometry if it is not associated with any models\n\t\tif ( modelNodes.length === 0 ) return;\n\n\t\tconst skeleton = relationships.children.reduce( function ( skeleton, child ) {\n\n\t\t\tif ( skeletons[ child.ID ] !== undefined ) skeleton = skeletons[ child.ID ];\n\n\t\t\treturn skeleton;\n\n\t\t}, null );\n\n\t\trelationships.children.forEach( function ( child ) {\n\n\t\t\tif ( deformers.morphTargets[ child.ID ] !== undefined ) {\n\n\t\t\t\tmorphTargets.push( deformers.morphTargets[ child.ID ] );\n\n\t\t\t}\n\n\t\t} );\n\n\t\t// Assume one model and get the preRotation from that\n\t\t// if there is more than one model associated with the geometry this may cause problems\n\t\tconst modelNode = modelNodes[ 0 ];\n\n\t\tconst transformData = {};\n\n\t\tif ( 'RotationOrder' in modelNode ) transformData.eulerOrder = getEulerOrder( modelNode.RotationOrder.value );\n\t\tif ( 'InheritType' in modelNode ) transformData.inheritType = parseInt( modelNode.InheritType.value );\n\n\t\tif ( 'GeometricTranslation' in modelNode ) transformData.translation = modelNode.GeometricTranslation.value;\n\t\tif ( 'GeometricRotation' in modelNode ) transformData.rotation = modelNode.GeometricRotation.value;\n\t\tif ( 'GeometricScaling' in modelNode ) transformData.scale = modelNode.GeometricScaling.value;\n\n\t\tconst transform = generateTransform( transformData );\n\n\t\treturn this.genGeometry( geoNode, skeleton, morphTargets, transform );\n\n\t}\n\n\t// Generate a BufferGeometry from a node in FBXTree.Objects.Geometry\n\tgenGeometry( geoNode, skeleton, morphTargets, preTransform ) {\n\n\t\tconst geo = new BufferGeometry();\n\t\tif ( geoNode.attrName ) geo.name = geoNode.attrName;\n\n\t\tconst geoInfo = this.parseGeoNode( geoNode, skeleton );\n\t\tconst buffers = this.genBuffers( geoInfo );\n\n\t\tconst positionAttribute = new Float32BufferAttribute( buffers.vertex, 3 );\n\n\t\tpositionAttribute.applyMatrix4( preTransform );\n\n\t\tgeo.setAttribute( 'position', positionAttribute );\n\n\t\tif ( buffers.colors.length > 0 ) {\n\n\t\t\tgeo.setAttribute( 'color', new Float32BufferAttribute( buffers.colors, 3 ) );\n\n\t\t}\n\n\t\tif ( skeleton ) {\n\n\t\t\tgeo.setAttribute( 'skinIndex', new Uint16BufferAttribute( buffers.weightsIndices, 4 ) );\n\n\t\t\tgeo.setAttribute( 'skinWeight', new Float32BufferAttribute( buffers.vertexWeights, 4 ) );\n\n\t\t\t// used later to bind the skeleton to the model\n\t\t\tgeo.FBX_Deformer = skeleton;\n\n\t\t}\n\n\t\tif ( buffers.normal.length > 0 ) {\n\n\t\t\tconst normalMatrix = new Matrix3().getNormalMatrix( preTransform );\n\n\t\t\tconst normalAttribute = new Float32BufferAttribute( buffers.normal, 3 );\n\t\t\tnormalAttribute.applyNormalMatrix( normalMatrix );\n\n\t\t\tgeo.setAttribute( 'normal', normalAttribute );\n\n\t\t}\n\n\t\tbuffers.uvs.forEach( function ( uvBuffer, i ) {\n\n\t\t\t// subsequent uv buffers are called 'uv1', 'uv2', ...\n\t\t\tlet name = 'uv' + ( i + 1 ).toString();\n\n\t\t\t// the first uv buffer is just called 'uv'\n\t\t\tif ( i === 0 ) {\n\n\t\t\t\tname = 'uv';\n\n\t\t\t}\n\n\t\t\tgeo.setAttribute( name, new Float32BufferAttribute( buffers.uvs[ i ], 2 ) );\n\n\t\t} );\n\n\t\tif ( geoInfo.material && geoInfo.material.mappingType !== 'AllSame' ) {\n\n\t\t\t// Convert the material indices of each vertex into rendering groups on the geometry.\n\t\t\tlet prevMaterialIndex = buffers.materialIndex[ 0 ];\n\t\t\tlet startIndex = 0;\n\n\t\t\tbuffers.materialIndex.forEach( function ( currentIndex, i ) {\n\n\t\t\t\tif ( currentIndex !== prevMaterialIndex ) {\n\n\t\t\t\t\tgeo.addGroup( startIndex, i - startIndex, prevMaterialIndex );\n\n\t\t\t\t\tprevMaterialIndex = currentIndex;\n\t\t\t\t\tstartIndex = i;\n\n\t\t\t\t}\n\n\t\t\t} );\n\n\t\t\t// the loop above doesn't add the last group, do that here.\n\t\t\tif ( geo.groups.length > 0 ) {\n\n\t\t\t\tconst lastGroup = geo.groups[ geo.groups.length - 1 ];\n\t\t\t\tconst lastIndex = lastGroup.start + lastGroup.count;\n\n\t\t\t\tif ( lastIndex !== buffers.materialIndex.length ) {\n\n\t\t\t\t\tgeo.addGroup( lastIndex, buffers.materialIndex.length - lastIndex, prevMaterialIndex );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\t// case where there are multiple materials but the whole geometry is only\n\t\t\t// using one of them\n\t\t\tif ( geo.groups.length === 0 ) {\n\n\t\t\t\tgeo.addGroup( 0, buffers.materialIndex.length, buffers.materialIndex[ 0 ] );\n\n\t\t\t}\n\n\t\t}\n\n\t\tthis.addMorphTargets( geo, geoNode, morphTargets, preTransform );\n\n\t\treturn geo;\n\n\t}\n\n\tparseGeoNode( geoNode, skeleton ) {\n\n\t\tconst geoInfo = {};\n\n\t\tgeoInfo.vertexPositions = ( geoNode.Vertices !== undefined ) ? geoNode.Vertices.a : [];\n\t\tgeoInfo.vertexIndices = ( geoNode.PolygonVertexIndex !== undefined ) ? geoNode.PolygonVertexIndex.a : [];\n\n\t\tif ( geoNode.LayerElementColor ) {\n\n\t\t\tgeoInfo.color = this.parseVertexColors( geoNode.LayerElementColor[ 0 ] );\n\n\t\t}\n\n\t\tif ( geoNode.LayerElementMaterial ) {\n\n\t\t\tgeoInfo.material = this.parseMaterialIndices( geoNode.LayerElementMaterial[ 0 ] );\n\n\t\t}\n\n\t\tif ( geoNode.LayerElementNormal ) {\n\n\t\t\tgeoInfo.normal = this.parseNormals( geoNode.LayerElementNormal[ 0 ] );\n\n\t\t}\n\n\t\tif ( geoNode.LayerElementUV ) {\n\n\t\t\tgeoInfo.uv = [];\n\n\t\t\tlet i = 0;\n\t\t\twhile ( geoNode.LayerElementUV[ i ] ) {\n\n\t\t\t\tif ( geoNode.LayerElementUV[ i ].UV ) {\n\n\t\t\t\t\tgeoInfo.uv.push( this.parseUVs( geoNode.LayerElementUV[ i ] ) );\n\n\t\t\t\t}\n\n\t\t\t\ti ++;\n\n\t\t\t}\n\n\t\t}\n\n\t\tgeoInfo.weightTable = {};\n\n\t\tif ( skeleton !== null ) {\n\n\t\t\tgeoInfo.skeleton = skeleton;\n\n\t\t\tskeleton.rawBones.forEach( function ( rawBone, i ) {\n\n\t\t\t\t// loop over the bone's vertex indices and weights\n\t\t\t\trawBone.indices.forEach( function ( index, j ) {\n\n\t\t\t\t\tif ( geoInfo.weightTable[ index ] === undefined ) geoInfo.weightTable[ index ] = [];\n\n\t\t\t\t\tgeoInfo.weightTable[ index ].push( {\n\n\t\t\t\t\t\tid: i,\n\t\t\t\t\t\tweight: rawBone.weights[ j ],\n\n\t\t\t\t\t} );\n\n\t\t\t\t} );\n\n\t\t\t} );\n\n\t\t}\n\n\t\treturn geoInfo;\n\n\t}\n\n\tgenBuffers( geoInfo ) {\n\n\t\tconst buffers = {\n\t\t\tvertex: [],\n\t\t\tnormal: [],\n\t\t\tcolors: [],\n\t\t\tuvs: [],\n\t\t\tmaterialIndex: [],\n\t\t\tvertexWeights: [],\n\t\t\tweightsIndices: [],\n\t\t};\n\n\t\tlet polygonIndex = 0;\n\t\tlet faceLength = 0;\n\t\tlet displayedWeightsWarning = false;\n\n\t\t// these will hold data for a single face\n\t\tlet facePositionIndexes = [];\n\t\tlet faceNormals = [];\n\t\tlet faceColors = [];\n\t\tlet faceUVs = [];\n\t\tlet faceWeights = [];\n\t\tlet faceWeightIndices = [];\n\n\t\tconst scope = this;\n\t\tgeoInfo.vertexIndices.forEach( function ( vertexIndex, polygonVertexIndex ) {\n\n\t\t\tlet materialIndex;\n\t\t\tlet endOfFace = false;\n\n\t\t\t// Face index and vertex index arrays are combined in a single array\n\t\t\t// A cube with quad faces looks like this:\n\t\t\t// PolygonVertexIndex: *24 {\n\t\t\t//  a: 0, 1, 3, -3, 2, 3, 5, -5, 4, 5, 7, -7, 6, 7, 1, -1, 1, 7, 5, -4, 6, 0, 2, -5\n\t\t\t//  }\n\t\t\t// Negative numbers mark the end of a face - first face here is 0, 1, 3, -3\n\t\t\t// to find index of last vertex bit shift the index: ^ - 1\n\t\t\tif ( vertexIndex < 0 ) {\n\n\t\t\t\tvertexIndex = vertexIndex ^ - 1; // equivalent to ( x * -1 ) - 1\n\t\t\t\tendOfFace = true;\n\n\t\t\t}\n\n\t\t\tlet weightIndices = [];\n\t\t\tlet weights = [];\n\n\t\t\tfacePositionIndexes.push( vertexIndex * 3, vertexIndex * 3 + 1, vertexIndex * 3 + 2 );\n\n\t\t\tif ( geoInfo.color ) {\n\n\t\t\t\tconst data = getData( polygonVertexIndex, polygonIndex, vertexIndex, geoInfo.color );\n\n\t\t\t\tfaceColors.push( data[ 0 ], data[ 1 ], data[ 2 ] );\n\n\t\t\t}\n\n\t\t\tif ( geoInfo.skeleton ) {\n\n\t\t\t\tif ( geoInfo.weightTable[ vertexIndex ] !== undefined ) {\n\n\t\t\t\t\tgeoInfo.weightTable[ vertexIndex ].forEach( function ( wt ) {\n\n\t\t\t\t\t\tweights.push( wt.weight );\n\t\t\t\t\t\tweightIndices.push( wt.id );\n\n\t\t\t\t\t} );\n\n\n\t\t\t\t}\n\n\t\t\t\tif ( weights.length > 4 ) {\n\n\t\t\t\t\tif ( ! displayedWeightsWarning ) {\n\n\t\t\t\t\t\tconsole.warn( 'THREE.FBXLoader: Vertex has more than 4 skinning weights assigned to vertex. Deleting additional weights.' );\n\t\t\t\t\t\tdisplayedWeightsWarning = true;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tconst wIndex = [ 0, 0, 0, 0 ];\n\t\t\t\t\tconst Weight = [ 0, 0, 0, 0 ];\n\n\t\t\t\t\tweights.forEach( function ( weight, weightIndex ) {\n\n\t\t\t\t\t\tlet currentWeight = weight;\n\t\t\t\t\t\tlet currentIndex = weightIndices[ weightIndex ];\n\n\t\t\t\t\t\tWeight.forEach( function ( comparedWeight, comparedWeightIndex, comparedWeightArray ) {\n\n\t\t\t\t\t\t\tif ( currentWeight > comparedWeight ) {\n\n\t\t\t\t\t\t\t\tcomparedWeightArray[ comparedWeightIndex ] = currentWeight;\n\t\t\t\t\t\t\t\tcurrentWeight = comparedWeight;\n\n\t\t\t\t\t\t\t\tconst tmp = wIndex[ comparedWeightIndex ];\n\t\t\t\t\t\t\t\twIndex[ comparedWeightIndex ] = currentIndex;\n\t\t\t\t\t\t\t\tcurrentIndex = tmp;\n\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t} );\n\n\t\t\t\t\t} );\n\n\t\t\t\t\tweightIndices = wIndex;\n\t\t\t\t\tweights = Weight;\n\n\t\t\t\t}\n\n\t\t\t\t// if the weight array is shorter than 4 pad with 0s\n\t\t\t\twhile ( weights.length < 4 ) {\n\n\t\t\t\t\tweights.push( 0 );\n\t\t\t\t\tweightIndices.push( 0 );\n\n\t\t\t\t}\n\n\t\t\t\tfor ( let i = 0; i < 4; ++ i ) {\n\n\t\t\t\t\tfaceWeights.push( weights[ i ] );\n\t\t\t\t\tfaceWeightIndices.push( weightIndices[ i ] );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tif ( geoInfo.normal ) {\n\n\t\t\t\tconst data = getData( polygonVertexIndex, polygonIndex, vertexIndex, geoInfo.normal );\n\n\t\t\t\tfaceNormals.push( data[ 0 ], data[ 1 ], data[ 2 ] );\n\n\t\t\t}\n\n\t\t\tif ( geoInfo.material && geoInfo.material.mappingType !== 'AllSame' ) {\n\n\t\t\t\tmaterialIndex = getData( polygonVertexIndex, polygonIndex, vertexIndex, geoInfo.material )[ 0 ];\n\n\t\t\t}\n\n\t\t\tif ( geoInfo.uv ) {\n\n\t\t\t\tgeoInfo.uv.forEach( function ( uv, i ) {\n\n\t\t\t\t\tconst data = getData( polygonVertexIndex, polygonIndex, vertexIndex, uv );\n\n\t\t\t\t\tif ( faceUVs[ i ] === undefined ) {\n\n\t\t\t\t\t\tfaceUVs[ i ] = [];\n\n\t\t\t\t\t}\n\n\t\t\t\t\tfaceUVs[ i ].push( data[ 0 ] );\n\t\t\t\t\tfaceUVs[ i ].push( data[ 1 ] );\n\n\t\t\t\t} );\n\n\t\t\t}\n\n\t\t\tfaceLength ++;\n\n\t\t\tif ( endOfFace ) {\n\n\t\t\t\tscope.genFace( buffers, geoInfo, facePositionIndexes, materialIndex, faceNormals, faceColors, faceUVs, faceWeights, faceWeightIndices, faceLength );\n\n\t\t\t\tpolygonIndex ++;\n\t\t\t\tfaceLength = 0;\n\n\t\t\t\t// reset arrays for the next face\n\t\t\t\tfacePositionIndexes = [];\n\t\t\t\tfaceNormals = [];\n\t\t\t\tfaceColors = [];\n\t\t\t\tfaceUVs = [];\n\t\t\t\tfaceWeights = [];\n\t\t\t\tfaceWeightIndices = [];\n\n\t\t\t}\n\n\t\t} );\n\n\t\treturn buffers;\n\n\t}\n\n\t// Generate data for a single face in a geometry. If the face is a quad then split it into 2 tris\n\tgenFace( buffers, geoInfo, facePositionIndexes, materialIndex, faceNormals, faceColors, faceUVs, faceWeights, faceWeightIndices, faceLength ) {\n\n\t\tfor ( let i = 2; i < faceLength; i ++ ) {\n\n\t\t\tbuffers.vertex.push( geoInfo.vertexPositions[ facePositionIndexes[ 0 ] ] );\n\t\t\tbuffers.vertex.push( geoInfo.vertexPositions[ facePositionIndexes[ 1 ] ] );\n\t\t\tbuffers.vertex.push( geoInfo.vertexPositions[ facePositionIndexes[ 2 ] ] );\n\n\t\t\tbuffers.vertex.push( geoInfo.vertexPositions[ facePositionIndexes[ ( i - 1 ) * 3 ] ] );\n\t\t\tbuffers.vertex.push( geoInfo.vertexPositions[ facePositionIndexes[ ( i - 1 ) * 3 + 1 ] ] );\n\t\t\tbuffers.vertex.push( geoInfo.vertexPositions[ facePositionIndexes[ ( i - 1 ) * 3 + 2 ] ] );\n\n\t\t\tbuffers.vertex.push( geoInfo.vertexPositions[ facePositionIndexes[ i * 3 ] ] );\n\t\t\tbuffers.vertex.push( geoInfo.vertexPositions[ facePositionIndexes[ i * 3 + 1 ] ] );\n\t\t\tbuffers.vertex.push( geoInfo.vertexPositions[ facePositionIndexes[ i * 3 + 2 ] ] );\n\n\t\t\tif ( geoInfo.skeleton ) {\n\n\t\t\t\tbuffers.vertexWeights.push( faceWeights[ 0 ] );\n\t\t\t\tbuffers.vertexWeights.push( faceWeights[ 1 ] );\n\t\t\t\tbuffers.vertexWeights.push( faceWeights[ 2 ] );\n\t\t\t\tbuffers.vertexWeights.push( faceWeights[ 3 ] );\n\n\t\t\t\tbuffers.vertexWeights.push( faceWeights[ ( i - 1 ) * 4 ] );\n\t\t\t\tbuffers.vertexWeights.push( faceWeights[ ( i - 1 ) * 4 + 1 ] );\n\t\t\t\tbuffers.vertexWeights.push( faceWeights[ ( i - 1 ) * 4 + 2 ] );\n\t\t\t\tbuffers.vertexWeights.push( faceWeights[ ( i - 1 ) * 4 + 3 ] );\n\n\t\t\t\tbuffers.vertexWeights.push( faceWeights[ i * 4 ] );\n\t\t\t\tbuffers.vertexWeights.push( faceWeights[ i * 4 + 1 ] );\n\t\t\t\tbuffers.vertexWeights.push( faceWeights[ i * 4 + 2 ] );\n\t\t\t\tbuffers.vertexWeights.push( faceWeights[ i * 4 + 3 ] );\n\n\t\t\t\tbuffers.weightsIndices.push( faceWeightIndices[ 0 ] );\n\t\t\t\tbuffers.weightsIndices.push( faceWeightIndices[ 1 ] );\n\t\t\t\tbuffers.weightsIndices.push( faceWeightIndices[ 2 ] );\n\t\t\t\tbuffers.weightsIndices.push( faceWeightIndices[ 3 ] );\n\n\t\t\t\tbuffers.weightsIndices.push( faceWeightIndices[ ( i - 1 ) * 4 ] );\n\t\t\t\tbuffers.weightsIndices.push( faceWeightIndices[ ( i - 1 ) * 4 + 1 ] );\n\t\t\t\tbuffers.weightsIndices.push( faceWeightIndices[ ( i - 1 ) * 4 + 2 ] );\n\t\t\t\tbuffers.weightsIndices.push( faceWeightIndices[ ( i - 1 ) * 4 + 3 ] );\n\n\t\t\t\tbuffers.weightsIndices.push( faceWeightIndices[ i * 4 ] );\n\t\t\t\tbuffers.weightsIndices.push( faceWeightIndices[ i * 4 + 1 ] );\n\t\t\t\tbuffers.weightsIndices.push( faceWeightIndices[ i * 4 + 2 ] );\n\t\t\t\tbuffers.weightsIndices.push( faceWeightIndices[ i * 4 + 3 ] );\n\n\t\t\t}\n\n\t\t\tif ( geoInfo.color ) {\n\n\t\t\t\tbuffers.colors.push( faceColors[ 0 ] );\n\t\t\t\tbuffers.colors.push( faceColors[ 1 ] );\n\t\t\t\tbuffers.colors.push( faceColors[ 2 ] );\n\n\t\t\t\tbuffers.colors.push( faceColors[ ( i - 1 ) * 3 ] );\n\t\t\t\tbuffers.colors.push( faceColors[ ( i - 1 ) * 3 + 1 ] );\n\t\t\t\tbuffers.colors.push( faceColors[ ( i - 1 ) * 3 + 2 ] );\n\n\t\t\t\tbuffers.colors.push( faceColors[ i * 3 ] );\n\t\t\t\tbuffers.colors.push( faceColors[ i * 3 + 1 ] );\n\t\t\t\tbuffers.colors.push( faceColors[ i * 3 + 2 ] );\n\n\t\t\t}\n\n\t\t\tif ( geoInfo.material && geoInfo.material.mappingType !== 'AllSame' ) {\n\n\t\t\t\tbuffers.materialIndex.push( materialIndex );\n\t\t\t\tbuffers.materialIndex.push( materialIndex );\n\t\t\t\tbuffers.materialIndex.push( materialIndex );\n\n\t\t\t}\n\n\t\t\tif ( geoInfo.normal ) {\n\n\t\t\t\tbuffers.normal.push( faceNormals[ 0 ] );\n\t\t\t\tbuffers.normal.push( faceNormals[ 1 ] );\n\t\t\t\tbuffers.normal.push( faceNormals[ 2 ] );\n\n\t\t\t\tbuffers.normal.push( faceNormals[ ( i - 1 ) * 3 ] );\n\t\t\t\tbuffers.normal.push( faceNormals[ ( i - 1 ) * 3 + 1 ] );\n\t\t\t\tbuffers.normal.push( faceNormals[ ( i - 1 ) * 3 + 2 ] );\n\n\t\t\t\tbuffers.normal.push( faceNormals[ i * 3 ] );\n\t\t\t\tbuffers.normal.push( faceNormals[ i * 3 + 1 ] );\n\t\t\t\tbuffers.normal.push( faceNormals[ i * 3 + 2 ] );\n\n\t\t\t}\n\n\t\t\tif ( geoInfo.uv ) {\n\n\t\t\t\tgeoInfo.uv.forEach( function ( uv, j ) {\n\n\t\t\t\t\tif ( buffers.uvs[ j ] === undefined ) buffers.uvs[ j ] = [];\n\n\t\t\t\t\tbuffers.uvs[ j ].push( faceUVs[ j ][ 0 ] );\n\t\t\t\t\tbuffers.uvs[ j ].push( faceUVs[ j ][ 1 ] );\n\n\t\t\t\t\tbuffers.uvs[ j ].push( faceUVs[ j ][ ( i - 1 ) * 2 ] );\n\t\t\t\t\tbuffers.uvs[ j ].push( faceUVs[ j ][ ( i - 1 ) * 2 + 1 ] );\n\n\t\t\t\t\tbuffers.uvs[ j ].push( faceUVs[ j ][ i * 2 ] );\n\t\t\t\t\tbuffers.uvs[ j ].push( faceUVs[ j ][ i * 2 + 1 ] );\n\n\t\t\t\t} );\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\taddMorphTargets( parentGeo, parentGeoNode, morphTargets, preTransform ) {\n\n\t\tif ( morphTargets.length === 0 ) return;\n\n\t\tparentGeo.morphTargetsRelative = true;\n\n\t\tparentGeo.morphAttributes.position = [];\n\t\t// parentGeo.morphAttributes.normal = []; // not implemented\n\n\t\tconst scope = this;\n\t\tmorphTargets.forEach( function ( morphTarget ) {\n\n\t\t\tmorphTarget.rawTargets.forEach( function ( rawTarget ) {\n\n\t\t\t\tconst morphGeoNode = fbxTree.Objects.Geometry[ rawTarget.geoID ];\n\n\t\t\t\tif ( morphGeoNode !== undefined ) {\n\n\t\t\t\t\tscope.genMorphGeometry( parentGeo, parentGeoNode, morphGeoNode, preTransform, rawTarget.name );\n\n\t\t\t\t}\n\n\t\t\t} );\n\n\t\t} );\n\n\t}\n\n\t// a morph geometry node is similar to a standard  node, and the node is also contained\n\t// in FBXTree.Objects.Geometry, however it can only have attributes for position, normal\n\t// and a special attribute Index defining which vertices of the original geometry are affected\n\t// Normal and position attributes only have data for the vertices that are affected by the morph\n\tgenMorphGeometry( parentGeo, parentGeoNode, morphGeoNode, preTransform, name ) {\n\n\t\tconst vertexIndices = ( parentGeoNode.PolygonVertexIndex !== undefined ) ? parentGeoNode.PolygonVertexIndex.a : [];\n\n\t\tconst morphPositionsSparse = ( morphGeoNode.Vertices !== undefined ) ? morphGeoNode.Vertices.a : [];\n\t\tconst indices = ( morphGeoNode.Indexes !== undefined ) ? morphGeoNode.Indexes.a : [];\n\n\t\tconst length = parentGeo.attributes.position.count * 3;\n\t\tconst morphPositions = new Float32Array( length );\n\n\t\tfor ( let i = 0; i < indices.length; i ++ ) {\n\n\t\t\tconst morphIndex = indices[ i ] * 3;\n\n\t\t\tmorphPositions[ morphIndex ] = morphPositionsSparse[ i * 3 ];\n\t\t\tmorphPositions[ morphIndex + 1 ] = morphPositionsSparse[ i * 3 + 1 ];\n\t\t\tmorphPositions[ morphIndex + 2 ] = morphPositionsSparse[ i * 3 + 2 ];\n\n\t\t}\n\n\t\t// TODO: add morph normal support\n\t\tconst morphGeoInfo = {\n\t\t\tvertexIndices: vertexIndices,\n\t\t\tvertexPositions: morphPositions,\n\n\t\t};\n\n\t\tconst morphBuffers = this.genBuffers( morphGeoInfo );\n\n\t\tconst positionAttribute = new Float32BufferAttribute( morphBuffers.vertex, 3 );\n\t\tpositionAttribute.name = name || morphGeoNode.attrName;\n\n\t\tpositionAttribute.applyMatrix4( preTransform );\n\n\t\tparentGeo.morphAttributes.position.push( positionAttribute );\n\n\t}\n\n\t// Parse normal from FBXTree.Objects.Geometry.LayerElementNormal if it exists\n\tparseNormals( NormalNode ) {\n\n\t\tconst mappingType = NormalNode.MappingInformationType;\n\t\tconst referenceType = NormalNode.ReferenceInformationType;\n\t\tconst buffer = NormalNode.Normals.a;\n\t\tlet indexBuffer = [];\n\t\tif ( referenceType === 'IndexToDirect' ) {\n\n\t\t\tif ( 'NormalIndex' in NormalNode ) {\n\n\t\t\t\tindexBuffer = NormalNode.NormalIndex.a;\n\n\t\t\t} else if ( 'NormalsIndex' in NormalNode ) {\n\n\t\t\t\tindexBuffer = NormalNode.NormalsIndex.a;\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn {\n\t\t\tdataSize: 3,\n\t\t\tbuffer: buffer,\n\t\t\tindices: indexBuffer,\n\t\t\tmappingType: mappingType,\n\t\t\treferenceType: referenceType\n\t\t};\n\n\t}\n\n\t// Parse UVs from FBXTree.Objects.Geometry.LayerElementUV if it exists\n\tparseUVs( UVNode ) {\n\n\t\tconst mappingType = UVNode.MappingInformationType;\n\t\tconst referenceType = UVNode.ReferenceInformationType;\n\t\tconst buffer = UVNode.UV.a;\n\t\tlet indexBuffer = [];\n\t\tif ( referenceType === 'IndexToDirect' ) {\n\n\t\t\tindexBuffer = UVNode.UVIndex.a;\n\n\t\t}\n\n\t\treturn {\n\t\t\tdataSize: 2,\n\t\t\tbuffer: buffer,\n\t\t\tindices: indexBuffer,\n\t\t\tmappingType: mappingType,\n\t\t\treferenceType: referenceType\n\t\t};\n\n\t}\n\n\t// Parse Vertex Colors from FBXTree.Objects.Geometry.LayerElementColor if it exists\n\tparseVertexColors( ColorNode ) {\n\n\t\tconst mappingType = ColorNode.MappingInformationType;\n\t\tconst referenceType = ColorNode.ReferenceInformationType;\n\t\tconst buffer = ColorNode.Colors.a;\n\t\tlet indexBuffer = [];\n\t\tif ( referenceType === 'IndexToDirect' ) {\n\n\t\t\tindexBuffer = ColorNode.ColorIndex.a;\n\n\t\t}\n\n\t\treturn {\n\t\t\tdataSize: 4,\n\t\t\tbuffer: buffer,\n\t\t\tindices: indexBuffer,\n\t\t\tmappingType: mappingType,\n\t\t\treferenceType: referenceType\n\t\t};\n\n\t}\n\n\t// Parse mapping and material data in FBXTree.Objects.Geometry.LayerElementMaterial if it exists\n\tparseMaterialIndices( MaterialNode ) {\n\n\t\tconst mappingType = MaterialNode.MappingInformationType;\n\t\tconst referenceType = MaterialNode.ReferenceInformationType;\n\n\t\tif ( mappingType === 'NoMappingInformation' ) {\n\n\t\t\treturn {\n\t\t\t\tdataSize: 1,\n\t\t\t\tbuffer: [ 0 ],\n\t\t\t\tindices: [ 0 ],\n\t\t\t\tmappingType: 'AllSame',\n\t\t\t\treferenceType: referenceType\n\t\t\t};\n\n\t\t}\n\n\t\tconst materialIndexBuffer = MaterialNode.Materials.a;\n\n\t\t// Since materials are stored as indices, there's a bit of a mismatch between FBX and what\n\t\t// we expect.So we create an intermediate buffer that points to the index in the buffer,\n\t\t// for conforming with the other functions we've written for other data.\n\t\tconst materialIndices = [];\n\n\t\tfor ( let i = 0; i < materialIndexBuffer.length; ++ i ) {\n\n\t\t\tmaterialIndices.push( i );\n\n\t\t}\n\n\t\treturn {\n\t\t\tdataSize: 1,\n\t\t\tbuffer: materialIndexBuffer,\n\t\t\tindices: materialIndices,\n\t\t\tmappingType: mappingType,\n\t\t\treferenceType: referenceType\n\t\t};\n\n\t}\n\n\t// Generate a NurbGeometry from a node in FBXTree.Objects.Geometry\n\tparseNurbsGeometry( geoNode ) {\n\n\t\tif ( NURBSCurve === undefined ) {\n\n\t\t\tconsole.error( 'THREE.FBXLoader: The loader relies on NURBSCurve for any nurbs present in the model. Nurbs will show up as empty geometry.' );\n\t\t\treturn new BufferGeometry();\n\n\t\t}\n\n\t\tconst order = parseInt( geoNode.Order );\n\n\t\tif ( isNaN( order ) ) {\n\n\t\t\tconsole.error( 'THREE.FBXLoader: Invalid Order %s given for geometry ID: %s', geoNode.Order, geoNode.id );\n\t\t\treturn new BufferGeometry();\n\n\t\t}\n\n\t\tconst degree = order - 1;\n\n\t\tconst knots = geoNode.KnotVector.a;\n\t\tconst controlPoints = [];\n\t\tconst pointsValues = geoNode.Points.a;\n\n\t\tfor ( let i = 0, l = pointsValues.length; i < l; i += 4 ) {\n\n\t\t\tcontrolPoints.push( new Vector4().fromArray( pointsValues, i ) );\n\n\t\t}\n\n\t\tlet startKnot, endKnot;\n\n\t\tif ( geoNode.Form === 'Closed' ) {\n\n\t\t\tcontrolPoints.push( controlPoints[ 0 ] );\n\n\t\t} else if ( geoNode.Form === 'Periodic' ) {\n\n\t\t\tstartKnot = degree;\n\t\t\tendKnot = knots.length - 1 - startKnot;\n\n\t\t\tfor ( let i = 0; i < degree; ++ i ) {\n\n\t\t\t\tcontrolPoints.push( controlPoints[ i ] );\n\n\t\t\t}\n\n\t\t}\n\n\t\tconst curve = new NURBSCurve( degree, knots, controlPoints, startKnot, endKnot );\n\t\tconst vertices = curve.getPoints( controlPoints.length * 7 );\n\n\t\tconst positions = new Float32Array( vertices.length * 3 );\n\n\t\tvertices.forEach( function ( vertex, i ) {\n\n\t\t\tvertex.toArray( positions, i * 3 );\n\n\t\t} );\n\n\t\tconst geometry = new BufferGeometry();\n\t\tgeometry.setAttribute( 'position', new BufferAttribute( positions, 3 ) );\n\n\t\treturn geometry;\n\n\t}\n\n}\n\n// parse animation data from FBXTree\nclass AnimationParser {\n\n\t// take raw animation clips and turn them into three.js animation clips\n\tparse() {\n\n\t\tconst animationClips = [];\n\n\t\tconst rawClips = this.parseClips();\n\n\t\tif ( rawClips !== undefined ) {\n\n\t\t\tfor ( const key in rawClips ) {\n\n\t\t\t\tconst rawClip = rawClips[ key ];\n\n\t\t\t\tconst clip = this.addClip( rawClip );\n\n\t\t\t\tanimationClips.push( clip );\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn animationClips;\n\n\t}\n\n\tparseClips() {\n\n\t\t// since the actual transformation data is stored in FBXTree.Objects.AnimationCurve,\n\t\t// if this is undefined we can safely assume there are no animations\n\t\tif ( fbxTree.Objects.AnimationCurve === undefined ) return undefined;\n\n\t\tconst curveNodesMap = this.parseAnimationCurveNodes();\n\n\t\tthis.parseAnimationCurves( curveNodesMap );\n\n\t\tconst layersMap = this.parseAnimationLayers( curveNodesMap );\n\t\tconst rawClips = this.parseAnimStacks( layersMap );\n\n\t\treturn rawClips;\n\n\t}\n\n\t// parse nodes in FBXTree.Objects.AnimationCurveNode\n\t// each AnimationCurveNode holds data for an animation transform for a model (e.g. left arm rotation )\n\t// and is referenced by an AnimationLayer\n\tparseAnimationCurveNodes() {\n\n\t\tconst rawCurveNodes = fbxTree.Objects.AnimationCurveNode;\n\n\t\tconst curveNodesMap = new Map();\n\n\t\tfor ( const nodeID in rawCurveNodes ) {\n\n\t\t\tconst rawCurveNode = rawCurveNodes[ nodeID ];\n\n\t\t\tif ( rawCurveNode.attrName.match( /S|R|T|DeformPercent/ ) !== null ) {\n\n\t\t\t\tconst curveNode = {\n\n\t\t\t\t\tid: rawCurveNode.id,\n\t\t\t\t\tattr: rawCurveNode.attrName,\n\t\t\t\t\tcurves: {},\n\n\t\t\t\t};\n\n\t\t\t\tcurveNodesMap.set( curveNode.id, curveNode );\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn curveNodesMap;\n\n\t}\n\n\t// parse nodes in FBXTree.Objects.AnimationCurve and connect them up to\n\t// previously parsed AnimationCurveNodes. Each AnimationCurve holds data for a single animated\n\t// axis ( e.g. times and values of x rotation)\n\tparseAnimationCurves( curveNodesMap ) {\n\n\t\tconst rawCurves = fbxTree.Objects.AnimationCurve;\n\n\t\t// TODO: Many values are identical up to roundoff error, but won't be optimised\n\t\t// e.g. position times: [0, 0.4, 0. 8]\n\t\t// position values: [7.23538335023477e-7, 93.67518615722656, -0.9982695579528809, 7.23538335023477e-7, 93.67518615722656, -0.9982695579528809, 7.235384487103147e-7, 93.67520904541016, -0.9982695579528809]\n\t\t// clearly, this should be optimised to\n\t\t// times: [0], positions [7.23538335023477e-7, 93.67518615722656, -0.9982695579528809]\n\t\t// this shows up in nearly every FBX file, and generally time array is length > 100\n\n\t\tfor ( const nodeID in rawCurves ) {\n\n\t\t\tconst animationCurve = {\n\n\t\t\t\tid: rawCurves[ nodeID ].id,\n\t\t\t\ttimes: rawCurves[ nodeID ].KeyTime.a.map( convertFBXTimeToSeconds ),\n\t\t\t\tvalues: rawCurves[ nodeID ].KeyValueFloat.a,\n\n\t\t\t};\n\n\t\t\tconst relationships = connections.get( animationCurve.id );\n\n\t\t\tif ( relationships !== undefined ) {\n\n\t\t\t\tconst animationCurveID = relationships.parents[ 0 ].ID;\n\t\t\t\tconst animationCurveRelationship = relationships.parents[ 0 ].relationship;\n\n\t\t\t\tif ( animationCurveRelationship.match( /X/ ) ) {\n\n\t\t\t\t\tcurveNodesMap.get( animationCurveID ).curves[ 'x' ] = animationCurve;\n\n\t\t\t\t} else if ( animationCurveRelationship.match( /Y/ ) ) {\n\n\t\t\t\t\tcurveNodesMap.get( animationCurveID ).curves[ 'y' ] = animationCurve;\n\n\t\t\t\t} else if ( animationCurveRelationship.match( /Z/ ) ) {\n\n\t\t\t\t\tcurveNodesMap.get( animationCurveID ).curves[ 'z' ] = animationCurve;\n\n\t\t\t\t} else if ( animationCurveRelationship.match( /d|DeformPercent/ ) && curveNodesMap.has( animationCurveID ) ) {\n\n\t\t\t\t\tcurveNodesMap.get( animationCurveID ).curves[ 'morph' ] = animationCurve;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\t// parse nodes in FBXTree.Objects.AnimationLayer. Each layers holds references\n\t// to various AnimationCurveNodes and is referenced by an AnimationStack node\n\t// note: theoretically a stack can have multiple layers, however in practice there always seems to be one per stack\n\tparseAnimationLayers( curveNodesMap ) {\n\n\t\tconst rawLayers = fbxTree.Objects.AnimationLayer;\n\n\t\tconst layersMap = new Map();\n\n\t\tfor ( const nodeID in rawLayers ) {\n\n\t\t\tconst layerCurveNodes = [];\n\n\t\t\tconst connection = connections.get( parseInt( nodeID ) );\n\n\t\t\tif ( connection !== undefined ) {\n\n\t\t\t\t// all the animationCurveNodes used in the layer\n\t\t\t\tconst children = connection.children;\n\n\t\t\t\tchildren.forEach( function ( child, i ) {\n\n\t\t\t\t\tif ( curveNodesMap.has( child.ID ) ) {\n\n\t\t\t\t\t\tconst curveNode = curveNodesMap.get( child.ID );\n\n\t\t\t\t\t\t// check that the curves are defined for at least one axis, otherwise ignore the curveNode\n\t\t\t\t\t\tif ( curveNode.curves.x !== undefined || curveNode.curves.y !== undefined || curveNode.curves.z !== undefined ) {\n\n\t\t\t\t\t\t\tif ( layerCurveNodes[ i ] === undefined ) {\n\n\t\t\t\t\t\t\t\tconst modelID = connections.get( child.ID ).parents.filter( function ( parent ) {\n\n\t\t\t\t\t\t\t\t\treturn parent.relationship !== undefined;\n\n\t\t\t\t\t\t\t\t} )[ 0 ].ID;\n\n\t\t\t\t\t\t\t\tif ( modelID !== undefined ) {\n\n\t\t\t\t\t\t\t\t\tconst rawModel = fbxTree.Objects.Model[ modelID.toString() ];\n\n\t\t\t\t\t\t\t\t\tif ( rawModel === undefined ) {\n\n\t\t\t\t\t\t\t\t\t\tconsole.warn( 'THREE.FBXLoader: Encountered a unused curve.', child );\n\t\t\t\t\t\t\t\t\t\treturn;\n\n\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\tconst node = {\n\n\t\t\t\t\t\t\t\t\t\tmodelName: rawModel.attrName ? PropertyBinding.sanitizeNodeName( rawModel.attrName ) : '',\n\t\t\t\t\t\t\t\t\t\tID: rawModel.id,\n\t\t\t\t\t\t\t\t\t\tinitialPosition: [ 0, 0, 0 ],\n\t\t\t\t\t\t\t\t\t\tinitialRotation: [ 0, 0, 0 ],\n\t\t\t\t\t\t\t\t\t\tinitialScale: [ 1, 1, 1 ],\n\n\t\t\t\t\t\t\t\t\t};\n\n\t\t\t\t\t\t\t\t\tsceneGraph.traverse( function ( child ) {\n\n\t\t\t\t\t\t\t\t\t\tif ( child.ID === rawModel.id ) {\n\n\t\t\t\t\t\t\t\t\t\t\tnode.transform = child.matrix;\n\n\t\t\t\t\t\t\t\t\t\t\tif ( child.userData.transformData ) node.eulerOrder = child.userData.transformData.eulerOrder;\n\n\t\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\t} );\n\n\t\t\t\t\t\t\t\t\tif ( ! node.transform ) node.transform = new Matrix4();\n\n\t\t\t\t\t\t\t\t\t// if the animated model is pre rotated, we'll have to apply the pre rotations to every\n\t\t\t\t\t\t\t\t\t// animation value as well\n\t\t\t\t\t\t\t\t\tif ( 'PreRotation' in rawModel ) node.preRotation = rawModel.PreRotation.value;\n\t\t\t\t\t\t\t\t\tif ( 'PostRotation' in rawModel ) node.postRotation = rawModel.PostRotation.value;\n\n\t\t\t\t\t\t\t\t\tlayerCurveNodes[ i ] = node;\n\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tif ( layerCurveNodes[ i ] ) layerCurveNodes[ i ][ curveNode.attr ] = curveNode;\n\n\t\t\t\t\t\t} else if ( curveNode.curves.morph !== undefined ) {\n\n\t\t\t\t\t\t\tif ( layerCurveNodes[ i ] === undefined ) {\n\n\t\t\t\t\t\t\t\tconst deformerID = connections.get( child.ID ).parents.filter( function ( parent ) {\n\n\t\t\t\t\t\t\t\t\treturn parent.relationship !== undefined;\n\n\t\t\t\t\t\t\t\t} )[ 0 ].ID;\n\n\t\t\t\t\t\t\t\tconst morpherID = connections.get( deformerID ).parents[ 0 ].ID;\n\t\t\t\t\t\t\t\tconst geoID = connections.get( morpherID ).parents[ 0 ].ID;\n\n\t\t\t\t\t\t\t\t// assuming geometry is not used in more than one model\n\t\t\t\t\t\t\t\tconst modelID = connections.get( geoID ).parents[ 0 ].ID;\n\n\t\t\t\t\t\t\t\tconst rawModel = fbxTree.Objects.Model[ modelID ];\n\n\t\t\t\t\t\t\t\tconst node = {\n\n\t\t\t\t\t\t\t\t\tmodelName: rawModel.attrName ? PropertyBinding.sanitizeNodeName( rawModel.attrName ) : '',\n\t\t\t\t\t\t\t\t\tmorphName: fbxTree.Objects.Deformer[ deformerID ].attrName,\n\n\t\t\t\t\t\t\t\t};\n\n\t\t\t\t\t\t\t\tlayerCurveNodes[ i ] = node;\n\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tlayerCurveNodes[ i ][ curveNode.attr ] = curveNode;\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t} );\n\n\t\t\t\tlayersMap.set( parseInt( nodeID ), layerCurveNodes );\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn layersMap;\n\n\t}\n\n\t// parse nodes in FBXTree.Objects.AnimationStack. These are the top level node in the animation\n\t// hierarchy. Each Stack node will be used to create a AnimationClip\n\tparseAnimStacks( layersMap ) {\n\n\t\tconst rawStacks = fbxTree.Objects.AnimationStack;\n\n\t\t// connect the stacks (clips) up to the layers\n\t\tconst rawClips = {};\n\n\t\tfor ( const nodeID in rawStacks ) {\n\n\t\t\tconst children = connections.get( parseInt( nodeID ) ).children;\n\n\t\t\tif ( children.length > 1 ) {\n\n\t\t\t\t// it seems like stacks will always be associated with a single layer. But just in case there are files\n\t\t\t\t// where there are multiple layers per stack, we'll display a warning\n\t\t\t\tconsole.warn( 'THREE.FBXLoader: Encountered an animation stack with multiple layers, this is currently not supported. Ignoring subsequent layers.' );\n\n\t\t\t}\n\n\t\t\tconst layer = layersMap.get( children[ 0 ].ID );\n\n\t\t\trawClips[ nodeID ] = {\n\n\t\t\t\tname: rawStacks[ nodeID ].attrName,\n\t\t\t\tlayer: layer,\n\n\t\t\t};\n\n\t\t}\n\n\t\treturn rawClips;\n\n\t}\n\n\taddClip( rawClip ) {\n\n\t\tlet tracks = [];\n\n\t\tconst scope = this;\n\t\trawClip.layer.forEach( function ( rawTracks ) {\n\n\t\t\ttracks = tracks.concat( scope.generateTracks( rawTracks ) );\n\n\t\t} );\n\n\t\treturn new AnimationClip( rawClip.name, - 1, tracks );\n\n\t}\n\n\tgenerateTracks( rawTracks ) {\n\n\t\tconst tracks = [];\n\n\t\tlet initialPosition = new Vector3();\n\t\tlet initialRotation = new Quaternion();\n\t\tlet initialScale = new Vector3();\n\n\t\tif ( rawTracks.transform ) rawTracks.transform.decompose( initialPosition, initialRotation, initialScale );\n\n\t\tinitialPosition = initialPosition.toArray();\n\t\tinitialRotation = new Euler().setFromQuaternion( initialRotation, rawTracks.eulerOrder ).toArray();\n\t\tinitialScale = initialScale.toArray();\n\n\t\tif ( rawTracks.T !== undefined && Object.keys( rawTracks.T.curves ).length > 0 ) {\n\n\t\t\tconst positionTrack = this.generateVectorTrack( rawTracks.modelName, rawTracks.T.curves, initialPosition, 'position' );\n\t\t\tif ( positionTrack !== undefined ) tracks.push( positionTrack );\n\n\t\t}\n\n\t\tif ( rawTracks.R !== undefined && Object.keys( rawTracks.R.curves ).length > 0 ) {\n\n\t\t\tconst rotationTrack = this.generateRotationTrack( rawTracks.modelName, rawTracks.R.curves, initialRotation, rawTracks.preRotation, rawTracks.postRotation, rawTracks.eulerOrder );\n\t\t\tif ( rotationTrack !== undefined ) tracks.push( rotationTrack );\n\n\t\t}\n\n\t\tif ( rawTracks.S !== undefined && Object.keys( rawTracks.S.curves ).length > 0 ) {\n\n\t\t\tconst scaleTrack = this.generateVectorTrack( rawTracks.modelName, rawTracks.S.curves, initialScale, 'scale' );\n\t\t\tif ( scaleTrack !== undefined ) tracks.push( scaleTrack );\n\n\t\t}\n\n\t\tif ( rawTracks.DeformPercent !== undefined ) {\n\n\t\t\tconst morphTrack = this.generateMorphTrack( rawTracks );\n\t\t\tif ( morphTrack !== undefined ) tracks.push( morphTrack );\n\n\t\t}\n\n\t\treturn tracks;\n\n\t}\n\n\tgenerateVectorTrack( modelName, curves, initialValue, type ) {\n\n\t\tconst times = this.getTimesForAllAxes( curves );\n\t\tconst values = this.getKeyframeTrackValues( times, curves, initialValue );\n\n\t\treturn new VectorKeyframeTrack( modelName + '.' + type, times, values );\n\n\t}\n\n\tgenerateRotationTrack( modelName, curves, initialValue, preRotation, postRotation, eulerOrder ) {\n\n\t\tif ( curves.x !== undefined ) {\n\n\t\t\tthis.interpolateRotations( curves.x );\n\t\t\tcurves.x.values = curves.x.values.map( MathUtils.degToRad );\n\n\t\t}\n\n\t\tif ( curves.y !== undefined ) {\n\n\t\t\tthis.interpolateRotations( curves.y );\n\t\t\tcurves.y.values = curves.y.values.map( MathUtils.degToRad );\n\n\t\t}\n\n\t\tif ( curves.z !== undefined ) {\n\n\t\t\tthis.interpolateRotations( curves.z );\n\t\t\tcurves.z.values = curves.z.values.map( MathUtils.degToRad );\n\n\t\t}\n\n\t\tconst times = this.getTimesForAllAxes( curves );\n\t\tconst values = this.getKeyframeTrackValues( times, curves, initialValue );\n\n\t\tif ( preRotation !== undefined ) {\n\n\t\t\tpreRotation = preRotation.map( MathUtils.degToRad );\n\t\t\tpreRotation.push( eulerOrder );\n\n\t\t\tpreRotation = new Euler().fromArray( preRotation );\n\t\t\tpreRotation = new Quaternion().setFromEuler( preRotation );\n\n\t\t}\n\n\t\tif ( postRotation !== undefined ) {\n\n\t\t\tpostRotation = postRotation.map( MathUtils.degToRad );\n\t\t\tpostRotation.push( eulerOrder );\n\n\t\t\tpostRotation = new Euler().fromArray( postRotation );\n\t\t\tpostRotation = new Quaternion().setFromEuler( postRotation ).invert();\n\n\t\t}\n\n\t\tconst quaternion = new Quaternion();\n\t\tconst euler = new Euler();\n\n\t\tconst quaternionValues = [];\n\n\t\tfor ( let i = 0; i < values.length; i += 3 ) {\n\n\t\t\teuler.set( values[ i ], values[ i + 1 ], values[ i + 2 ], eulerOrder );\n\n\t\t\tquaternion.setFromEuler( euler );\n\n\t\t\tif ( preRotation !== undefined ) quaternion.premultiply( preRotation );\n\t\t\tif ( postRotation !== undefined ) quaternion.multiply( postRotation );\n\n\t\t\tquaternion.toArray( quaternionValues, ( i / 3 ) * 4 );\n\n\t\t}\n\n\t\treturn new QuaternionKeyframeTrack( modelName + '.quaternion', times, quaternionValues );\n\n\t}\n\n\tgenerateMorphTrack( rawTracks ) {\n\n\t\tconst curves = rawTracks.DeformPercent.curves.morph;\n\t\tconst values = curves.values.map( function ( val ) {\n\n\t\t\treturn val / 100;\n\n\t\t} );\n\n\t\tconst morphNum = sceneGraph.getObjectByName( rawTracks.modelName ).morphTargetDictionary[ rawTracks.morphName ];\n\n\t\treturn new NumberKeyframeTrack( rawTracks.modelName + '.morphTargetInfluences[' + morphNum + ']', curves.times, values );\n\n\t}\n\n\t// For all animated objects, times are defined separately for each axis\n\t// Here we'll combine the times into one sorted array without duplicates\n\tgetTimesForAllAxes( curves ) {\n\n\t\tlet times = [];\n\n\t\t// first join together the times for each axis, if defined\n\t\tif ( curves.x !== undefined ) times = times.concat( curves.x.times );\n\t\tif ( curves.y !== undefined ) times = times.concat( curves.y.times );\n\t\tif ( curves.z !== undefined ) times = times.concat( curves.z.times );\n\n\t\t// then sort them\n\t\ttimes = times.sort( function ( a, b ) {\n\n\t\t\treturn a - b;\n\n\t\t} );\n\n\t\t// and remove duplicates\n\t\tif ( times.length > 1 ) {\n\n\t\t\tlet targetIndex = 1;\n\t\t\tlet lastValue = times[ 0 ];\n\t\t\tfor ( let i = 1; i < times.length; i ++ ) {\n\n\t\t\t\tconst currentValue = times[ i ];\n\t\t\t\tif ( currentValue !== lastValue ) {\n\n\t\t\t\t\ttimes[ targetIndex ] = currentValue;\n\t\t\t\t\tlastValue = currentValue;\n\t\t\t\t\ttargetIndex ++;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\ttimes = times.slice( 0, targetIndex );\n\n\t\t}\n\n\t\treturn times;\n\n\t}\n\n\tgetKeyframeTrackValues( times, curves, initialValue ) {\n\n\t\tconst prevValue = initialValue;\n\n\t\tconst values = [];\n\n\t\tlet xIndex = - 1;\n\t\tlet yIndex = - 1;\n\t\tlet zIndex = - 1;\n\n\t\ttimes.forEach( function ( time ) {\n\n\t\t\tif ( curves.x ) xIndex = curves.x.times.indexOf( time );\n\t\t\tif ( curves.y ) yIndex = curves.y.times.indexOf( time );\n\t\t\tif ( curves.z ) zIndex = curves.z.times.indexOf( time );\n\n\t\t\t// if there is an x value defined for this frame, use that\n\t\t\tif ( xIndex !== - 1 ) {\n\n\t\t\t\tconst xValue = curves.x.values[ xIndex ];\n\t\t\t\tvalues.push( xValue );\n\t\t\t\tprevValue[ 0 ] = xValue;\n\n\t\t\t} else {\n\n\t\t\t\t// otherwise use the x value from the previous frame\n\t\t\t\tvalues.push( prevValue[ 0 ] );\n\n\t\t\t}\n\n\t\t\tif ( yIndex !== - 1 ) {\n\n\t\t\t\tconst yValue = curves.y.values[ yIndex ];\n\t\t\t\tvalues.push( yValue );\n\t\t\t\tprevValue[ 1 ] = yValue;\n\n\t\t\t} else {\n\n\t\t\t\tvalues.push( prevValue[ 1 ] );\n\n\t\t\t}\n\n\t\t\tif ( zIndex !== - 1 ) {\n\n\t\t\t\tconst zValue = curves.z.values[ zIndex ];\n\t\t\t\tvalues.push( zValue );\n\t\t\t\tprevValue[ 2 ] = zValue;\n\n\t\t\t} else {\n\n\t\t\t\tvalues.push( prevValue[ 2 ] );\n\n\t\t\t}\n\n\t\t} );\n\n\t\treturn values;\n\n\t}\n\n\t// Rotations are defined as Euler angles which can have values  of any size\n\t// These will be converted to quaternions which don't support values greater than\n\t// PI, so we'll interpolate large rotations\n\tinterpolateRotations( curve ) {\n\n\t\tfor ( let i = 1; i < curve.values.length; i ++ ) {\n\n\t\t\tconst initialValue = curve.values[ i - 1 ];\n\t\t\tconst valuesSpan = curve.values[ i ] - initialValue;\n\n\t\t\tconst absoluteSpan = Math.abs( valuesSpan );\n\n\t\t\tif ( absoluteSpan >= 180 ) {\n\n\t\t\t\tconst numSubIntervals = absoluteSpan / 180;\n\n\t\t\t\tconst step = valuesSpan / numSubIntervals;\n\t\t\t\tlet nextValue = initialValue + step;\n\n\t\t\t\tconst initialTime = curve.times[ i - 1 ];\n\t\t\t\tconst timeSpan = curve.times[ i ] - initialTime;\n\t\t\t\tconst interval = timeSpan / numSubIntervals;\n\t\t\t\tlet nextTime = initialTime + interval;\n\n\t\t\t\tconst interpolatedTimes = [];\n\t\t\t\tconst interpolatedValues = [];\n\n\t\t\t\twhile ( nextTime < curve.times[ i ] ) {\n\n\t\t\t\t\tinterpolatedTimes.push( nextTime );\n\t\t\t\t\tnextTime += interval;\n\n\t\t\t\t\tinterpolatedValues.push( nextValue );\n\t\t\t\t\tnextValue += step;\n\n\t\t\t\t}\n\n\t\t\t\tcurve.times = inject( curve.times, i, interpolatedTimes );\n\t\t\t\tcurve.values = inject( curve.values, i, interpolatedValues );\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n}\n\n// parse an FBX file in ASCII format\nclass TextParser {\n\n\tgetPrevNode() {\n\n\t\treturn this.nodeStack[ this.currentIndent - 2 ];\n\n\t}\n\n\tgetCurrentNode() {\n\n\t\treturn this.nodeStack[ this.currentIndent - 1 ];\n\n\t}\n\n\tgetCurrentProp() {\n\n\t\treturn this.currentProp;\n\n\t}\n\n\tpushStack( node ) {\n\n\t\tthis.nodeStack.push( node );\n\t\tthis.currentIndent += 1;\n\n\t}\n\n\tpopStack() {\n\n\t\tthis.nodeStack.pop();\n\t\tthis.currentIndent -= 1;\n\n\t}\n\n\tsetCurrentProp( val, name ) {\n\n\t\tthis.currentProp = val;\n\t\tthis.currentPropName = name;\n\n\t}\n\n\tparse( text ) {\n\n\t\tthis.currentIndent = 0;\n\n\t\tthis.allNodes = new FBXTree();\n\t\tthis.nodeStack = [];\n\t\tthis.currentProp = [];\n\t\tthis.currentPropName = '';\n\n\t\tconst scope = this;\n\n\t\tconst split = text.split( /[\\r\\n]+/ );\n\n\t\tsplit.forEach( function ( line, i ) {\n\n\t\t\tconst matchComment = line.match( /^[\\s\\t]*;/ );\n\t\t\tconst matchEmpty = line.match( /^[\\s\\t]*$/ );\n\n\t\t\tif ( matchComment || matchEmpty ) return;\n\n\t\t\tconst matchBeginning = line.match( '^\\\\t{' + scope.currentIndent + '}(\\\\w+):(.*){', '' );\n\t\t\tconst matchProperty = line.match( '^\\\\t{' + ( scope.currentIndent ) + '}(\\\\w+):[\\\\s\\\\t\\\\r\\\\n](.*)' );\n\t\t\tconst matchEnd = line.match( '^\\\\t{' + ( scope.currentIndent - 1 ) + '}}' );\n\n\t\t\tif ( matchBeginning ) {\n\n\t\t\t\tscope.parseNodeBegin( line, matchBeginning );\n\n\t\t\t} else if ( matchProperty ) {\n\n\t\t\t\tscope.parseNodeProperty( line, matchProperty, split[ ++ i ] );\n\n\t\t\t} else if ( matchEnd ) {\n\n\t\t\t\tscope.popStack();\n\n\t\t\t} else if ( line.match( /^[^\\s\\t}]/ ) ) {\n\n\t\t\t\t// large arrays are split over multiple lines terminated with a ',' character\n\t\t\t\t// if this is encountered the line needs to be joined to the previous line\n\t\t\t\tscope.parseNodePropertyContinued( line );\n\n\t\t\t}\n\n\t\t} );\n\n\t\treturn this.allNodes;\n\n\t}\n\n\tparseNodeBegin( line, property ) {\n\n\t\tconst nodeName = property[ 1 ].trim().replace( /^\"/, '' ).replace( /\"$/, '' );\n\n\t\tconst nodeAttrs = property[ 2 ].split( ',' ).map( function ( attr ) {\n\n\t\t\treturn attr.trim().replace( /^\"/, '' ).replace( /\"$/, '' );\n\n\t\t} );\n\n\t\tconst node = { name: nodeName };\n\t\tconst attrs = this.parseNodeAttr( nodeAttrs );\n\n\t\tconst currentNode = this.getCurrentNode();\n\n\t\t// a top node\n\t\tif ( this.currentIndent === 0 ) {\n\n\t\t\tthis.allNodes.add( nodeName, node );\n\n\t\t} else { // a subnode\n\n\t\t\t// if the subnode already exists, append it\n\t\t\tif ( nodeName in currentNode ) {\n\n\t\t\t\t// special case Pose needs PoseNodes as an array\n\t\t\t\tif ( nodeName === 'PoseNode' ) {\n\n\t\t\t\t\tcurrentNode.PoseNode.push( node );\n\n\t\t\t\t} else if ( currentNode[ nodeName ].id !== undefined ) {\n\n\t\t\t\t\tcurrentNode[ nodeName ] = {};\n\t\t\t\t\tcurrentNode[ nodeName ][ currentNode[ nodeName ].id ] = currentNode[ nodeName ];\n\n\t\t\t\t}\n\n\t\t\t\tif ( attrs.id !== '' ) currentNode[ nodeName ][ attrs.id ] = node;\n\n\t\t\t} else if ( typeof attrs.id === 'number' ) {\n\n\t\t\t\tcurrentNode[ nodeName ] = {};\n\t\t\t\tcurrentNode[ nodeName ][ attrs.id ] = node;\n\n\t\t\t} else if ( nodeName !== 'Properties70' ) {\n\n\t\t\t\tif ( nodeName === 'PoseNode' )\tcurrentNode[ nodeName ] = [ node ];\n\t\t\t\telse currentNode[ nodeName ] = node;\n\n\t\t\t}\n\n\t\t}\n\n\t\tif ( typeof attrs.id === 'number' ) node.id = attrs.id;\n\t\tif ( attrs.name !== '' ) node.attrName = attrs.name;\n\t\tif ( attrs.type !== '' ) node.attrType = attrs.type;\n\n\t\tthis.pushStack( node );\n\n\t}\n\n\tparseNodeAttr( attrs ) {\n\n\t\tlet id = attrs[ 0 ];\n\n\t\tif ( attrs[ 0 ] !== '' ) {\n\n\t\t\tid = parseInt( attrs[ 0 ] );\n\n\t\t\tif ( isNaN( id ) ) {\n\n\t\t\t\tid = attrs[ 0 ];\n\n\t\t\t}\n\n\t\t}\n\n\t\tlet name = '', type = '';\n\n\t\tif ( attrs.length > 1 ) {\n\n\t\t\tname = attrs[ 1 ].replace( /^(\\w+)::/, '' );\n\t\t\ttype = attrs[ 2 ];\n\n\t\t}\n\n\t\treturn { id: id, name: name, type: type };\n\n\t}\n\n\tparseNodeProperty( line, property, contentLine ) {\n\n\t\tlet propName = property[ 1 ].replace( /^\"/, '' ).replace( /\"$/, '' ).trim();\n\t\tlet propValue = property[ 2 ].replace( /^\"/, '' ).replace( /\"$/, '' ).trim();\n\n\t\t// for special case: base64 image data follows \"Content: ,\" line\n\t\t//\tContent: ,\n\t\t//\t \"/9j/4RDaRXhpZgAATU0A...\"\n\t\tif ( propName === 'Content' && propValue === ',' ) {\n\n\t\t\tpropValue = contentLine.replace( /\"/g, '' ).replace( /,$/, '' ).trim();\n\n\t\t}\n\n\t\tconst currentNode = this.getCurrentNode();\n\t\tconst parentName = currentNode.name;\n\n\t\tif ( parentName === 'Properties70' ) {\n\n\t\t\tthis.parseNodeSpecialProperty( line, propName, propValue );\n\t\t\treturn;\n\n\t\t}\n\n\t\t// Connections\n\t\tif ( propName === 'C' ) {\n\n\t\t\tconst connProps = propValue.split( ',' ).slice( 1 );\n\t\t\tconst from = parseInt( connProps[ 0 ] );\n\t\t\tconst to = parseInt( connProps[ 1 ] );\n\n\t\t\tlet rest = propValue.split( ',' ).slice( 3 );\n\n\t\t\trest = rest.map( function ( elem ) {\n\n\t\t\t\treturn elem.trim().replace( /^\"/, '' );\n\n\t\t\t} );\n\n\t\t\tpropName = 'connections';\n\t\t\tpropValue = [ from, to ];\n\t\t\tappend( propValue, rest );\n\n\t\t\tif ( currentNode[ propName ] === undefined ) {\n\n\t\t\t\tcurrentNode[ propName ] = [];\n\n\t\t\t}\n\n\t\t}\n\n\t\t// Node\n\t\tif ( propName === 'Node' ) currentNode.id = propValue;\n\n\t\t// connections\n\t\tif ( propName in currentNode && Array.isArray( currentNode[ propName ] ) ) {\n\n\t\t\tcurrentNode[ propName ].push( propValue );\n\n\t\t} else {\n\n\t\t\tif ( propName !== 'a' ) currentNode[ propName ] = propValue;\n\t\t\telse currentNode.a = propValue;\n\n\t\t}\n\n\t\tthis.setCurrentProp( currentNode, propName );\n\n\t\t// convert string to array, unless it ends in ',' in which case more will be added to it\n\t\tif ( propName === 'a' && propValue.slice( - 1 ) !== ',' ) {\n\n\t\t\tcurrentNode.a = parseNumberArray( propValue );\n\n\t\t}\n\n\t}\n\n\tparseNodePropertyContinued( line ) {\n\n\t\tconst currentNode = this.getCurrentNode();\n\n\t\tcurrentNode.a += line;\n\n\t\t// if the line doesn't end in ',' we have reached the end of the property value\n\t\t// so convert the string to an array\n\t\tif ( line.slice( - 1 ) !== ',' ) {\n\n\t\t\tcurrentNode.a = parseNumberArray( currentNode.a );\n\n\t\t}\n\n\t}\n\n\t// parse \"Property70\"\n\tparseNodeSpecialProperty( line, propName, propValue ) {\n\n\t\t// split this\n\t\t// P: \"Lcl Scaling\", \"Lcl Scaling\", \"\", \"A\",1,1,1\n\t\t// into array like below\n\t\t// [\"Lcl Scaling\", \"Lcl Scaling\", \"\", \"A\", \"1,1,1\" ]\n\t\tconst props = propValue.split( '\",' ).map( function ( prop ) {\n\n\t\t\treturn prop.trim().replace( /^\\\"/, '' ).replace( /\\s/, '_' );\n\n\t\t} );\n\n\t\tconst innerPropName = props[ 0 ];\n\t\tconst innerPropType1 = props[ 1 ];\n\t\tconst innerPropType2 = props[ 2 ];\n\t\tconst innerPropFlag = props[ 3 ];\n\t\tlet innerPropValue = props[ 4 ];\n\n\t\t// cast values where needed, otherwise leave as strings\n\t\tswitch ( innerPropType1 ) {\n\n\t\t\tcase 'int':\n\t\t\tcase 'enum':\n\t\t\tcase 'bool':\n\t\t\tcase 'ULongLong':\n\t\t\tcase 'double':\n\t\t\tcase 'Number':\n\t\t\tcase 'FieldOfView':\n\t\t\t\tinnerPropValue = parseFloat( innerPropValue );\n\t\t\t\tbreak;\n\n\t\t\tcase 'Color':\n\t\t\tcase 'ColorRGB':\n\t\t\tcase 'Vector3D':\n\t\t\tcase 'Lcl_Translation':\n\t\t\tcase 'Lcl_Rotation':\n\t\t\tcase 'Lcl_Scaling':\n\t\t\t\tinnerPropValue = parseNumberArray( innerPropValue );\n\t\t\t\tbreak;\n\n\t\t}\n\n\t\t// CAUTION: these props must append to parent's parent\n\t\tthis.getPrevNode()[ innerPropName ] = {\n\n\t\t\t'type': innerPropType1,\n\t\t\t'type2': innerPropType2,\n\t\t\t'flag': innerPropFlag,\n\t\t\t'value': innerPropValue\n\n\t\t};\n\n\t\tthis.setCurrentProp( this.getPrevNode(), innerPropName );\n\n\t}\n\n}\n\n// Parse an FBX file in Binary format\nclass BinaryParser {\n\n\tparse( buffer ) {\n\n\t\tconst reader = new BinaryReader( buffer );\n\t\treader.skip( 23 ); // skip magic 23 bytes\n\n\t\tconst version = reader.getUint32();\n\n\t\tif ( version < 6400 ) {\n\n\t\t\tthrow new Error( 'THREE.FBXLoader: FBX version not supported, FileVersion: ' + version );\n\n\t\t}\n\n\t\tconst allNodes = new FBXTree();\n\n\t\twhile ( ! this.endOfContent( reader ) ) {\n\n\t\t\tconst node = this.parseNode( reader, version );\n\t\t\tif ( node !== null ) allNodes.add( node.name, node );\n\n\t\t}\n\n\t\treturn allNodes;\n\n\t}\n\n\t// Check if reader has reached the end of content.\n\tendOfContent( reader ) {\n\n\t\t// footer size: 160bytes + 16-byte alignment padding\n\t\t// - 16bytes: magic\n\t\t// - padding til 16-byte alignment (at least 1byte?)\n\t\t//\t(seems like some exporters embed fixed 15 or 16bytes?)\n\t\t// - 4bytes: magic\n\t\t// - 4bytes: version\n\t\t// - 120bytes: zero\n\t\t// - 16bytes: magic\n\t\tif ( reader.size() % 16 === 0 ) {\n\n\t\t\treturn ( ( reader.getOffset() + 160 + 16 ) & ~ 0xf ) >= reader.size();\n\n\t\t} else {\n\n\t\t\treturn reader.getOffset() + 160 + 16 >= reader.size();\n\n\t\t}\n\n\t}\n\n\t// recursively parse nodes until the end of the file is reached\n\tparseNode( reader, version ) {\n\n\t\tconst node = {};\n\n\t\t// The first three data sizes depends on version.\n\t\tconst endOffset = ( version >= 7500 ) ? reader.getUint64() : reader.getUint32();\n\t\tconst numProperties = ( version >= 7500 ) ? reader.getUint64() : reader.getUint32();\n\n\t\t( version >= 7500 ) ? reader.getUint64() : reader.getUint32(); // the returned propertyListLen is not used\n\n\t\tconst nameLen = reader.getUint8();\n\t\tconst name = reader.getString( nameLen );\n\n\t\t// Regards this node as NULL-record if endOffset is zero\n\t\tif ( endOffset === 0 ) return null;\n\n\t\tconst propertyList = [];\n\n\t\tfor ( let i = 0; i < numProperties; i ++ ) {\n\n\t\t\tpropertyList.push( this.parseProperty( reader ) );\n\n\t\t}\n\n\t\t// Regards the first three elements in propertyList as id, attrName, and attrType\n\t\tconst id = propertyList.length > 0 ? propertyList[ 0 ] : '';\n\t\tconst attrName = propertyList.length > 1 ? propertyList[ 1 ] : '';\n\t\tconst attrType = propertyList.length > 2 ? propertyList[ 2 ] : '';\n\n\t\t// check if this node represents just a single property\n\t\t// like (name, 0) set or (name2, [0, 1, 2]) set of {name: 0, name2: [0, 1, 2]}\n\t\tnode.singleProperty = ( numProperties === 1 && reader.getOffset() === endOffset ) ? true : false;\n\n\t\twhile ( endOffset > reader.getOffset() ) {\n\n\t\t\tconst subNode = this.parseNode( reader, version );\n\n\t\t\tif ( subNode !== null ) this.parseSubNode( name, node, subNode );\n\n\t\t}\n\n\t\tnode.propertyList = propertyList; // raw property list used by parent\n\n\t\tif ( typeof id === 'number' ) node.id = id;\n\t\tif ( attrName !== '' ) node.attrName = attrName;\n\t\tif ( attrType !== '' ) node.attrType = attrType;\n\t\tif ( name !== '' ) node.name = name;\n\n\t\treturn node;\n\n\t}\n\n\tparseSubNode( name, node, subNode ) {\n\n\t\t// special case: child node is single property\n\t\tif ( subNode.singleProperty === true ) {\n\n\t\t\tconst value = subNode.propertyList[ 0 ];\n\n\t\t\tif ( Array.isArray( value ) ) {\n\n\t\t\t\tnode[ subNode.name ] = subNode;\n\n\t\t\t\tsubNode.a = value;\n\n\t\t\t} else {\n\n\t\t\t\tnode[ subNode.name ] = value;\n\n\t\t\t}\n\n\t\t} else if ( name === 'Connections' && subNode.name === 'C' ) {\n\n\t\t\tconst array = [];\n\n\t\t\tsubNode.propertyList.forEach( function ( property, i ) {\n\n\t\t\t\t// first Connection is FBX type (OO, OP, etc.). We'll discard these\n\t\t\t\tif ( i !== 0 ) array.push( property );\n\n\t\t\t} );\n\n\t\t\tif ( node.connections === undefined ) {\n\n\t\t\t\tnode.connections = [];\n\n\t\t\t}\n\n\t\t\tnode.connections.push( array );\n\n\t\t} else if ( subNode.name === 'Properties70' ) {\n\n\t\t\tconst keys = Object.keys( subNode );\n\n\t\t\tkeys.forEach( function ( key ) {\n\n\t\t\t\tnode[ key ] = subNode[ key ];\n\n\t\t\t} );\n\n\t\t} else if ( name === 'Properties70' && subNode.name === 'P' ) {\n\n\t\t\tlet innerPropName = subNode.propertyList[ 0 ];\n\t\t\tlet innerPropType1 = subNode.propertyList[ 1 ];\n\t\t\tconst innerPropType2 = subNode.propertyList[ 2 ];\n\t\t\tconst innerPropFlag = subNode.propertyList[ 3 ];\n\t\t\tlet innerPropValue;\n\n\t\t\tif ( innerPropName.indexOf( 'Lcl ' ) === 0 ) innerPropName = innerPropName.replace( 'Lcl ', 'Lcl_' );\n\t\t\tif ( innerPropType1.indexOf( 'Lcl ' ) === 0 ) innerPropType1 = innerPropType1.replace( 'Lcl ', 'Lcl_' );\n\n\t\t\tif ( innerPropType1 === 'Color' || innerPropType1 === 'ColorRGB' || innerPropType1 === 'Vector' || innerPropType1 === 'Vector3D' || innerPropType1.indexOf( 'Lcl_' ) === 0 ) {\n\n\t\t\t\tinnerPropValue = [\n\t\t\t\t\tsubNode.propertyList[ 4 ],\n\t\t\t\t\tsubNode.propertyList[ 5 ],\n\t\t\t\t\tsubNode.propertyList[ 6 ]\n\t\t\t\t];\n\n\t\t\t} else {\n\n\t\t\t\tinnerPropValue = subNode.propertyList[ 4 ];\n\n\t\t\t}\n\n\t\t\t// this will be copied to parent, see above\n\t\t\tnode[ innerPropName ] = {\n\n\t\t\t\t'type': innerPropType1,\n\t\t\t\t'type2': innerPropType2,\n\t\t\t\t'flag': innerPropFlag,\n\t\t\t\t'value': innerPropValue\n\n\t\t\t};\n\n\t\t} else if ( node[ subNode.name ] === undefined ) {\n\n\t\t\tif ( typeof subNode.id === 'number' ) {\n\n\t\t\t\tnode[ subNode.name ] = {};\n\t\t\t\tnode[ subNode.name ][ subNode.id ] = subNode;\n\n\t\t\t} else {\n\n\t\t\t\tnode[ subNode.name ] = subNode;\n\n\t\t\t}\n\n\t\t} else {\n\n\t\t\tif ( subNode.name === 'PoseNode' ) {\n\n\t\t\t\tif ( ! Array.isArray( node[ subNode.name ] ) ) {\n\n\t\t\t\t\tnode[ subNode.name ] = [ node[ subNode.name ] ];\n\n\t\t\t\t}\n\n\t\t\t\tnode[ subNode.name ].push( subNode );\n\n\t\t\t} else if ( node[ subNode.name ][ subNode.id ] === undefined ) {\n\n\t\t\t\tnode[ subNode.name ][ subNode.id ] = subNode;\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\tparseProperty( reader ) {\n\n\t\tconst type = reader.getString( 1 );\n\t\tlet length;\n\n\t\tswitch ( type ) {\n\n\t\t\tcase 'C':\n\t\t\t\treturn reader.getBoolean();\n\n\t\t\tcase 'D':\n\t\t\t\treturn reader.getFloat64();\n\n\t\t\tcase 'F':\n\t\t\t\treturn reader.getFloat32();\n\n\t\t\tcase 'I':\n\t\t\t\treturn reader.getInt32();\n\n\t\t\tcase 'L':\n\t\t\t\treturn reader.getInt64();\n\n\t\t\tcase 'R':\n\t\t\t\tlength = reader.getUint32();\n\t\t\t\treturn reader.getArrayBuffer( length );\n\n\t\t\tcase 'S':\n\t\t\t\tlength = reader.getUint32();\n\t\t\t\treturn reader.getString( length );\n\n\t\t\tcase 'Y':\n\t\t\t\treturn reader.getInt16();\n\n\t\t\tcase 'b':\n\t\t\tcase 'c':\n\t\t\tcase 'd':\n\t\t\tcase 'f':\n\t\t\tcase 'i':\n\t\t\tcase 'l':\n\n\t\t\t\tconst arrayLength = reader.getUint32();\n\t\t\t\tconst encoding = reader.getUint32(); // 0: non-compressed, 1: compressed\n\t\t\t\tconst compressedLength = reader.getUint32();\n\n\t\t\t\tif ( encoding === 0 ) {\n\n\t\t\t\t\tswitch ( type ) {\n\n\t\t\t\t\t\tcase 'b':\n\t\t\t\t\t\tcase 'c':\n\t\t\t\t\t\t\treturn reader.getBooleanArray( arrayLength );\n\n\t\t\t\t\t\tcase 'd':\n\t\t\t\t\t\t\treturn reader.getFloat64Array( arrayLength );\n\n\t\t\t\t\t\tcase 'f':\n\t\t\t\t\t\t\treturn reader.getFloat32Array( arrayLength );\n\n\t\t\t\t\t\tcase 'i':\n\t\t\t\t\t\t\treturn reader.getInt32Array( arrayLength );\n\n\t\t\t\t\t\tcase 'l':\n\t\t\t\t\t\t\treturn reader.getInt64Array( arrayLength );\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\tif ( typeof fflate === 'undefined' ) {\n\n\t\t\t\t\tconsole.error( 'THREE.FBXLoader: External library fflate.min.js required.' );\n\n\t\t\t\t}\n\n\t\t\t\tconst data = fflate.unzlibSync( new Uint8Array( reader.getArrayBuffer( compressedLength ) ) ); // eslint-disable-line no-undef\n\t\t\t\tconst reader2 = new BinaryReader( data.buffer );\n\n\t\t\t\tswitch ( type ) {\n\n\t\t\t\t\tcase 'b':\n\t\t\t\t\tcase 'c':\n\t\t\t\t\t\treturn reader2.getBooleanArray( arrayLength );\n\n\t\t\t\t\tcase 'd':\n\t\t\t\t\t\treturn reader2.getFloat64Array( arrayLength );\n\n\t\t\t\t\tcase 'f':\n\t\t\t\t\t\treturn reader2.getFloat32Array( arrayLength );\n\n\t\t\t\t\tcase 'i':\n\t\t\t\t\t\treturn reader2.getInt32Array( arrayLength );\n\n\t\t\t\t\tcase 'l':\n\t\t\t\t\t\treturn reader2.getInt64Array( arrayLength );\n\n\t\t\t\t}\n\n\t\t\tdefault:\n\t\t\t\tthrow new Error( 'THREE.FBXLoader: Unknown property type ' + type );\n\n\t\t}\n\n\t}\n\n}\n\nclass BinaryReader {\n\n\tconstructor( buffer, littleEndian ) {\n\n\t\tthis.dv = new DataView( buffer );\n\t\tthis.offset = 0;\n\t\tthis.littleEndian = ( littleEndian !== undefined ) ? littleEndian : true;\n\n\t}\n\n\tgetOffset() {\n\n\t\treturn this.offset;\n\n\t}\n\n\tsize() {\n\n\t\treturn this.dv.buffer.byteLength;\n\n\t}\n\n\tskip( length ) {\n\n\t\tthis.offset += length;\n\n\t}\n\n\t// seems like true/false representation depends on exporter.\n\t// true: 1 or 'Y'(=0x59), false: 0 or 'T'(=0x54)\n\t// then sees LSB.\n\tgetBoolean() {\n\n\t\treturn ( this.getUint8() & 1 ) === 1;\n\n\t}\n\n\tgetBooleanArray( size ) {\n\n\t\tconst a = [];\n\n\t\tfor ( let i = 0; i < size; i ++ ) {\n\n\t\t\ta.push( this.getBoolean() );\n\n\t\t}\n\n\t\treturn a;\n\n\t}\n\n\tgetUint8() {\n\n\t\tconst value = this.dv.getUint8( this.offset );\n\t\tthis.offset += 1;\n\t\treturn value;\n\n\t}\n\n\tgetInt16() {\n\n\t\tconst value = this.dv.getInt16( this.offset, this.littleEndian );\n\t\tthis.offset += 2;\n\t\treturn value;\n\n\t}\n\n\tgetInt32() {\n\n\t\tconst value = this.dv.getInt32( this.offset, this.littleEndian );\n\t\tthis.offset += 4;\n\t\treturn value;\n\n\t}\n\n\tgetInt32Array( size ) {\n\n\t\tconst a = [];\n\n\t\tfor ( let i = 0; i < size; i ++ ) {\n\n\t\t\ta.push( this.getInt32() );\n\n\t\t}\n\n\t\treturn a;\n\n\t}\n\n\tgetUint32() {\n\n\t\tconst value = this.dv.getUint32( this.offset, this.littleEndian );\n\t\tthis.offset += 4;\n\t\treturn value;\n\n\t}\n\n\t// JavaScript doesn't support 64-bit integer so calculate this here\n\t// 1 << 32 will return 1 so using multiply operation instead here.\n\t// There's a possibility that this method returns wrong value if the value\n\t// is out of the range between Number.MAX_SAFE_INTEGER and Number.MIN_SAFE_INTEGER.\n\t// TODO: safely handle 64-bit integer\n\tgetInt64() {\n\n\t\tlet low, high;\n\n\t\tif ( this.littleEndian ) {\n\n\t\t\tlow = this.getUint32();\n\t\t\thigh = this.getUint32();\n\n\t\t} else {\n\n\t\t\thigh = this.getUint32();\n\t\t\tlow = this.getUint32();\n\n\t\t}\n\n\t\t// calculate negative value\n\t\tif ( high & 0x80000000 ) {\n\n\t\t\thigh = ~ high & 0xFFFFFFFF;\n\t\t\tlow = ~ low & 0xFFFFFFFF;\n\n\t\t\tif ( low === 0xFFFFFFFF ) high = ( high + 1 ) & 0xFFFFFFFF;\n\n\t\t\tlow = ( low + 1 ) & 0xFFFFFFFF;\n\n\t\t\treturn - ( high * 0x100000000 + low );\n\n\t\t}\n\n\t\treturn high * 0x100000000 + low;\n\n\t}\n\n\tgetInt64Array( size ) {\n\n\t\tconst a = [];\n\n\t\tfor ( let i = 0; i < size; i ++ ) {\n\n\t\t\ta.push( this.getInt64() );\n\n\t\t}\n\n\t\treturn a;\n\n\t}\n\n\t// Note: see getInt64() comment\n\tgetUint64() {\n\n\t\tlet low, high;\n\n\t\tif ( this.littleEndian ) {\n\n\t\t\tlow = this.getUint32();\n\t\t\thigh = this.getUint32();\n\n\t\t} else {\n\n\t\t\thigh = this.getUint32();\n\t\t\tlow = this.getUint32();\n\n\t\t}\n\n\t\treturn high * 0x100000000 + low;\n\n\t}\n\n\tgetFloat32() {\n\n\t\tconst value = this.dv.getFloat32( this.offset, this.littleEndian );\n\t\tthis.offset += 4;\n\t\treturn value;\n\n\t}\n\n\tgetFloat32Array( size ) {\n\n\t\tconst a = [];\n\n\t\tfor ( let i = 0; i < size; i ++ ) {\n\n\t\t\ta.push( this.getFloat32() );\n\n\t\t}\n\n\t\treturn a;\n\n\t}\n\n\tgetFloat64() {\n\n\t\tconst value = this.dv.getFloat64( this.offset, this.littleEndian );\n\t\tthis.offset += 8;\n\t\treturn value;\n\n\t}\n\n\tgetFloat64Array( size ) {\n\n\t\tconst a = [];\n\n\t\tfor ( let i = 0; i < size; i ++ ) {\n\n\t\t\ta.push( this.getFloat64() );\n\n\t\t}\n\n\t\treturn a;\n\n\t}\n\n\tgetArrayBuffer( size ) {\n\n\t\tconst value = this.dv.buffer.slice( this.offset, this.offset + size );\n\t\tthis.offset += size;\n\t\treturn value;\n\n\t}\n\n\tgetString( size ) {\n\n\t\t// note: safari 9 doesn't support Uint8Array.indexOf; create intermediate array instead\n\t\tlet a = [];\n\n\t\tfor ( let i = 0; i < size; i ++ ) {\n\n\t\t\ta[ i ] = this.getUint8();\n\n\t\t}\n\n\t\tconst nullByte = a.indexOf( 0 );\n\t\tif ( nullByte >= 0 ) a = a.slice( 0, nullByte );\n\n\t\treturn LoaderUtils.decodeText( new Uint8Array( a ) );\n\n\t}\n\n}\n\n// FBXTree holds a representation of the FBX data, returned by the TextParser ( FBX ASCII format)\n// and BinaryParser( FBX Binary format)\nclass FBXTree {\n\n\tadd( key, val ) {\n\n\t\tthis[ key ] = val;\n\n\t}\n\n}\n\n// ************** UTILITY FUNCTIONS **************\n\nfunction isFbxFormatBinary( buffer ) {\n\n\tconst CORRECT = 'Kaydara\\u0020FBX\\u0020Binary\\u0020\\u0020\\0';\n\n\treturn buffer.byteLength >= CORRECT.length && CORRECT === convertArrayBufferToString( buffer, 0, CORRECT.length );\n\n}\n\nfunction isFbxFormatASCII( text ) {\n\n\tconst CORRECT = [ 'K', 'a', 'y', 'd', 'a', 'r', 'a', '\\\\', 'F', 'B', 'X', '\\\\', 'B', 'i', 'n', 'a', 'r', 'y', '\\\\', '\\\\' ];\n\n\tlet cursor = 0;\n\n\tfunction read( offset ) {\n\n\t\tconst result = text[ offset - 1 ];\n\t\ttext = text.slice( cursor + offset );\n\t\tcursor ++;\n\t\treturn result;\n\n\t}\n\n\tfor ( let i = 0; i < CORRECT.length; ++ i ) {\n\n\t\tconst num = read( 1 );\n\t\tif ( num === CORRECT[ i ] ) {\n\n\t\t\treturn false;\n\n\t\t}\n\n\t}\n\n\treturn true;\n\n}\n\nfunction getFbxVersion( text ) {\n\n\tconst versionRegExp = /FBXVersion: (\\d+)/;\n\tconst match = text.match( versionRegExp );\n\n\tif ( match ) {\n\n\t\tconst version = parseInt( match[ 1 ] );\n\t\treturn version;\n\n\t}\n\n\tthrow new Error( 'THREE.FBXLoader: Cannot find the version number for the file given.' );\n\n}\n\n// Converts FBX ticks into real time seconds.\nfunction convertFBXTimeToSeconds( time ) {\n\n\treturn time / 46186158000;\n\n}\n\nconst dataArray = [];\n\n// extracts the data from the correct position in the FBX array based on indexing type\nfunction getData( polygonVertexIndex, polygonIndex, vertexIndex, infoObject ) {\n\n\tlet index;\n\n\tswitch ( infoObject.mappingType ) {\n\n\t\tcase 'ByPolygonVertex' :\n\t\t\tindex = polygonVertexIndex;\n\t\t\tbreak;\n\t\tcase 'ByPolygon' :\n\t\t\tindex = polygonIndex;\n\t\t\tbreak;\n\t\tcase 'ByVertice' :\n\t\t\tindex = vertexIndex;\n\t\t\tbreak;\n\t\tcase 'AllSame' :\n\t\t\tindex = infoObject.indices[ 0 ];\n\t\t\tbreak;\n\t\tdefault :\n\t\t\tconsole.warn( 'THREE.FBXLoader: unknown attribute mapping type ' + infoObject.mappingType );\n\n\t}\n\n\tif ( infoObject.referenceType === 'IndexToDirect' ) index = infoObject.indices[ index ];\n\n\tconst from = index * infoObject.dataSize;\n\tconst to = from + infoObject.dataSize;\n\n\treturn slice( dataArray, infoObject.buffer, from, to );\n\n}\n\nconst tempEuler = new Euler();\nconst tempVec = new Vector3();\n\n// generate transformation from FBX transform data\n// ref: https://help.autodesk.com/view/FBX/2017/ENU/?guid=__files_GUID_10CDD63C_79C1_4F2D_BB28_AD2BE65A02ED_htm\n// ref: http://docs.autodesk.com/FBX/2014/ENU/FBX-SDK-Documentation/index.html?url=cpp_ref/_transformations_2main_8cxx-example.html,topicNumber=cpp_ref__transformations_2main_8cxx_example_htmlfc10a1e1-b18d-4e72-9dc0-70d0f1959f5e\nfunction generateTransform( transformData ) {\n\n\tconst lTranslationM = new Matrix4();\n\tconst lPreRotationM = new Matrix4();\n\tconst lRotationM = new Matrix4();\n\tconst lPostRotationM = new Matrix4();\n\n\tconst lScalingM = new Matrix4();\n\tconst lScalingPivotM = new Matrix4();\n\tconst lScalingOffsetM = new Matrix4();\n\tconst lRotationOffsetM = new Matrix4();\n\tconst lRotationPivotM = new Matrix4();\n\n\tconst lParentGX = new Matrix4();\n\tconst lParentLX = new Matrix4();\n\tconst lGlobalT = new Matrix4();\n\n\tconst inheritType = ( transformData.inheritType ) ? transformData.inheritType : 0;\n\n\tif ( transformData.translation ) lTranslationM.setPosition( tempVec.fromArray( transformData.translation ) );\n\n\tif ( transformData.preRotation ) {\n\n\t\tconst array = transformData.preRotation.map( MathUtils.degToRad );\n\t\tarray.push( transformData.eulerOrder );\n\t\tlPreRotationM.makeRotationFromEuler( tempEuler.fromArray( array ) );\n\n\t}\n\n\tif ( transformData.rotation ) {\n\n\t\tconst array = transformData.rotation.map( MathUtils.degToRad );\n\t\tarray.push( transformData.eulerOrder );\n\t\tlRotationM.makeRotationFromEuler( tempEuler.fromArray( array ) );\n\n\t}\n\n\tif ( transformData.postRotation ) {\n\n\t\tconst array = transformData.postRotation.map( MathUtils.degToRad );\n\t\tarray.push( transformData.eulerOrder );\n\t\tlPostRotationM.makeRotationFromEuler( tempEuler.fromArray( array ) );\n\t\tlPostRotationM.invert();\n\n\t}\n\n\tif ( transformData.scale ) lScalingM.scale( tempVec.fromArray( transformData.scale ) );\n\n\t// Pivots and offsets\n\tif ( transformData.scalingOffset ) lScalingOffsetM.setPosition( tempVec.fromArray( transformData.scalingOffset ) );\n\tif ( transformData.scalingPivot ) lScalingPivotM.setPosition( tempVec.fromArray( transformData.scalingPivot ) );\n\tif ( transformData.rotationOffset ) lRotationOffsetM.setPosition( tempVec.fromArray( transformData.rotationOffset ) );\n\tif ( transformData.rotationPivot ) lRotationPivotM.setPosition( tempVec.fromArray( transformData.rotationPivot ) );\n\n\t// parent transform\n\tif ( transformData.parentMatrixWorld ) {\n\n\t\tlParentLX.copy( transformData.parentMatrix );\n\t\tlParentGX.copy( transformData.parentMatrixWorld );\n\n\t}\n\n\tconst lLRM = lPreRotationM.clone().multiply( lRotationM ).multiply( lPostRotationM );\n\t// Global Rotation\n\tconst lParentGRM = new Matrix4();\n\tlParentGRM.extractRotation( lParentGX );\n\n\t// Global Shear*Scaling\n\tconst lParentTM = new Matrix4();\n\tlParentTM.copyPosition( lParentGX );\n\n\tconst lParentGRSM = lParentTM.clone().invert().multiply( lParentGX );\n\tconst lParentGSM = lParentGRM.clone().invert().multiply( lParentGRSM );\n\tconst lLSM = lScalingM;\n\n\tconst lGlobalRS = new Matrix4();\n\n\tif ( inheritType === 0 ) {\n\n\t\tlGlobalRS.copy( lParentGRM ).multiply( lLRM ).multiply( lParentGSM ).multiply( lLSM );\n\n\t} else if ( inheritType === 1 ) {\n\n\t\tlGlobalRS.copy( lParentGRM ).multiply( lParentGSM ).multiply( lLRM ).multiply( lLSM );\n\n\t} else {\n\n\t\tconst lParentLSM = new Matrix4().scale( new Vector3().setFromMatrixScale( lParentLX ) );\n\t\tconst lParentLSM_inv = lParentLSM.clone().invert();\n\t\tconst lParentGSM_noLocal = lParentGSM.clone().multiply( lParentLSM_inv );\n\n\t\tlGlobalRS.copy( lParentGRM ).multiply( lLRM ).multiply( lParentGSM_noLocal ).multiply( lLSM );\n\n\t}\n\n\tconst lRotationPivotM_inv = lRotationPivotM.clone().invert();\n\tconst lScalingPivotM_inv = lScalingPivotM.clone().invert();\n\t// Calculate the local transform matrix\n\tlet lTransform = lTranslationM.clone().multiply( lRotationOffsetM ).multiply( lRotationPivotM ).multiply( lPreRotationM ).multiply( lRotationM ).multiply( lPostRotationM ).multiply( lRotationPivotM_inv ).multiply( lScalingOffsetM ).multiply( lScalingPivotM ).multiply( lScalingM ).multiply( lScalingPivotM_inv );\n\n\tconst lLocalTWithAllPivotAndOffsetInfo = new Matrix4().copyPosition( lTransform );\n\n\tconst lGlobalTranslation = lParentGX.clone().multiply( lLocalTWithAllPivotAndOffsetInfo );\n\tlGlobalT.copyPosition( lGlobalTranslation );\n\n\tlTransform = lGlobalT.clone().multiply( lGlobalRS );\n\n\t// from global to local\n\tlTransform.premultiply( lParentGX.invert() );\n\n\treturn lTransform;\n\n}\n\n// Returns the three.js intrinsic Euler order corresponding to FBX extrinsic Euler order\n// ref: http://help.autodesk.com/view/FBX/2017/ENU/?guid=__cpp_ref_class_fbx_euler_html\nfunction getEulerOrder( order ) {\n\n\torder = order || 0;\n\n\tconst enums = [\n\t\t'ZYX', // -> XYZ extrinsic\n\t\t'YZX', // -> XZY extrinsic\n\t\t'XZY', // -> YZX extrinsic\n\t\t'ZXY', // -> YXZ extrinsic\n\t\t'YXZ', // -> ZXY extrinsic\n\t\t'XYZ', // -> ZYX extrinsic\n\t\t//'SphericXYZ', // not possible to support\n\t];\n\n\tif ( order === 6 ) {\n\n\t\tconsole.warn( 'THREE.FBXLoader: unsupported Euler Order: Spherical XYZ. Animations and rotations may be incorrect.' );\n\t\treturn enums[ 0 ];\n\n\t}\n\n\treturn enums[ order ];\n\n}\n\n// Parses comma separated list of numbers and returns them an array.\n// Used internally by the TextParser\nfunction parseNumberArray( value ) {\n\n\tconst array = value.split( ',' ).map( function ( val ) {\n\n\t\treturn parseFloat( val );\n\n\t} );\n\n\treturn array;\n\n}\n\nfunction convertArrayBufferToString( buffer, from, to ) {\n\n\tif ( from === undefined ) from = 0;\n\tif ( to === undefined ) to = buffer.byteLength;\n\n\treturn LoaderUtils.decodeText( new Uint8Array( buffer, from, to ) );\n\n}\n\nfunction append( a, b ) {\n\n\tfor ( let i = 0, j = a.length, l = b.length; i < l; i ++, j ++ ) {\n\n\t\ta[ j ] = b[ i ];\n\n\t}\n\n}\n\nfunction slice( a, b, from, to ) {\n\n\tfor ( let i = from, j = 0; i < to; i ++, j ++ ) {\n\n\t\ta[ j ] = b[ i ];\n\n\t}\n\n\treturn a;\n\n}\n\n// inject array a2 into array a1 at index\nfunction inject( a1, index, a2 ) {\n\n\treturn a1.slice( 0, index ).concat( a2 ).concat( a1.slice( index ) );\n\n}\n\nexport { FBXLoader };\n","import {\n\tAnimationClip,\n\tBone,\n\tBox3,\n\tBufferAttribute,\n\tBufferGeometry,\n\tClampToEdgeWrapping,\n\tColor,\n\tDirectionalLight,\n\tDoubleSide,\n\tFileLoader,\n\tFrontSide,\n\tGroup,\n\tImageBitmapLoader,\n\tInterleavedBuffer,\n\tInterleavedBufferAttribute,\n\tInterpolant,\n\tInterpolateDiscrete,\n\tInterpolateLinear,\n\tLine,\n\tLineBasicMaterial,\n\tLineLoop,\n\tLineSegments,\n\tLinearFilter,\n\tLinearMipmapLinearFilter,\n\tLinearMipmapNearestFilter,\n\tLoader,\n\tLoaderUtils,\n\tMaterial,\n\tMathUtils,\n\tMatrix4,\n\tMesh,\n\tMeshBasicMaterial,\n\tMeshPhysicalMaterial,\n\tMeshStandardMaterial,\n\tMirroredRepeatWrapping,\n\tNearestFilter,\n\tNearestMipmapLinearFilter,\n\tNearestMipmapNearestFilter,\n\tNumberKeyframeTrack,\n\tObject3D,\n\tOrthographicCamera,\n\tPerspectiveCamera,\n\tPointLight,\n\tPoints,\n\tPointsMaterial,\n\tPropertyBinding,\n\tQuaternionKeyframeTrack,\n\tRGBFormat,\n\tRepeatWrapping,\n\tSkeleton,\n\tSkinnedMesh,\n\tSphere,\n\tSpotLight,\n\tTangentSpaceNormalMap,\n\tTexture,\n\tTextureLoader,\n\tTriangleFanDrawMode,\n\tTriangleStripDrawMode,\n\tVector2,\n\tVector3,\n\tVectorKeyframeTrack,\n\tsRGBEncoding\n} from 'three';\n\nclass GLTFLoader extends Loader {\n\n\tconstructor( manager ) {\n\n\t\tsuper( manager );\n\n\t\tthis.dracoLoader = null;\n\t\tthis.ktx2Loader = null;\n\t\tthis.meshoptDecoder = null;\n\n\t\tthis.pluginCallbacks = [];\n\n\t\tthis.register( function ( parser ) {\n\n\t\t\treturn new GLTFMaterialsClearcoatExtension( parser );\n\n\t\t} );\n\n\t\tthis.register( function ( parser ) {\n\n\t\t\treturn new GLTFTextureBasisUExtension( parser );\n\n\t\t} );\n\n\t\tthis.register( function ( parser ) {\n\n\t\t\treturn new GLTFTextureWebPExtension( parser );\n\n\t\t} );\n\n\t\tthis.register( function ( parser ) {\n\n\t\t\treturn new GLTFMaterialsTransmissionExtension( parser );\n\n\t\t} );\n\n\t\tthis.register( function ( parser ) {\n\n\t\t\treturn new GLTFLightsExtension( parser );\n\n\t\t} );\n\n\t\tthis.register( function ( parser ) {\n\n\t\t\treturn new GLTFMeshoptCompression( parser );\n\n\t\t} );\n\n\t}\n\n\tload( url, onLoad, onProgress, onError ) {\n\n\t\tconst scope = this;\n\n\t\tlet resourcePath;\n\n\t\tif ( this.resourcePath !== '' ) {\n\n\t\t\tresourcePath = this.resourcePath;\n\n\t\t} else if ( this.path !== '' ) {\n\n\t\t\tresourcePath = this.path;\n\n\t\t} else {\n\n\t\t\tresourcePath = LoaderUtils.extractUrlBase( url );\n\n\t\t}\n\n\t\t// Tells the LoadingManager to track an extra item, which resolves after\n\t\t// the model is fully loaded. This means the count of items loaded will\n\t\t// be incorrect, but ensures manager.onLoad() does not fire early.\n\t\tthis.manager.itemStart( url );\n\n\t\tconst _onError = function ( e ) {\n\n\t\t\tif ( onError ) {\n\n\t\t\t\tonError( e );\n\n\t\t\t} else {\n\n\t\t\t\tconsole.error( e );\n\n\t\t\t}\n\n\t\t\tscope.manager.itemError( url );\n\t\t\tscope.manager.itemEnd( url );\n\n\t\t};\n\n\t\tconst loader = new FileLoader( this.manager );\n\n\t\tloader.setPath( this.path );\n\t\tloader.setResponseType( 'arraybuffer' );\n\t\tloader.setRequestHeader( this.requestHeader );\n\t\tloader.setWithCredentials( this.withCredentials );\n\n\t\tloader.load( url, function ( data ) {\n\n\t\t\ttry {\n\n\t\t\t\tscope.parse( data, resourcePath, function ( gltf ) {\n\n\t\t\t\t\tonLoad( gltf );\n\n\t\t\t\t\tscope.manager.itemEnd( url );\n\n\t\t\t\t}, _onError );\n\n\t\t\t} catch ( e ) {\n\n\t\t\t\t_onError( e );\n\n\t\t\t}\n\n\t\t}, onProgress, _onError );\n\n\t}\n\n\tsetDRACOLoader( dracoLoader ) {\n\n\t\tthis.dracoLoader = dracoLoader;\n\t\treturn this;\n\n\t}\n\n\tsetDDSLoader() {\n\n\t\tthrow new Error(\n\n\t\t\t'THREE.GLTFLoader: \"MSFT_texture_dds\" no longer supported. Please update to \"KHR_texture_basisu\".'\n\n\t\t);\n\n\t}\n\n\tsetKTX2Loader( ktx2Loader ) {\n\n\t\tthis.ktx2Loader = ktx2Loader;\n\t\treturn this;\n\n\t}\n\n\tsetMeshoptDecoder( meshoptDecoder ) {\n\n\t\tthis.meshoptDecoder = meshoptDecoder;\n\t\treturn this;\n\n\t}\n\n\tregister( callback ) {\n\n\t\tif ( this.pluginCallbacks.indexOf( callback ) === - 1 ) {\n\n\t\t\tthis.pluginCallbacks.push( callback );\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tunregister( callback ) {\n\n\t\tif ( this.pluginCallbacks.indexOf( callback ) !== - 1 ) {\n\n\t\t\tthis.pluginCallbacks.splice( this.pluginCallbacks.indexOf( callback ), 1 );\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tparse( data, path, onLoad, onError ) {\n\n\t\tlet content;\n\t\tconst extensions = {};\n\t\tconst plugins = {};\n\n\t\tif ( typeof data === 'string' ) {\n\n\t\t\tcontent = data;\n\n\t\t} else {\n\n\t\t\tconst magic = LoaderUtils.decodeText( new Uint8Array( data, 0, 4 ) );\n\n\t\t\tif ( magic === BINARY_EXTENSION_HEADER_MAGIC ) {\n\n\t\t\t\ttry {\n\n\t\t\t\t\textensions[ EXTENSIONS.KHR_BINARY_GLTF ] = new GLTFBinaryExtension( data );\n\n\t\t\t\t} catch ( error ) {\n\n\t\t\t\t\tif ( onError ) onError( error );\n\t\t\t\t\treturn;\n\n\t\t\t\t}\n\n\t\t\t\tcontent = extensions[ EXTENSIONS.KHR_BINARY_GLTF ].content;\n\n\t\t\t} else {\n\n\t\t\t\tcontent = LoaderUtils.decodeText( new Uint8Array( data ) );\n\n\t\t\t}\n\n\t\t}\n\n\t\tconst json = JSON.parse( content );\n\n\t\tif ( json.asset === undefined || json.asset.version[ 0 ] < 2 ) {\n\n\t\t\tif ( onError ) onError( new Error( 'THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported.' ) );\n\t\t\treturn;\n\n\t\t}\n\n\t\tconst parser = new GLTFParser( json, {\n\n\t\t\tpath: path || this.resourcePath || '',\n\t\t\tcrossOrigin: this.crossOrigin,\n\t\t\trequestHeader: this.requestHeader,\n\t\t\tmanager: this.manager,\n\t\t\tktx2Loader: this.ktx2Loader,\n\t\t\tmeshoptDecoder: this.meshoptDecoder\n\n\t\t} );\n\n\t\tparser.fileLoader.setRequestHeader( this.requestHeader );\n\n\t\tfor ( let i = 0; i < this.pluginCallbacks.length; i ++ ) {\n\n\t\t\tconst plugin = this.pluginCallbacks[ i ]( parser );\n\t\t\tplugins[ plugin.name ] = plugin;\n\n\t\t\t// Workaround to avoid determining as unknown extension\n\t\t\t// in addUnknownExtensionsToUserData().\n\t\t\t// Remove this workaround if we move all the existing\n\t\t\t// extension handlers to plugin system\n\t\t\textensions[ plugin.name ] = true;\n\n\t\t}\n\n\t\tif ( json.extensionsUsed ) {\n\n\t\t\tfor ( let i = 0; i < json.extensionsUsed.length; ++ i ) {\n\n\t\t\t\tconst extensionName = json.extensionsUsed[ i ];\n\t\t\t\tconst extensionsRequired = json.extensionsRequired || [];\n\n\t\t\t\tswitch ( extensionName ) {\n\n\t\t\t\t\tcase EXTENSIONS.KHR_MATERIALS_UNLIT:\n\t\t\t\t\t\textensions[ extensionName ] = new GLTFMaterialsUnlitExtension();\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase EXTENSIONS.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS:\n\t\t\t\t\t\textensions[ extensionName ] = new GLTFMaterialsPbrSpecularGlossinessExtension();\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase EXTENSIONS.KHR_DRACO_MESH_COMPRESSION:\n\t\t\t\t\t\textensions[ extensionName ] = new GLTFDracoMeshCompressionExtension( json, this.dracoLoader );\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase EXTENSIONS.KHR_TEXTURE_TRANSFORM:\n\t\t\t\t\t\textensions[ extensionName ] = new GLTFTextureTransformExtension();\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase EXTENSIONS.KHR_MESH_QUANTIZATION:\n\t\t\t\t\t\textensions[ extensionName ] = new GLTFMeshQuantizationExtension();\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tdefault:\n\n\t\t\t\t\t\tif ( extensionsRequired.indexOf( extensionName ) >= 0 && plugins[ extensionName ] === undefined ) {\n\n\t\t\t\t\t\t\tconsole.warn( 'THREE.GLTFLoader: Unknown extension \"' + extensionName + '\".' );\n\n\t\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\tparser.setExtensions( extensions );\n\t\tparser.setPlugins( plugins );\n\t\tparser.parse( onLoad, onError );\n\n\t}\n\n}\n\n/* GLTFREGISTRY */\n\nfunction GLTFRegistry() {\n\n\tlet objects = {};\n\n\treturn\t{\n\n\t\tget: function ( key ) {\n\n\t\t\treturn objects[ key ];\n\n\t\t},\n\n\t\tadd: function ( key, object ) {\n\n\t\t\tobjects[ key ] = object;\n\n\t\t},\n\n\t\tremove: function ( key ) {\n\n\t\t\tdelete objects[ key ];\n\n\t\t},\n\n\t\tremoveAll: function () {\n\n\t\t\tobjects = {};\n\n\t\t}\n\n\t};\n\n}\n\n/*********************************/\n/********** EXTENSIONS ***********/\n/*********************************/\n\nconst EXTENSIONS = {\n\tKHR_BINARY_GLTF: 'KHR_binary_glTF',\n\tKHR_DRACO_MESH_COMPRESSION: 'KHR_draco_mesh_compression',\n\tKHR_LIGHTS_PUNCTUAL: 'KHR_lights_punctual',\n\tKHR_MATERIALS_CLEARCOAT: 'KHR_materials_clearcoat',\n\tKHR_MATERIALS_PBR_SPECULAR_GLOSSINESS: 'KHR_materials_pbrSpecularGlossiness',\n\tKHR_MATERIALS_TRANSMISSION: 'KHR_materials_transmission',\n\tKHR_MATERIALS_UNLIT: 'KHR_materials_unlit',\n\tKHR_TEXTURE_BASISU: 'KHR_texture_basisu',\n\tKHR_TEXTURE_TRANSFORM: 'KHR_texture_transform',\n\tKHR_MESH_QUANTIZATION: 'KHR_mesh_quantization',\n\tEXT_TEXTURE_WEBP: 'EXT_texture_webp',\n\tEXT_MESHOPT_COMPRESSION: 'EXT_meshopt_compression'\n};\n\n/**\n * Punctual Lights Extension\n *\n * Specification: https://github.com/KhronosGroup/glTF/tree/master/extensions/2.0/Khronos/KHR_lights_punctual\n */\nclass GLTFLightsExtension {\n\n\tconstructor( parser ) {\n\n\t\tthis.parser = parser;\n\t\tthis.name = EXTENSIONS.KHR_LIGHTS_PUNCTUAL;\n\n\t\t// Object3D instance caches\n\t\tthis.cache = { refs: {}, uses: {} };\n\n\t}\n\n\t_markDefs() {\n\n\t\tconst parser = this.parser;\n\t\tconst nodeDefs = this.parser.json.nodes || [];\n\n\t\tfor ( let nodeIndex = 0, nodeLength = nodeDefs.length; nodeIndex < nodeLength; nodeIndex ++ ) {\n\n\t\t\tconst nodeDef = nodeDefs[ nodeIndex ];\n\n\t\t\tif ( nodeDef.extensions\n\t\t\t\t\t&& nodeDef.extensions[ this.name ]\n\t\t\t\t\t&& nodeDef.extensions[ this.name ].light !== undefined ) {\n\n\t\t\t\tparser._addNodeRef( this.cache, nodeDef.extensions[ this.name ].light );\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\t_loadLight( lightIndex ) {\n\n\t\tconst parser = this.parser;\n\t\tconst cacheKey = 'light:' + lightIndex;\n\t\tlet dependency = parser.cache.get( cacheKey );\n\n\t\tif ( dependency ) return dependency;\n\n\t\tconst json = parser.json;\n\t\tconst extensions = ( json.extensions && json.extensions[ this.name ] ) || {};\n\t\tconst lightDefs = extensions.lights || [];\n\t\tconst lightDef = lightDefs[ lightIndex ];\n\t\tlet lightNode;\n\n\t\tconst color = new Color( 0xffffff );\n\n\t\tif ( lightDef.color !== undefined ) color.fromArray( lightDef.color );\n\n\t\tconst range = lightDef.range !== undefined ? lightDef.range : 0;\n\n\t\tswitch ( lightDef.type ) {\n\n\t\t\tcase 'directional':\n\t\t\t\tlightNode = new DirectionalLight( color );\n\t\t\t\tlightNode.target.position.set( 0, 0, - 1 );\n\t\t\t\tlightNode.add( lightNode.target );\n\t\t\t\tbreak;\n\n\t\t\tcase 'point':\n\t\t\t\tlightNode = new PointLight( color );\n\t\t\t\tlightNode.distance = range;\n\t\t\t\tbreak;\n\n\t\t\tcase 'spot':\n\t\t\t\tlightNode = new SpotLight( color );\n\t\t\t\tlightNode.distance = range;\n\t\t\t\t// Handle spotlight properties.\n\t\t\t\tlightDef.spot = lightDef.spot || {};\n\t\t\t\tlightDef.spot.innerConeAngle = lightDef.spot.innerConeAngle !== undefined ? lightDef.spot.innerConeAngle : 0;\n\t\t\t\tlightDef.spot.outerConeAngle = lightDef.spot.outerConeAngle !== undefined ? lightDef.spot.outerConeAngle : Math.PI / 4.0;\n\t\t\t\tlightNode.angle = lightDef.spot.outerConeAngle;\n\t\t\t\tlightNode.penumbra = 1.0 - lightDef.spot.innerConeAngle / lightDef.spot.outerConeAngle;\n\t\t\t\tlightNode.target.position.set( 0, 0, - 1 );\n\t\t\t\tlightNode.add( lightNode.target );\n\t\t\t\tbreak;\n\n\t\t\tdefault:\n\t\t\t\tthrow new Error( 'THREE.GLTFLoader: Unexpected light type: ' + lightDef.type );\n\n\t\t}\n\n\t\t// Some lights (e.g. spot) default to a position other than the origin. Reset the position\n\t\t// here, because node-level parsing will only override position if explicitly specified.\n\t\tlightNode.position.set( 0, 0, 0 );\n\n\t\tlightNode.decay = 2;\n\n\t\tif ( lightDef.intensity !== undefined ) lightNode.intensity = lightDef.intensity;\n\n\t\tlightNode.name = parser.createUniqueName( lightDef.name || ( 'light_' + lightIndex ) );\n\n\t\tdependency = Promise.resolve( lightNode );\n\n\t\tparser.cache.add( cacheKey, dependency );\n\n\t\treturn dependency;\n\n\t}\n\n\tcreateNodeAttachment( nodeIndex ) {\n\n\t\tconst self = this;\n\t\tconst parser = this.parser;\n\t\tconst json = parser.json;\n\t\tconst nodeDef = json.nodes[ nodeIndex ];\n\t\tconst lightDef = ( nodeDef.extensions && nodeDef.extensions[ this.name ] ) || {};\n\t\tconst lightIndex = lightDef.light;\n\n\t\tif ( lightIndex === undefined ) return null;\n\n\t\treturn this._loadLight( lightIndex ).then( function ( light ) {\n\n\t\t\treturn parser._getNodeRef( self.cache, lightIndex, light );\n\n\t\t} );\n\n\t}\n\n}\n\n/**\n * Unlit Materials Extension\n *\n * Specification: https://github.com/KhronosGroup/glTF/tree/master/extensions/2.0/Khronos/KHR_materials_unlit\n */\nclass GLTFMaterialsUnlitExtension {\n\n\tconstructor() {\n\n\t\tthis.name = EXTENSIONS.KHR_MATERIALS_UNLIT;\n\n\t}\n\n\tgetMaterialType() {\n\n\t\treturn MeshBasicMaterial;\n\n\t}\n\n\textendParams( materialParams, materialDef, parser ) {\n\n\t\tconst pending = [];\n\n\t\tmaterialParams.color = new Color( 1.0, 1.0, 1.0 );\n\t\tmaterialParams.opacity = 1.0;\n\n\t\tconst metallicRoughness = materialDef.pbrMetallicRoughness;\n\n\t\tif ( metallicRoughness ) {\n\n\t\t\tif ( Array.isArray( metallicRoughness.baseColorFactor ) ) {\n\n\t\t\t\tconst array = metallicRoughness.baseColorFactor;\n\n\t\t\t\tmaterialParams.color.fromArray( array );\n\t\t\t\tmaterialParams.opacity = array[ 3 ];\n\n\t\t\t}\n\n\t\t\tif ( metallicRoughness.baseColorTexture !== undefined ) {\n\n\t\t\t\tpending.push( parser.assignTexture( materialParams, 'map', metallicRoughness.baseColorTexture ) );\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn Promise.all( pending );\n\n\t}\n\n}\n\n/**\n * Clearcoat Materials Extension\n *\n * Specification: https://github.com/KhronosGroup/glTF/tree/master/extensions/2.0/Khronos/KHR_materials_clearcoat\n */\nclass GLTFMaterialsClearcoatExtension {\n\n\tconstructor( parser ) {\n\n\t\tthis.parser = parser;\n\t\tthis.name = EXTENSIONS.KHR_MATERIALS_CLEARCOAT;\n\n\t}\n\n\tgetMaterialType( materialIndex ) {\n\n\t\tconst parser = this.parser;\n\t\tconst materialDef = parser.json.materials[ materialIndex ];\n\n\t\tif ( ! materialDef.extensions || ! materialDef.extensions[ this.name ] ) return null;\n\n\t\treturn MeshPhysicalMaterial;\n\n\t}\n\n\textendMaterialParams( materialIndex, materialParams ) {\n\n\t\tconst parser = this.parser;\n\t\tconst materialDef = parser.json.materials[ materialIndex ];\n\n\t\tif ( ! materialDef.extensions || ! materialDef.extensions[ this.name ] ) {\n\n\t\t\treturn Promise.resolve();\n\n\t\t}\n\n\t\tconst pending = [];\n\n\t\tconst extension = materialDef.extensions[ this.name ];\n\n\t\tif ( extension.clearcoatFactor !== undefined ) {\n\n\t\t\tmaterialParams.clearcoat = extension.clearcoatFactor;\n\n\t\t}\n\n\t\tif ( extension.clearcoatTexture !== undefined ) {\n\n\t\t\tpending.push( parser.assignTexture( materialParams, 'clearcoatMap', extension.clearcoatTexture ) );\n\n\t\t}\n\n\t\tif ( extension.clearcoatRoughnessFactor !== undefined ) {\n\n\t\t\tmaterialParams.clearcoatRoughness = extension.clearcoatRoughnessFactor;\n\n\t\t}\n\n\t\tif ( extension.clearcoatRoughnessTexture !== undefined ) {\n\n\t\t\tpending.push( parser.assignTexture( materialParams, 'clearcoatRoughnessMap', extension.clearcoatRoughnessTexture ) );\n\n\t\t}\n\n\t\tif ( extension.clearcoatNormalTexture !== undefined ) {\n\n\t\t\tpending.push( parser.assignTexture( materialParams, 'clearcoatNormalMap', extension.clearcoatNormalTexture ) );\n\n\t\t\tif ( extension.clearcoatNormalTexture.scale !== undefined ) {\n\n\t\t\t\tconst scale = extension.clearcoatNormalTexture.scale;\n\n\t\t\t\t// https://github.com/mrdoob/three.js/issues/11438#issuecomment-507003995\n\t\t\t\tmaterialParams.clearcoatNormalScale = new Vector2( scale, - scale );\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn Promise.all( pending );\n\n\t}\n\n}\n\n/**\n * Transmission Materials Extension\n *\n * Specification: https://github.com/KhronosGroup/glTF/tree/master/extensions/2.0/Khronos/KHR_materials_transmission\n * Draft: https://github.com/KhronosGroup/glTF/pull/1698\n */\nclass GLTFMaterialsTransmissionExtension {\n\n\tconstructor( parser ) {\n\n\t\tthis.parser = parser;\n\t\tthis.name = EXTENSIONS.KHR_MATERIALS_TRANSMISSION;\n\n\t}\n\n\tgetMaterialType( materialIndex ) {\n\n\t\tconst parser = this.parser;\n\t\tconst materialDef = parser.json.materials[ materialIndex ];\n\n\t\tif ( ! materialDef.extensions || ! materialDef.extensions[ this.name ] ) return null;\n\n\t\treturn MeshPhysicalMaterial;\n\n\t}\n\n\textendMaterialParams( materialIndex, materialParams ) {\n\n\t\tconst parser = this.parser;\n\t\tconst materialDef = parser.json.materials[ materialIndex ];\n\n\t\tif ( ! materialDef.extensions || ! materialDef.extensions[ this.name ] ) {\n\n\t\t\treturn Promise.resolve();\n\n\t\t}\n\n\t\tconst pending = [];\n\n\t\tconst extension = materialDef.extensions[ this.name ];\n\n\t\tif ( extension.transmissionFactor !== undefined ) {\n\n\t\t\tmaterialParams.transmission = extension.transmissionFactor;\n\n\t\t}\n\n\t\tif ( extension.transmissionTexture !== undefined ) {\n\n\t\t\tpending.push( parser.assignTexture( materialParams, 'transmissionMap', extension.transmissionTexture ) );\n\n\t\t}\n\n\t\treturn Promise.all( pending );\n\n\t}\n\n}\n\n/**\n * BasisU Texture Extension\n *\n * Specification: https://github.com/KhronosGroup/glTF/tree/master/extensions/2.0/Khronos/KHR_texture_basisu\n */\nclass GLTFTextureBasisUExtension {\n\n\tconstructor( parser ) {\n\n\t\tthis.parser = parser;\n\t\tthis.name = EXTENSIONS.KHR_TEXTURE_BASISU;\n\n\t}\n\n\tloadTexture( textureIndex ) {\n\n\t\tconst parser = this.parser;\n\t\tconst json = parser.json;\n\n\t\tconst textureDef = json.textures[ textureIndex ];\n\n\t\tif ( ! textureDef.extensions || ! textureDef.extensions[ this.name ] ) {\n\n\t\t\treturn null;\n\n\t\t}\n\n\t\tconst extension = textureDef.extensions[ this.name ];\n\t\tconst source = json.images[ extension.source ];\n\t\tconst loader = parser.options.ktx2Loader;\n\n\t\tif ( ! loader ) {\n\n\t\t\tif ( json.extensionsRequired && json.extensionsRequired.indexOf( this.name ) >= 0 ) {\n\n\t\t\t\tthrow new Error( 'THREE.GLTFLoader: setKTX2Loader must be called before loading KTX2 textures' );\n\n\t\t\t} else {\n\n\t\t\t\t// Assumes that the extension is optional and that a fallback texture is present\n\t\t\t\treturn null;\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn parser.loadTextureImage( textureIndex, source, loader );\n\n\t}\n\n}\n\n/**\n * WebP Texture Extension\n *\n * Specification: https://github.com/KhronosGroup/glTF/tree/master/extensions/2.0/Vendor/EXT_texture_webp\n */\nclass GLTFTextureWebPExtension {\n\n\tconstructor( parser ) {\n\n\t\tthis.parser = parser;\n\t\tthis.name = EXTENSIONS.EXT_TEXTURE_WEBP;\n\t\tthis.isSupported = null;\n\n\t}\n\n\tloadTexture( textureIndex ) {\n\n\t\tconst name = this.name;\n\t\tconst parser = this.parser;\n\t\tconst json = parser.json;\n\n\t\tconst textureDef = json.textures[ textureIndex ];\n\n\t\tif ( ! textureDef.extensions || ! textureDef.extensions[ name ] ) {\n\n\t\t\treturn null;\n\n\t\t}\n\n\t\tconst extension = textureDef.extensions[ name ];\n\t\tconst source = json.images[ extension.source ];\n\n\t\tlet loader = parser.textureLoader;\n\t\tif ( source.uri ) {\n\n\t\t\tconst handler = parser.options.manager.getHandler( source.uri );\n\t\t\tif ( handler !== null ) loader = handler;\n\n\t\t}\n\n\t\treturn this.detectSupport().then( function ( isSupported ) {\n\n\t\t\tif ( isSupported ) return parser.loadTextureImage( textureIndex, source, loader );\n\n\t\t\tif ( json.extensionsRequired && json.extensionsRequired.indexOf( name ) >= 0 ) {\n\n\t\t\t\tthrow new Error( 'THREE.GLTFLoader: WebP required by asset but unsupported.' );\n\n\t\t\t}\n\n\t\t\t// Fall back to PNG or JPEG.\n\t\t\treturn parser.loadTexture( textureIndex );\n\n\t\t} );\n\n\t}\n\n\tdetectSupport() {\n\n\t\tif ( ! this.isSupported ) {\n\n\t\t\tthis.isSupported = new Promise( function ( resolve ) {\n\n\t\t\t\tconst image = new Image();\n\n\t\t\t\t// Lossy test image. Support for lossy images doesn't guarantee support for all\n\t\t\t\t// WebP images, unfortunately.\n\t\t\t\timage.src = 'data:image/webp;base64,UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA';\n\n\t\t\t\timage.onload = image.onerror = function () {\n\n\t\t\t\t\tresolve( image.height === 1 );\n\n\t\t\t\t};\n\n\t\t\t} );\n\n\t\t}\n\n\t\treturn this.isSupported;\n\n\t}\n\n}\n\n/**\n * meshopt BufferView Compression Extension\n *\n * Specification: https://github.com/KhronosGroup/glTF/tree/master/extensions/2.0/Vendor/EXT_meshopt_compression\n */\nclass GLTFMeshoptCompression {\n\n\tconstructor( parser ) {\n\n\t\tthis.name = EXTENSIONS.EXT_MESHOPT_COMPRESSION;\n\t\tthis.parser = parser;\n\n\t}\n\n\tloadBufferView( index ) {\n\n\t\tconst json = this.parser.json;\n\t\tconst bufferView = json.bufferViews[ index ];\n\n\t\tif ( bufferView.extensions && bufferView.extensions[ this.name ] ) {\n\n\t\t\tconst extensionDef = bufferView.extensions[ this.name ];\n\n\t\t\tconst buffer = this.parser.getDependency( 'buffer', extensionDef.buffer );\n\t\t\tconst decoder = this.parser.options.meshoptDecoder;\n\n\t\t\tif ( ! decoder || ! decoder.supported ) {\n\n\t\t\t\tif ( json.extensionsRequired && json.extensionsRequired.indexOf( this.name ) >= 0 ) {\n\n\t\t\t\t\tthrow new Error( 'THREE.GLTFLoader: setMeshoptDecoder must be called before loading compressed files' );\n\n\t\t\t\t} else {\n\n\t\t\t\t\t// Assumes that the extension is optional and that fallback buffer data is present\n\t\t\t\t\treturn null;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\treturn Promise.all( [ buffer, decoder.ready ] ).then( function ( res ) {\n\n\t\t\t\tconst byteOffset = extensionDef.byteOffset || 0;\n\t\t\t\tconst byteLength = extensionDef.byteLength || 0;\n\n\t\t\t\tconst count = extensionDef.count;\n\t\t\t\tconst stride = extensionDef.byteStride;\n\n\t\t\t\tconst result = new ArrayBuffer( count * stride );\n\t\t\t\tconst source = new Uint8Array( res[ 0 ], byteOffset, byteLength );\n\n\t\t\t\tdecoder.decodeGltfBuffer( new Uint8Array( result ), count, stride, source, extensionDef.mode, extensionDef.filter );\n\t\t\t\treturn result;\n\n\t\t\t} );\n\n\t\t} else {\n\n\t\t\treturn null;\n\n\t\t}\n\n\t}\n\n}\n\n/* BINARY EXTENSION */\nconst BINARY_EXTENSION_HEADER_MAGIC = 'glTF';\nconst BINARY_EXTENSION_HEADER_LENGTH = 12;\nconst BINARY_EXTENSION_CHUNK_TYPES = { JSON: 0x4E4F534A, BIN: 0x004E4942 };\n\nclass GLTFBinaryExtension {\n\n\tconstructor( data ) {\n\n\t\tthis.name = EXTENSIONS.KHR_BINARY_GLTF;\n\t\tthis.content = null;\n\t\tthis.body = null;\n\n\t\tconst headerView = new DataView( data, 0, BINARY_EXTENSION_HEADER_LENGTH );\n\n\t\tthis.header = {\n\t\t\tmagic: LoaderUtils.decodeText( new Uint8Array( data.slice( 0, 4 ) ) ),\n\t\t\tversion: headerView.getUint32( 4, true ),\n\t\t\tlength: headerView.getUint32( 8, true )\n\t\t};\n\n\t\tif ( this.header.magic !== BINARY_EXTENSION_HEADER_MAGIC ) {\n\n\t\t\tthrow new Error( 'THREE.GLTFLoader: Unsupported glTF-Binary header.' );\n\n\t\t} else if ( this.header.version < 2.0 ) {\n\n\t\t\tthrow new Error( 'THREE.GLTFLoader: Legacy binary file detected.' );\n\n\t\t}\n\n\t\tconst chunkContentsLength = this.header.length - BINARY_EXTENSION_HEADER_LENGTH;\n\t\tconst chunkView = new DataView( data, BINARY_EXTENSION_HEADER_LENGTH );\n\t\tlet chunkIndex = 0;\n\n\t\twhile ( chunkIndex < chunkContentsLength ) {\n\n\t\t\tconst chunkLength = chunkView.getUint32( chunkIndex, true );\n\t\t\tchunkIndex += 4;\n\n\t\t\tconst chunkType = chunkView.getUint32( chunkIndex, true );\n\t\t\tchunkIndex += 4;\n\n\t\t\tif ( chunkType === BINARY_EXTENSION_CHUNK_TYPES.JSON ) {\n\n\t\t\t\tconst contentArray = new Uint8Array( data, BINARY_EXTENSION_HEADER_LENGTH + chunkIndex, chunkLength );\n\t\t\t\tthis.content = LoaderUtils.decodeText( contentArray );\n\n\t\t\t} else if ( chunkType === BINARY_EXTENSION_CHUNK_TYPES.BIN ) {\n\n\t\t\t\tconst byteOffset = BINARY_EXTENSION_HEADER_LENGTH + chunkIndex;\n\t\t\t\tthis.body = data.slice( byteOffset, byteOffset + chunkLength );\n\n\t\t\t}\n\n\t\t\t// Clients must ignore chunks with unknown types.\n\n\t\t\tchunkIndex += chunkLength;\n\n\t\t}\n\n\t\tif ( this.content === null ) {\n\n\t\t\tthrow new Error( 'THREE.GLTFLoader: JSON content not found.' );\n\n\t\t}\n\n\t}\n\n}\n\n/**\n * DRACO Mesh Compression Extension\n *\n * Specification: https://github.com/KhronosGroup/glTF/tree/master/extensions/2.0/Khronos/KHR_draco_mesh_compression\n */\nclass GLTFDracoMeshCompressionExtension {\n\n\tconstructor( json, dracoLoader ) {\n\n\t\tif ( ! dracoLoader ) {\n\n\t\t\tthrow new Error( 'THREE.GLTFLoader: No DRACOLoader instance provided.' );\n\n\t\t}\n\n\t\tthis.name = EXTENSIONS.KHR_DRACO_MESH_COMPRESSION;\n\t\tthis.json = json;\n\t\tthis.dracoLoader = dracoLoader;\n\t\tthis.dracoLoader.preload();\n\n\t}\n\n\tdecodePrimitive( primitive, parser ) {\n\n\t\tconst json = this.json;\n\t\tconst dracoLoader = this.dracoLoader;\n\t\tconst bufferViewIndex = primitive.extensions[ this.name ].bufferView;\n\t\tconst gltfAttributeMap = primitive.extensions[ this.name ].attributes;\n\t\tconst threeAttributeMap = {};\n\t\tconst attributeNormalizedMap = {};\n\t\tconst attributeTypeMap = {};\n\n\t\tfor ( const attributeName in gltfAttributeMap ) {\n\n\t\t\tconst threeAttributeName = ATTRIBUTES[ attributeName ] || attributeName.toLowerCase();\n\n\t\t\tthreeAttributeMap[ threeAttributeName ] = gltfAttributeMap[ attributeName ];\n\n\t\t}\n\n\t\tfor ( const attributeName in primitive.attributes ) {\n\n\t\t\tconst threeAttributeName = ATTRIBUTES[ attributeName ] || attributeName.toLowerCase();\n\n\t\t\tif ( gltfAttributeMap[ attributeName ] !== undefined ) {\n\n\t\t\t\tconst accessorDef = json.accessors[ primitive.attributes[ attributeName ] ];\n\t\t\t\tconst componentType = WEBGL_COMPONENT_TYPES[ accessorDef.componentType ];\n\n\t\t\t\tattributeTypeMap[ threeAttributeName ] = componentType;\n\t\t\t\tattributeNormalizedMap[ threeAttributeName ] = accessorDef.normalized === true;\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn parser.getDependency( 'bufferView', bufferViewIndex ).then( function ( bufferView ) {\n\n\t\t\treturn new Promise( function ( resolve ) {\n\n\t\t\t\tdracoLoader.decodeDracoFile( bufferView, function ( geometry ) {\n\n\t\t\t\t\tfor ( const attributeName in geometry.attributes ) {\n\n\t\t\t\t\t\tconst attribute = geometry.attributes[ attributeName ];\n\t\t\t\t\t\tconst normalized = attributeNormalizedMap[ attributeName ];\n\n\t\t\t\t\t\tif ( normalized !== undefined ) attribute.normalized = normalized;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tresolve( geometry );\n\n\t\t\t\t}, threeAttributeMap, attributeTypeMap );\n\n\t\t\t} );\n\n\t\t} );\n\n\t}\n\n}\n\n/**\n * Texture Transform Extension\n *\n * Specification: https://github.com/KhronosGroup/glTF/tree/master/extensions/2.0/Khronos/KHR_texture_transform\n */\nclass GLTFTextureTransformExtension {\n\n\tconstructor() {\n\n\t\tthis.name = EXTENSIONS.KHR_TEXTURE_TRANSFORM;\n\n\t}\n\n\textendTexture( texture, transform ) {\n\n\t\tif ( transform.texCoord !== undefined ) {\n\n\t\t\tconsole.warn( 'THREE.GLTFLoader: Custom UV sets in \"' + this.name + '\" extension not yet supported.' );\n\n\t\t}\n\n\t\tif ( transform.offset === undefined && transform.rotation === undefined && transform.scale === undefined ) {\n\n\t\t\t// See https://github.com/mrdoob/three.js/issues/21819.\n\t\t\treturn texture;\n\n\t\t}\n\n\t\ttexture = texture.clone();\n\n\t\tif ( transform.offset !== undefined ) {\n\n\t\t\ttexture.offset.fromArray( transform.offset );\n\n\t\t}\n\n\t\tif ( transform.rotation !== undefined ) {\n\n\t\t\ttexture.rotation = transform.rotation;\n\n\t\t}\n\n\t\tif ( transform.scale !== undefined ) {\n\n\t\t\ttexture.repeat.fromArray( transform.scale );\n\n\t\t}\n\n\t\ttexture.needsUpdate = true;\n\n\t\treturn texture;\n\n\t}\n\n}\n\n/**\n * Specular-Glossiness Extension\n *\n * Specification: https://github.com/KhronosGroup/glTF/tree/master/extensions/2.0/Khronos/KHR_materials_pbrSpecularGlossiness\n */\n\n/**\n * A sub class of StandardMaterial with some of the functionality\n * changed via the `onBeforeCompile` callback\n * @pailhead\n */\nclass GLTFMeshStandardSGMaterial extends MeshStandardMaterial {\n\n\tconstructor( params ) {\n\n\t\tsuper();\n\n\t\tthis.isGLTFSpecularGlossinessMaterial = true;\n\n\t\t//various chunks that need replacing\n\t\tconst specularMapParsFragmentChunk = [\n\t\t\t'#ifdef USE_SPECULARMAP',\n\t\t\t'\tuniform sampler2D specularMap;',\n\t\t\t'#endif'\n\t\t].join( '\\n' );\n\n\t\tconst glossinessMapParsFragmentChunk = [\n\t\t\t'#ifdef USE_GLOSSINESSMAP',\n\t\t\t'\tuniform sampler2D glossinessMap;',\n\t\t\t'#endif'\n\t\t].join( '\\n' );\n\n\t\tconst specularMapFragmentChunk = [\n\t\t\t'vec3 specularFactor = specular;',\n\t\t\t'#ifdef USE_SPECULARMAP',\n\t\t\t'\tvec4 texelSpecular = texture2D( specularMap, vUv );',\n\t\t\t'\ttexelSpecular = sRGBToLinear( texelSpecular );',\n\t\t\t'\t// reads channel RGB, compatible with a glTF Specular-Glossiness (RGBA) texture',\n\t\t\t'\tspecularFactor *= texelSpecular.rgb;',\n\t\t\t'#endif'\n\t\t].join( '\\n' );\n\n\t\tconst glossinessMapFragmentChunk = [\n\t\t\t'float glossinessFactor = glossiness;',\n\t\t\t'#ifdef USE_GLOSSINESSMAP',\n\t\t\t'\tvec4 texelGlossiness = texture2D( glossinessMap, vUv );',\n\t\t\t'\t// reads channel A, compatible with a glTF Specular-Glossiness (RGBA) texture',\n\t\t\t'\tglossinessFactor *= texelGlossiness.a;',\n\t\t\t'#endif'\n\t\t].join( '\\n' );\n\n\t\tconst lightPhysicalFragmentChunk = [\n\t\t\t'PhysicalMaterial material;',\n\t\t\t'material.diffuseColor = diffuseColor.rgb * ( 1. - max( specularFactor.r, max( specularFactor.g, specularFactor.b ) ) );',\n\t\t\t'vec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );',\n\t\t\t'float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );',\n\t\t\t'material.specularRoughness = max( 1.0 - glossinessFactor, 0.0525 ); // 0.0525 corresponds to the base mip of a 256 cubemap.',\n\t\t\t'material.specularRoughness += geometryRoughness;',\n\t\t\t'material.specularRoughness = min( material.specularRoughness, 1.0 );',\n\t\t\t'material.specularColor = specularFactor;',\n\t\t].join( '\\n' );\n\n\t\tconst uniforms = {\n\t\t\tspecular: { value: new Color().setHex( 0xffffff ) },\n\t\t\tglossiness: { value: 1 },\n\t\t\tspecularMap: { value: null },\n\t\t\tglossinessMap: { value: null }\n\t\t};\n\n\t\tthis._extraUniforms = uniforms;\n\n\t\tthis.onBeforeCompile = function ( shader ) {\n\n\t\t\tfor ( const uniformName in uniforms ) {\n\n\t\t\t\tshader.uniforms[ uniformName ] = uniforms[ uniformName ];\n\n\t\t\t}\n\n\t\t\tshader.fragmentShader = shader.fragmentShader\n\t\t\t\t.replace( 'uniform float roughness;', 'uniform vec3 specular;' )\n\t\t\t\t.replace( 'uniform float metalness;', 'uniform float glossiness;' )\n\t\t\t\t.replace( '#include <roughnessmap_pars_fragment>', specularMapParsFragmentChunk )\n\t\t\t\t.replace( '#include <metalnessmap_pars_fragment>', glossinessMapParsFragmentChunk )\n\t\t\t\t.replace( '#include <roughnessmap_fragment>', specularMapFragmentChunk )\n\t\t\t\t.replace( '#include <metalnessmap_fragment>', glossinessMapFragmentChunk )\n\t\t\t\t.replace( '#include <lights_physical_fragment>', lightPhysicalFragmentChunk );\n\n\t\t};\n\n\t\tObject.defineProperties( this, {\n\n\t\t\tspecular: {\n\t\t\t\tget: function () {\n\n\t\t\t\t\treturn uniforms.specular.value;\n\n\t\t\t\t},\n\t\t\t\tset: function ( v ) {\n\n\t\t\t\t\tuniforms.specular.value = v;\n\n\t\t\t\t}\n\t\t\t},\n\n\t\t\tspecularMap: {\n\t\t\t\tget: function () {\n\n\t\t\t\t\treturn uniforms.specularMap.value;\n\n\t\t\t\t},\n\t\t\t\tset: function ( v ) {\n\n\t\t\t\t\tuniforms.specularMap.value = v;\n\n\t\t\t\t\tif ( v ) {\n\n\t\t\t\t\t\tthis.defines.USE_SPECULARMAP = ''; // USE_UV is set by the renderer for specular maps\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\tdelete this.defines.USE_SPECULARMAP;\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\t\t\t},\n\n\t\t\tglossiness: {\n\t\t\t\tget: function () {\n\n\t\t\t\t\treturn uniforms.glossiness.value;\n\n\t\t\t\t},\n\t\t\t\tset: function ( v ) {\n\n\t\t\t\t\tuniforms.glossiness.value = v;\n\n\t\t\t\t}\n\t\t\t},\n\n\t\t\tglossinessMap: {\n\t\t\t\tget: function () {\n\n\t\t\t\t\treturn uniforms.glossinessMap.value;\n\n\t\t\t\t},\n\t\t\t\tset: function ( v ) {\n\n\t\t\t\t\tuniforms.glossinessMap.value = v;\n\n\t\t\t\t\tif ( v ) {\n\n\t\t\t\t\t\tthis.defines.USE_GLOSSINESSMAP = '';\n\t\t\t\t\t\tthis.defines.USE_UV = '';\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\tdelete this.defines.USE_GLOSSINESSMAP;\n\t\t\t\t\t\tdelete this.defines.USE_UV;\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\t\t\t}\n\n\t\t} );\n\n\t\tdelete this.metalness;\n\t\tdelete this.roughness;\n\t\tdelete this.metalnessMap;\n\t\tdelete this.roughnessMap;\n\n\t\tthis.setValues( params );\n\n\t}\n\n\tcopy( source ) {\n\n\t\tsuper.copy( source );\n\n\t\tthis.specularMap = source.specularMap;\n\t\tthis.specular.copy( source.specular );\n\t\tthis.glossinessMap = source.glossinessMap;\n\t\tthis.glossiness = source.glossiness;\n\t\tdelete this.metalness;\n\t\tdelete this.roughness;\n\t\tdelete this.metalnessMap;\n\t\tdelete this.roughnessMap;\n\t\treturn this;\n\n\t}\n\n}\n\n\nclass GLTFMaterialsPbrSpecularGlossinessExtension {\n\n\tconstructor() {\n\n\t\tthis.name = EXTENSIONS.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS;\n\n\t\tthis.specularGlossinessParams = [\n\t\t\t'color',\n\t\t\t'map',\n\t\t\t'lightMap',\n\t\t\t'lightMapIntensity',\n\t\t\t'aoMap',\n\t\t\t'aoMapIntensity',\n\t\t\t'emissive',\n\t\t\t'emissiveIntensity',\n\t\t\t'emissiveMap',\n\t\t\t'bumpMap',\n\t\t\t'bumpScale',\n\t\t\t'normalMap',\n\t\t\t'normalMapType',\n\t\t\t'displacementMap',\n\t\t\t'displacementScale',\n\t\t\t'displacementBias',\n\t\t\t'specularMap',\n\t\t\t'specular',\n\t\t\t'glossinessMap',\n\t\t\t'glossiness',\n\t\t\t'alphaMap',\n\t\t\t'envMap',\n\t\t\t'envMapIntensity',\n\t\t\t'refractionRatio',\n\t\t];\n\n\t}\n\n\tgetMaterialType() {\n\n\t\treturn GLTFMeshStandardSGMaterial;\n\n\t}\n\n\textendParams( materialParams, materialDef, parser ) {\n\n\t\tconst pbrSpecularGlossiness = materialDef.extensions[ this.name ];\n\n\t\tmaterialParams.color = new Color( 1.0, 1.0, 1.0 );\n\t\tmaterialParams.opacity = 1.0;\n\n\t\tconst pending = [];\n\n\t\tif ( Array.isArray( pbrSpecularGlossiness.diffuseFactor ) ) {\n\n\t\t\tconst array = pbrSpecularGlossiness.diffuseFactor;\n\n\t\t\tmaterialParams.color.fromArray( array );\n\t\t\tmaterialParams.opacity = array[ 3 ];\n\n\t\t}\n\n\t\tif ( pbrSpecularGlossiness.diffuseTexture !== undefined ) {\n\n\t\t\tpending.push( parser.assignTexture( materialParams, 'map', pbrSpecularGlossiness.diffuseTexture ) );\n\n\t\t}\n\n\t\tmaterialParams.emissive = new Color( 0.0, 0.0, 0.0 );\n\t\tmaterialParams.glossiness = pbrSpecularGlossiness.glossinessFactor !== undefined ? pbrSpecularGlossiness.glossinessFactor : 1.0;\n\t\tmaterialParams.specular = new Color( 1.0, 1.0, 1.0 );\n\n\t\tif ( Array.isArray( pbrSpecularGlossiness.specularFactor ) ) {\n\n\t\t\tmaterialParams.specular.fromArray( pbrSpecularGlossiness.specularFactor );\n\n\t\t}\n\n\t\tif ( pbrSpecularGlossiness.specularGlossinessTexture !== undefined ) {\n\n\t\t\tconst specGlossMapDef = pbrSpecularGlossiness.specularGlossinessTexture;\n\t\t\tpending.push( parser.assignTexture( materialParams, 'glossinessMap', specGlossMapDef ) );\n\t\t\tpending.push( parser.assignTexture( materialParams, 'specularMap', specGlossMapDef ) );\n\n\t\t}\n\n\t\treturn Promise.all( pending );\n\n\t}\n\n\tcreateMaterial( materialParams ) {\n\n\t\tconst material = new GLTFMeshStandardSGMaterial( materialParams );\n\t\tmaterial.fog = true;\n\n\t\tmaterial.color = materialParams.color;\n\n\t\tmaterial.map = materialParams.map === undefined ? null : materialParams.map;\n\n\t\tmaterial.lightMap = null;\n\t\tmaterial.lightMapIntensity = 1.0;\n\n\t\tmaterial.aoMap = materialParams.aoMap === undefined ? null : materialParams.aoMap;\n\t\tmaterial.aoMapIntensity = 1.0;\n\n\t\tmaterial.emissive = materialParams.emissive;\n\t\tmaterial.emissiveIntensity = 1.0;\n\t\tmaterial.emissiveMap = materialParams.emissiveMap === undefined ? null : materialParams.emissiveMap;\n\n\t\tmaterial.bumpMap = materialParams.bumpMap === undefined ? null : materialParams.bumpMap;\n\t\tmaterial.bumpScale = 1;\n\n\t\tmaterial.normalMap = materialParams.normalMap === undefined ? null : materialParams.normalMap;\n\t\tmaterial.normalMapType = TangentSpaceNormalMap;\n\n\t\tif ( materialParams.normalScale ) material.normalScale = materialParams.normalScale;\n\n\t\tmaterial.displacementMap = null;\n\t\tmaterial.displacementScale = 1;\n\t\tmaterial.displacementBias = 0;\n\n\t\tmaterial.specularMap = materialParams.specularMap === undefined ? null : materialParams.specularMap;\n\t\tmaterial.specular = materialParams.specular;\n\n\t\tmaterial.glossinessMap = materialParams.glossinessMap === undefined ? null : materialParams.glossinessMap;\n\t\tmaterial.glossiness = materialParams.glossiness;\n\n\t\tmaterial.alphaMap = null;\n\n\t\tmaterial.envMap = materialParams.envMap === undefined ? null : materialParams.envMap;\n\t\tmaterial.envMapIntensity = 1.0;\n\n\t\tmaterial.refractionRatio = 0.98;\n\n\t\treturn material;\n\n\t}\n\n}\n\n/**\n * Mesh Quantization Extension\n *\n * Specification: https://github.com/KhronosGroup/glTF/tree/master/extensions/2.0/Khronos/KHR_mesh_quantization\n */\nclass GLTFMeshQuantizationExtension {\n\n\tconstructor() {\n\n\t\tthis.name = EXTENSIONS.KHR_MESH_QUANTIZATION;\n\n\t}\n\n}\n\n/*********************************/\n/********** INTERPOLATION ********/\n/*********************************/\n\n// Spline Interpolation\n// Specification: https://github.com/KhronosGroup/glTF/blob/master/specification/2.0/README.md#appendix-c-spline-interpolation\nclass GLTFCubicSplineInterpolant extends Interpolant {\n\n\tconstructor( parameterPositions, sampleValues, sampleSize, resultBuffer ) {\n\n\t\tsuper( parameterPositions, sampleValues, sampleSize, resultBuffer );\n\n\t}\n\n\tcopySampleValue_( index ) {\n\n\t\t// Copies a sample value to the result buffer. See description of glTF\n\t\t// CUBICSPLINE values layout in interpolate_() function below.\n\n\t\tconst result = this.resultBuffer,\n\t\t\tvalues = this.sampleValues,\n\t\t\tvalueSize = this.valueSize,\n\t\t\toffset = index * valueSize * 3 + valueSize;\n\n\t\tfor ( let i = 0; i !== valueSize; i ++ ) {\n\n\t\t\tresult[ i ] = values[ offset + i ];\n\n\t\t}\n\n\t\treturn result;\n\n\t}\n\n}\n\nGLTFCubicSplineInterpolant.prototype.beforeStart_ = GLTFCubicSplineInterpolant.prototype.copySampleValue_;\n\nGLTFCubicSplineInterpolant.prototype.afterEnd_ = GLTFCubicSplineInterpolant.prototype.copySampleValue_;\n\nGLTFCubicSplineInterpolant.prototype.interpolate_ = function ( i1, t0, t, t1 ) {\n\n\tconst result = this.resultBuffer;\n\tconst values = this.sampleValues;\n\tconst stride = this.valueSize;\n\n\tconst stride2 = stride * 2;\n\tconst stride3 = stride * 3;\n\n\tconst td = t1 - t0;\n\n\tconst p = ( t - t0 ) / td;\n\tconst pp = p * p;\n\tconst ppp = pp * p;\n\n\tconst offset1 = i1 * stride3;\n\tconst offset0 = offset1 - stride3;\n\n\tconst s2 = - 2 * ppp + 3 * pp;\n\tconst s3 = ppp - pp;\n\tconst s0 = 1 - s2;\n\tconst s1 = s3 - pp + p;\n\n\t// Layout of keyframe output values for CUBICSPLINE animations:\n\t//   [ inTangent_1, splineVertex_1, outTangent_1, inTangent_2, splineVertex_2, ... ]\n\tfor ( let i = 0; i !== stride; i ++ ) {\n\n\t\tconst p0 = values[ offset0 + i + stride ]; // splineVertex_k\n\t\tconst m0 = values[ offset0 + i + stride2 ] * td; // outTangent_k * (t_k+1 - t_k)\n\t\tconst p1 = values[ offset1 + i + stride ]; // splineVertex_k+1\n\t\tconst m1 = values[ offset1 + i ] * td; // inTangent_k+1 * (t_k+1 - t_k)\n\n\t\tresult[ i ] = s0 * p0 + s1 * m0 + s2 * p1 + s3 * m1;\n\n\t}\n\n\treturn result;\n\n};\n\n/*********************************/\n/********** INTERNALS ************/\n/*********************************/\n\n/* CONSTANTS */\n\nconst WEBGL_CONSTANTS = {\n\tFLOAT: 5126,\n\t//FLOAT_MAT2: 35674,\n\tFLOAT_MAT3: 35675,\n\tFLOAT_MAT4: 35676,\n\tFLOAT_VEC2: 35664,\n\tFLOAT_VEC3: 35665,\n\tFLOAT_VEC4: 35666,\n\tLINEAR: 9729,\n\tREPEAT: 10497,\n\tSAMPLER_2D: 35678,\n\tPOINTS: 0,\n\tLINES: 1,\n\tLINE_LOOP: 2,\n\tLINE_STRIP: 3,\n\tTRIANGLES: 4,\n\tTRIANGLE_STRIP: 5,\n\tTRIANGLE_FAN: 6,\n\tUNSIGNED_BYTE: 5121,\n\tUNSIGNED_SHORT: 5123\n};\n\nconst WEBGL_COMPONENT_TYPES = {\n\t5120: Int8Array,\n\t5121: Uint8Array,\n\t5122: Int16Array,\n\t5123: Uint16Array,\n\t5125: Uint32Array,\n\t5126: Float32Array\n};\n\nconst WEBGL_FILTERS = {\n\t9728: NearestFilter,\n\t9729: LinearFilter,\n\t9984: NearestMipmapNearestFilter,\n\t9985: LinearMipmapNearestFilter,\n\t9986: NearestMipmapLinearFilter,\n\t9987: LinearMipmapLinearFilter\n};\n\nconst WEBGL_WRAPPINGS = {\n\t33071: ClampToEdgeWrapping,\n\t33648: MirroredRepeatWrapping,\n\t10497: RepeatWrapping\n};\n\nconst WEBGL_TYPE_SIZES = {\n\t'SCALAR': 1,\n\t'VEC2': 2,\n\t'VEC3': 3,\n\t'VEC4': 4,\n\t'MAT2': 4,\n\t'MAT3': 9,\n\t'MAT4': 16\n};\n\nconst ATTRIBUTES = {\n\tPOSITION: 'position',\n\tNORMAL: 'normal',\n\tTANGENT: 'tangent',\n\tTEXCOORD_0: 'uv',\n\tTEXCOORD_1: 'uv2',\n\tCOLOR_0: 'color',\n\tWEIGHTS_0: 'skinWeight',\n\tJOINTS_0: 'skinIndex',\n};\n\nconst PATH_PROPERTIES = {\n\tscale: 'scale',\n\ttranslation: 'position',\n\trotation: 'quaternion',\n\tweights: 'morphTargetInfluences'\n};\n\nconst INTERPOLATION = {\n\tCUBICSPLINE: undefined, // We use a custom interpolant (GLTFCubicSplineInterpolation) for CUBICSPLINE tracks. Each\n\t\t                        // keyframe track will be initialized with a default interpolation type, then modified.\n\tLINEAR: InterpolateLinear,\n\tSTEP: InterpolateDiscrete\n};\n\nconst ALPHA_MODES = {\n\tOPAQUE: 'OPAQUE',\n\tMASK: 'MASK',\n\tBLEND: 'BLEND'\n};\n\n/* UTILITY FUNCTIONS */\n\nfunction resolveURL( url, path ) {\n\n\t// Invalid URL\n\tif ( typeof url !== 'string' || url === '' ) return '';\n\n\t// Host Relative URL\n\tif ( /^https?:\\/\\//i.test( path ) && /^\\//.test( url ) ) {\n\n\t\tpath = path.replace( /(^https?:\\/\\/[^\\/]+).*/i, '$1' );\n\n\t}\n\n\t// Absolute URL http://,https://,//\n\tif ( /^(https?:)?\\/\\//i.test( url ) ) return url;\n\n\t// Data URI\n\tif ( /^data:.*,.*$/i.test( url ) ) return url;\n\n\t// Blob URL\n\tif ( /^blob:.*$/i.test( url ) ) return url;\n\n\t// Relative URL\n\treturn path + url;\n\n}\n\n/**\n * Specification: https://github.com/KhronosGroup/glTF/blob/master/specification/2.0/README.md#default-material\n */\nfunction createDefaultMaterial( cache ) {\n\n\tif ( cache[ 'DefaultMaterial' ] === undefined ) {\n\n\t\tcache[ 'DefaultMaterial' ] = new MeshStandardMaterial( {\n\t\t\tcolor: 0xFFFFFF,\n\t\t\temissive: 0x000000,\n\t\t\tmetalness: 1,\n\t\t\troughness: 1,\n\t\t\ttransparent: false,\n\t\t\tdepthTest: true,\n\t\t\tside: FrontSide\n\t\t} );\n\n\t}\n\n\treturn cache[ 'DefaultMaterial' ];\n\n}\n\nfunction addUnknownExtensionsToUserData( knownExtensions, object, objectDef ) {\n\n\t// Add unknown glTF extensions to an object's userData.\n\n\tfor ( const name in objectDef.extensions ) {\n\n\t\tif ( knownExtensions[ name ] === undefined ) {\n\n\t\t\tobject.userData.gltfExtensions = object.userData.gltfExtensions || {};\n\t\t\tobject.userData.gltfExtensions[ name ] = objectDef.extensions[ name ];\n\n\t\t}\n\n\t}\n\n}\n\n/**\n * @param {Object3D|Material|BufferGeometry} object\n * @param {GLTF.definition} gltfDef\n */\nfunction assignExtrasToUserData( object, gltfDef ) {\n\n\tif ( gltfDef.extras !== undefined ) {\n\n\t\tif ( typeof gltfDef.extras === 'object' ) {\n\n\t\t\tObject.assign( object.userData, gltfDef.extras );\n\n\t\t} else {\n\n\t\t\tconsole.warn( 'THREE.GLTFLoader: Ignoring primitive type .extras, ' + gltfDef.extras );\n\n\t\t}\n\n\t}\n\n}\n\n/**\n * Specification: https://github.com/KhronosGroup/glTF/blob/master/specification/2.0/README.md#morph-targets\n *\n * @param {BufferGeometry} geometry\n * @param {Array<GLTF.Target>} targets\n * @param {GLTFParser} parser\n * @return {Promise<BufferGeometry>}\n */\nfunction addMorphTargets( geometry, targets, parser ) {\n\n\tlet hasMorphPosition = false;\n\tlet hasMorphNormal = false;\n\n\tfor ( let i = 0, il = targets.length; i < il; i ++ ) {\n\n\t\tconst target = targets[ i ];\n\n\t\tif ( target.POSITION !== undefined ) hasMorphPosition = true;\n\t\tif ( target.NORMAL !== undefined ) hasMorphNormal = true;\n\n\t\tif ( hasMorphPosition && hasMorphNormal ) break;\n\n\t}\n\n\tif ( ! hasMorphPosition && ! hasMorphNormal ) return Promise.resolve( geometry );\n\n\tconst pendingPositionAccessors = [];\n\tconst pendingNormalAccessors = [];\n\n\tfor ( let i = 0, il = targets.length; i < il; i ++ ) {\n\n\t\tconst target = targets[ i ];\n\n\t\tif ( hasMorphPosition ) {\n\n\t\t\tconst pendingAccessor = target.POSITION !== undefined\n\t\t\t\t? parser.getDependency( 'accessor', target.POSITION )\n\t\t\t\t: geometry.attributes.position;\n\n\t\t\tpendingPositionAccessors.push( pendingAccessor );\n\n\t\t}\n\n\t\tif ( hasMorphNormal ) {\n\n\t\t\tconst pendingAccessor = target.NORMAL !== undefined\n\t\t\t\t? parser.getDependency( 'accessor', target.NORMAL )\n\t\t\t\t: geometry.attributes.normal;\n\n\t\t\tpendingNormalAccessors.push( pendingAccessor );\n\n\t\t}\n\n\t}\n\n\treturn Promise.all( [\n\t\tPromise.all( pendingPositionAccessors ),\n\t\tPromise.all( pendingNormalAccessors )\n\t] ).then( function ( accessors ) {\n\n\t\tconst morphPositions = accessors[ 0 ];\n\t\tconst morphNormals = accessors[ 1 ];\n\n\t\tif ( hasMorphPosition ) geometry.morphAttributes.position = morphPositions;\n\t\tif ( hasMorphNormal ) geometry.morphAttributes.normal = morphNormals;\n\t\tgeometry.morphTargetsRelative = true;\n\n\t\treturn geometry;\n\n\t} );\n\n}\n\n/**\n * @param {Mesh} mesh\n * @param {GLTF.Mesh} meshDef\n */\nfunction updateMorphTargets( mesh, meshDef ) {\n\n\tmesh.updateMorphTargets();\n\n\tif ( meshDef.weights !== undefined ) {\n\n\t\tfor ( let i = 0, il = meshDef.weights.length; i < il; i ++ ) {\n\n\t\t\tmesh.morphTargetInfluences[ i ] = meshDef.weights[ i ];\n\n\t\t}\n\n\t}\n\n\t// .extras has user-defined data, so check that .extras.targetNames is an array.\n\tif ( meshDef.extras && Array.isArray( meshDef.extras.targetNames ) ) {\n\n\t\tconst targetNames = meshDef.extras.targetNames;\n\n\t\tif ( mesh.morphTargetInfluences.length === targetNames.length ) {\n\n\t\t\tmesh.morphTargetDictionary = {};\n\n\t\t\tfor ( let i = 0, il = targetNames.length; i < il; i ++ ) {\n\n\t\t\t\tmesh.morphTargetDictionary[ targetNames[ i ] ] = i;\n\n\t\t\t}\n\n\t\t} else {\n\n\t\t\tconsole.warn( 'THREE.GLTFLoader: Invalid extras.targetNames length. Ignoring names.' );\n\n\t\t}\n\n\t}\n\n}\n\nfunction createPrimitiveKey( primitiveDef ) {\n\n\tconst dracoExtension = primitiveDef.extensions && primitiveDef.extensions[ EXTENSIONS.KHR_DRACO_MESH_COMPRESSION ];\n\tlet geometryKey;\n\n\tif ( dracoExtension ) {\n\n\t\tgeometryKey = 'draco:' + dracoExtension.bufferView\n\t\t\t\t+ ':' + dracoExtension.indices\n\t\t\t\t+ ':' + createAttributesKey( dracoExtension.attributes );\n\n\t} else {\n\n\t\tgeometryKey = primitiveDef.indices + ':' + createAttributesKey( primitiveDef.attributes ) + ':' + primitiveDef.mode;\n\n\t}\n\n\treturn geometryKey;\n\n}\n\nfunction createAttributesKey( attributes ) {\n\n\tlet attributesKey = '';\n\n\tconst keys = Object.keys( attributes ).sort();\n\n\tfor ( let i = 0, il = keys.length; i < il; i ++ ) {\n\n\t\tattributesKey += keys[ i ] + ':' + attributes[ keys[ i ] ] + ';';\n\n\t}\n\n\treturn attributesKey;\n\n}\n\nfunction getNormalizedComponentScale( constructor ) {\n\n\t// Reference:\n\t// https://github.com/KhronosGroup/glTF/tree/master/extensions/2.0/Khronos/KHR_mesh_quantization#encoding-quantized-data\n\n\tswitch ( constructor ) {\n\n\t\tcase Int8Array:\n\t\t\treturn 1 / 127;\n\n\t\tcase Uint8Array:\n\t\t\treturn 1 / 255;\n\n\t\tcase Int16Array:\n\t\t\treturn 1 / 32767;\n\n\t\tcase Uint16Array:\n\t\t\treturn 1 / 65535;\n\n\t\tdefault:\n\t\t\tthrow new Error( 'THREE.GLTFLoader: Unsupported normalized accessor component type.' );\n\n\t}\n\n}\n\n/* GLTF PARSER */\n\nclass GLTFParser {\n\n\tconstructor( json = {}, options = {} ) {\n\n\t\tthis.json = json;\n\t\tthis.extensions = {};\n\t\tthis.plugins = {};\n\t\tthis.options = options;\n\n\t\t// loader object cache\n\t\tthis.cache = new GLTFRegistry();\n\n\t\t// associations between Three.js objects and glTF elements\n\t\tthis.associations = new Map();\n\n\t\t// BufferGeometry caching\n\t\tthis.primitiveCache = {};\n\n\t\t// Object3D instance caches\n\t\tthis.meshCache = { refs: {}, uses: {} };\n\t\tthis.cameraCache = { refs: {}, uses: {} };\n\t\tthis.lightCache = { refs: {}, uses: {} };\n\n\t\tthis.textureCache = {};\n\n\t\t// Track node names, to ensure no duplicates\n\t\tthis.nodeNamesUsed = {};\n\n\t\t// Use an ImageBitmapLoader if imageBitmaps are supported. Moves much of the\n\t\t// expensive work of uploading a texture to the GPU off the main thread.\n\t\tif ( typeof createImageBitmap !== 'undefined' && /Firefox/.test( navigator.userAgent ) === false ) {\n\n\t\t\tthis.textureLoader = new ImageBitmapLoader( this.options.manager );\n\n\t\t} else {\n\n\t\t\tthis.textureLoader = new TextureLoader( this.options.manager );\n\n\t\t}\n\n\t\tthis.textureLoader.setCrossOrigin( this.options.crossOrigin );\n\t\tthis.textureLoader.setRequestHeader( this.options.requestHeader );\n\n\t\tthis.fileLoader = new FileLoader( this.options.manager );\n\t\tthis.fileLoader.setResponseType( 'arraybuffer' );\n\n\t\tif ( this.options.crossOrigin === 'use-credentials' ) {\n\n\t\t\tthis.fileLoader.setWithCredentials( true );\n\n\t\t}\n\n\t}\n\n\tsetExtensions( extensions ) {\n\n\t\tthis.extensions = extensions;\n\n\t}\n\n\tsetPlugins( plugins ) {\n\n\t\tthis.plugins = plugins;\n\n\t}\n\n\tparse( onLoad, onError ) {\n\n\t\tconst parser = this;\n\t\tconst json = this.json;\n\t\tconst extensions = this.extensions;\n\n\t\t// Clear the loader cache\n\t\tthis.cache.removeAll();\n\n\t\t// Mark the special nodes/meshes in json for efficient parse\n\t\tthis._invokeAll( function ( ext ) {\n\n\t\t\treturn ext._markDefs && ext._markDefs();\n\n\t\t} );\n\n\t\tPromise.all( this._invokeAll( function ( ext ) {\n\n\t\t\treturn ext.beforeRoot && ext.beforeRoot();\n\n\t\t} ) ).then( function () {\n\n\t\t\treturn Promise.all( [\n\n\t\t\t\tparser.getDependencies( 'scene' ),\n\t\t\t\tparser.getDependencies( 'animation' ),\n\t\t\t\tparser.getDependencies( 'camera' ),\n\n\t\t\t] );\n\n\t\t} ).then( function ( dependencies ) {\n\n\t\t\tconst result = {\n\t\t\t\tscene: dependencies[ 0 ][ json.scene || 0 ],\n\t\t\t\tscenes: dependencies[ 0 ],\n\t\t\t\tanimations: dependencies[ 1 ],\n\t\t\t\tcameras: dependencies[ 2 ],\n\t\t\t\tasset: json.asset,\n\t\t\t\tparser: parser,\n\t\t\t\tuserData: {}\n\t\t\t};\n\n\t\t\taddUnknownExtensionsToUserData( extensions, result, json );\n\n\t\t\tassignExtrasToUserData( result, json );\n\n\t\t\tPromise.all( parser._invokeAll( function ( ext ) {\n\n\t\t\t\treturn ext.afterRoot && ext.afterRoot( result );\n\n\t\t\t} ) ).then( function () {\n\n\t\t\t\tonLoad( result );\n\n\t\t\t} );\n\n\t\t} ).catch( onError );\n\n\t}\n\n\t/**\n\t * Marks the special nodes/meshes in json for efficient parse.\n\t */\n\t_markDefs() {\n\n\t\tconst nodeDefs = this.json.nodes || [];\n\t\tconst skinDefs = this.json.skins || [];\n\t\tconst meshDefs = this.json.meshes || [];\n\n\t\t// Nothing in the node definition indicates whether it is a Bone or an\n\t\t// Object3D. Use the skins' joint references to mark bones.\n\t\tfor ( let skinIndex = 0, skinLength = skinDefs.length; skinIndex < skinLength; skinIndex ++ ) {\n\n\t\t\tconst joints = skinDefs[ skinIndex ].joints;\n\n\t\t\tfor ( let i = 0, il = joints.length; i < il; i ++ ) {\n\n\t\t\t\tnodeDefs[ joints[ i ] ].isBone = true;\n\n\t\t\t}\n\n\t\t}\n\n\t\t// Iterate over all nodes, marking references to shared resources,\n\t\t// as well as skeleton joints.\n\t\tfor ( let nodeIndex = 0, nodeLength = nodeDefs.length; nodeIndex < nodeLength; nodeIndex ++ ) {\n\n\t\t\tconst nodeDef = nodeDefs[ nodeIndex ];\n\n\t\t\tif ( nodeDef.mesh !== undefined ) {\n\n\t\t\t\tthis._addNodeRef( this.meshCache, nodeDef.mesh );\n\n\t\t\t\t// Nothing in the mesh definition indicates whether it is\n\t\t\t\t// a SkinnedMesh or Mesh. Use the node's mesh reference\n\t\t\t\t// to mark SkinnedMesh if node has skin.\n\t\t\t\tif ( nodeDef.skin !== undefined ) {\n\n\t\t\t\t\tmeshDefs[ nodeDef.mesh ].isSkinnedMesh = true;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tif ( nodeDef.camera !== undefined ) {\n\n\t\t\t\tthis._addNodeRef( this.cameraCache, nodeDef.camera );\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\t/**\n\t * Counts references to shared node / Object3D resources. These resources\n\t * can be reused, or \"instantiated\", at multiple nodes in the scene\n\t * hierarchy. Mesh, Camera, and Light instances are instantiated and must\n\t * be marked. Non-scenegraph resources (like Materials, Geometries, and\n\t * Textures) can be reused directly and are not marked here.\n\t *\n\t * Example: CesiumMilkTruck sample model reuses \"Wheel\" meshes.\n\t */\n\t_addNodeRef( cache, index ) {\n\n\t\tif ( index === undefined ) return;\n\n\t\tif ( cache.refs[ index ] === undefined ) {\n\n\t\t\tcache.refs[ index ] = cache.uses[ index ] = 0;\n\n\t\t}\n\n\t\tcache.refs[ index ] ++;\n\n\t}\n\n\t/** Returns a reference to a shared resource, cloning it if necessary. */\n\t_getNodeRef( cache, index, object ) {\n\n\t\tif ( cache.refs[ index ] <= 1 ) return object;\n\n\t\tconst ref = object.clone();\n\n\t\tref.name += '_instance_' + ( cache.uses[ index ] ++ );\n\n\t\treturn ref;\n\n\t}\n\n\t_invokeOne( func ) {\n\n\t\tconst extensions = Object.values( this.plugins );\n\t\textensions.push( this );\n\n\t\tfor ( let i = 0; i < extensions.length; i ++ ) {\n\n\t\t\tconst result = func( extensions[ i ] );\n\n\t\t\tif ( result ) return result;\n\n\t\t}\n\n\t\treturn null;\n\n\t}\n\n\t_invokeAll( func ) {\n\n\t\tconst extensions = Object.values( this.plugins );\n\t\textensions.unshift( this );\n\n\t\tconst pending = [];\n\n\t\tfor ( let i = 0; i < extensions.length; i ++ ) {\n\n\t\t\tconst result = func( extensions[ i ] );\n\n\t\t\tif ( result ) pending.push( result );\n\n\t\t}\n\n\t\treturn pending;\n\n\t}\n\n\t/**\n\t * Requests the specified dependency asynchronously, with caching.\n\t * @param {string} type\n\t * @param {number} index\n\t * @return {Promise<Object3D|Material|THREE.Texture|AnimationClip|ArrayBuffer|Object>}\n\t */\n\tgetDependency( type, index ) {\n\n\t\tconst cacheKey = type + ':' + index;\n\t\tlet dependency = this.cache.get( cacheKey );\n\n\t\tif ( ! dependency ) {\n\n\t\t\tswitch ( type ) {\n\n\t\t\t\tcase 'scene':\n\t\t\t\t\tdependency = this.loadScene( index );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'node':\n\t\t\t\t\tdependency = this.loadNode( index );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'mesh':\n\t\t\t\t\tdependency = this._invokeOne( function ( ext ) {\n\n\t\t\t\t\t\treturn ext.loadMesh && ext.loadMesh( index );\n\n\t\t\t\t\t} );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'accessor':\n\t\t\t\t\tdependency = this.loadAccessor( index );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'bufferView':\n\t\t\t\t\tdependency = this._invokeOne( function ( ext ) {\n\n\t\t\t\t\t\treturn ext.loadBufferView && ext.loadBufferView( index );\n\n\t\t\t\t\t} );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'buffer':\n\t\t\t\t\tdependency = this.loadBuffer( index );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'material':\n\t\t\t\t\tdependency = this._invokeOne( function ( ext ) {\n\n\t\t\t\t\t\treturn ext.loadMaterial && ext.loadMaterial( index );\n\n\t\t\t\t\t} );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'texture':\n\t\t\t\t\tdependency = this._invokeOne( function ( ext ) {\n\n\t\t\t\t\t\treturn ext.loadTexture && ext.loadTexture( index );\n\n\t\t\t\t\t} );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'skin':\n\t\t\t\t\tdependency = this.loadSkin( index );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'animation':\n\t\t\t\t\tdependency = this.loadAnimation( index );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'camera':\n\t\t\t\t\tdependency = this.loadCamera( index );\n\t\t\t\t\tbreak;\n\n\t\t\t\tdefault:\n\t\t\t\t\tthrow new Error( 'Unknown type: ' + type );\n\n\t\t\t}\n\n\t\t\tthis.cache.add( cacheKey, dependency );\n\n\t\t}\n\n\t\treturn dependency;\n\n\t}\n\n\t/**\n\t * Requests all dependencies of the specified type asynchronously, with caching.\n\t * @param {string} type\n\t * @return {Promise<Array<Object>>}\n\t */\n\tgetDependencies( type ) {\n\n\t\tlet dependencies = this.cache.get( type );\n\n\t\tif ( ! dependencies ) {\n\n\t\t\tconst parser = this;\n\t\t\tconst defs = this.json[ type + ( type === 'mesh' ? 'es' : 's' ) ] || [];\n\n\t\t\tdependencies = Promise.all( defs.map( function ( def, index ) {\n\n\t\t\t\treturn parser.getDependency( type, index );\n\n\t\t\t} ) );\n\n\t\t\tthis.cache.add( type, dependencies );\n\n\t\t}\n\n\t\treturn dependencies;\n\n\t}\n\n\t/**\n\t * Specification: https://github.com/KhronosGroup/glTF/blob/master/specification/2.0/README.md#buffers-and-buffer-views\n\t * @param {number} bufferIndex\n\t * @return {Promise<ArrayBuffer>}\n\t */\n\tloadBuffer( bufferIndex ) {\n\n\t\tconst bufferDef = this.json.buffers[ bufferIndex ];\n\t\tconst loader = this.fileLoader;\n\n\t\tif ( bufferDef.type && bufferDef.type !== 'arraybuffer' ) {\n\n\t\t\tthrow new Error( 'THREE.GLTFLoader: ' + bufferDef.type + ' buffer type is not supported.' );\n\n\t\t}\n\n\t\t// If present, GLB container is required to be the first buffer.\n\t\tif ( bufferDef.uri === undefined && bufferIndex === 0 ) {\n\n\t\t\treturn Promise.resolve( this.extensions[ EXTENSIONS.KHR_BINARY_GLTF ].body );\n\n\t\t}\n\n\t\tconst options = this.options;\n\n\t\treturn new Promise( function ( resolve, reject ) {\n\n\t\t\tloader.load( resolveURL( bufferDef.uri, options.path ), resolve, undefined, function () {\n\n\t\t\t\treject( new Error( 'THREE.GLTFLoader: Failed to load buffer \"' + bufferDef.uri + '\".' ) );\n\n\t\t\t} );\n\n\t\t} );\n\n\t}\n\n\t/**\n\t * Specification: https://github.com/KhronosGroup/glTF/blob/master/specification/2.0/README.md#buffers-and-buffer-views\n\t * @param {number} bufferViewIndex\n\t * @return {Promise<ArrayBuffer>}\n\t */\n\tloadBufferView( bufferViewIndex ) {\n\n\t\tconst bufferViewDef = this.json.bufferViews[ bufferViewIndex ];\n\n\t\treturn this.getDependency( 'buffer', bufferViewDef.buffer ).then( function ( buffer ) {\n\n\t\t\tconst byteLength = bufferViewDef.byteLength || 0;\n\t\t\tconst byteOffset = bufferViewDef.byteOffset || 0;\n\t\t\treturn buffer.slice( byteOffset, byteOffset + byteLength );\n\n\t\t} );\n\n\t}\n\n\t/**\n\t * Specification: https://github.com/KhronosGroup/glTF/blob/master/specification/2.0/README.md#accessors\n\t * @param {number} accessorIndex\n\t * @return {Promise<BufferAttribute|InterleavedBufferAttribute>}\n\t */\n\tloadAccessor( accessorIndex ) {\n\n\t\tconst parser = this;\n\t\tconst json = this.json;\n\n\t\tconst accessorDef = this.json.accessors[ accessorIndex ];\n\n\t\tif ( accessorDef.bufferView === undefined && accessorDef.sparse === undefined ) {\n\n\t\t\t// Ignore empty accessors, which may be used to declare runtime\n\t\t\t// information about attributes coming from another source (e.g. Draco\n\t\t\t// compression extension).\n\t\t\treturn Promise.resolve( null );\n\n\t\t}\n\n\t\tconst pendingBufferViews = [];\n\n\t\tif ( accessorDef.bufferView !== undefined ) {\n\n\t\t\tpendingBufferViews.push( this.getDependency( 'bufferView', accessorDef.bufferView ) );\n\n\t\t} else {\n\n\t\t\tpendingBufferViews.push( null );\n\n\t\t}\n\n\t\tif ( accessorDef.sparse !== undefined ) {\n\n\t\t\tpendingBufferViews.push( this.getDependency( 'bufferView', accessorDef.sparse.indices.bufferView ) );\n\t\t\tpendingBufferViews.push( this.getDependency( 'bufferView', accessorDef.sparse.values.bufferView ) );\n\n\t\t}\n\n\t\treturn Promise.all( pendingBufferViews ).then( function ( bufferViews ) {\n\n\t\t\tconst bufferView = bufferViews[ 0 ];\n\n\t\t\tconst itemSize = WEBGL_TYPE_SIZES[ accessorDef.type ];\n\t\t\tconst TypedArray = WEBGL_COMPONENT_TYPES[ accessorDef.componentType ];\n\n\t\t\t// For VEC3: itemSize is 3, elementBytes is 4, itemBytes is 12.\n\t\t\tconst elementBytes = TypedArray.BYTES_PER_ELEMENT;\n\t\t\tconst itemBytes = elementBytes * itemSize;\n\t\t\tconst byteOffset = accessorDef.byteOffset || 0;\n\t\t\tconst byteStride = accessorDef.bufferView !== undefined ? json.bufferViews[ accessorDef.bufferView ].byteStride : undefined;\n\t\t\tconst normalized = accessorDef.normalized === true;\n\t\t\tlet array, bufferAttribute;\n\n\t\t\t// The buffer is not interleaved if the stride is the item size in bytes.\n\t\t\tif ( byteStride && byteStride !== itemBytes ) {\n\n\t\t\t\t// Each \"slice\" of the buffer, as defined by 'count' elements of 'byteStride' bytes, gets its own InterleavedBuffer\n\t\t\t\t// This makes sure that IBA.count reflects accessor.count properly\n\t\t\t\tconst ibSlice = Math.floor( byteOffset / byteStride );\n\t\t\t\tconst ibCacheKey = 'InterleavedBuffer:' + accessorDef.bufferView + ':' + accessorDef.componentType + ':' + ibSlice + ':' + accessorDef.count;\n\t\t\t\tlet ib = parser.cache.get( ibCacheKey );\n\n\t\t\t\tif ( ! ib ) {\n\n\t\t\t\t\tarray = new TypedArray( bufferView, ibSlice * byteStride, accessorDef.count * byteStride / elementBytes );\n\n\t\t\t\t\t// Integer parameters to IB/IBA are in array elements, not bytes.\n\t\t\t\t\tib = new InterleavedBuffer( array, byteStride / elementBytes );\n\n\t\t\t\t\tparser.cache.add( ibCacheKey, ib );\n\n\t\t\t\t}\n\n\t\t\t\tbufferAttribute = new InterleavedBufferAttribute( ib, itemSize, ( byteOffset % byteStride ) / elementBytes, normalized );\n\n\t\t\t} else {\n\n\t\t\t\tif ( bufferView === null ) {\n\n\t\t\t\t\tarray = new TypedArray( accessorDef.count * itemSize );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tarray = new TypedArray( bufferView, byteOffset, accessorDef.count * itemSize );\n\n\t\t\t\t}\n\n\t\t\t\tbufferAttribute = new BufferAttribute( array, itemSize, normalized );\n\n\t\t\t}\n\n\t\t\t// https://github.com/KhronosGroup/glTF/blob/master/specification/2.0/README.md#sparse-accessors\n\t\t\tif ( accessorDef.sparse !== undefined ) {\n\n\t\t\t\tconst itemSizeIndices = WEBGL_TYPE_SIZES.SCALAR;\n\t\t\t\tconst TypedArrayIndices = WEBGL_COMPONENT_TYPES[ accessorDef.sparse.indices.componentType ];\n\n\t\t\t\tconst byteOffsetIndices = accessorDef.sparse.indices.byteOffset || 0;\n\t\t\t\tconst byteOffsetValues = accessorDef.sparse.values.byteOffset || 0;\n\n\t\t\t\tconst sparseIndices = new TypedArrayIndices( bufferViews[ 1 ], byteOffsetIndices, accessorDef.sparse.count * itemSizeIndices );\n\t\t\t\tconst sparseValues = new TypedArray( bufferViews[ 2 ], byteOffsetValues, accessorDef.sparse.count * itemSize );\n\n\t\t\t\tif ( bufferView !== null ) {\n\n\t\t\t\t\t// Avoid modifying the original ArrayBuffer, if the bufferView wasn't initialized with zeroes.\n\t\t\t\t\tbufferAttribute = new BufferAttribute( bufferAttribute.array.slice(), bufferAttribute.itemSize, bufferAttribute.normalized );\n\n\t\t\t\t}\n\n\t\t\t\tfor ( let i = 0, il = sparseIndices.length; i < il; i ++ ) {\n\n\t\t\t\t\tconst index = sparseIndices[ i ];\n\n\t\t\t\t\tbufferAttribute.setX( index, sparseValues[ i * itemSize ] );\n\t\t\t\t\tif ( itemSize >= 2 ) bufferAttribute.setY( index, sparseValues[ i * itemSize + 1 ] );\n\t\t\t\t\tif ( itemSize >= 3 ) bufferAttribute.setZ( index, sparseValues[ i * itemSize + 2 ] );\n\t\t\t\t\tif ( itemSize >= 4 ) bufferAttribute.setW( index, sparseValues[ i * itemSize + 3 ] );\n\t\t\t\t\tif ( itemSize >= 5 ) throw new Error( 'THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.' );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\treturn bufferAttribute;\n\n\t\t} );\n\n\t}\n\n\t/**\n\t * Specification: https://github.com/KhronosGroup/glTF/tree/master/specification/2.0#textures\n\t * @param {number} textureIndex\n\t * @return {Promise<THREE.Texture>}\n\t */\n\tloadTexture( textureIndex ) {\n\n\t\tconst json = this.json;\n\t\tconst options = this.options;\n\t\tconst textureDef = json.textures[ textureIndex ];\n\t\tconst source = json.images[ textureDef.source ];\n\n\t\tlet loader = this.textureLoader;\n\n\t\tif ( source.uri ) {\n\n\t\t\tconst handler = options.manager.getHandler( source.uri );\n\t\t\tif ( handler !== null ) loader = handler;\n\n\t\t}\n\n\t\treturn this.loadTextureImage( textureIndex, source, loader );\n\n\t}\n\n\tloadTextureImage( textureIndex, source, loader ) {\n\n\t\tconst parser = this;\n\t\tconst json = this.json;\n\t\tconst options = this.options;\n\n\t\tconst textureDef = json.textures[ textureIndex ];\n\n\t\tconst cacheKey = ( source.uri || source.bufferView ) + ':' + textureDef.sampler;\n\n\t\tif ( this.textureCache[ cacheKey ] ) {\n\n\t\t\t// See https://github.com/mrdoob/three.js/issues/21559.\n\t\t\treturn this.textureCache[ cacheKey ];\n\n\t\t}\n\n\t\tconst URL = self.URL || self.webkitURL;\n\n\t\tlet sourceURI = source.uri || '';\n\t\tlet isObjectURL = false;\n\t\tlet hasAlpha = true;\n\n\t\tconst isJPEG = sourceURI.search( /\\.jpe?g($|\\?)/i ) > 0 || sourceURI.search( /^data\\:image\\/jpeg/ ) === 0;\n\n\t\tif ( source.mimeType === 'image/jpeg' || isJPEG ) hasAlpha = false;\n\n\t\tif ( source.bufferView !== undefined ) {\n\n\t\t\t// Load binary image data from bufferView, if provided.\n\n\t\t\tsourceURI = parser.getDependency( 'bufferView', source.bufferView ).then( function ( bufferView ) {\n\n\t\t\t\tif ( source.mimeType === 'image/png' ) {\n\n\t\t\t\t\t// Inspect the PNG 'IHDR' chunk to determine whether the image could have an\n\t\t\t\t\t// alpha channel. This check is conservative  the image could have an alpha\n\t\t\t\t\t// channel with all values == 1, and the indexed type (colorType == 3) only\n\t\t\t\t\t// sometimes contains alpha.\n\t\t\t\t\t//\n\t\t\t\t\t// https://en.wikipedia.org/wiki/Portable_Network_Graphics#File_header\n\t\t\t\t\tconst colorType = new DataView( bufferView, 25, 1 ).getUint8( 0, false );\n\t\t\t\t\thasAlpha = colorType === 6 || colorType === 4 || colorType === 3;\n\n\t\t\t\t}\n\n\t\t\t\tisObjectURL = true;\n\t\t\t\tconst blob = new Blob( [ bufferView ], { type: source.mimeType } );\n\t\t\t\tsourceURI = URL.createObjectURL( blob );\n\t\t\t\treturn sourceURI;\n\n\t\t\t} );\n\n\t\t} else if ( source.uri === undefined ) {\n\n\t\t\tthrow new Error( 'THREE.GLTFLoader: Image ' + textureIndex + ' is missing URI and bufferView' );\n\n\t\t}\n\n\t\tconst promise = Promise.resolve( sourceURI ).then( function ( sourceURI ) {\n\n\t\t\treturn new Promise( function ( resolve, reject ) {\n\n\t\t\t\tlet onLoad = resolve;\n\n\t\t\t\tif ( loader.isImageBitmapLoader === true ) {\n\n\t\t\t\t\tonLoad = function ( imageBitmap ) {\n\n\t\t\t\t\t\tconst texture = new Texture( imageBitmap );\n\t\t\t\t\t\ttexture.needsUpdate = true;\n\n\t\t\t\t\t\tresolve( texture );\n\n\t\t\t\t\t};\n\n\t\t\t\t}\n\n\t\t\t\tloader.load( resolveURL( sourceURI, options.path ), onLoad, undefined, reject );\n\n\t\t\t} );\n\n\t\t} ).then( function ( texture ) {\n\n\t\t\t// Clean up resources and configure Texture.\n\n\t\t\tif ( isObjectURL === true ) {\n\n\t\t\t\tURL.revokeObjectURL( sourceURI );\n\n\t\t\t}\n\n\t\t\ttexture.flipY = false;\n\n\t\t\tif ( textureDef.name ) texture.name = textureDef.name;\n\n\t\t\t// When there is definitely no alpha channel in the texture, set RGBFormat to save space.\n\t\t\tif ( ! hasAlpha ) texture.format = RGBFormat;\n\n\t\t\tconst samplers = json.samplers || {};\n\t\t\tconst sampler = samplers[ textureDef.sampler ] || {};\n\n\t\t\ttexture.magFilter = WEBGL_FILTERS[ sampler.magFilter ] || LinearFilter;\n\t\t\ttexture.minFilter = WEBGL_FILTERS[ sampler.minFilter ] || LinearMipmapLinearFilter;\n\t\t\ttexture.wrapS = WEBGL_WRAPPINGS[ sampler.wrapS ] || RepeatWrapping;\n\t\t\ttexture.wrapT = WEBGL_WRAPPINGS[ sampler.wrapT ] || RepeatWrapping;\n\n\t\t\tparser.associations.set( texture, {\n\t\t\t\ttype: 'textures',\n\t\t\t\tindex: textureIndex\n\t\t\t} );\n\n\t\t\treturn texture;\n\n\t\t} ).catch( function () {\n\n\t\t\tconsole.error( 'THREE.GLTFLoader: Couldn\\'t load texture', sourceURI );\n\t\t\treturn null;\n\n\t\t} );\n\n\t\tthis.textureCache[ cacheKey ] = promise;\n\n\t\treturn promise;\n\n\t}\n\n\t/**\n\t * Asynchronously assigns a texture to the given material parameters.\n\t * @param {Object} materialParams\n\t * @param {string} mapName\n\t * @param {Object} mapDef\n\t * @return {Promise}\n\t */\n\tassignTexture( materialParams, mapName, mapDef ) {\n\n\t\tconst parser = this;\n\n\t\treturn this.getDependency( 'texture', mapDef.index ).then( function ( texture ) {\n\n\t\t\t// Materials sample aoMap from UV set 1 and other maps from UV set 0 - this can't be configured\n\t\t\t// However, we will copy UV set 0 to UV set 1 on demand for aoMap\n\t\t\tif ( mapDef.texCoord !== undefined && mapDef.texCoord != 0 && ! ( mapName === 'aoMap' && mapDef.texCoord == 1 ) ) {\n\n\t\t\t\tconsole.warn( 'THREE.GLTFLoader: Custom UV set ' + mapDef.texCoord + ' for texture ' + mapName + ' not yet supported.' );\n\n\t\t\t}\n\n\t\t\tif ( parser.extensions[ EXTENSIONS.KHR_TEXTURE_TRANSFORM ] ) {\n\n\t\t\t\tconst transform = mapDef.extensions !== undefined ? mapDef.extensions[ EXTENSIONS.KHR_TEXTURE_TRANSFORM ] : undefined;\n\n\t\t\t\tif ( transform ) {\n\n\t\t\t\t\tconst gltfReference = parser.associations.get( texture );\n\t\t\t\t\ttexture = parser.extensions[ EXTENSIONS.KHR_TEXTURE_TRANSFORM ].extendTexture( texture, transform );\n\t\t\t\t\tparser.associations.set( texture, gltfReference );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tmaterialParams[ mapName ] = texture;\n\n\t\t} );\n\n\t}\n\n\t/**\n\t * Assigns final material to a Mesh, Line, or Points instance. The instance\n\t * already has a material (generated from the glTF material options alone)\n\t * but reuse of the same glTF material may require multiple threejs materials\n\t * to accommodate different primitive types, defines, etc. New materials will\n\t * be created if necessary, and reused from a cache.\n\t * @param  {Object3D} mesh Mesh, Line, or Points instance.\n\t */\n\tassignFinalMaterial( mesh ) {\n\n\t\tconst geometry = mesh.geometry;\n\t\tlet material = mesh.material;\n\n\t\tconst useVertexTangents = geometry.attributes.tangent !== undefined;\n\t\tconst useVertexColors = geometry.attributes.color !== undefined;\n\t\tconst useFlatShading = geometry.attributes.normal === undefined;\n\t\tconst useMorphTargets = Object.keys( geometry.morphAttributes ).length > 0;\n\t\tconst useMorphNormals = useMorphTargets && geometry.morphAttributes.normal !== undefined;\n\n\t\tif ( mesh.isPoints ) {\n\n\t\t\tconst cacheKey = 'PointsMaterial:' + material.uuid;\n\n\t\t\tlet pointsMaterial = this.cache.get( cacheKey );\n\n\t\t\tif ( ! pointsMaterial ) {\n\n\t\t\t\tpointsMaterial = new PointsMaterial();\n\t\t\t\tMaterial.prototype.copy.call( pointsMaterial, material );\n\t\t\t\tpointsMaterial.color.copy( material.color );\n\t\t\t\tpointsMaterial.map = material.map;\n\t\t\t\tpointsMaterial.sizeAttenuation = false; // glTF spec says points should be 1px\n\n\t\t\t\tthis.cache.add( cacheKey, pointsMaterial );\n\n\t\t\t}\n\n\t\t\tmaterial = pointsMaterial;\n\n\t\t} else if ( mesh.isLine ) {\n\n\t\t\tconst cacheKey = 'LineBasicMaterial:' + material.uuid;\n\n\t\t\tlet lineMaterial = this.cache.get( cacheKey );\n\n\t\t\tif ( ! lineMaterial ) {\n\n\t\t\t\tlineMaterial = new LineBasicMaterial();\n\t\t\t\tMaterial.prototype.copy.call( lineMaterial, material );\n\t\t\t\tlineMaterial.color.copy( material.color );\n\n\t\t\t\tthis.cache.add( cacheKey, lineMaterial );\n\n\t\t\t}\n\n\t\t\tmaterial = lineMaterial;\n\n\t\t}\n\n\t\t// Clone the material if it will be modified\n\t\tif ( useVertexTangents || useVertexColors || useFlatShading || useMorphTargets ) {\n\n\t\t\tlet cacheKey = 'ClonedMaterial:' + material.uuid + ':';\n\n\t\t\tif ( material.isGLTFSpecularGlossinessMaterial ) cacheKey += 'specular-glossiness:';\n\t\t\tif ( useVertexTangents ) cacheKey += 'vertex-tangents:';\n\t\t\tif ( useVertexColors ) cacheKey += 'vertex-colors:';\n\t\t\tif ( useFlatShading ) cacheKey += 'flat-shading:';\n\t\t\tif ( useMorphTargets ) cacheKey += 'morph-targets:';\n\t\t\tif ( useMorphNormals ) cacheKey += 'morph-normals:';\n\n\t\t\tlet cachedMaterial = this.cache.get( cacheKey );\n\n\t\t\tif ( ! cachedMaterial ) {\n\n\t\t\t\tcachedMaterial = material.clone();\n\n\t\t\t\tif ( useVertexColors ) cachedMaterial.vertexColors = true;\n\t\t\t\tif ( useFlatShading ) cachedMaterial.flatShading = true;\n\t\t\t\tif ( useMorphTargets ) cachedMaterial.morphTargets = true;\n\t\t\t\tif ( useMorphNormals ) cachedMaterial.morphNormals = true;\n\n\t\t\t\tif ( useVertexTangents ) {\n\n\t\t\t\t\tcachedMaterial.vertexTangents = true;\n\n\t\t\t\t\t// https://github.com/mrdoob/three.js/issues/11438#issuecomment-507003995\n\t\t\t\t\tif ( cachedMaterial.normalScale ) cachedMaterial.normalScale.y *= - 1;\n\t\t\t\t\tif ( cachedMaterial.clearcoatNormalScale ) cachedMaterial.clearcoatNormalScale.y *= - 1;\n\n\t\t\t\t}\n\n\t\t\t\tthis.cache.add( cacheKey, cachedMaterial );\n\n\t\t\t\tthis.associations.set( cachedMaterial, this.associations.get( material ) );\n\n\t\t\t}\n\n\t\t\tmaterial = cachedMaterial;\n\n\t\t}\n\n\t\t// workarounds for mesh and geometry\n\n\t\tif ( material.aoMap && geometry.attributes.uv2 === undefined && geometry.attributes.uv !== undefined ) {\n\n\t\t\tgeometry.setAttribute( 'uv2', geometry.attributes.uv );\n\n\t\t}\n\n\t\tmesh.material = material;\n\n\t}\n\n\tgetMaterialType( /* materialIndex */ ) {\n\n\t\treturn MeshStandardMaterial;\n\n\t}\n\n\t/**\n\t * Specification: https://github.com/KhronosGroup/glTF/blob/master/specification/2.0/README.md#materials\n\t * @param {number} materialIndex\n\t * @return {Promise<Material>}\n\t */\n\tloadMaterial( materialIndex ) {\n\n\t\tconst parser = this;\n\t\tconst json = this.json;\n\t\tconst extensions = this.extensions;\n\t\tconst materialDef = json.materials[ materialIndex ];\n\n\t\tlet materialType;\n\t\tconst materialParams = {};\n\t\tconst materialExtensions = materialDef.extensions || {};\n\n\t\tconst pending = [];\n\n\t\tif ( materialExtensions[ EXTENSIONS.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS ] ) {\n\n\t\t\tconst sgExtension = extensions[ EXTENSIONS.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS ];\n\t\t\tmaterialType = sgExtension.getMaterialType();\n\t\t\tpending.push( sgExtension.extendParams( materialParams, materialDef, parser ) );\n\n\t\t} else if ( materialExtensions[ EXTENSIONS.KHR_MATERIALS_UNLIT ] ) {\n\n\t\t\tconst kmuExtension = extensions[ EXTENSIONS.KHR_MATERIALS_UNLIT ];\n\t\t\tmaterialType = kmuExtension.getMaterialType();\n\t\t\tpending.push( kmuExtension.extendParams( materialParams, materialDef, parser ) );\n\n\t\t} else {\n\n\t\t\t// Specification:\n\t\t\t// https://github.com/KhronosGroup/glTF/tree/master/specification/2.0#metallic-roughness-material\n\n\t\t\tconst metallicRoughness = materialDef.pbrMetallicRoughness || {};\n\n\t\t\tmaterialParams.color = new Color( 1.0, 1.0, 1.0 );\n\t\t\tmaterialParams.opacity = 1.0;\n\n\t\t\tif ( Array.isArray( metallicRoughness.baseColorFactor ) ) {\n\n\t\t\t\tconst array = metallicRoughness.baseColorFactor;\n\n\t\t\t\tmaterialParams.color.fromArray( array );\n\t\t\t\tmaterialParams.opacity = array[ 3 ];\n\n\t\t\t}\n\n\t\t\tif ( metallicRoughness.baseColorTexture !== undefined ) {\n\n\t\t\t\tpending.push( parser.assignTexture( materialParams, 'map', metallicRoughness.baseColorTexture ) );\n\n\t\t\t}\n\n\t\t\tmaterialParams.metalness = metallicRoughness.metallicFactor !== undefined ? metallicRoughness.metallicFactor : 1.0;\n\t\t\tmaterialParams.roughness = metallicRoughness.roughnessFactor !== undefined ? metallicRoughness.roughnessFactor : 1.0;\n\n\t\t\tif ( metallicRoughness.metallicRoughnessTexture !== undefined ) {\n\n\t\t\t\tpending.push( parser.assignTexture( materialParams, 'metalnessMap', metallicRoughness.metallicRoughnessTexture ) );\n\t\t\t\tpending.push( parser.assignTexture( materialParams, 'roughnessMap', metallicRoughness.metallicRoughnessTexture ) );\n\n\t\t\t}\n\n\t\t\tmaterialType = this._invokeOne( function ( ext ) {\n\n\t\t\t\treturn ext.getMaterialType && ext.getMaterialType( materialIndex );\n\n\t\t\t} );\n\n\t\t\tpending.push( Promise.all( this._invokeAll( function ( ext ) {\n\n\t\t\t\treturn ext.extendMaterialParams && ext.extendMaterialParams( materialIndex, materialParams );\n\n\t\t\t} ) ) );\n\n\t\t}\n\n\t\tif ( materialDef.doubleSided === true ) {\n\n\t\t\tmaterialParams.side = DoubleSide;\n\n\t\t}\n\n\t\tconst alphaMode = materialDef.alphaMode || ALPHA_MODES.OPAQUE;\n\n\t\tif ( alphaMode === ALPHA_MODES.BLEND ) {\n\n\t\t\tmaterialParams.transparent = true;\n\n\t\t\t// See: https://github.com/mrdoob/three.js/issues/17706\n\t\t\tmaterialParams.depthWrite = false;\n\n\t\t} else {\n\n\t\t\tmaterialParams.transparent = false;\n\n\t\t\tif ( alphaMode === ALPHA_MODES.MASK ) {\n\n\t\t\t\tmaterialParams.alphaTest = materialDef.alphaCutoff !== undefined ? materialDef.alphaCutoff : 0.5;\n\n\t\t\t}\n\n\t\t}\n\n\t\tif ( materialDef.normalTexture !== undefined && materialType !== MeshBasicMaterial ) {\n\n\t\t\tpending.push( parser.assignTexture( materialParams, 'normalMap', materialDef.normalTexture ) );\n\n\t\t\t// https://github.com/mrdoob/three.js/issues/11438#issuecomment-507003995\n\t\t\tmaterialParams.normalScale = new Vector2( 1, - 1 );\n\n\t\t\tif ( materialDef.normalTexture.scale !== undefined ) {\n\n\t\t\t\tmaterialParams.normalScale.set( materialDef.normalTexture.scale, - materialDef.normalTexture.scale );\n\n\t\t\t}\n\n\t\t}\n\n\t\tif ( materialDef.occlusionTexture !== undefined && materialType !== MeshBasicMaterial ) {\n\n\t\t\tpending.push( parser.assignTexture( materialParams, 'aoMap', materialDef.occlusionTexture ) );\n\n\t\t\tif ( materialDef.occlusionTexture.strength !== undefined ) {\n\n\t\t\t\tmaterialParams.aoMapIntensity = materialDef.occlusionTexture.strength;\n\n\t\t\t}\n\n\t\t}\n\n\t\tif ( materialDef.emissiveFactor !== undefined && materialType !== MeshBasicMaterial ) {\n\n\t\t\tmaterialParams.emissive = new Color().fromArray( materialDef.emissiveFactor );\n\n\t\t}\n\n\t\tif ( materialDef.emissiveTexture !== undefined && materialType !== MeshBasicMaterial ) {\n\n\t\t\tpending.push( parser.assignTexture( materialParams, 'emissiveMap', materialDef.emissiveTexture ) );\n\n\t\t}\n\n\t\treturn Promise.all( pending ).then( function () {\n\n\t\t\tlet material;\n\n\t\t\tif ( materialType === GLTFMeshStandardSGMaterial ) {\n\n\t\t\t\tmaterial = extensions[ EXTENSIONS.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS ].createMaterial( materialParams );\n\n\t\t\t} else {\n\n\t\t\t\tmaterial = new materialType( materialParams );\n\n\t\t\t}\n\n\t\t\tif ( materialDef.name ) material.name = materialDef.name;\n\n\t\t\t// baseColorTexture, emissiveTexture, and specularGlossinessTexture use sRGB encoding.\n\t\t\tif ( material.map ) material.map.encoding = sRGBEncoding;\n\t\t\tif ( material.emissiveMap ) material.emissiveMap.encoding = sRGBEncoding;\n\n\t\t\tassignExtrasToUserData( material, materialDef );\n\n\t\t\tparser.associations.set( material, { type: 'materials', index: materialIndex } );\n\n\t\t\tif ( materialDef.extensions ) addUnknownExtensionsToUserData( extensions, material, materialDef );\n\n\t\t\treturn material;\n\n\t\t} );\n\n\t}\n\n\t/** When Object3D instances are targeted by animation, they need unique names. */\n\tcreateUniqueName( originalName ) {\n\n\t\tconst sanitizedName = PropertyBinding.sanitizeNodeName( originalName || '' );\n\n\t\tlet name = sanitizedName;\n\n\t\tfor ( let i = 1; this.nodeNamesUsed[ name ]; ++ i ) {\n\n\t\t\tname = sanitizedName + '_' + i;\n\n\t\t}\n\n\t\tthis.nodeNamesUsed[ name ] = true;\n\n\t\treturn name;\n\n\t}\n\n\t/**\n\t * Specification: https://github.com/KhronosGroup/glTF/blob/master/specification/2.0/README.md#geometry\n\t *\n\t * Creates BufferGeometries from primitives.\n\t *\n\t * @param {Array<GLTF.Primitive>} primitives\n\t * @return {Promise<Array<BufferGeometry>>}\n\t */\n\tloadGeometries( primitives ) {\n\n\t\tconst parser = this;\n\t\tconst extensions = this.extensions;\n\t\tconst cache = this.primitiveCache;\n\n\t\tfunction createDracoPrimitive( primitive ) {\n\n\t\t\treturn extensions[ EXTENSIONS.KHR_DRACO_MESH_COMPRESSION ]\n\t\t\t\t.decodePrimitive( primitive, parser )\n\t\t\t\t.then( function ( geometry ) {\n\n\t\t\t\t\treturn addPrimitiveAttributes( geometry, primitive, parser );\n\n\t\t\t\t} );\n\n\t\t}\n\n\t\tconst pending = [];\n\n\t\tfor ( let i = 0, il = primitives.length; i < il; i ++ ) {\n\n\t\t\tconst primitive = primitives[ i ];\n\t\t\tconst cacheKey = createPrimitiveKey( primitive );\n\n\t\t\t// See if we've already created this geometry\n\t\t\tconst cached = cache[ cacheKey ];\n\n\t\t\tif ( cached ) {\n\n\t\t\t\t// Use the cached geometry if it exists\n\t\t\t\tpending.push( cached.promise );\n\n\t\t\t} else {\n\n\t\t\t\tlet geometryPromise;\n\n\t\t\t\tif ( primitive.extensions && primitive.extensions[ EXTENSIONS.KHR_DRACO_MESH_COMPRESSION ] ) {\n\n\t\t\t\t\t// Use DRACO geometry if available\n\t\t\t\t\tgeometryPromise = createDracoPrimitive( primitive );\n\n\t\t\t\t} else {\n\n\t\t\t\t\t// Otherwise create a new geometry\n\t\t\t\t\tgeometryPromise = addPrimitiveAttributes( new BufferGeometry(), primitive, parser );\n\n\t\t\t\t}\n\n\t\t\t\t// Cache this geometry\n\t\t\t\tcache[ cacheKey ] = { primitive: primitive, promise: geometryPromise };\n\n\t\t\t\tpending.push( geometryPromise );\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn Promise.all( pending );\n\n\t}\n\n\t/**\n\t * Specification: https://github.com/KhronosGroup/glTF/blob/master/specification/2.0/README.md#meshes\n\t * @param {number} meshIndex\n\t * @return {Promise<Group|Mesh|SkinnedMesh>}\n\t */\n\tloadMesh( meshIndex ) {\n\n\t\tconst parser = this;\n\t\tconst json = this.json;\n\t\tconst extensions = this.extensions;\n\n\t\tconst meshDef = json.meshes[ meshIndex ];\n\t\tconst primitives = meshDef.primitives;\n\n\t\tconst pending = [];\n\n\t\tfor ( let i = 0, il = primitives.length; i < il; i ++ ) {\n\n\t\t\tconst material = primitives[ i ].material === undefined\n\t\t\t\t? createDefaultMaterial( this.cache )\n\t\t\t\t: this.getDependency( 'material', primitives[ i ].material );\n\n\t\t\tpending.push( material );\n\n\t\t}\n\n\t\tpending.push( parser.loadGeometries( primitives ) );\n\n\t\treturn Promise.all( pending ).then( function ( results ) {\n\n\t\t\tconst materials = results.slice( 0, results.length - 1 );\n\t\t\tconst geometries = results[ results.length - 1 ];\n\n\t\t\tconst meshes = [];\n\n\t\t\tfor ( let i = 0, il = geometries.length; i < il; i ++ ) {\n\n\t\t\t\tconst geometry = geometries[ i ];\n\t\t\t\tconst primitive = primitives[ i ];\n\n\t\t\t\t// 1. create Mesh\n\n\t\t\t\tlet mesh;\n\n\t\t\t\tconst material = materials[ i ];\n\n\t\t\t\tif ( primitive.mode === WEBGL_CONSTANTS.TRIANGLES ||\n\t\t\t\t\t\tprimitive.mode === WEBGL_CONSTANTS.TRIANGLE_STRIP ||\n\t\t\t\t\t\tprimitive.mode === WEBGL_CONSTANTS.TRIANGLE_FAN ||\n\t\t\t\t\t\tprimitive.mode === undefined ) {\n\n\t\t\t\t\t// .isSkinnedMesh isn't in glTF spec. See ._markDefs()\n\t\t\t\t\tmesh = meshDef.isSkinnedMesh === true\n\t\t\t\t\t\t? new SkinnedMesh( geometry, material )\n\t\t\t\t\t\t: new Mesh( geometry, material );\n\n\t\t\t\t\tif ( mesh.isSkinnedMesh === true && ! mesh.geometry.attributes.skinWeight.normalized ) {\n\n\t\t\t\t\t\t// we normalize floating point skin weight array to fix malformed assets (see #15319)\n\t\t\t\t\t\t// it's important to skip this for non-float32 data since normalizeSkinWeights assumes non-normalized inputs\n\t\t\t\t\t\tmesh.normalizeSkinWeights();\n\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( primitive.mode === WEBGL_CONSTANTS.TRIANGLE_STRIP ) {\n\n\t\t\t\t\t\tmesh.geometry = toTrianglesDrawMode( mesh.geometry, TriangleStripDrawMode );\n\n\t\t\t\t\t} else if ( primitive.mode === WEBGL_CONSTANTS.TRIANGLE_FAN ) {\n\n\t\t\t\t\t\tmesh.geometry = toTrianglesDrawMode( mesh.geometry, TriangleFanDrawMode );\n\n\t\t\t\t\t}\n\n\t\t\t\t} else if ( primitive.mode === WEBGL_CONSTANTS.LINES ) {\n\n\t\t\t\t\tmesh = new LineSegments( geometry, material );\n\n\t\t\t\t} else if ( primitive.mode === WEBGL_CONSTANTS.LINE_STRIP ) {\n\n\t\t\t\t\tmesh = new Line( geometry, material );\n\n\t\t\t\t} else if ( primitive.mode === WEBGL_CONSTANTS.LINE_LOOP ) {\n\n\t\t\t\t\tmesh = new LineLoop( geometry, material );\n\n\t\t\t\t} else if ( primitive.mode === WEBGL_CONSTANTS.POINTS ) {\n\n\t\t\t\t\tmesh = new Points( geometry, material );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tthrow new Error( 'THREE.GLTFLoader: Primitive mode unsupported: ' + primitive.mode );\n\n\t\t\t\t}\n\n\t\t\t\tif ( Object.keys( mesh.geometry.morphAttributes ).length > 0 ) {\n\n\t\t\t\t\tupdateMorphTargets( mesh, meshDef );\n\n\t\t\t\t}\n\n\t\t\t\tmesh.name = parser.createUniqueName( meshDef.name || ( 'mesh_' + meshIndex ) );\n\n\t\t\t\tassignExtrasToUserData( mesh, meshDef );\n\n\t\t\t\tif ( primitive.extensions ) addUnknownExtensionsToUserData( extensions, mesh, primitive );\n\n\t\t\t\tparser.assignFinalMaterial( mesh );\n\n\t\t\t\tmeshes.push( mesh );\n\n\t\t\t}\n\n\t\t\tif ( meshes.length === 1 ) {\n\n\t\t\t\treturn meshes[ 0 ];\n\n\t\t\t}\n\n\t\t\tconst group = new Group();\n\n\t\t\tfor ( let i = 0, il = meshes.length; i < il; i ++ ) {\n\n\t\t\t\tgroup.add( meshes[ i ] );\n\n\t\t\t}\n\n\t\t\treturn group;\n\n\t\t} );\n\n\t}\n\n\t/**\n\t * Specification: https://github.com/KhronosGroup/glTF/tree/master/specification/2.0#cameras\n\t * @param {number} cameraIndex\n\t * @return {Promise<THREE.Camera>}\n\t */\n\tloadCamera( cameraIndex ) {\n\n\t\tlet camera;\n\t\tconst cameraDef = this.json.cameras[ cameraIndex ];\n\t\tconst params = cameraDef[ cameraDef.type ];\n\n\t\tif ( ! params ) {\n\n\t\t\tconsole.warn( 'THREE.GLTFLoader: Missing camera parameters.' );\n\t\t\treturn;\n\n\t\t}\n\n\t\tif ( cameraDef.type === 'perspective' ) {\n\n\t\t\tcamera = new PerspectiveCamera( MathUtils.radToDeg( params.yfov ), params.aspectRatio || 1, params.znear || 1, params.zfar || 2e6 );\n\n\t\t} else if ( cameraDef.type === 'orthographic' ) {\n\n\t\t\tcamera = new OrthographicCamera( - params.xmag, params.xmag, params.ymag, - params.ymag, params.znear, params.zfar );\n\n\t\t}\n\n\t\tif ( cameraDef.name ) camera.name = this.createUniqueName( cameraDef.name );\n\n\t\tassignExtrasToUserData( camera, cameraDef );\n\n\t\treturn Promise.resolve( camera );\n\n\t}\n\n\t/**\n\t * Specification: https://github.com/KhronosGroup/glTF/tree/master/specification/2.0#skins\n\t * @param {number} skinIndex\n\t * @return {Promise<Object>}\n\t */\n\tloadSkin( skinIndex ) {\n\n\t\tconst skinDef = this.json.skins[ skinIndex ];\n\n\t\tconst skinEntry = { joints: skinDef.joints };\n\n\t\tif ( skinDef.inverseBindMatrices === undefined ) {\n\n\t\t\treturn Promise.resolve( skinEntry );\n\n\t\t}\n\n\t\treturn this.getDependency( 'accessor', skinDef.inverseBindMatrices ).then( function ( accessor ) {\n\n\t\t\tskinEntry.inverseBindMatrices = accessor;\n\n\t\t\treturn skinEntry;\n\n\t\t} );\n\n\t}\n\n\t/**\n\t * Specification: https://github.com/KhronosGroup/glTF/tree/master/specification/2.0#animations\n\t * @param {number} animationIndex\n\t * @return {Promise<AnimationClip>}\n\t */\n\tloadAnimation( animationIndex ) {\n\n\t\tconst json = this.json;\n\n\t\tconst animationDef = json.animations[ animationIndex ];\n\n\t\tconst pendingNodes = [];\n\t\tconst pendingInputAccessors = [];\n\t\tconst pendingOutputAccessors = [];\n\t\tconst pendingSamplers = [];\n\t\tconst pendingTargets = [];\n\n\t\tfor ( let i = 0, il = animationDef.channels.length; i < il; i ++ ) {\n\n\t\t\tconst channel = animationDef.channels[ i ];\n\t\t\tconst sampler = animationDef.samplers[ channel.sampler ];\n\t\t\tconst target = channel.target;\n\t\t\tconst name = target.node !== undefined ? target.node : target.id; // NOTE: target.id is deprecated.\n\t\t\tconst input = animationDef.parameters !== undefined ? animationDef.parameters[ sampler.input ] : sampler.input;\n\t\t\tconst output = animationDef.parameters !== undefined ? animationDef.parameters[ sampler.output ] : sampler.output;\n\n\t\t\tpendingNodes.push( this.getDependency( 'node', name ) );\n\t\t\tpendingInputAccessors.push( this.getDependency( 'accessor', input ) );\n\t\t\tpendingOutputAccessors.push( this.getDependency( 'accessor', output ) );\n\t\t\tpendingSamplers.push( sampler );\n\t\t\tpendingTargets.push( target );\n\n\t\t}\n\n\t\treturn Promise.all( [\n\n\t\t\tPromise.all( pendingNodes ),\n\t\t\tPromise.all( pendingInputAccessors ),\n\t\t\tPromise.all( pendingOutputAccessors ),\n\t\t\tPromise.all( pendingSamplers ),\n\t\t\tPromise.all( pendingTargets )\n\n\t\t] ).then( function ( dependencies ) {\n\n\t\t\tconst nodes = dependencies[ 0 ];\n\t\t\tconst inputAccessors = dependencies[ 1 ];\n\t\t\tconst outputAccessors = dependencies[ 2 ];\n\t\t\tconst samplers = dependencies[ 3 ];\n\t\t\tconst targets = dependencies[ 4 ];\n\n\t\t\tconst tracks = [];\n\n\t\t\tfor ( let i = 0, il = nodes.length; i < il; i ++ ) {\n\n\t\t\t\tconst node = nodes[ i ];\n\t\t\t\tconst inputAccessor = inputAccessors[ i ];\n\t\t\t\tconst outputAccessor = outputAccessors[ i ];\n\t\t\t\tconst sampler = samplers[ i ];\n\t\t\t\tconst target = targets[ i ];\n\n\t\t\t\tif ( node === undefined ) continue;\n\n\t\t\t\tnode.updateMatrix();\n\t\t\t\tnode.matrixAutoUpdate = true;\n\n\t\t\t\tlet TypedKeyframeTrack;\n\n\t\t\t\tswitch ( PATH_PROPERTIES[ target.path ] ) {\n\n\t\t\t\t\tcase PATH_PROPERTIES.weights:\n\n\t\t\t\t\t\tTypedKeyframeTrack = NumberKeyframeTrack;\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase PATH_PROPERTIES.rotation:\n\n\t\t\t\t\t\tTypedKeyframeTrack = QuaternionKeyframeTrack;\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase PATH_PROPERTIES.position:\n\t\t\t\t\tcase PATH_PROPERTIES.scale:\n\t\t\t\t\tdefault:\n\n\t\t\t\t\t\tTypedKeyframeTrack = VectorKeyframeTrack;\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t}\n\n\t\t\t\tconst targetName = node.name ? node.name : node.uuid;\n\n\t\t\t\tconst interpolation = sampler.interpolation !== undefined ? INTERPOLATION[ sampler.interpolation ] : InterpolateLinear;\n\n\t\t\t\tconst targetNames = [];\n\n\t\t\t\tif ( PATH_PROPERTIES[ target.path ] === PATH_PROPERTIES.weights ) {\n\n\t\t\t\t\t// Node may be a Group (glTF mesh with several primitives) or a Mesh.\n\t\t\t\t\tnode.traverse( function ( object ) {\n\n\t\t\t\t\t\tif ( object.isMesh === true && object.morphTargetInfluences ) {\n\n\t\t\t\t\t\t\ttargetNames.push( object.name ? object.name : object.uuid );\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t} );\n\n\t\t\t\t} else {\n\n\t\t\t\t\ttargetNames.push( targetName );\n\n\t\t\t\t}\n\n\t\t\t\tlet outputArray = outputAccessor.array;\n\n\t\t\t\tif ( outputAccessor.normalized ) {\n\n\t\t\t\t\tconst scale = getNormalizedComponentScale( outputArray.constructor );\n\t\t\t\t\tconst scaled = new Float32Array( outputArray.length );\n\n\t\t\t\t\tfor ( let j = 0, jl = outputArray.length; j < jl; j ++ ) {\n\n\t\t\t\t\t\tscaled[ j ] = outputArray[ j ] * scale;\n\n\t\t\t\t\t}\n\n\t\t\t\t\toutputArray = scaled;\n\n\t\t\t\t}\n\n\t\t\t\tfor ( let j = 0, jl = targetNames.length; j < jl; j ++ ) {\n\n\t\t\t\t\tconst track = new TypedKeyframeTrack(\n\t\t\t\t\t\ttargetNames[ j ] + '.' + PATH_PROPERTIES[ target.path ],\n\t\t\t\t\t\tinputAccessor.array,\n\t\t\t\t\t\toutputArray,\n\t\t\t\t\t\tinterpolation\n\t\t\t\t\t);\n\n\t\t\t\t\t// Override interpolation with custom factory method.\n\t\t\t\t\tif ( sampler.interpolation === 'CUBICSPLINE' ) {\n\n\t\t\t\t\t\ttrack.createInterpolant = function InterpolantFactoryMethodGLTFCubicSpline( result ) {\n\n\t\t\t\t\t\t\t// A CUBICSPLINE keyframe in glTF has three output values for each input value,\n\t\t\t\t\t\t\t// representing inTangent, splineVertex, and outTangent. As a result, track.getValueSize()\n\t\t\t\t\t\t\t// must be divided by three to get the interpolant's sampleSize argument.\n\n\t\t\t\t\t\t\treturn new GLTFCubicSplineInterpolant( this.times, this.values, this.getValueSize() / 3, result );\n\n\t\t\t\t\t\t};\n\n\t\t\t\t\t\t// Mark as CUBICSPLINE. `track.getInterpolation()` doesn't support custom interpolants.\n\t\t\t\t\t\ttrack.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline = true;\n\n\t\t\t\t\t}\n\n\t\t\t\t\ttracks.push( track );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tconst name = animationDef.name ? animationDef.name : 'animation_' + animationIndex;\n\n\t\t\treturn new AnimationClip( name, undefined, tracks );\n\n\t\t} );\n\n\t}\n\n\tcreateNodeMesh( nodeIndex ) {\n\n\t\tconst json = this.json;\n\t\tconst parser = this;\n\t\tconst nodeDef = json.nodes[ nodeIndex ];\n\n\t\tif ( nodeDef.mesh === undefined ) return null;\n\n\t\treturn parser.getDependency( 'mesh', nodeDef.mesh ).then( function ( mesh ) {\n\n\t\t\tconst node = parser._getNodeRef( parser.meshCache, nodeDef.mesh, mesh );\n\n\t\t\t// if weights are provided on the node, override weights on the mesh.\n\t\t\tif ( nodeDef.weights !== undefined ) {\n\n\t\t\t\tnode.traverse( function ( o ) {\n\n\t\t\t\t\tif ( ! o.isMesh ) return;\n\n\t\t\t\t\tfor ( let i = 0, il = nodeDef.weights.length; i < il; i ++ ) {\n\n\t\t\t\t\t\to.morphTargetInfluences[ i ] = nodeDef.weights[ i ];\n\n\t\t\t\t\t}\n\n\t\t\t\t} );\n\n\t\t\t}\n\n\t\t\treturn node;\n\n\t\t} );\n\n\t}\n\n\t/**\n\t * Specification: https://github.com/KhronosGroup/glTF/tree/master/specification/2.0#nodes-and-hierarchy\n\t * @param {number} nodeIndex\n\t * @return {Promise<Object3D>}\n\t */\n\tloadNode( nodeIndex ) {\n\n\t\tconst json = this.json;\n\t\tconst extensions = this.extensions;\n\t\tconst parser = this;\n\n\t\tconst nodeDef = json.nodes[ nodeIndex ];\n\n\t\t// reserve node's name before its dependencies, so the root has the intended name.\n\t\tconst nodeName = nodeDef.name ? parser.createUniqueName( nodeDef.name ) : '';\n\n\t\treturn ( function () {\n\n\t\t\tconst pending = [];\n\n\t\t\tconst meshPromise = parser._invokeOne( function ( ext ) {\n\n\t\t\t\treturn ext.createNodeMesh && ext.createNodeMesh( nodeIndex );\n\n\t\t\t} );\n\n\t\t\tif ( meshPromise ) {\n\n\t\t\t\tpending.push( meshPromise );\n\n\t\t\t}\n\n\t\t\tif ( nodeDef.camera !== undefined ) {\n\n\t\t\t\tpending.push( parser.getDependency( 'camera', nodeDef.camera ).then( function ( camera ) {\n\n\t\t\t\t\treturn parser._getNodeRef( parser.cameraCache, nodeDef.camera, camera );\n\n\t\t\t\t} ) );\n\n\t\t\t}\n\n\t\t\tparser._invokeAll( function ( ext ) {\n\n\t\t\t\treturn ext.createNodeAttachment && ext.createNodeAttachment( nodeIndex );\n\n\t\t\t} ).forEach( function ( promise ) {\n\n\t\t\t\tpending.push( promise );\n\n\t\t\t} );\n\n\t\t\treturn Promise.all( pending );\n\n\t\t}() ).then( function ( objects ) {\n\n\t\t\tlet node;\n\n\t\t\t// .isBone isn't in glTF spec. See ._markDefs\n\t\t\tif ( nodeDef.isBone === true ) {\n\n\t\t\t\tnode = new Bone();\n\n\t\t\t} else if ( objects.length > 1 ) {\n\n\t\t\t\tnode = new Group();\n\n\t\t\t} else if ( objects.length === 1 ) {\n\n\t\t\t\tnode = objects[ 0 ];\n\n\t\t\t} else {\n\n\t\t\t\tnode = new Object3D();\n\n\t\t\t}\n\n\t\t\tif ( node !== objects[ 0 ] ) {\n\n\t\t\t\tfor ( let i = 0, il = objects.length; i < il; i ++ ) {\n\n\t\t\t\t\tnode.add( objects[ i ] );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tif ( nodeDef.name ) {\n\n\t\t\t\tnode.userData.name = nodeDef.name;\n\t\t\t\tnode.name = nodeName;\n\n\t\t\t}\n\n\t\t\tassignExtrasToUserData( node, nodeDef );\n\n\t\t\tif ( nodeDef.extensions ) addUnknownExtensionsToUserData( extensions, node, nodeDef );\n\n\t\t\tif ( nodeDef.matrix !== undefined ) {\n\n\t\t\t\tconst matrix = new Matrix4();\n\t\t\t\tmatrix.fromArray( nodeDef.matrix );\n\t\t\t\tnode.applyMatrix4( matrix );\n\n\t\t\t} else {\n\n\t\t\t\tif ( nodeDef.translation !== undefined ) {\n\n\t\t\t\t\tnode.position.fromArray( nodeDef.translation );\n\n\t\t\t\t}\n\n\t\t\t\tif ( nodeDef.rotation !== undefined ) {\n\n\t\t\t\t\tnode.quaternion.fromArray( nodeDef.rotation );\n\n\t\t\t\t}\n\n\t\t\t\tif ( nodeDef.scale !== undefined ) {\n\n\t\t\t\t\tnode.scale.fromArray( nodeDef.scale );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tparser.associations.set( node, { type: 'nodes', index: nodeIndex } );\n\n\t\t\treturn node;\n\n\t\t} );\n\n\t}\n\n\t/**\n\t * Specification: https://github.com/KhronosGroup/glTF/tree/master/specification/2.0#scenes\n\t * @param {number} sceneIndex\n\t * @return {Promise<Group>}\n\t */\n\tloadScene( sceneIndex ) {\n\n\t\tconst json = this.json;\n\t\tconst extensions = this.extensions;\n\t\tconst sceneDef = this.json.scenes[ sceneIndex ];\n\t\tconst parser = this;\n\n\t\t// Loader returns Group, not Scene.\n\t\t// See: https://github.com/mrdoob/three.js/issues/18342#issuecomment-578981172\n\t\tconst scene = new Group();\n\t\tif ( sceneDef.name ) scene.name = parser.createUniqueName( sceneDef.name );\n\n\t\tassignExtrasToUserData( scene, sceneDef );\n\n\t\tif ( sceneDef.extensions ) addUnknownExtensionsToUserData( extensions, scene, sceneDef );\n\n\t\tconst nodeIds = sceneDef.nodes || [];\n\n\t\tconst pending = [];\n\n\t\tfor ( let i = 0, il = nodeIds.length; i < il; i ++ ) {\n\n\t\t\tpending.push( buildNodeHierachy( nodeIds[ i ], scene, json, parser ) );\n\n\t\t}\n\n\t\treturn Promise.all( pending ).then( function () {\n\n\t\t\treturn scene;\n\n\t\t} );\n\n\t}\n\n}\n\nfunction buildNodeHierachy( nodeId, parentObject, json, parser ) {\n\n\tconst nodeDef = json.nodes[ nodeId ];\n\n\treturn parser.getDependency( 'node', nodeId ).then( function ( node ) {\n\n\t\tif ( nodeDef.skin === undefined ) return node;\n\n\t\t// build skeleton here as well\n\n\t\tlet skinEntry;\n\n\t\treturn parser.getDependency( 'skin', nodeDef.skin ).then( function ( skin ) {\n\n\t\t\tskinEntry = skin;\n\n\t\t\tconst pendingJoints = [];\n\n\t\t\tfor ( let i = 0, il = skinEntry.joints.length; i < il; i ++ ) {\n\n\t\t\t\tpendingJoints.push( parser.getDependency( 'node', skinEntry.joints[ i ] ) );\n\n\t\t\t}\n\n\t\t\treturn Promise.all( pendingJoints );\n\n\t\t} ).then( function ( jointNodes ) {\n\n\t\t\tnode.traverse( function ( mesh ) {\n\n\t\t\t\tif ( ! mesh.isMesh ) return;\n\n\t\t\t\tconst bones = [];\n\t\t\t\tconst boneInverses = [];\n\n\t\t\t\tfor ( let j = 0, jl = jointNodes.length; j < jl; j ++ ) {\n\n\t\t\t\t\tconst jointNode = jointNodes[ j ];\n\n\t\t\t\t\tif ( jointNode ) {\n\n\t\t\t\t\t\tbones.push( jointNode );\n\n\t\t\t\t\t\tconst mat = new Matrix4();\n\n\t\t\t\t\t\tif ( skinEntry.inverseBindMatrices !== undefined ) {\n\n\t\t\t\t\t\t\tmat.fromArray( skinEntry.inverseBindMatrices.array, j * 16 );\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tboneInverses.push( mat );\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\tconsole.warn( 'THREE.GLTFLoader: Joint \"%s\" could not be found.', skinEntry.joints[ j ] );\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\tmesh.bind( new Skeleton( bones, boneInverses ), mesh.matrixWorld );\n\n\t\t\t} );\n\n\t\t\treturn node;\n\n\t\t} );\n\n\t} ).then( function ( node ) {\n\n\t\t// build node hierachy\n\n\t\tparentObject.add( node );\n\n\t\tconst pending = [];\n\n\t\tif ( nodeDef.children ) {\n\n\t\t\tconst children = nodeDef.children;\n\n\t\t\tfor ( let i = 0, il = children.length; i < il; i ++ ) {\n\n\t\t\t\tconst child = children[ i ];\n\t\t\t\tpending.push( buildNodeHierachy( child, node, json, parser ) );\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn Promise.all( pending );\n\n\t} );\n\n}\n\n/**\n * @param {BufferGeometry} geometry\n * @param {GLTF.Primitive} primitiveDef\n * @param {GLTFParser} parser\n */\nfunction computeBounds( geometry, primitiveDef, parser ) {\n\n\tconst attributes = primitiveDef.attributes;\n\n\tconst box = new Box3();\n\n\tif ( attributes.POSITION !== undefined ) {\n\n\t\tconst accessor = parser.json.accessors[ attributes.POSITION ];\n\n\t\tconst min = accessor.min;\n\t\tconst max = accessor.max;\n\n\t\t// glTF requires 'min' and 'max', but VRM (which extends glTF) currently ignores that requirement.\n\n\t\tif ( min !== undefined && max !== undefined ) {\n\n\t\t\tbox.set(\n\t\t\t\tnew Vector3( min[ 0 ], min[ 1 ], min[ 2 ] ),\n\t\t\t\tnew Vector3( max[ 0 ], max[ 1 ], max[ 2 ] )\n\t\t\t);\n\n\t\t\tif ( accessor.normalized ) {\n\n\t\t\t\tconst boxScale = getNormalizedComponentScale( WEBGL_COMPONENT_TYPES[ accessor.componentType ] );\n\t\t\t\tbox.min.multiplyScalar( boxScale );\n\t\t\t\tbox.max.multiplyScalar( boxScale );\n\n\t\t\t}\n\n\t\t} else {\n\n\t\t\tconsole.warn( 'THREE.GLTFLoader: Missing min/max properties for accessor POSITION.' );\n\n\t\t\treturn;\n\n\t\t}\n\n\t} else {\n\n\t\treturn;\n\n\t}\n\n\tconst targets = primitiveDef.targets;\n\n\tif ( targets !== undefined ) {\n\n\t\tconst maxDisplacement = new Vector3();\n\t\tconst vector = new Vector3();\n\n\t\tfor ( let i = 0, il = targets.length; i < il; i ++ ) {\n\n\t\t\tconst target = targets[ i ];\n\n\t\t\tif ( target.POSITION !== undefined ) {\n\n\t\t\t\tconst accessor = parser.json.accessors[ target.POSITION ];\n\t\t\t\tconst min = accessor.min;\n\t\t\t\tconst max = accessor.max;\n\n\t\t\t\t// glTF requires 'min' and 'max', but VRM (which extends glTF) currently ignores that requirement.\n\n\t\t\t\tif ( min !== undefined && max !== undefined ) {\n\n\t\t\t\t\t// we need to get max of absolute components because target weight is [-1,1]\n\t\t\t\t\tvector.setX( Math.max( Math.abs( min[ 0 ] ), Math.abs( max[ 0 ] ) ) );\n\t\t\t\t\tvector.setY( Math.max( Math.abs( min[ 1 ] ), Math.abs( max[ 1 ] ) ) );\n\t\t\t\t\tvector.setZ( Math.max( Math.abs( min[ 2 ] ), Math.abs( max[ 2 ] ) ) );\n\n\n\t\t\t\t\tif ( accessor.normalized ) {\n\n\t\t\t\t\t\tconst boxScale = getNormalizedComponentScale( WEBGL_COMPONENT_TYPES[ accessor.componentType ] );\n\t\t\t\t\t\tvector.multiplyScalar( boxScale );\n\n\t\t\t\t\t}\n\n\t\t\t\t\t// Note: this assumes that the sum of all weights is at most 1. This isn't quite correct - it's more conservative\n\t\t\t\t\t// to assume that each target can have a max weight of 1. However, for some use cases - notably, when morph targets\n\t\t\t\t\t// are used to implement key-frame animations and as such only two are active at a time - this results in very large\n\t\t\t\t\t// boxes. So for now we make a box that's sometimes a touch too small but is hopefully mostly of reasonable size.\n\t\t\t\t\tmaxDisplacement.max( vector );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tconsole.warn( 'THREE.GLTFLoader: Missing min/max properties for accessor POSITION.' );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\t// As per comment above this box isn't conservative, but has a reasonable size for a very large number of morph targets.\n\t\tbox.expandByVector( maxDisplacement );\n\n\t}\n\n\tgeometry.boundingBox = box;\n\n\tconst sphere = new Sphere();\n\n\tbox.getCenter( sphere.center );\n\tsphere.radius = box.min.distanceTo( box.max ) / 2;\n\n\tgeometry.boundingSphere = sphere;\n\n}\n\n/**\n * @param {BufferGeometry} geometry\n * @param {GLTF.Primitive} primitiveDef\n * @param {GLTFParser} parser\n * @return {Promise<BufferGeometry>}\n */\nfunction addPrimitiveAttributes( geometry, primitiveDef, parser ) {\n\n\tconst attributes = primitiveDef.attributes;\n\n\tconst pending = [];\n\n\tfunction assignAttributeAccessor( accessorIndex, attributeName ) {\n\n\t\treturn parser.getDependency( 'accessor', accessorIndex )\n\t\t\t.then( function ( accessor ) {\n\n\t\t\t\tgeometry.setAttribute( attributeName, accessor );\n\n\t\t\t} );\n\n\t}\n\n\tfor ( const gltfAttributeName in attributes ) {\n\n\t\tconst threeAttributeName = ATTRIBUTES[ gltfAttributeName ] || gltfAttributeName.toLowerCase();\n\n\t\t// Skip attributes already provided by e.g. Draco extension.\n\t\tif ( threeAttributeName in geometry.attributes ) continue;\n\n\t\tpending.push( assignAttributeAccessor( attributes[ gltfAttributeName ], threeAttributeName ) );\n\n\t}\n\n\tif ( primitiveDef.indices !== undefined && ! geometry.index ) {\n\n\t\tconst accessor = parser.getDependency( 'accessor', primitiveDef.indices ).then( function ( accessor ) {\n\n\t\t\tgeometry.setIndex( accessor );\n\n\t\t} );\n\n\t\tpending.push( accessor );\n\n\t}\n\n\tassignExtrasToUserData( geometry, primitiveDef );\n\n\tcomputeBounds( geometry, primitiveDef, parser );\n\n\treturn Promise.all( pending ).then( function () {\n\n\t\treturn primitiveDef.targets !== undefined\n\t\t\t? addMorphTargets( geometry, primitiveDef.targets, parser )\n\t\t\t: geometry;\n\n\t} );\n\n}\n\n/**\n * @param {BufferGeometry} geometry\n * @param {Number} drawMode\n * @return {BufferGeometry}\n */\nfunction toTrianglesDrawMode( geometry, drawMode ) {\n\n\tlet index = geometry.getIndex();\n\n\t// generate index if not present\n\n\tif ( index === null ) {\n\n\t\tconst indices = [];\n\n\t\tconst position = geometry.getAttribute( 'position' );\n\n\t\tif ( position !== undefined ) {\n\n\t\t\tfor ( let i = 0; i < position.count; i ++ ) {\n\n\t\t\t\tindices.push( i );\n\n\t\t\t}\n\n\t\t\tgeometry.setIndex( indices );\n\t\t\tindex = geometry.getIndex();\n\n\t\t} else {\n\n\t\t\tconsole.error( 'THREE.GLTFLoader.toTrianglesDrawMode(): Undefined position attribute. Processing not possible.' );\n\t\t\treturn geometry;\n\n\t\t}\n\n\t}\n\n\t//\n\n\tconst numberOfTriangles = index.count - 2;\n\tconst newIndices = [];\n\n\tif ( drawMode === TriangleFanDrawMode ) {\n\n\t\t// gl.TRIANGLE_FAN\n\n\t\tfor ( let i = 1; i <= numberOfTriangles; i ++ ) {\n\n\t\t\tnewIndices.push( index.getX( 0 ) );\n\t\t\tnewIndices.push( index.getX( i ) );\n\t\t\tnewIndices.push( index.getX( i + 1 ) );\n\n\t\t}\n\n\t} else {\n\n\t\t// gl.TRIANGLE_STRIP\n\n\t\tfor ( let i = 0; i < numberOfTriangles; i ++ ) {\n\n\t\t\tif ( i % 2 === 0 ) {\n\n\t\t\t\tnewIndices.push( index.getX( i ) );\n\t\t\t\tnewIndices.push( index.getX( i + 1 ) );\n\t\t\t\tnewIndices.push( index.getX( i + 2 ) );\n\n\n\t\t\t} else {\n\n\t\t\t\tnewIndices.push( index.getX( i + 2 ) );\n\t\t\t\tnewIndices.push( index.getX( i + 1 ) );\n\t\t\t\tnewIndices.push( index.getX( i ) );\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\tif ( ( newIndices.length / 3 ) !== numberOfTriangles ) {\n\n\t\tconsole.error( 'THREE.GLTFLoader.toTrianglesDrawMode(): Unable to generate correct amount of triangles.' );\n\n\t}\n\n\t// build final geometry\n\n\tconst newGeometry = geometry.clone();\n\tnewGeometry.setIndex( newIndices );\n\n\treturn newGeometry;\n\n}\n\nexport { GLTFLoader };\n","/**\r\n * @author       Yannick Deubel (https://github.com/yandeu)\r\n * @copyright    Copyright (c) 2020 Yannick Deubel; Project Url: https://github.com/enable3d/enable3d\r\n * @license      {@link https://github.com/enable3d/enable3d/blob/master/LICENSE|GNU GPLv3}\r\n */\r\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n};\r\nimport { FileLoader, ImageLoader, ObjectLoader, TextureLoader } from 'three';\r\nimport { FBXLoader } from 'three/examples/jsm/loaders/FBXLoader';\r\nimport { GLTFLoader } from 'three/examples/jsm/loaders/GLTFLoader';\r\nimport { SVGLoader } from 'three/examples/jsm/loaders/SVGLoader';\r\nexport default class Loaders {\r\n    constructor(cache, textureAnisotropy) {\r\n        this.cache = cache;\r\n        this.textureAnisotropy = textureAnisotropy;\r\n    }\r\n    get fileLoader() {\r\n        if (!this._fileLoader)\r\n            this._fileLoader = new FileLoader();\r\n        return this._fileLoader;\r\n    }\r\n    get imageLoader() {\r\n        if (!this._imgLoader)\r\n            this._imgLoader = new ImageLoader();\r\n        return this._imgLoader;\r\n    }\r\n    get svgLoader() {\r\n        if (!this._svgLoader)\r\n            this._svgLoader = new SVGLoader();\r\n        return this._svgLoader;\r\n    }\r\n    get textureLoader() {\r\n        if (!this._textureLoader)\r\n            this._textureLoader = new TextureLoader();\r\n        return this._textureLoader;\r\n    }\r\n    get objectLoader() {\r\n        if (!this._objectLoader)\r\n            this._objectLoader = new ObjectLoader();\r\n        return this._objectLoader;\r\n    }\r\n    get gltfLoader() {\r\n        if (!this._gltfLoader)\r\n            this._gltfLoader = new GLTFLoader();\r\n        return this._gltfLoader;\r\n    }\r\n    get fbxLoader() {\r\n        if (!this._fbxLoader)\r\n            this._fbxLoader = new FBXLoader();\r\n        return this._fbxLoader;\r\n    }\r\n    preload(key, url) {\r\n        return __awaiter(this, void 0, void 0, function* () {\r\n            this.cache.add(key, url);\r\n            return new Promise(resolve => {\r\n                const isModel = /\\.fbx$|\\.glb$|\\.gltf$/.test(url);\r\n                const isTexture = /\\.jpe?g$|\\.png$/.test(url);\r\n                if (isTexture) {\r\n                    this.textureLoader.load(url, texture => {\r\n                        return resolve(texture);\r\n                    });\r\n                }\r\n                else {\r\n                    if (isModel)\r\n                        this.fileLoader.setResponseType('arraybuffer');\r\n                    this.fileLoader.load(url, file => {\r\n                        return resolve(file);\r\n                    });\r\n                }\r\n            });\r\n        });\r\n    }\r\n    textureAtlas(texture, json, _type = 'JSONHash') {\r\n        return __awaiter(this, void 0, void 0, function* () {\r\n            let parsed = JSON.parse((yield this.file(json)));\r\n            // convert JSONArray to JSONHash\r\n            const isJSONArray = parsed.textures;\r\n            if (isJSONArray) {\r\n                const frames = parsed.textures[0].frames;\r\n                let jsonHash = { frames: {} };\r\n                frames.forEach(frame => {\r\n                    jsonHash = Object.assign(Object.assign({}, jsonHash), { frames: Object.assign(Object.assign({}, jsonHash.frames), { [frame.filename]: {\r\n                                frame: frame.frame,\r\n                                rotated: frame.rotated,\r\n                                sourceSize: frame.sourceSize,\r\n                                spriteSourceSize: frame.spriteSourceSize,\r\n                                trimmed: frame.trimmed\r\n                            } }) });\r\n                });\r\n                parsed = jsonHash;\r\n            }\r\n            const atlas = {\r\n                texture: yield this.texture(texture),\r\n                json: parsed\r\n            };\r\n            return atlas;\r\n        });\r\n    }\r\n    file(url) {\r\n        const key = this.cache.get(url);\r\n        url = key ? key : url;\r\n        return new Promise(resolve => {\r\n            this.fileLoader.load(url, file => {\r\n                return resolve(file);\r\n            });\r\n        });\r\n    }\r\n    svg(url) {\r\n        const key = this.cache.get(url);\r\n        url = key ? key : url;\r\n        return new Promise(resolve => {\r\n            this.svgLoader.load(url, svg => {\r\n                return resolve(svg);\r\n            });\r\n        });\r\n    }\r\n    texture(url) {\r\n        const isBase64 = /^data:image\\/[\\S]+;base64,/gm.test(url);\r\n        // we do not want to cache base64 images\r\n        if (!isBase64) {\r\n            const key = this.cache.get(url);\r\n            url = key ? key : url;\r\n        }\r\n        return new Promise(resolve => {\r\n            this.textureLoader.load(url, (texture) => {\r\n                texture.anisotropy = this.textureAnisotropy;\r\n                texture.needsUpdate = true;\r\n                resolve(texture);\r\n            });\r\n        });\r\n    }\r\n    // examples: https://github.com/mrdoob/three.js/wiki/JSON-Object-Scene-format-4\r\n    object(url) {\r\n        const key = this.cache.get(url);\r\n        url = key ? key : url;\r\n        return new Promise(resolve => {\r\n            this.objectLoader.load(url, (json) => {\r\n                resolve(json);\r\n            });\r\n        });\r\n    }\r\n    gltf(url) {\r\n        const key = this.cache.get(url);\r\n        url = key ? key : url;\r\n        return new Promise(resolve => {\r\n            this.gltfLoader.load(url, (gltf) => {\r\n                resolve(gltf);\r\n            });\r\n        });\r\n    }\r\n    fbx(url) {\r\n        const key = this.cache.get(url);\r\n        url = key ? key : url;\r\n        return new Promise(resolve => {\r\n            this.fbxLoader.load(url, (fbx) => {\r\n                resolve(fbx);\r\n            });\r\n        });\r\n    }\r\n}\r\n//# sourceMappingURL=loaders.js.map","/**\r\n * @author       Yannick Deubel (https://github.com/yandeu)\r\n * @copyright    Copyright (c) 2020 Yannick Deubel; Project Url: https://github.com/enable3d/enable3d\r\n * @license      {@link https://github.com/enable3d/enable3d/blob/master/LICENSE|GNU GPLv3}\r\n */\r\nimport { Mesh, MeshBasicMaterial, Object3D, SphereBufferGeometry } from 'three';\r\nimport { AmbientLight, DirectionalLight, HemisphereLight, PointLight, RectAreaLight, SpotLight } from 'three';\r\nimport { DirectionalLightHelper, SpotLightHelper } from 'three';\r\nclass PointLightHelper extends Object3D {\r\n    constructor(scene, light, size, color) {\r\n        super();\r\n        this.scene = scene;\r\n        this.light = light;\r\n        this.size = size;\r\n        this.color = color;\r\n        this.geo = new SphereBufferGeometry(size || 0.2, 16, 8);\r\n        this.mat = new MeshBasicMaterial({ color: color || light.color });\r\n        this.mesh = new Mesh(this.geo, this.mat);\r\n        this.add(this.mesh);\r\n        light.add(this);\r\n    }\r\n    dispose() {\r\n        this.mesh.geometry.dispose();\r\n        if (!Array.isArray(this.mesh.material))\r\n            this.mesh.material.dispose();\r\n        else\r\n            this.mesh.material.forEach(m => m.dispose());\r\n        this.remove(this.mesh);\r\n    }\r\n    update() { }\r\n}\r\nexport default class Lights {\r\n    constructor(scene) {\r\n        this.scene = scene;\r\n    }\r\n    get helper() {\r\n        return {\r\n            directionalLightHelper: (light, size, color) => {\r\n                const helper = new DirectionalLightHelper(light, size, color);\r\n                this.scene.add(helper);\r\n                return helper;\r\n            },\r\n            spotLightHelper: (light, color) => {\r\n                const helper = new SpotLightHelper(light, color);\r\n                this.scene.add(helper);\r\n                return helper;\r\n            },\r\n            pointLightHelper: (light, size, color) => new PointLightHelper(this.scene, light, size, color)\r\n        };\r\n    }\r\n    directionalLight(options = {}) {\r\n        const { color = 0xffffff, intensity = 1 } = options;\r\n        const light = new DirectionalLight(color, intensity);\r\n        light.castShadow = true;\r\n        this.scene.add(light);\r\n        return light;\r\n    }\r\n    hemisphereLight(options = {}) {\r\n        const { skyColor = 0xffffff, groundColor = 0xffffff, intensity = 1 } = options;\r\n        const light = new HemisphereLight(skyColor, groundColor, intensity);\r\n        this.scene.add(light);\r\n        return light;\r\n    }\r\n    ambientLight(options = {}) {\r\n        const { color = 0xffffff, intensity = 1 } = options;\r\n        const light = new AmbientLight(color, intensity);\r\n        this.scene.add(light);\r\n        return light;\r\n    }\r\n    pointLight(options = {}) {\r\n        const { color = 0xffffff, intensity = 1, distance = 0, decay = 1 } = options;\r\n        const light = new PointLight(color, intensity, distance, decay);\r\n        light.castShadow = true;\r\n        this.scene.add(light);\r\n        return light;\r\n    }\r\n    spotLight(options = {}) {\r\n        const { color = 0xffffff, intensity = 1, distance = 0, angle = Math.PI / 8, penumbra = 0, decay = 1 } = options;\r\n        const light = new SpotLight(color, intensity, distance, angle, penumbra, decay);\r\n        light.castShadow = true;\r\n        this.scene.add(light);\r\n        return light;\r\n    }\r\n    rectAreaLight(options = {}) {\r\n        const { color = 0xffffff, intensity = 1, width = 10, height = 10 } = options;\r\n        const light = new RectAreaLight(color, intensity, width, height);\r\n        this.scene.add(light);\r\n        return light;\r\n    }\r\n}\r\n//# sourceMappingURL=lights.js.map","/**\r\n * @author       Yannick Deubel (https://github.com/yandeu)\r\n * @copyright    Copyright (c) 2021 Yannick Deubel; Project Url: https://github.com/enable3d/enable3d\r\n * @license      {@link https://github.com/enable3d/enable3d/blob/master/LICENSE|GNU GPLv3}\r\n */\r\nimport { Mesh, Vector3 } from 'three';\r\nexport class ExtendedMesh extends Mesh {\r\n    constructor(geometry, material) {\r\n        super(geometry, material);\r\n        this.isExtendedMesh = true;\r\n        this.isGroup = false;\r\n        this.vector3 = new Vector3();\r\n        this.hasBody = false;\r\n        // convex object breaking\r\n        this.fragmentDepth = 0;\r\n        this.breakable = false;\r\n        this.fractureImpulse = 1;\r\n        this.name = `object-${this.id}`;\r\n    }\r\n    /** Returns all values relative to the world. */\r\n    get world() {\r\n        return {\r\n            theta: this.worldTheta,\r\n            phi: this.worldPhi\r\n        };\r\n    }\r\n    /** Get the theta relative to the world. */\r\n    get worldTheta() {\r\n        this.getWorldDirection(this.vector3);\r\n        return Math.atan2(this.vector3.x, this.vector3.z);\r\n    }\r\n    /** Get the phi relative to the world. */\r\n    get worldPhi() {\r\n        this.getWorldDirection(this.vector3);\r\n        return Math.acos(this.vector3.y);\r\n    }\r\n}\r\n//# sourceMappingURL=extendedMesh.js.map","const loggerCache = new Map();\r\nconst LOG_LIMIT = 5;\r\nexport const logger = (msg, error = false) => {\r\n    if (!loggerCache.has(msg)) {\r\n        loggerCache.set(msg, 1);\r\n    }\r\n    else {\r\n        const count = loggerCache.get(msg);\r\n        if (typeof count === 'undefined')\r\n            return;\r\n        if (count >= LOG_LIMIT)\r\n            return;\r\n        loggerCache.set(msg, count + 1);\r\n    }\r\n    if (error)\r\n        console.error(`%c [enable3d] ${msg} `, 'background: #222; color: #bada55');\r\n    else\r\n        console.warn(`%c [enable3d] ${msg} `, 'background: #222; color: #bada55');\r\n};\r\n//# sourceMappingURL=logger.js.map","import { MeshLambertMaterial } from 'three';\r\nclass DefaultMaterial {\r\n    constructor() {\r\n        this._defaultMaterial = new MeshLambertMaterial({ color: 0xcccccc });\r\n    }\r\n    get() {\r\n        return this._defaultMaterial;\r\n    }\r\n}\r\nexport default DefaultMaterial;\r\n//# sourceMappingURL=defaultMaterial.js.map","/**\r\n * @author       Yannick Deubel (https://github.com/yandeu)\r\n * @copyright    Copyright (c) 2020 Yannick Deubel; Project Url: https://github.com/enable3d/enable3d\r\n * @license      {@link https://github.com/enable3d/enable3d/blob/master/LICENSE|GNU GPLv3}\r\n */\r\nvar __rest = (this && this.__rest) || function (s, e) {\r\n    var t = {};\r\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\r\n        t[p] = s[p];\r\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\r\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\r\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\r\n                t[p[i]] = s[p[i]];\r\n        }\r\n    return t;\r\n};\r\nimport { BoxBufferGeometry, ConeBufferGeometry, CylinderBufferGeometry, DoubleSide, ExtrudeBufferGeometry, Line, LineBasicMaterial, MeshBasicMaterial, MeshLambertMaterial, MeshNormalMaterial, MeshPhongMaterial, MeshPhysicalMaterial, MeshStandardMaterial, MeshToonMaterial, PlaneBufferGeometry, Points, PointsMaterial, SphereBufferGeometry, MathUtils as THREE_Math, TorusBufferGeometry } from 'three';\r\nimport { ExtendedMesh } from './extendedMesh';\r\nimport { logger } from './logger';\r\nimport DefaultMaterial from './defaultMaterial';\r\nexport default class Factories {\r\n    constructor(scene) {\r\n        this.scene = scene;\r\n        this.isHeadless = scene === 'headless' ? true : false;\r\n        this.defaultMaterial = new DefaultMaterial();\r\n    }\r\n    get make() {\r\n        return {\r\n            plane: (planeConfig = {}, materialConfig = {}) => this.makePlane(planeConfig, materialConfig),\r\n            box: (boxConfig = {}, materialConfig = {}) => this.makeBox(boxConfig, materialConfig),\r\n            sphere: (sphereConfig = {}, materialConfig = {}) => this.makeSphere(sphereConfig, materialConfig),\r\n            cylinder: (cylinderConfig = {}, materialConfig = {}) => this.makeCylinder(cylinderConfig, materialConfig),\r\n            cone: (coneConfig = {}, materialConfig = {}) => this.makeCone(coneConfig, materialConfig),\r\n            torus: (torusConfig = {}, materialConfig = {}) => this.makeTorus(torusConfig, materialConfig),\r\n            extrude: (extrudeConfig, materialConfig = {}) => this.makeExtrude(extrudeConfig, materialConfig)\r\n        };\r\n    }\r\n    get add() {\r\n        return {\r\n            // effectComposer: () => this.addEffectComposer(),\r\n            mesh: (mesh) => this.addMesh(mesh),\r\n            // group: (...children) => this.addGroup(children),\r\n            existing: (object) => this.addExisting(object),\r\n            //  Geometry\r\n            plane: (planeConfig = {}, materialConfig = {}) => this.addPlane(planeConfig, materialConfig),\r\n            box: (boxConfig = {}, materialConfig = {}) => this.addBox(boxConfig, materialConfig),\r\n            ground: (groundConfig, materialConfig = {}) => this.addGround(groundConfig, materialConfig),\r\n            //...\r\n            sphere: (sphereConfig = {}, materialConfig = {}) => this.addSphere(sphereConfig, materialConfig),\r\n            cylinder: (cylinderConfig = {}, materialConfig = {}) => this.addCylinder(cylinderConfig, materialConfig),\r\n            cone: (coneConfig = {}, materialConfig = {}) => this.addCone(coneConfig, materialConfig),\r\n            torus: (torusConfig = {}, materialConfig = {}) => this.addTorus(torusConfig, materialConfig),\r\n            extrude: (extrudeConfig, materialConfig = {}) => this.addExtrude(extrudeConfig, materialConfig),\r\n            //...\r\n            material: (materialConfig = {}) => this.addMaterial(materialConfig)\r\n        };\r\n    }\r\n    addExisting(...object) {\r\n        if (this.scene === 'headless')\r\n            return;\r\n        this.scene.add(...object);\r\n    }\r\n    addMesh(mesh) {\r\n        if (Array.isArray(mesh)) {\r\n            for (let i = 0; i < mesh.length; i++) {\r\n                this.addExisting(mesh[i]);\r\n            }\r\n        }\r\n        else {\r\n            this.addExisting(mesh);\r\n        }\r\n        return this;\r\n    }\r\n    createMesh(geometry, material, position) {\r\n        const { x = 0, y = 0, z = 0 } = position;\r\n        let obj;\r\n        switch (!Array.isArray(material) && material.type) {\r\n            case 'LineBasicMaterial':\r\n                obj = new Line(geometry, material);\r\n                break;\r\n            case 'PointsMaterial':\r\n                obj = new Points(geometry, material);\r\n                break;\r\n            default:\r\n                obj = new ExtendedMesh(geometry, material);\r\n                break;\r\n        }\r\n        obj.position.set(x, y, z);\r\n        obj.castShadow = obj.receiveShadow = true;\r\n        return obj;\r\n    }\r\n    makeExtrude(extrudeConfig, materialConfig) {\r\n        const { x, y, z, name, shape, autoCenter = true, breakable = false } = extrudeConfig, rest = __rest(extrudeConfig\r\n        // @ts-ignore // ExtrudeGeometryOptions interface missing since three.js r121\r\n        , [\"x\", \"y\", \"z\", \"name\", \"shape\", \"autoCenter\", \"breakable\"]);\r\n        // @ts-ignore // ExtrudeGeometryOptions interface missing since three.js r121\r\n        const { depth = 1, bevelEnabled = false } = rest;\r\n        const geometry = new ExtrudeBufferGeometry(shape, Object.assign({ depth, bevelEnabled }, rest));\r\n        const material = this.addMaterial(materialConfig);\r\n        const mesh = this.createMesh(geometry, material, { x, y, z });\r\n        // auto adjust the center for custom shapes\r\n        if (autoCenter)\r\n            mesh.geometry.center();\r\n        mesh.name = name || `body_id_${mesh.id}`;\r\n        mesh.shape = 'extrude';\r\n        return mesh;\r\n    }\r\n    addExtrude(extrudeConfig, materialConfig = {}) {\r\n        const obj = this.makeExtrude(extrudeConfig, materialConfig);\r\n        this.addExisting(obj);\r\n        return obj;\r\n    }\r\n    makePlane(planeConfig, materialConfig) {\r\n        const { x, y, z, name, breakable = false } = planeConfig, rest = __rest(planeConfig, [\"x\", \"y\", \"z\", \"name\", \"breakable\"]);\r\n        const geometry = new PlaneBufferGeometry(rest.width || 1, rest.height || 1, rest.widthSegments || 1, rest.heightSegments || 1);\r\n        const material = this.addMaterial(materialConfig);\r\n        material.side = DoubleSide;\r\n        const mesh = this.createMesh(geometry, material, { x, y, z });\r\n        mesh.name = name || `body_id_${mesh.id}`;\r\n        mesh.shape = 'plane';\r\n        return mesh;\r\n    }\r\n    addPlane(planeConfig, materialConfig) {\r\n        const obj = this.makePlane(planeConfig, materialConfig);\r\n        this.addExisting(obj);\r\n        return obj;\r\n    }\r\n    makeSphere(sphereConfig, materialConfig) {\r\n        const { x, y, z, name, breakable = false } = sphereConfig, rest = __rest(sphereConfig, [\"x\", \"y\", \"z\", \"name\", \"breakable\"]);\r\n        const geometry = new SphereBufferGeometry(rest.radius || 1, rest.widthSegments || 16, rest.heightSegments || 12, rest.phiStart || undefined, rest.phiLength || undefined, rest.thetaStart || undefined, rest.thetaLength || undefined);\r\n        const material = this.addMaterial(materialConfig);\r\n        const mesh = this.createMesh(geometry, material, { x, y, z });\r\n        mesh.name = name || `body_id_${mesh.id}`;\r\n        mesh.shape = 'sphere';\r\n        return mesh;\r\n    }\r\n    addSphere(sphereConfig = {}, materialConfig = {}) {\r\n        const obj = this.makeSphere(sphereConfig, materialConfig);\r\n        this.addExisting(obj);\r\n        return obj;\r\n    }\r\n    makeBox(boxConfig, materialConfig) {\r\n        const { x, y, z, name, breakable = false } = boxConfig, rest = __rest(boxConfig, [\"x\", \"y\", \"z\", \"name\", \"breakable\"]);\r\n        const geometry = new BoxBufferGeometry(rest.width || 1, rest.height || 1, rest.depth || 1, rest.widthSegments || undefined, rest.heightSegments || undefined, rest.depthSegments || undefined);\r\n        const material = this.addMaterial(materialConfig);\r\n        const mesh = this.createMesh(geometry, material, { x, y, z });\r\n        mesh.name = name || `body_id_${mesh.id}`;\r\n        mesh.shape = 'box';\r\n        return mesh;\r\n    }\r\n    addBox(boxConfig = {}, materialConfig = {}) {\r\n        const obj = this.makeBox(boxConfig, materialConfig);\r\n        this.addExisting(obj);\r\n        return obj;\r\n    }\r\n    addGround(groundConfig, materialConfig = {}) {\r\n        const obj = this.makeBox(groundConfig, materialConfig);\r\n        obj.rotateX(THREE_Math.degToRad(90));\r\n        this.addExisting(obj);\r\n        return obj;\r\n    }\r\n    makeCylinder(cylinderConfig = {}, materialConfig = {}) {\r\n        const { x, y, z, name, breakable = false } = cylinderConfig, rest = __rest(cylinderConfig, [\"x\", \"y\", \"z\", \"name\", \"breakable\"]);\r\n        const geometry = new CylinderBufferGeometry(rest.radiusTop || 1, rest.radiusBottom || 1, rest.height || 1, rest.radiusSegments || undefined, rest.heightSegments || undefined, rest.openEnded || undefined, rest.thetaStart || undefined, rest.thetaLength || undefined);\r\n        const material = this.addMaterial(materialConfig);\r\n        const mesh = this.createMesh(geometry, material, { x, y, z });\r\n        mesh.name = name || `body_id_${mesh.id}`;\r\n        mesh.shape = 'cylinder';\r\n        return mesh;\r\n    }\r\n    addCylinder(cylinderConfig = {}, materialConfig = {}) {\r\n        const obj = this.makeCylinder(cylinderConfig, materialConfig);\r\n        this.addExisting(obj);\r\n        return obj;\r\n    }\r\n    makeCone(coneConfig = {}, materialConfig = {}) {\r\n        const { x, y, z, name, breakable = false } = coneConfig, rest = __rest(coneConfig, [\"x\", \"y\", \"z\", \"name\", \"breakable\"]);\r\n        const geometry = new ConeBufferGeometry(rest.radius || 1, rest.height || 1, rest.radiusSegments || 8, rest.heightSegments || 1, rest.openEnded || false, rest.thetaStart || 0, rest.thetaLength || 2 * Math.PI);\r\n        const material = this.addMaterial(materialConfig);\r\n        const mesh = this.createMesh(geometry, material, { x, y, z });\r\n        mesh.name = name || `body_id_${mesh.id}`;\r\n        mesh.shape = 'cone';\r\n        return mesh;\r\n    }\r\n    addCone(coneConfig = {}, materialConfig = {}) {\r\n        const obj = this.makeCone(coneConfig, materialConfig);\r\n        this.addExisting(obj);\r\n        return obj;\r\n    }\r\n    // https://threejs.org/docs/index.html#api/en/geometries/TorusBufferGeometry\r\n    makeTorus(torusConfig = {}, materialConfig = {}) {\r\n        const { x, y, z, name, breakable = false } = torusConfig, rest = __rest(torusConfig, [\"x\", \"y\", \"z\", \"name\", \"breakable\"]);\r\n        const geometry = new TorusBufferGeometry(rest.radius || undefined, rest.tube || undefined, rest.radialSegments || undefined, rest.tubularSegments || undefined, rest.arc || undefined);\r\n        const material = this.addMaterial(materialConfig);\r\n        const mesh = this.createMesh(geometry, material, { x, y, z });\r\n        mesh.name = name || `body_id_${mesh.id}`;\r\n        mesh.shape = 'torus';\r\n        return mesh;\r\n    }\r\n    addTorus(torusConfig = {}, materialConfig = {}) {\r\n        const obj = this.makeTorus(torusConfig, materialConfig);\r\n        this.addExisting(obj);\r\n        return obj;\r\n    }\r\n    addMaterial(materialConfig = {}) {\r\n        const type = Object.keys(materialConfig)[0];\r\n        let material;\r\n        // if (type) {\r\n        //   const { map } = materialConfig[type]\r\n        //   if (typeof map === 'string') materialConfig[type].map = this.loadTexture(map)\r\n        // }\r\n        // always share the same material in headless mode to save memory\r\n        if (this.scene === 'headless')\r\n            return this.defaultMaterial.get();\r\n        switch (type) {\r\n            case 'basic':\r\n                material = new MeshBasicMaterial(materialConfig.basic);\r\n                break;\r\n            case 'normal':\r\n                material = new MeshNormalMaterial(materialConfig.normal);\r\n                break;\r\n            case 'standard':\r\n                material = new MeshStandardMaterial(materialConfig.standard);\r\n                break;\r\n            case 'lambert':\r\n                material = new MeshLambertMaterial(materialConfig.lambert);\r\n                break;\r\n            case 'phong':\r\n                material = new MeshPhongMaterial(materialConfig.phong);\r\n                break;\r\n            case 'physical':\r\n                if (typeof materialConfig.physical !== 'undefined') {\r\n                    material = new MeshPhysicalMaterial(materialConfig.physical);\r\n                }\r\n                else {\r\n                    logger('You need to pass parameters to the physical material. (Fallback to default material)');\r\n                    material = this.defaultMaterial.get();\r\n                }\r\n                break;\r\n            case 'toon':\r\n                material = new MeshToonMaterial(materialConfig.toon);\r\n                break;\r\n            case 'line':\r\n                material = new LineBasicMaterial(materialConfig.line);\r\n                break;\r\n            case 'points':\r\n                material = new PointsMaterial(materialConfig.points);\r\n                break;\r\n            case 'custom':\r\n                material = materialConfig.custom || this.defaultMaterial.get();\r\n                break;\r\n            default:\r\n                material = this.defaultMaterial.get();\r\n                break;\r\n        }\r\n        return material;\r\n    }\r\n}\r\n//# sourceMappingURL=factories.js.map","/**\r\n * @author       Yannick Deubel (https://github.com/yandeu)\r\n * @copyright    Copyright (c) 2020 Yannick Deubel; Project Url: https://github.com/enable3d/enable3d\r\n * @license      {@link https://github.com/enable3d/enable3d/blob/master/LICENSE|GNU GPLv3}\r\n */\r\n// TODO(yandeu) Make heightmap work with Buffer Geometries.\r\nimport { BufferGeometry, Color, DoubleSide, MeshPhongMaterial, PlaneBufferGeometry } from 'three';\r\nimport { ExtendedMesh } from '@enable3d/common/dist/extendedMesh';\r\nimport { Geometry } from 'three/examples/jsm/deprecated/Geometry';\r\nimport { fromGeometry } from '../csg/_fromGeometry';\r\nexport default class HeightMap {\r\n    constructor(scene) {\r\n        this.scene = scene;\r\n    }\r\n    add(texture, config = {}) {\r\n        const heightMap = this.make(texture, config);\r\n        if (heightMap)\r\n            this.scene.add(heightMap);\r\n        else\r\n            console.warn('Could not make heightmap');\r\n        return heightMap;\r\n    }\r\n    make(texture, config = {}) {\r\n        const { image } = texture;\r\n        const { width, height } = image;\r\n        const { colorScale } = config;\r\n        const canvas = document.createElement('canvas');\r\n        canvas.width = width;\r\n        canvas.height = height;\r\n        const ctx = canvas.getContext('2d');\r\n        if (!ctx)\r\n            return;\r\n        ctx.drawImage(texture.image, 0, 0);\r\n        const pixel = ctx.getImageData(0, 0, width, height);\r\n        // geometry (convert buffer geometry to deprecated geometry)\r\n        const plane = new Geometry().fromBufferGeometry(new PlaneBufferGeometry(10, 10, width - 1, height - 1));\r\n        // material\r\n        let materialConfig = { color: 0xcccccc, side: DoubleSide };\r\n        if (colorScale)\r\n            materialConfig = Object.assign(Object.assign({}, materialConfig), { vertexColors: true });\r\n        const material = new MeshPhongMaterial(materialConfig);\r\n        // mesh\r\n        const mesh = new ExtendedMesh(plane, material);\r\n        mesh.receiveShadow = mesh.castShadow = true;\r\n        mesh.shape = 'concave';\r\n        // adjust all z values\r\n        const geo = mesh.geometry;\r\n        for (let i = 0; i < geo.vertices.length; i++) {\r\n            geo.vertices[i].z = pixel.data[i * 4] / 120;\r\n        }\r\n        // helper function to get the highest point\r\n        const getHighPoint = (geometry, face) => {\r\n            var v1 = geometry.vertices[face.a].z;\r\n            var v2 = geometry.vertices[face.b].z;\r\n            var v3 = geometry.vertices[face.c].z;\r\n            return Math.max(v1, v2, v3);\r\n        };\r\n        // apply color scale if available\r\n        if (colorScale)\r\n            geo.faces.forEach(face => (face.color = new Color(colorScale(getHighPoint(geo, face)).hex())));\r\n        mesh.rotateX(-Math.PI / 2);\r\n        mesh.updateMatrix();\r\n        plane.computeFaceNormals();\r\n        plane.computeVertexNormals();\r\n        mesh.name = 'heightmap';\r\n        // back to buffer geometry\r\n        mesh.geometry = fromGeometry(new BufferGeometry(), mesh.geometry);\r\n        return mesh;\r\n    }\r\n}\r\n//# sourceMappingURL=heightmap.js.map","import {\n\tEventDispatcher,\n\tMOUSE,\n\tQuaternion,\n\tSpherical,\n\tTOUCH,\n\tVector2,\n\tVector3\n} from 'three';\n\n// This set of controls performs orbiting, dollying (zooming), and panning.\n// Unlike TrackballControls, it maintains the \"up\" direction object.up (+Y by default).\n//\n//    Orbit - left mouse / touch: one-finger move\n//    Zoom - middle mouse, or mousewheel / touch: two-finger spread or squish\n//    Pan - right mouse, or left mouse + ctrl/meta/shiftKey, or arrow keys / touch: two-finger move\n\nconst _changeEvent = { type: 'change' };\nconst _startEvent = { type: 'start' };\nconst _endEvent = { type: 'end' };\n\nclass OrbitControls extends EventDispatcher {\n\n\tconstructor( object, domElement ) {\n\n\t\tsuper();\n\n\t\tif ( domElement === undefined ) console.warn( 'THREE.OrbitControls: The second parameter \"domElement\" is now mandatory.' );\n\t\tif ( domElement === document ) console.error( 'THREE.OrbitControls: \"document\" should not be used as the target \"domElement\". Please use \"renderer.domElement\" instead.' );\n\n\t\tthis.object = object;\n\t\tthis.domElement = domElement;\n\t\tthis.domElement.style.touchAction = 'none'; // disable touch scroll\n\n\t\t// Set to false to disable this control\n\t\tthis.enabled = true;\n\n\t\t// \"target\" sets the location of focus, where the object orbits around\n\t\tthis.target = new Vector3();\n\n\t\t// How far you can dolly in and out ( PerspectiveCamera only )\n\t\tthis.minDistance = 0;\n\t\tthis.maxDistance = Infinity;\n\n\t\t// How far you can zoom in and out ( OrthographicCamera only )\n\t\tthis.minZoom = 0;\n\t\tthis.maxZoom = Infinity;\n\n\t\t// How far you can orbit vertically, upper and lower limits.\n\t\t// Range is 0 to Math.PI radians.\n\t\tthis.minPolarAngle = 0; // radians\n\t\tthis.maxPolarAngle = Math.PI; // radians\n\n\t\t// How far you can orbit horizontally, upper and lower limits.\n\t\t// If set, the interval [ min, max ] must be a sub-interval of [ - 2 PI, 2 PI ], with ( max - min < 2 PI )\n\t\tthis.minAzimuthAngle = - Infinity; // radians\n\t\tthis.maxAzimuthAngle = Infinity; // radians\n\n\t\t// Set to true to enable damping (inertia)\n\t\t// If damping is enabled, you must call controls.update() in your animation loop\n\t\tthis.enableDamping = false;\n\t\tthis.dampingFactor = 0.05;\n\n\t\t// This option actually enables dollying in and out; left as \"zoom\" for backwards compatibility.\n\t\t// Set to false to disable zooming\n\t\tthis.enableZoom = true;\n\t\tthis.zoomSpeed = 1.0;\n\n\t\t// Set to false to disable rotating\n\t\tthis.enableRotate = true;\n\t\tthis.rotateSpeed = 1.0;\n\n\t\t// Set to false to disable panning\n\t\tthis.enablePan = true;\n\t\tthis.panSpeed = 1.0;\n\t\tthis.screenSpacePanning = true; // if false, pan orthogonal to world-space direction camera.up\n\t\tthis.keyPanSpeed = 7.0;\t// pixels moved per arrow key push\n\n\t\t// Set to true to automatically rotate around the target\n\t\t// If auto-rotate is enabled, you must call controls.update() in your animation loop\n\t\tthis.autoRotate = false;\n\t\tthis.autoRotateSpeed = 2.0; // 30 seconds per orbit when fps is 60\n\n\t\t// The four arrow keys\n\t\tthis.keys = { LEFT: 'ArrowLeft', UP: 'ArrowUp', RIGHT: 'ArrowRight', BOTTOM: 'ArrowDown' };\n\n\t\t// Mouse buttons\n\t\tthis.mouseButtons = { LEFT: MOUSE.ROTATE, MIDDLE: MOUSE.DOLLY, RIGHT: MOUSE.PAN };\n\n\t\t// Touch fingers\n\t\tthis.touches = { ONE: TOUCH.ROTATE, TWO: TOUCH.DOLLY_PAN };\n\n\t\t// for reset\n\t\tthis.target0 = this.target.clone();\n\t\tthis.position0 = this.object.position.clone();\n\t\tthis.zoom0 = this.object.zoom;\n\n\t\t// the target DOM element for key events\n\t\tthis._domElementKeyEvents = null;\n\n\t\t//\n\t\t// public methods\n\t\t//\n\n\t\tthis.getPolarAngle = function () {\n\n\t\t\treturn spherical.phi;\n\n\t\t};\n\n\t\tthis.getAzimuthalAngle = function () {\n\n\t\t\treturn spherical.theta;\n\n\t\t};\n\n\t\tthis.listenToKeyEvents = function ( domElement ) {\n\n\t\t\tdomElement.addEventListener( 'keydown', onKeyDown );\n\t\t\tthis._domElementKeyEvents = domElement;\n\n\t\t};\n\n\t\tthis.saveState = function () {\n\n\t\t\tscope.target0.copy( scope.target );\n\t\t\tscope.position0.copy( scope.object.position );\n\t\t\tscope.zoom0 = scope.object.zoom;\n\n\t\t};\n\n\t\tthis.reset = function () {\n\n\t\t\tscope.target.copy( scope.target0 );\n\t\t\tscope.object.position.copy( scope.position0 );\n\t\t\tscope.object.zoom = scope.zoom0;\n\n\t\t\tscope.object.updateProjectionMatrix();\n\t\t\tscope.dispatchEvent( _changeEvent );\n\n\t\t\tscope.update();\n\n\t\t\tstate = STATE.NONE;\n\n\t\t};\n\n\t\t// this method is exposed, but perhaps it would be better if we can make it private...\n\t\tthis.update = function () {\n\n\t\t\tconst offset = new Vector3();\n\n\t\t\t// so camera.up is the orbit axis\n\t\t\tconst quat = new Quaternion().setFromUnitVectors( object.up, new Vector3( 0, 1, 0 ) );\n\t\t\tconst quatInverse = quat.clone().invert();\n\n\t\t\tconst lastPosition = new Vector3();\n\t\t\tconst lastQuaternion = new Quaternion();\n\n\t\t\tconst twoPI = 2 * Math.PI;\n\n\t\t\treturn function update() {\n\n\t\t\t\tconst position = scope.object.position;\n\n\t\t\t\toffset.copy( position ).sub( scope.target );\n\n\t\t\t\t// rotate offset to \"y-axis-is-up\" space\n\t\t\t\toffset.applyQuaternion( quat );\n\n\t\t\t\t// angle from z-axis around y-axis\n\t\t\t\tspherical.setFromVector3( offset );\n\n\t\t\t\tif ( scope.autoRotate && state === STATE.NONE ) {\n\n\t\t\t\t\trotateLeft( getAutoRotationAngle() );\n\n\t\t\t\t}\n\n\t\t\t\tif ( scope.enableDamping ) {\n\n\t\t\t\t\tspherical.theta += sphericalDelta.theta * scope.dampingFactor;\n\t\t\t\t\tspherical.phi += sphericalDelta.phi * scope.dampingFactor;\n\n\t\t\t\t} else {\n\n\t\t\t\t\tspherical.theta += sphericalDelta.theta;\n\t\t\t\t\tspherical.phi += sphericalDelta.phi;\n\n\t\t\t\t}\n\n\t\t\t\t// restrict theta to be between desired limits\n\n\t\t\t\tlet min = scope.minAzimuthAngle;\n\t\t\t\tlet max = scope.maxAzimuthAngle;\n\n\t\t\t\tif ( isFinite( min ) && isFinite( max ) ) {\n\n\t\t\t\t\tif ( min < - Math.PI ) min += twoPI; else if ( min > Math.PI ) min -= twoPI;\n\n\t\t\t\t\tif ( max < - Math.PI ) max += twoPI; else if ( max > Math.PI ) max -= twoPI;\n\n\t\t\t\t\tif ( min <= max ) {\n\n\t\t\t\t\t\tspherical.theta = Math.max( min, Math.min( max, spherical.theta ) );\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\tspherical.theta = ( spherical.theta > ( min + max ) / 2 ) ?\n\t\t\t\t\t\t\tMath.max( min, spherical.theta ) :\n\t\t\t\t\t\t\tMath.min( max, spherical.theta );\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\t// restrict phi to be between desired limits\n\t\t\t\tspherical.phi = Math.max( scope.minPolarAngle, Math.min( scope.maxPolarAngle, spherical.phi ) );\n\n\t\t\t\tspherical.makeSafe();\n\n\n\t\t\t\tspherical.radius *= scale;\n\n\t\t\t\t// restrict radius to be between desired limits\n\t\t\t\tspherical.radius = Math.max( scope.minDistance, Math.min( scope.maxDistance, spherical.radius ) );\n\n\t\t\t\t// move target to panned location\n\n\t\t\t\tif ( scope.enableDamping === true ) {\n\n\t\t\t\t\tscope.target.addScaledVector( panOffset, scope.dampingFactor );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tscope.target.add( panOffset );\n\n\t\t\t\t}\n\n\t\t\t\toffset.setFromSpherical( spherical );\n\n\t\t\t\t// rotate offset back to \"camera-up-vector-is-up\" space\n\t\t\t\toffset.applyQuaternion( quatInverse );\n\n\t\t\t\tposition.copy( scope.target ).add( offset );\n\n\t\t\t\tscope.object.lookAt( scope.target );\n\n\t\t\t\tif ( scope.enableDamping === true ) {\n\n\t\t\t\t\tsphericalDelta.theta *= ( 1 - scope.dampingFactor );\n\t\t\t\t\tsphericalDelta.phi *= ( 1 - scope.dampingFactor );\n\n\t\t\t\t\tpanOffset.multiplyScalar( 1 - scope.dampingFactor );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tsphericalDelta.set( 0, 0, 0 );\n\n\t\t\t\t\tpanOffset.set( 0, 0, 0 );\n\n\t\t\t\t}\n\n\t\t\t\tscale = 1;\n\n\t\t\t\t// update condition is:\n\t\t\t\t// min(camera displacement, camera rotation in radians)^2 > EPS\n\t\t\t\t// using small-angle approximation cos(x/2) = 1 - x^2 / 8\n\n\t\t\t\tif ( zoomChanged ||\n\t\t\t\t\tlastPosition.distanceToSquared( scope.object.position ) > EPS ||\n\t\t\t\t\t8 * ( 1 - lastQuaternion.dot( scope.object.quaternion ) ) > EPS ) {\n\n\t\t\t\t\tscope.dispatchEvent( _changeEvent );\n\n\t\t\t\t\tlastPosition.copy( scope.object.position );\n\t\t\t\t\tlastQuaternion.copy( scope.object.quaternion );\n\t\t\t\t\tzoomChanged = false;\n\n\t\t\t\t\treturn true;\n\n\t\t\t\t}\n\n\t\t\t\treturn false;\n\n\t\t\t};\n\n\t\t}();\n\n\t\tthis.dispose = function () {\n\n\t\t\tscope.domElement.removeEventListener( 'contextmenu', onContextMenu );\n\n\t\t\tscope.domElement.removeEventListener( 'pointerdown', onPointerDown );\n\t\t\tscope.domElement.removeEventListener( 'pointercancel', onPointerCancel );\n\t\t\tscope.domElement.removeEventListener( 'wheel', onMouseWheel );\n\n\t\t\tscope.domElement.ownerDocument.removeEventListener( 'pointermove', onPointerMove );\n\t\t\tscope.domElement.ownerDocument.removeEventListener( 'pointerup', onPointerUp );\n\n\n\t\t\tif ( scope._domElementKeyEvents !== null ) {\n\n\t\t\t\tscope._domElementKeyEvents.removeEventListener( 'keydown', onKeyDown );\n\n\t\t\t}\n\n\t\t\t//scope.dispatchEvent( { type: 'dispose' } ); // should this be added here?\n\n\t\t};\n\n\t\t//\n\t\t// internals\n\t\t//\n\n\t\tconst scope = this;\n\n\t\tconst STATE = {\n\t\t\tNONE: - 1,\n\t\t\tROTATE: 0,\n\t\t\tDOLLY: 1,\n\t\t\tPAN: 2,\n\t\t\tTOUCH_ROTATE: 3,\n\t\t\tTOUCH_PAN: 4,\n\t\t\tTOUCH_DOLLY_PAN: 5,\n\t\t\tTOUCH_DOLLY_ROTATE: 6\n\t\t};\n\n\t\tlet state = STATE.NONE;\n\n\t\tconst EPS = 0.000001;\n\n\t\t// current position in spherical coordinates\n\t\tconst spherical = new Spherical();\n\t\tconst sphericalDelta = new Spherical();\n\n\t\tlet scale = 1;\n\t\tconst panOffset = new Vector3();\n\t\tlet zoomChanged = false;\n\n\t\tconst rotateStart = new Vector2();\n\t\tconst rotateEnd = new Vector2();\n\t\tconst rotateDelta = new Vector2();\n\n\t\tconst panStart = new Vector2();\n\t\tconst panEnd = new Vector2();\n\t\tconst panDelta = new Vector2();\n\n\t\tconst dollyStart = new Vector2();\n\t\tconst dollyEnd = new Vector2();\n\t\tconst dollyDelta = new Vector2();\n\n\t\tconst pointers = [];\n\t\tconst pointerPositions = {};\n\n\t\tfunction getAutoRotationAngle() {\n\n\t\t\treturn 2 * Math.PI / 60 / 60 * scope.autoRotateSpeed;\n\n\t\t}\n\n\t\tfunction getZoomScale() {\n\n\t\t\treturn Math.pow( 0.95, scope.zoomSpeed );\n\n\t\t}\n\n\t\tfunction rotateLeft( angle ) {\n\n\t\t\tsphericalDelta.theta -= angle;\n\n\t\t}\n\n\t\tfunction rotateUp( angle ) {\n\n\t\t\tsphericalDelta.phi -= angle;\n\n\t\t}\n\n\t\tconst panLeft = function () {\n\n\t\t\tconst v = new Vector3();\n\n\t\t\treturn function panLeft( distance, objectMatrix ) {\n\n\t\t\t\tv.setFromMatrixColumn( objectMatrix, 0 ); // get X column of objectMatrix\n\t\t\t\tv.multiplyScalar( - distance );\n\n\t\t\t\tpanOffset.add( v );\n\n\t\t\t};\n\n\t\t}();\n\n\t\tconst panUp = function () {\n\n\t\t\tconst v = new Vector3();\n\n\t\t\treturn function panUp( distance, objectMatrix ) {\n\n\t\t\t\tif ( scope.screenSpacePanning === true ) {\n\n\t\t\t\t\tv.setFromMatrixColumn( objectMatrix, 1 );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tv.setFromMatrixColumn( objectMatrix, 0 );\n\t\t\t\t\tv.crossVectors( scope.object.up, v );\n\n\t\t\t\t}\n\n\t\t\t\tv.multiplyScalar( distance );\n\n\t\t\t\tpanOffset.add( v );\n\n\t\t\t};\n\n\t\t}();\n\n\t\t// deltaX and deltaY are in pixels; right and down are positive\n\t\tconst pan = function () {\n\n\t\t\tconst offset = new Vector3();\n\n\t\t\treturn function pan( deltaX, deltaY ) {\n\n\t\t\t\tconst element = scope.domElement;\n\n\t\t\t\tif ( scope.object.isPerspectiveCamera ) {\n\n\t\t\t\t\t// perspective\n\t\t\t\t\tconst position = scope.object.position;\n\t\t\t\t\toffset.copy( position ).sub( scope.target );\n\t\t\t\t\tlet targetDistance = offset.length();\n\n\t\t\t\t\t// half of the fov is center to top of screen\n\t\t\t\t\ttargetDistance *= Math.tan( ( scope.object.fov / 2 ) * Math.PI / 180.0 );\n\n\t\t\t\t\t// we use only clientHeight here so aspect ratio does not distort speed\n\t\t\t\t\tpanLeft( 2 * deltaX * targetDistance / element.clientHeight, scope.object.matrix );\n\t\t\t\t\tpanUp( 2 * deltaY * targetDistance / element.clientHeight, scope.object.matrix );\n\n\t\t\t\t} else if ( scope.object.isOrthographicCamera ) {\n\n\t\t\t\t\t// orthographic\n\t\t\t\t\tpanLeft( deltaX * ( scope.object.right - scope.object.left ) / scope.object.zoom / element.clientWidth, scope.object.matrix );\n\t\t\t\t\tpanUp( deltaY * ( scope.object.top - scope.object.bottom ) / scope.object.zoom / element.clientHeight, scope.object.matrix );\n\n\t\t\t\t} else {\n\n\t\t\t\t\t// camera neither orthographic nor perspective\n\t\t\t\t\tconsole.warn( 'WARNING: OrbitControls.js encountered an unknown camera type - pan disabled.' );\n\t\t\t\t\tscope.enablePan = false;\n\n\t\t\t\t}\n\n\t\t\t};\n\n\t\t}();\n\n\t\tfunction dollyOut( dollyScale ) {\n\n\t\t\tif ( scope.object.isPerspectiveCamera ) {\n\n\t\t\t\tscale /= dollyScale;\n\n\t\t\t} else if ( scope.object.isOrthographicCamera ) {\n\n\t\t\t\tscope.object.zoom = Math.max( scope.minZoom, Math.min( scope.maxZoom, scope.object.zoom * dollyScale ) );\n\t\t\t\tscope.object.updateProjectionMatrix();\n\t\t\t\tzoomChanged = true;\n\n\t\t\t} else {\n\n\t\t\t\tconsole.warn( 'WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled.' );\n\t\t\t\tscope.enableZoom = false;\n\n\t\t\t}\n\n\t\t}\n\n\t\tfunction dollyIn( dollyScale ) {\n\n\t\t\tif ( scope.object.isPerspectiveCamera ) {\n\n\t\t\t\tscale *= dollyScale;\n\n\t\t\t} else if ( scope.object.isOrthographicCamera ) {\n\n\t\t\t\tscope.object.zoom = Math.max( scope.minZoom, Math.min( scope.maxZoom, scope.object.zoom / dollyScale ) );\n\t\t\t\tscope.object.updateProjectionMatrix();\n\t\t\t\tzoomChanged = true;\n\n\t\t\t} else {\n\n\t\t\t\tconsole.warn( 'WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled.' );\n\t\t\t\tscope.enableZoom = false;\n\n\t\t\t}\n\n\t\t}\n\n\t\t//\n\t\t// event callbacks - update the object state\n\t\t//\n\n\t\tfunction handleMouseDownRotate( event ) {\n\n\t\t\trotateStart.set( event.clientX, event.clientY );\n\n\t\t}\n\n\t\tfunction handleMouseDownDolly( event ) {\n\n\t\t\tdollyStart.set( event.clientX, event.clientY );\n\n\t\t}\n\n\t\tfunction handleMouseDownPan( event ) {\n\n\t\t\tpanStart.set( event.clientX, event.clientY );\n\n\t\t}\n\n\t\tfunction handleMouseMoveRotate( event ) {\n\n\t\t\trotateEnd.set( event.clientX, event.clientY );\n\n\t\t\trotateDelta.subVectors( rotateEnd, rotateStart ).multiplyScalar( scope.rotateSpeed );\n\n\t\t\tconst element = scope.domElement;\n\n\t\t\trotateLeft( 2 * Math.PI * rotateDelta.x / element.clientHeight ); // yes, height\n\n\t\t\trotateUp( 2 * Math.PI * rotateDelta.y / element.clientHeight );\n\n\t\t\trotateStart.copy( rotateEnd );\n\n\t\t\tscope.update();\n\n\t\t}\n\n\t\tfunction handleMouseMoveDolly( event ) {\n\n\t\t\tdollyEnd.set( event.clientX, event.clientY );\n\n\t\t\tdollyDelta.subVectors( dollyEnd, dollyStart );\n\n\t\t\tif ( dollyDelta.y > 0 ) {\n\n\t\t\t\tdollyOut( getZoomScale() );\n\n\t\t\t} else if ( dollyDelta.y < 0 ) {\n\n\t\t\t\tdollyIn( getZoomScale() );\n\n\t\t\t}\n\n\t\t\tdollyStart.copy( dollyEnd );\n\n\t\t\tscope.update();\n\n\t\t}\n\n\t\tfunction handleMouseMovePan( event ) {\n\n\t\t\tpanEnd.set( event.clientX, event.clientY );\n\n\t\t\tpanDelta.subVectors( panEnd, panStart ).multiplyScalar( scope.panSpeed );\n\n\t\t\tpan( panDelta.x, panDelta.y );\n\n\t\t\tpanStart.copy( panEnd );\n\n\t\t\tscope.update();\n\n\t\t}\n\n\t\tfunction handleMouseUp( /*event*/ ) {\n\n\t\t\t// no-op\n\n\t\t}\n\n\t\tfunction handleMouseWheel( event ) {\n\n\t\t\tif ( event.deltaY < 0 ) {\n\n\t\t\t\tdollyIn( getZoomScale() );\n\n\t\t\t} else if ( event.deltaY > 0 ) {\n\n\t\t\t\tdollyOut( getZoomScale() );\n\n\t\t\t}\n\n\t\t\tscope.update();\n\n\t\t}\n\n\t\tfunction handleKeyDown( event ) {\n\n\t\t\tlet needsUpdate = false;\n\n\t\t\tswitch ( event.code ) {\n\n\t\t\t\tcase scope.keys.UP:\n\t\t\t\t\tpan( 0, scope.keyPanSpeed );\n\t\t\t\t\tneedsUpdate = true;\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase scope.keys.BOTTOM:\n\t\t\t\t\tpan( 0, - scope.keyPanSpeed );\n\t\t\t\t\tneedsUpdate = true;\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase scope.keys.LEFT:\n\t\t\t\t\tpan( scope.keyPanSpeed, 0 );\n\t\t\t\t\tneedsUpdate = true;\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase scope.keys.RIGHT:\n\t\t\t\t\tpan( - scope.keyPanSpeed, 0 );\n\t\t\t\t\tneedsUpdate = true;\n\t\t\t\t\tbreak;\n\n\t\t\t}\n\n\t\t\tif ( needsUpdate ) {\n\n\t\t\t\t// prevent the browser from scrolling on cursor keys\n\t\t\t\tevent.preventDefault();\n\n\t\t\t\tscope.update();\n\n\t\t\t}\n\n\n\t\t}\n\n\t\tfunction handleTouchStartRotate() {\n\n\t\t\tif ( pointers.length === 1 ) {\n\n\t\t\t\trotateStart.set( pointers[ 0 ].pageX, pointers[ 0 ].pageY );\n\n\t\t\t} else {\n\n\t\t\t\tconst x = 0.5 * ( pointers[ 0 ].pageX + pointers[ 1 ].pageX );\n\t\t\t\tconst y = 0.5 * ( pointers[ 0 ].pageY + pointers[ 1 ].pageY );\n\n\t\t\t\trotateStart.set( x, y );\n\n\t\t\t}\n\n\t\t}\n\n\t\tfunction handleTouchStartPan() {\n\n\t\t\tif ( pointers.length === 1 ) {\n\n\t\t\t\tpanStart.set( pointers[ 0 ].pageX, pointers[ 0 ].pageY );\n\n\t\t\t} else {\n\n\t\t\t\tconst x = 0.5 * ( pointers[ 0 ].pageX + pointers[ 1 ].pageX );\n\t\t\t\tconst y = 0.5 * ( pointers[ 0 ].pageY + pointers[ 1 ].pageY );\n\n\t\t\t\tpanStart.set( x, y );\n\n\t\t\t}\n\n\t\t}\n\n\t\tfunction handleTouchStartDolly() {\n\n\t\t\tconst dx = pointers[ 0 ].pageX - pointers[ 1 ].pageX;\n\t\t\tconst dy = pointers[ 0 ].pageY - pointers[ 1 ].pageY;\n\n\t\t\tconst distance = Math.sqrt( dx * dx + dy * dy );\n\n\t\t\tdollyStart.set( 0, distance );\n\n\t\t}\n\n\t\tfunction handleTouchStartDollyPan() {\n\n\t\t\tif ( scope.enableZoom ) handleTouchStartDolly();\n\n\t\t\tif ( scope.enablePan ) handleTouchStartPan();\n\n\t\t}\n\n\t\tfunction handleTouchStartDollyRotate() {\n\n\t\t\tif ( scope.enableZoom ) handleTouchStartDolly();\n\n\t\t\tif ( scope.enableRotate ) handleTouchStartRotate();\n\n\t\t}\n\n\t\tfunction handleTouchMoveRotate( event ) {\n\n\t\t\tif ( pointers.length == 1 ) {\n\n\t\t\t\trotateEnd.set( event.pageX, event.pageY );\n\n\t\t\t} else {\n\n\t\t\t\tconst position = getSecondPointerPosition( event );\n\n\t\t\t\tconst x = 0.5 * ( event.pageX + position.x );\n\t\t\t\tconst y = 0.5 * ( event.pageY + position.y );\n\n\t\t\t\trotateEnd.set( x, y );\n\n\t\t\t}\n\n\t\t\trotateDelta.subVectors( rotateEnd, rotateStart ).multiplyScalar( scope.rotateSpeed );\n\n\t\t\tconst element = scope.domElement;\n\n\t\t\trotateLeft( 2 * Math.PI * rotateDelta.x / element.clientHeight ); // yes, height\n\n\t\t\trotateUp( 2 * Math.PI * rotateDelta.y / element.clientHeight );\n\n\t\t\trotateStart.copy( rotateEnd );\n\n\t\t}\n\n\t\tfunction handleTouchMovePan( event ) {\n\n\t\t\tif ( pointers.length === 1 ) {\n\n\t\t\t\tpanEnd.set( event.pageX, event.pageY );\n\n\t\t\t} else {\n\n\t\t\t\tconst position = getSecondPointerPosition( event );\n\n\t\t\t\tconst x = 0.5 * ( event.pageX + position.x );\n\t\t\t\tconst y = 0.5 * ( event.pageY + position.y );\n\n\t\t\t\tpanEnd.set( x, y );\n\n\t\t\t}\n\n\t\t\tpanDelta.subVectors( panEnd, panStart ).multiplyScalar( scope.panSpeed );\n\n\t\t\tpan( panDelta.x, panDelta.y );\n\n\t\t\tpanStart.copy( panEnd );\n\n\t\t}\n\n\t\tfunction handleTouchMoveDolly( event ) {\n\n\t\t\tconst position = getSecondPointerPosition( event );\n\n\t\t\tconst dx = event.pageX - position.x;\n\t\t\tconst dy = event.pageY - position.y;\n\n\t\t\tconst distance = Math.sqrt( dx * dx + dy * dy );\n\n\t\t\tdollyEnd.set( 0, distance );\n\n\t\t\tdollyDelta.set( 0, Math.pow( dollyEnd.y / dollyStart.y, scope.zoomSpeed ) );\n\n\t\t\tdollyOut( dollyDelta.y );\n\n\t\t\tdollyStart.copy( dollyEnd );\n\n\t\t}\n\n\t\tfunction handleTouchMoveDollyPan( event ) {\n\n\t\t\tif ( scope.enableZoom ) handleTouchMoveDolly( event );\n\n\t\t\tif ( scope.enablePan ) handleTouchMovePan( event );\n\n\t\t}\n\n\t\tfunction handleTouchMoveDollyRotate( event ) {\n\n\t\t\tif ( scope.enableZoom ) handleTouchMoveDolly( event );\n\n\t\t\tif ( scope.enableRotate ) handleTouchMoveRotate( event );\n\n\t\t}\n\n\t\tfunction handleTouchEnd( /*event*/ ) {\n\n\t\t\t// no-op\n\n\t\t}\n\n\t\t//\n\t\t// event handlers - FSM: listen for events and reset state\n\t\t//\n\n\t\tfunction onPointerDown( event ) {\n\n\t\t\tif ( scope.enabled === false ) return;\n\n\t\t\tif ( pointers.length === 0 ) {\n\n\t\t\t\tscope.domElement.ownerDocument.addEventListener( 'pointermove', onPointerMove );\n\t\t\t\tscope.domElement.ownerDocument.addEventListener( 'pointerup', onPointerUp );\n\n\t\t\t}\n\n\t\t\t//\n\n\t\t\taddPointer( event );\n\n\t\t\tif ( event.pointerType === 'touch' ) {\n\n\t\t\t\tonTouchStart( event );\n\n\t\t\t} else {\n\n\t\t\t\tonMouseDown( event );\n\n\t\t\t}\n\n\t\t}\n\n\t\tfunction onPointerMove( event ) {\n\n\t\t\tif ( scope.enabled === false ) return;\n\n\t\t\tif ( event.pointerType === 'touch' ) {\n\n\t\t\t\tonTouchMove( event );\n\n\t\t\t} else {\n\n\t\t\t\tonMouseMove( event );\n\n\t\t\t}\n\n\t\t}\n\n\t\tfunction onPointerUp( event ) {\n\n\t\t\tif ( scope.enabled === false ) return;\n\n\t\t\tif ( event.pointerType === 'touch' ) {\n\n\t\t\t\tonTouchEnd();\n\n\t\t\t} else {\n\n\t\t\t\tonMouseUp( event );\n\n\t\t\t}\n\n\t\t\tremovePointer( event );\n\n\t\t\t//\n\n\t\t\tif ( pointers.length === 0 ) {\n\n\t\t\t\tscope.domElement.ownerDocument.removeEventListener( 'pointermove', onPointerMove );\n\t\t\t\tscope.domElement.ownerDocument.removeEventListener( 'pointerup', onPointerUp );\n\n\t\t\t}\n\n\t\t}\n\n\t\tfunction onPointerCancel( event ) {\n\n\t\t\tremovePointer( event );\n\n\t\t}\n\n\t\tfunction onMouseDown( event ) {\n\n\t\t\tlet mouseAction;\n\n\t\t\tswitch ( event.button ) {\n\n\t\t\t\tcase 0:\n\n\t\t\t\t\tmouseAction = scope.mouseButtons.LEFT;\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 1:\n\n\t\t\t\t\tmouseAction = scope.mouseButtons.MIDDLE;\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 2:\n\n\t\t\t\t\tmouseAction = scope.mouseButtons.RIGHT;\n\t\t\t\t\tbreak;\n\n\t\t\t\tdefault:\n\n\t\t\t\t\tmouseAction = - 1;\n\n\t\t\t}\n\n\t\t\tswitch ( mouseAction ) {\n\n\t\t\t\tcase MOUSE.DOLLY:\n\n\t\t\t\t\tif ( scope.enableZoom === false ) return;\n\n\t\t\t\t\thandleMouseDownDolly( event );\n\n\t\t\t\t\tstate = STATE.DOLLY;\n\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase MOUSE.ROTATE:\n\n\t\t\t\t\tif ( event.ctrlKey || event.metaKey || event.shiftKey ) {\n\n\t\t\t\t\t\tif ( scope.enablePan === false ) return;\n\n\t\t\t\t\t\thandleMouseDownPan( event );\n\n\t\t\t\t\t\tstate = STATE.PAN;\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\tif ( scope.enableRotate === false ) return;\n\n\t\t\t\t\t\thandleMouseDownRotate( event );\n\n\t\t\t\t\t\tstate = STATE.ROTATE;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase MOUSE.PAN:\n\n\t\t\t\t\tif ( event.ctrlKey || event.metaKey || event.shiftKey ) {\n\n\t\t\t\t\t\tif ( scope.enableRotate === false ) return;\n\n\t\t\t\t\t\thandleMouseDownRotate( event );\n\n\t\t\t\t\t\tstate = STATE.ROTATE;\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\tif ( scope.enablePan === false ) return;\n\n\t\t\t\t\t\thandleMouseDownPan( event );\n\n\t\t\t\t\t\tstate = STATE.PAN;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tbreak;\n\n\t\t\t\tdefault:\n\n\t\t\t\t\tstate = STATE.NONE;\n\n\t\t\t}\n\n\t\t\tif ( state !== STATE.NONE ) {\n\n\t\t\t\tscope.dispatchEvent( _startEvent );\n\n\t\t\t}\n\n\t\t}\n\n\t\tfunction onMouseMove( event ) {\n\n\t\t\tif ( scope.enabled === false ) return;\n\n\t\t\tswitch ( state ) {\n\n\t\t\t\tcase STATE.ROTATE:\n\n\t\t\t\t\tif ( scope.enableRotate === false ) return;\n\n\t\t\t\t\thandleMouseMoveRotate( event );\n\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase STATE.DOLLY:\n\n\t\t\t\t\tif ( scope.enableZoom === false ) return;\n\n\t\t\t\t\thandleMouseMoveDolly( event );\n\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase STATE.PAN:\n\n\t\t\t\t\tif ( scope.enablePan === false ) return;\n\n\t\t\t\t\thandleMouseMovePan( event );\n\n\t\t\t\t\tbreak;\n\n\t\t\t}\n\n\t\t}\n\n\t\tfunction onMouseUp( event ) {\n\n\t\t\thandleMouseUp( event );\n\n\t\t\tscope.dispatchEvent( _endEvent );\n\n\t\t\tstate = STATE.NONE;\n\n\t\t}\n\n\t\tfunction onMouseWheel( event ) {\n\n\t\t\tif ( scope.enabled === false || scope.enableZoom === false || ( state !== STATE.NONE && state !== STATE.ROTATE ) ) return;\n\n\t\t\tevent.preventDefault();\n\n\t\t\tscope.dispatchEvent( _startEvent );\n\n\t\t\thandleMouseWheel( event );\n\n\t\t\tscope.dispatchEvent( _endEvent );\n\n\t\t}\n\n\t\tfunction onKeyDown( event ) {\n\n\t\t\tif ( scope.enabled === false || scope.enablePan === false ) return;\n\n\t\t\thandleKeyDown( event );\n\n\t\t}\n\n\t\tfunction onTouchStart( event ) {\n\n\t\t\ttrackPointer( event );\n\n\t\t\tswitch ( pointers.length ) {\n\n\t\t\t\tcase 1:\n\n\t\t\t\t\tswitch ( scope.touches.ONE ) {\n\n\t\t\t\t\t\tcase TOUCH.ROTATE:\n\n\t\t\t\t\t\t\tif ( scope.enableRotate === false ) return;\n\n\t\t\t\t\t\t\thandleTouchStartRotate();\n\n\t\t\t\t\t\t\tstate = STATE.TOUCH_ROTATE;\n\n\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\tcase TOUCH.PAN:\n\n\t\t\t\t\t\t\tif ( scope.enablePan === false ) return;\n\n\t\t\t\t\t\t\thandleTouchStartPan();\n\n\t\t\t\t\t\t\tstate = STATE.TOUCH_PAN;\n\n\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\tdefault:\n\n\t\t\t\t\t\t\tstate = STATE.NONE;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 2:\n\n\t\t\t\t\tswitch ( scope.touches.TWO ) {\n\n\t\t\t\t\t\tcase TOUCH.DOLLY_PAN:\n\n\t\t\t\t\t\t\tif ( scope.enableZoom === false && scope.enablePan === false ) return;\n\n\t\t\t\t\t\t\thandleTouchStartDollyPan();\n\n\t\t\t\t\t\t\tstate = STATE.TOUCH_DOLLY_PAN;\n\n\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\tcase TOUCH.DOLLY_ROTATE:\n\n\t\t\t\t\t\t\tif ( scope.enableZoom === false && scope.enableRotate === false ) return;\n\n\t\t\t\t\t\t\thandleTouchStartDollyRotate();\n\n\t\t\t\t\t\t\tstate = STATE.TOUCH_DOLLY_ROTATE;\n\n\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\tdefault:\n\n\t\t\t\t\t\t\tstate = STATE.NONE;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tbreak;\n\n\t\t\t\tdefault:\n\n\t\t\t\t\tstate = STATE.NONE;\n\n\t\t\t}\n\n\t\t\tif ( state !== STATE.NONE ) {\n\n\t\t\t\tscope.dispatchEvent( _startEvent );\n\n\t\t\t}\n\n\t\t}\n\n\t\tfunction onTouchMove( event ) {\n\n\t\t\ttrackPointer( event );\n\n\t\t\tswitch ( state ) {\n\n\t\t\t\tcase STATE.TOUCH_ROTATE:\n\n\t\t\t\t\tif ( scope.enableRotate === false ) return;\n\n\t\t\t\t\thandleTouchMoveRotate( event );\n\n\t\t\t\t\tscope.update();\n\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase STATE.TOUCH_PAN:\n\n\t\t\t\t\tif ( scope.enablePan === false ) return;\n\n\t\t\t\t\thandleTouchMovePan( event );\n\n\t\t\t\t\tscope.update();\n\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase STATE.TOUCH_DOLLY_PAN:\n\n\t\t\t\t\tif ( scope.enableZoom === false && scope.enablePan === false ) return;\n\n\t\t\t\t\thandleTouchMoveDollyPan( event );\n\n\t\t\t\t\tscope.update();\n\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase STATE.TOUCH_DOLLY_ROTATE:\n\n\t\t\t\t\tif ( scope.enableZoom === false && scope.enableRotate === false ) return;\n\n\t\t\t\t\thandleTouchMoveDollyRotate( event );\n\n\t\t\t\t\tscope.update();\n\n\t\t\t\t\tbreak;\n\n\t\t\t\tdefault:\n\n\t\t\t\t\tstate = STATE.NONE;\n\n\t\t\t}\n\n\t\t}\n\n\t\tfunction onTouchEnd( event ) {\n\n\t\t\thandleTouchEnd( event );\n\n\t\t\tscope.dispatchEvent( _endEvent );\n\n\t\t\tstate = STATE.NONE;\n\n\t\t}\n\n\t\tfunction onContextMenu( event ) {\n\n\t\t\tif ( scope.enabled === false ) return;\n\n\t\t\tevent.preventDefault();\n\n\t\t}\n\n\t\tfunction addPointer( event ) {\n\n\t\t\tpointers.push( event );\n\n\t\t}\n\n\t\tfunction removePointer( event ) {\n\n\t\t\tdelete pointerPositions[ event.pointerId ];\n\n\t\t\tfor ( let i = 0; i < pointers.length; i ++ ) {\n\n\t\t\t\tif ( pointers[ i ].pointerId == event.pointerId ) {\n\n\t\t\t\t\tpointers.splice( i, 1 );\n\t\t\t\t\treturn;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\tfunction trackPointer( event ) {\n\n\t\t\tlet position = pointerPositions[ event.pointerId ];\n\n\t\t\tif ( position === undefined ) {\n\n\t\t\t\tposition = new Vector2();\n\t\t\t\tpointerPositions[ event.pointerId ] = position;\n\n\t\t\t}\n\n\t\t\tposition.set( event.pageX, event.pageY );\n\n\t\t}\n\n\t\tfunction getSecondPointerPosition( event ) {\n\n\t\t\tconst pointer = ( event.pointerId === pointers[ 0 ].pointerId ) ? pointers[ 1 ] : pointers[ 0 ];\n\n\t\t\treturn pointerPositions[ pointer.pointerId ];\n\n\t\t}\n\n\t\t//\n\n\t\tscope.domElement.addEventListener( 'contextmenu', onContextMenu );\n\n\t\tscope.domElement.addEventListener( 'pointerdown', onPointerDown );\n\t\tscope.domElement.addEventListener( 'pointercancel', onPointerCancel );\n\t\tscope.domElement.addEventListener( 'wheel', onMouseWheel, { passive: false } );\n\n\t\t// force an update at start\n\n\t\tthis.update();\n\n\t}\n\n}\n\n\n// This set of controls performs orbiting, dollying (zooming), and panning.\n// Unlike TrackballControls, it maintains the \"up\" direction object.up (+Y by default).\n// This is very similar to OrbitControls, another set of touch behavior\n//\n//    Orbit - right mouse, or left mouse + ctrl/meta/shiftKey / touch: two-finger rotate\n//    Zoom - middle mouse, or mousewheel / touch: two-finger spread or squish\n//    Pan - left mouse, or arrow keys / touch: one-finger move\n\nclass MapControls extends OrbitControls {\n\n\tconstructor( object, domElement ) {\n\n\t\tsuper( object, domElement );\n\n\t\tthis.screenSpacePanning = false; // pan orthogonal to world-space direction camera.up\n\n\t\tthis.mouseButtons.LEFT = MOUSE.PAN;\n\t\tthis.mouseButtons.RIGHT = MOUSE.ROTATE;\n\n\t\tthis.touches.ONE = TOUCH.PAN;\n\t\tthis.touches.TWO = TOUCH.DOLLY_ROTATE;\n\n\t}\n\n}\n\nexport { OrbitControls, MapControls };\n","var __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n};\r\nimport { BackSide, Color, Mesh, RepeatWrapping, ShaderMaterial, SphereBufferGeometry } from 'three';\r\nimport { OrbitControls } from 'three/examples/jsm/controls/OrbitControls';\r\nexport default class WarpSpeed {\r\n    constructor(scene, renderer, camera, lights, physics, load, factories) {\r\n        this.scene = scene;\r\n        this.renderer = renderer;\r\n        this.camera = camera;\r\n        this.lights = lights;\r\n        this.physics = physics;\r\n        this.load = load;\r\n        this.factories = factories;\r\n    }\r\n    /**\r\n     * It takes took long to setup the third dimension your self? Get started with warp speed by using this function.\r\n     * @param features Pass the features you want to setup.\r\n     */\r\n    warpSpeed(...features) {\r\n        return __awaiter(this, void 0, void 0, function* () {\r\n            let Features = {};\r\n            // test for negative features\r\n            const negativeFeatures = features.filter(feature => /^-\\w+/.test(feature));\r\n            const hasNegativeFeatures = negativeFeatures.length > 0 ? true : false;\r\n            // add all features\r\n            if (features.length === 0 || hasNegativeFeatures)\r\n                features = ['light', 'camera', 'lookAtCenter', 'ground', 'grid', 'orbitControls', 'fog', 'sky'];\r\n            // remove the negative features\r\n            if (hasNegativeFeatures) {\r\n                const featuresToRemove = negativeFeatures.map(feature => feature.substr(1));\r\n                featuresToRemove.forEach(feature => {\r\n                    // @ts-ignore\r\n                    const index = features.indexOf(feature);\r\n                    features.splice(index, 1);\r\n                });\r\n            }\r\n            // TODO(yandeu): add fog\r\n            // if (features.includes('fog')) {\r\n            // }\r\n            if (features.includes('sky')) {\r\n                // https://github.com/mrdoob/three.js/blob/master/examples/webgl_lights_hemisphere.html\r\n                // SKYDOME\r\n                const vertexShader = [\r\n                    'varying vec3 vWorldPosition;',\r\n                    '',\r\n                    'void main() {',\r\n                    '',\r\n                    'vec4 worldPosition = modelMatrix * vec4( position, 1.0 );',\r\n                    'vWorldPosition = worldPosition.xyz;',\r\n                    '',\r\n                    'gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );',\r\n                    '',\r\n                    '}'\r\n                ].join('\\n');\r\n                const fragmentShader = [\r\n                    'uniform vec3 topColor;',\r\n                    'uniform vec3 bottomColor;',\r\n                    'uniform float offset;',\r\n                    'uniform float exponent;',\r\n                    '',\r\n                    'varying vec3 vWorldPosition;',\r\n                    '',\r\n                    'void main() {',\r\n                    '',\r\n                    'float h = normalize( vWorldPosition + offset ).y;',\r\n                    'gl_FragColor = vec4( mix( bottomColor, topColor, max( pow( max( h , 0.0), exponent ), 0.0 ) ), 1.0 );',\r\n                    '',\r\n                    '}'\r\n                ].join('\\n');\r\n                const uniforms = {\r\n                    topColor: { value: new Color(0x0077ff) },\r\n                    bottomColor: { value: new Color(0xedf5ff) },\r\n                    offset: { value: 33 },\r\n                    exponent: { value: 0.6 }\r\n                };\r\n                var skyGeo = new SphereBufferGeometry(500, 32, 15);\r\n                var skyMat = new ShaderMaterial({\r\n                    uniforms: uniforms,\r\n                    vertexShader: vertexShader,\r\n                    fragmentShader: fragmentShader,\r\n                    side: BackSide\r\n                });\r\n                var sky = new Mesh(skyGeo, skyMat);\r\n                this.scene.add(sky);\r\n            }\r\n            if (features.includes('camera')) {\r\n                this.camera.position.set(0, 6, 12);\r\n                Features = Object.assign({ camera: this.camera }, Features);\r\n            }\r\n            if (features.includes('light')) {\r\n                const intensity = 0.4;\r\n                const hemisphereLight = this.lights.hemisphereLight({ skyColor: 0xffffff, groundColor: 0x000000, intensity });\r\n                const ambientLight = this.lights.ambientLight({ color: 0xffffff, intensity });\r\n                const directionalLight = this.lights.directionalLight({ color: 0xffffff, intensity });\r\n                directionalLight.position.set(100, 200, 50);\r\n                const d = 20;\r\n                directionalLight.shadow.camera.top = d;\r\n                directionalLight.shadow.camera.bottom = -d;\r\n                directionalLight.shadow.camera.left = -d;\r\n                directionalLight.shadow.camera.right = d;\r\n                directionalLight.shadow.mapSize.set(1024, 1024);\r\n                // this.directionalLight = light\r\n                const lights = {\r\n                    ambientLight,\r\n                    directionalLight,\r\n                    hemisphereLight\r\n                };\r\n                Features = Object.assign({ lights }, Features);\r\n            }\r\n            if (features.includes('lookAtCenter')) {\r\n                this.camera.lookAt(this.scene.position);\r\n            }\r\n            if (features.includes('ground')) {\r\n                // grid (texture)\r\n                const addGrid = features.includes('grid');\r\n                const gridData = 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAAOnAAADusBZ+q87AAAAJtJREFUeJzt0EENwDAAxLDbNP6UOxh+NEYQ5dl2drFv286598GrA7QG6ACtATpAa4AO0BqgA7QG6ACtATpAa4AO0BqgA7QG6ACtATpAa4AO0BqgA7QG6ACtATpAa4AO0BqgA7QG6ACtATpAa4AO0BqgA7QG6ACtATpAa4AO0BqgA7QG6ACtATpAa4AO0BqgA7QG6ACtATpAu37AD8eaBH5JQdVbAAAAAElFTkSuQmCC';\r\n                const texture = yield this.load.texture(gridData);\r\n                texture.wrapS = texture.wrapT = RepeatWrapping;\r\n                texture.repeat.set(21, 21);\r\n                // ground\r\n                const geometry = { name: 'ground', width: 21, height: 21, depth: 1, y: -0.5 };\r\n                const material = {\r\n                    phong: { map: addGrid ? texture : null, color: 0xffffff }\r\n                };\r\n                let ground;\r\n                if (window.__loadPhysics) {\r\n                    ground = this.physics.add.ground(geometry, material);\r\n                    ground.body.setRestitution(1);\r\n                }\r\n                else {\r\n                    ground = this.factories.add.ground(geometry, material);\r\n                }\r\n                ground.receiveShadow = true;\r\n                Features = Object.assign({ ground }, Features);\r\n            }\r\n            if (features.includes('orbitControls')) {\r\n                // for phaser\r\n                // this.root is the phaser scene (scene3D)\r\n                // this.root.scale.parent instead of this.renderer.domElement\r\n                const orbitControls = new OrbitControls(this.camera, document.getElementById('enable3d-phaser-canvas') || this.renderer.domElement);\r\n                Features = Object.assign({ orbitControls }, Features);\r\n            }\r\n            return Features;\r\n        });\r\n    }\r\n}\r\n//# sourceMappingURL=warpSpeed.js.map","import {\n\tColor,\n\tLinearFilter,\n\tMathUtils,\n\tMatrix4,\n\tMesh,\n\tPerspectiveCamera,\n\tPlane,\n\tRGBFormat,\n\tShaderMaterial,\n\tUniformsUtils,\n\tVector3,\n\tVector4,\n\tWebGLRenderTarget\n} from 'three';\n\nclass Reflector extends Mesh {\n\n\tconstructor( geometry, options = {} ) {\n\n\t\tsuper( geometry );\n\n\t\tthis.type = 'Reflector';\n\n\t\tconst scope = this;\n\n\t\tconst color = ( options.color !== undefined ) ? new Color( options.color ) : new Color( 0x7F7F7F );\n\t\tconst textureWidth = options.textureWidth || 512;\n\t\tconst textureHeight = options.textureHeight || 512;\n\t\tconst clipBias = options.clipBias || 0;\n\t\tconst shader = options.shader || Reflector.ReflectorShader;\n\n\t\t//\n\n\t\tconst reflectorPlane = new Plane();\n\t\tconst normal = new Vector3();\n\t\tconst reflectorWorldPosition = new Vector3();\n\t\tconst cameraWorldPosition = new Vector3();\n\t\tconst rotationMatrix = new Matrix4();\n\t\tconst lookAtPosition = new Vector3( 0, 0, - 1 );\n\t\tconst clipPlane = new Vector4();\n\n\t\tconst view = new Vector3();\n\t\tconst target = new Vector3();\n\t\tconst q = new Vector4();\n\n\t\tconst textureMatrix = new Matrix4();\n\t\tconst virtualCamera = new PerspectiveCamera();\n\n\t\tconst parameters = {\n\t\t\tminFilter: LinearFilter,\n\t\t\tmagFilter: LinearFilter,\n\t\t\tformat: RGBFormat\n\t\t};\n\n\t\tconst renderTarget = new WebGLRenderTarget( textureWidth, textureHeight, parameters );\n\n\t\tif ( ! MathUtils.isPowerOfTwo( textureWidth ) || ! MathUtils.isPowerOfTwo( textureHeight ) ) {\n\n\t\t\trenderTarget.texture.generateMipmaps = false;\n\n\t\t}\n\n\t\tconst material = new ShaderMaterial( {\n\t\t\tuniforms: UniformsUtils.clone( shader.uniforms ),\n\t\t\tfragmentShader: shader.fragmentShader,\n\t\t\tvertexShader: shader.vertexShader\n\t\t} );\n\n\t\tmaterial.uniforms[ 'tDiffuse' ].value = renderTarget.texture;\n\t\tmaterial.uniforms[ 'color' ].value = color;\n\t\tmaterial.uniforms[ 'textureMatrix' ].value = textureMatrix;\n\n\t\tthis.material = material;\n\n\t\tthis.onBeforeRender = function ( renderer, scene, camera ) {\n\n\t\t\treflectorWorldPosition.setFromMatrixPosition( scope.matrixWorld );\n\t\t\tcameraWorldPosition.setFromMatrixPosition( camera.matrixWorld );\n\n\t\t\trotationMatrix.extractRotation( scope.matrixWorld );\n\n\t\t\tnormal.set( 0, 0, 1 );\n\t\t\tnormal.applyMatrix4( rotationMatrix );\n\n\t\t\tview.subVectors( reflectorWorldPosition, cameraWorldPosition );\n\n\t\t\t// Avoid rendering when reflector is facing away\n\n\t\t\tif ( view.dot( normal ) > 0 ) return;\n\n\t\t\tview.reflect( normal ).negate();\n\t\t\tview.add( reflectorWorldPosition );\n\n\t\t\trotationMatrix.extractRotation( camera.matrixWorld );\n\n\t\t\tlookAtPosition.set( 0, 0, - 1 );\n\t\t\tlookAtPosition.applyMatrix4( rotationMatrix );\n\t\t\tlookAtPosition.add( cameraWorldPosition );\n\n\t\t\ttarget.subVectors( reflectorWorldPosition, lookAtPosition );\n\t\t\ttarget.reflect( normal ).negate();\n\t\t\ttarget.add( reflectorWorldPosition );\n\n\t\t\tvirtualCamera.position.copy( view );\n\t\t\tvirtualCamera.up.set( 0, 1, 0 );\n\t\t\tvirtualCamera.up.applyMatrix4( rotationMatrix );\n\t\t\tvirtualCamera.up.reflect( normal );\n\t\t\tvirtualCamera.lookAt( target );\n\n\t\t\tvirtualCamera.far = camera.far; // Used in WebGLBackground\n\n\t\t\tvirtualCamera.updateMatrixWorld();\n\t\t\tvirtualCamera.projectionMatrix.copy( camera.projectionMatrix );\n\n\t\t\t// Update the texture matrix\n\t\t\ttextureMatrix.set(\n\t\t\t\t0.5, 0.0, 0.0, 0.5,\n\t\t\t\t0.0, 0.5, 0.0, 0.5,\n\t\t\t\t0.0, 0.0, 0.5, 0.5,\n\t\t\t\t0.0, 0.0, 0.0, 1.0\n\t\t\t);\n\t\t\ttextureMatrix.multiply( virtualCamera.projectionMatrix );\n\t\t\ttextureMatrix.multiply( virtualCamera.matrixWorldInverse );\n\t\t\ttextureMatrix.multiply( scope.matrixWorld );\n\n\t\t\t// Now update projection matrix with new clip plane, implementing code from: http://www.terathon.com/code/oblique.html\n\t\t\t// Paper explaining this technique: http://www.terathon.com/lengyel/Lengyel-Oblique.pdf\n\t\t\treflectorPlane.setFromNormalAndCoplanarPoint( normal, reflectorWorldPosition );\n\t\t\treflectorPlane.applyMatrix4( virtualCamera.matrixWorldInverse );\n\n\t\t\tclipPlane.set( reflectorPlane.normal.x, reflectorPlane.normal.y, reflectorPlane.normal.z, reflectorPlane.constant );\n\n\t\t\tconst projectionMatrix = virtualCamera.projectionMatrix;\n\n\t\t\tq.x = ( Math.sign( clipPlane.x ) + projectionMatrix.elements[ 8 ] ) / projectionMatrix.elements[ 0 ];\n\t\t\tq.y = ( Math.sign( clipPlane.y ) + projectionMatrix.elements[ 9 ] ) / projectionMatrix.elements[ 5 ];\n\t\t\tq.z = - 1.0;\n\t\t\tq.w = ( 1.0 + projectionMatrix.elements[ 10 ] ) / projectionMatrix.elements[ 14 ];\n\n\t\t\t// Calculate the scaled plane vector\n\t\t\tclipPlane.multiplyScalar( 2.0 / clipPlane.dot( q ) );\n\n\t\t\t// Replacing the third row of the projection matrix\n\t\t\tprojectionMatrix.elements[ 2 ] = clipPlane.x;\n\t\t\tprojectionMatrix.elements[ 6 ] = clipPlane.y;\n\t\t\tprojectionMatrix.elements[ 10 ] = clipPlane.z + 1.0 - clipBias;\n\t\t\tprojectionMatrix.elements[ 14 ] = clipPlane.w;\n\n\t\t\t// Render\n\n\t\t\trenderTarget.texture.encoding = renderer.outputEncoding;\n\n\t\t\tscope.visible = false;\n\n\t\t\tconst currentRenderTarget = renderer.getRenderTarget();\n\n\t\t\tconst currentXrEnabled = renderer.xr.enabled;\n\t\t\tconst currentShadowAutoUpdate = renderer.shadowMap.autoUpdate;\n\n\t\t\trenderer.xr.enabled = false; // Avoid camera modification\n\t\t\trenderer.shadowMap.autoUpdate = false; // Avoid re-computing shadows\n\n\t\t\trenderer.setRenderTarget( renderTarget );\n\n\t\t\trenderer.state.buffers.depth.setMask( true ); // make sure the depth buffer is writable so it can be properly cleared, see #18897\n\n\t\t\tif ( renderer.autoClear === false ) renderer.clear();\n\t\t\trenderer.render( scene, virtualCamera );\n\n\t\t\trenderer.xr.enabled = currentXrEnabled;\n\t\t\trenderer.shadowMap.autoUpdate = currentShadowAutoUpdate;\n\n\t\t\trenderer.setRenderTarget( currentRenderTarget );\n\n\t\t\t// Restore viewport\n\n\t\t\tconst viewport = camera.viewport;\n\n\t\t\tif ( viewport !== undefined ) {\n\n\t\t\t\trenderer.state.viewport( viewport );\n\n\t\t\t}\n\n\t\t\tscope.visible = true;\n\n\t\t};\n\n\t\tthis.getRenderTarget = function () {\n\n\t\t\treturn renderTarget;\n\n\t\t};\n\n\t}\n\n}\n\nReflector.prototype.isReflector = true;\n\nReflector.ReflectorShader = {\n\n\tuniforms: {\n\n\t\t'color': {\n\t\t\tvalue: null\n\t\t},\n\n\t\t'tDiffuse': {\n\t\t\tvalue: null\n\t\t},\n\n\t\t'textureMatrix': {\n\t\t\tvalue: null\n\t\t}\n\n\t},\n\n\tvertexShader: /* glsl */`\n\t\tuniform mat4 textureMatrix;\n\t\tvarying vec4 vUv;\n\n\t\t#include <common>\n\t\t#include <logdepthbuf_pars_vertex>\n\n\t\tvoid main() {\n\n\t\t\tvUv = textureMatrix * vec4( position, 1.0 );\n\n\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\n\t\t\t#include <logdepthbuf_vertex>\n\n\t\t}`,\n\n\tfragmentShader: /* glsl */`\n\t\tuniform vec3 color;\n\t\tuniform sampler2D tDiffuse;\n\t\tvarying vec4 vUv;\n\n\t\t#include <logdepthbuf_pars_fragment>\n\n\t\tfloat blendOverlay( float base, float blend ) {\n\n\t\t\treturn( base < 0.5 ? ( 2.0 * base * blend ) : ( 1.0 - 2.0 * ( 1.0 - base ) * ( 1.0 - blend ) ) );\n\n\t\t}\n\n\t\tvec3 blendOverlay( vec3 base, vec3 blend ) {\n\n\t\t\treturn vec3( blendOverlay( base.r, blend.r ), blendOverlay( base.g, blend.g ), blendOverlay( base.b, blend.b ) );\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\t#include <logdepthbuf_fragment>\n\n\t\t\tvec4 base = texture2DProj( tDiffuse, vUv );\n\t\t\tgl_FragColor = vec4( blendOverlay( base.rgb, color ), 1.0 );\n\n\t\t}`\n};\n\nexport { Reflector };\n","import {\n\tColor,\n\tLinearFilter,\n\tMathUtils,\n\tMatrix4,\n\tMesh,\n\tPerspectiveCamera,\n\tPlane,\n\tQuaternion,\n\tRGBFormat,\n\tShaderMaterial,\n\tUniformsUtils,\n\tVector3,\n\tVector4,\n\tWebGLRenderTarget\n} from 'three';\n\nclass Refractor extends Mesh {\n\n\tconstructor( geometry, options = {} ) {\n\n\t\tsuper( geometry );\n\n\t\tthis.type = 'Refractor';\n\n\t\tconst scope = this;\n\n\t\tconst color = ( options.color !== undefined ) ? new Color( options.color ) : new Color( 0x7F7F7F );\n\t\tconst textureWidth = options.textureWidth || 512;\n\t\tconst textureHeight = options.textureHeight || 512;\n\t\tconst clipBias = options.clipBias || 0;\n\t\tconst shader = options.shader || Refractor.RefractorShader;\n\n\t\t//\n\n\t\tconst virtualCamera = new PerspectiveCamera();\n\t\tvirtualCamera.matrixAutoUpdate = false;\n\t\tvirtualCamera.userData.refractor = true;\n\n\t\t//\n\n\t\tconst refractorPlane = new Plane();\n\t\tconst textureMatrix = new Matrix4();\n\n\t\t// render target\n\n\t\tconst parameters = {\n\t\t\tminFilter: LinearFilter,\n\t\t\tmagFilter: LinearFilter,\n\t\t\tformat: RGBFormat\n\t\t};\n\n\t\tconst renderTarget = new WebGLRenderTarget( textureWidth, textureHeight, parameters );\n\n\t\tif ( ! MathUtils.isPowerOfTwo( textureWidth ) || ! MathUtils.isPowerOfTwo( textureHeight ) ) {\n\n\t\t\trenderTarget.texture.generateMipmaps = false;\n\n\t\t}\n\n\t\t// material\n\n\t\tthis.material = new ShaderMaterial( {\n\t\t\tuniforms: UniformsUtils.clone( shader.uniforms ),\n\t\t\tvertexShader: shader.vertexShader,\n\t\t\tfragmentShader: shader.fragmentShader,\n\t\t\ttransparent: true // ensures, refractors are drawn from farthest to closest\n\t\t} );\n\n\t\tthis.material.uniforms[ 'color' ].value = color;\n\t\tthis.material.uniforms[ 'tDiffuse' ].value = renderTarget.texture;\n\t\tthis.material.uniforms[ 'textureMatrix' ].value = textureMatrix;\n\n\t\t// functions\n\n\t\tconst visible = ( function () {\n\n\t\t\tconst refractorWorldPosition = new Vector3();\n\t\t\tconst cameraWorldPosition = new Vector3();\n\t\t\tconst rotationMatrix = new Matrix4();\n\n\t\t\tconst view = new Vector3();\n\t\t\tconst normal = new Vector3();\n\n\t\t\treturn function visible( camera ) {\n\n\t\t\t\trefractorWorldPosition.setFromMatrixPosition( scope.matrixWorld );\n\t\t\t\tcameraWorldPosition.setFromMatrixPosition( camera.matrixWorld );\n\n\t\t\t\tview.subVectors( refractorWorldPosition, cameraWorldPosition );\n\n\t\t\t\trotationMatrix.extractRotation( scope.matrixWorld );\n\n\t\t\t\tnormal.set( 0, 0, 1 );\n\t\t\t\tnormal.applyMatrix4( rotationMatrix );\n\n\t\t\t\treturn view.dot( normal ) < 0;\n\n\t\t\t};\n\n\t\t} )();\n\n\t\tconst updateRefractorPlane = ( function () {\n\n\t\t\tconst normal = new Vector3();\n\t\t\tconst position = new Vector3();\n\t\t\tconst quaternion = new Quaternion();\n\t\t\tconst scale = new Vector3();\n\n\t\t\treturn function updateRefractorPlane() {\n\n\t\t\t\tscope.matrixWorld.decompose( position, quaternion, scale );\n\t\t\t\tnormal.set( 0, 0, 1 ).applyQuaternion( quaternion ).normalize();\n\n\t\t\t\t// flip the normal because we want to cull everything above the plane\n\n\t\t\t\tnormal.negate();\n\n\t\t\t\trefractorPlane.setFromNormalAndCoplanarPoint( normal, position );\n\n\t\t\t};\n\n\t\t} )();\n\n\t\tconst updateVirtualCamera = ( function () {\n\n\t\t\tconst clipPlane = new Plane();\n\t\t\tconst clipVector = new Vector4();\n\t\t\tconst q = new Vector4();\n\n\t\t\treturn function updateVirtualCamera( camera ) {\n\n\t\t\t\tvirtualCamera.matrixWorld.copy( camera.matrixWorld );\n\t\t\t\tvirtualCamera.matrixWorldInverse.copy( virtualCamera.matrixWorld ).invert();\n\t\t\t\tvirtualCamera.projectionMatrix.copy( camera.projectionMatrix );\n\t\t\t\tvirtualCamera.far = camera.far; // used in WebGLBackground\n\n\t\t\t\t// The following code creates an oblique view frustum for clipping.\n\t\t\t\t// see: Lengyel, Eric. Oblique View Frustum Depth Projection and Clipping.\n\t\t\t\t// Journal of Game Development, Vol. 1, No. 2 (2005), Charles River Media, pp. 516\n\n\t\t\t\tclipPlane.copy( refractorPlane );\n\t\t\t\tclipPlane.applyMatrix4( virtualCamera.matrixWorldInverse );\n\n\t\t\t\tclipVector.set( clipPlane.normal.x, clipPlane.normal.y, clipPlane.normal.z, clipPlane.constant );\n\n\t\t\t\t// calculate the clip-space corner point opposite the clipping plane and\n\t\t\t\t// transform it into camera space by multiplying it by the inverse of the projection matrix\n\n\t\t\t\tconst projectionMatrix = virtualCamera.projectionMatrix;\n\n\t\t\t\tq.x = ( Math.sign( clipVector.x ) + projectionMatrix.elements[ 8 ] ) / projectionMatrix.elements[ 0 ];\n\t\t\t\tq.y = ( Math.sign( clipVector.y ) + projectionMatrix.elements[ 9 ] ) / projectionMatrix.elements[ 5 ];\n\t\t\t\tq.z = - 1.0;\n\t\t\t\tq.w = ( 1.0 + projectionMatrix.elements[ 10 ] ) / projectionMatrix.elements[ 14 ];\n\n\t\t\t\t// calculate the scaled plane vector\n\n\t\t\t\tclipVector.multiplyScalar( 2.0 / clipVector.dot( q ) );\n\n\t\t\t\t// replacing the third row of the projection matrix\n\n\t\t\t\tprojectionMatrix.elements[ 2 ] = clipVector.x;\n\t\t\t\tprojectionMatrix.elements[ 6 ] = clipVector.y;\n\t\t\t\tprojectionMatrix.elements[ 10 ] = clipVector.z + 1.0 - clipBias;\n\t\t\t\tprojectionMatrix.elements[ 14 ] = clipVector.w;\n\n\t\t\t};\n\n\t\t} )();\n\n\t\t// This will update the texture matrix that is used for projective texture mapping in the shader.\n\t\t// see: http://developer.download.nvidia.com/assets/gamedev/docs/projective_texture_mapping.pdf\n\n\t\tfunction updateTextureMatrix( camera ) {\n\n\t\t\t// this matrix does range mapping to [ 0, 1 ]\n\n\t\t\ttextureMatrix.set(\n\t\t\t\t0.5, 0.0, 0.0, 0.5,\n\t\t\t\t0.0, 0.5, 0.0, 0.5,\n\t\t\t\t0.0, 0.0, 0.5, 0.5,\n\t\t\t\t0.0, 0.0, 0.0, 1.0\n\t\t\t);\n\n\t\t\t// we use \"Object Linear Texgen\", so we need to multiply the texture matrix T\n\t\t\t// (matrix above) with the projection and view matrix of the virtual camera\n\t\t\t// and the model matrix of the refractor\n\n\t\t\ttextureMatrix.multiply( camera.projectionMatrix );\n\t\t\ttextureMatrix.multiply( camera.matrixWorldInverse );\n\t\t\ttextureMatrix.multiply( scope.matrixWorld );\n\n\t\t}\n\n\t\t//\n\n\t\tfunction render( renderer, scene, camera ) {\n\n\t\t\tscope.visible = false;\n\n\t\t\tconst currentRenderTarget = renderer.getRenderTarget();\n\t\t\tconst currentXrEnabled = renderer.xr.enabled;\n\t\t\tconst currentShadowAutoUpdate = renderer.shadowMap.autoUpdate;\n\n\t\t\trenderer.xr.enabled = false; // avoid camera modification\n\t\t\trenderer.shadowMap.autoUpdate = false; // avoid re-computing shadows\n\n\t\t\trenderer.setRenderTarget( renderTarget );\n\t\t\tif ( renderer.autoClear === false ) renderer.clear();\n\t\t\trenderer.render( scene, virtualCamera );\n\n\t\t\trenderer.xr.enabled = currentXrEnabled;\n\t\t\trenderer.shadowMap.autoUpdate = currentShadowAutoUpdate;\n\t\t\trenderer.setRenderTarget( currentRenderTarget );\n\n\t\t\t// restore viewport\n\n\t\t\tconst viewport = camera.viewport;\n\n\t\t\tif ( viewport !== undefined ) {\n\n\t\t\t\trenderer.state.viewport( viewport );\n\n\t\t\t}\n\n\t\t\tscope.visible = true;\n\n\t\t}\n\n\t\t//\n\n\t\tthis.onBeforeRender = function ( renderer, scene, camera ) {\n\n\t\t\t// Render\n\n\t\t\trenderTarget.texture.encoding = renderer.outputEncoding;\n\n\t\t\t// ensure refractors are rendered only once per frame\n\n\t\t\tif ( camera.userData.refractor === true ) return;\n\n\t\t\t// avoid rendering when the refractor is viewed from behind\n\n\t\t\tif ( ! visible( camera ) === true ) return;\n\n\t\t\t// update\n\n\t\t\tupdateRefractorPlane();\n\n\t\t\tupdateTextureMatrix( camera );\n\n\t\t\tupdateVirtualCamera( camera );\n\n\t\t\trender( renderer, scene, camera );\n\n\t\t};\n\n\t\tthis.getRenderTarget = function () {\n\n\t\t\treturn renderTarget;\n\n\t\t};\n\n\t}\n\n}\n\nRefractor.prototype.isRefractor = true;\n\nRefractor.RefractorShader = {\n\n\tuniforms: {\n\n\t\t'color': {\n\t\t\tvalue: null\n\t\t},\n\n\t\t'tDiffuse': {\n\t\t\tvalue: null\n\t\t},\n\n\t\t'textureMatrix': {\n\t\t\tvalue: null\n\t\t}\n\n\t},\n\n\tvertexShader: /* glsl */`\n\n\t\tuniform mat4 textureMatrix;\n\n\t\tvarying vec4 vUv;\n\n\t\tvoid main() {\n\n\t\t\tvUv = textureMatrix * vec4( position, 1.0 );\n\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\n\t\t}`,\n\n\tfragmentShader: /* glsl */`\n\n\t\tuniform vec3 color;\n\t\tuniform sampler2D tDiffuse;\n\n\t\tvarying vec4 vUv;\n\n\t\tfloat blendOverlay( float base, float blend ) {\n\n\t\t\treturn( base < 0.5 ? ( 2.0 * base * blend ) : ( 1.0 - 2.0 * ( 1.0 - base ) * ( 1.0 - blend ) ) );\n\n\t\t}\n\n\t\tvec3 blendOverlay( vec3 base, vec3 blend ) {\n\n\t\t\treturn vec3( blendOverlay( base.r, blend.r ), blendOverlay( base.g, blend.g ), blendOverlay( base.b, blend.b ) );\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvec4 base = texture2DProj( tDiffuse, vUv );\n\t\t\tgl_FragColor = vec4( blendOverlay( base.rgb, color ), 1.0 );\n\n\t\t}`\n\n};\n\nexport { Refractor };\n","import {\n\tClock,\n\tColor,\n\tLinearEncoding,\n\tMatrix4,\n\tMesh,\n\tRepeatWrapping,\n\tShaderMaterial,\n\tTextureLoader,\n\tUniformsLib,\n\tUniformsUtils,\n\tVector2,\n\tVector4\n} from 'three';\nimport { Reflector } from '../objects/Reflector.js';\nimport { Refractor } from '../objects/Refractor.js';\n\n/**\n * References:\n *\thttp://www.valvesoftware.com/publications/2010/siggraph2010_vlachos_waterflow.pdf\n * \thttp://graphicsrunner.blogspot.de/2010/08/water-using-flow-maps.html\n *\n */\n\nclass Water extends Mesh {\n\n\tconstructor( geometry, options = {} ) {\n\n\t\tsuper( geometry );\n\n\t\tthis.type = 'Water';\n\n\t\tconst scope = this;\n\n\t\tconst color = ( options.color !== undefined ) ? new Color( options.color ) : new Color( 0xFFFFFF );\n\t\tconst textureWidth = options.textureWidth || 512;\n\t\tconst textureHeight = options.textureHeight || 512;\n\t\tconst clipBias = options.clipBias || 0;\n\t\tconst flowDirection = options.flowDirection || new Vector2( 1, 0 );\n\t\tconst flowSpeed = options.flowSpeed || 0.03;\n\t\tconst reflectivity = options.reflectivity || 0.02;\n\t\tconst scale = options.scale || 1;\n\t\tconst shader = options.shader || Water.WaterShader;\n\t\tconst encoding = options.encoding !== undefined ? options.encoding : LinearEncoding;\n\n\t\tconst textureLoader = new TextureLoader();\n\n\t\tconst flowMap = options.flowMap || undefined;\n\t\tconst normalMap0 = options.normalMap0 || textureLoader.load( 'textures/water/Water_1_M_Normal.jpg' );\n\t\tconst normalMap1 = options.normalMap1 || textureLoader.load( 'textures/water/Water_2_M_Normal.jpg' );\n\n\t\tconst cycle = 0.15; // a cycle of a flow map phase\n\t\tconst halfCycle = cycle * 0.5;\n\t\tconst textureMatrix = new Matrix4();\n\t\tconst clock = new Clock();\n\n\t\t// internal components\n\n\t\tif ( Reflector === undefined ) {\n\n\t\t\tconsole.error( 'THREE.Water: Required component Reflector not found.' );\n\t\t\treturn;\n\n\t\t}\n\n\t\tif ( Refractor === undefined ) {\n\n\t\t\tconsole.error( 'THREE.Water: Required component Refractor not found.' );\n\t\t\treturn;\n\n\t\t}\n\n\t\tconst reflector = new Reflector( geometry, {\n\t\t\ttextureWidth: textureWidth,\n\t\t\ttextureHeight: textureHeight,\n\t\t\tclipBias: clipBias,\n\t\t\tencoding: encoding\n\t\t} );\n\n\t\tconst refractor = new Refractor( geometry, {\n\t\t\ttextureWidth: textureWidth,\n\t\t\ttextureHeight: textureHeight,\n\t\t\tclipBias: clipBias,\n\t\t\tencoding: encoding\n\t\t} );\n\n\t\treflector.matrixAutoUpdate = false;\n\t\trefractor.matrixAutoUpdate = false;\n\n\t\t// material\n\n\t\tthis.material = new ShaderMaterial( {\n\t\t\tuniforms: UniformsUtils.merge( [\n\t\t\t\tUniformsLib[ 'fog' ],\n\t\t\t\tshader.uniforms\n\t\t\t] ),\n\t\t\tvertexShader: shader.vertexShader,\n\t\t\tfragmentShader: shader.fragmentShader,\n\t\t\ttransparent: true,\n\t\t\tfog: true\n\t\t} );\n\n\t\tif ( flowMap !== undefined ) {\n\n\t\t\tthis.material.defines.USE_FLOWMAP = '';\n\t\t\tthis.material.uniforms[ 'tFlowMap' ] = {\n\t\t\t\ttype: 't',\n\t\t\t\tvalue: flowMap\n\t\t\t};\n\n\t\t} else {\n\n\t\t\tthis.material.uniforms[ 'flowDirection' ] = {\n\t\t\t\ttype: 'v2',\n\t\t\t\tvalue: flowDirection\n\t\t\t};\n\n\t\t}\n\n\t\t// maps\n\n\t\tnormalMap0.wrapS = normalMap0.wrapT = RepeatWrapping;\n\t\tnormalMap1.wrapS = normalMap1.wrapT = RepeatWrapping;\n\n\t\tthis.material.uniforms[ 'tReflectionMap' ].value = reflector.getRenderTarget().texture;\n\t\tthis.material.uniforms[ 'tRefractionMap' ].value = refractor.getRenderTarget().texture;\n\t\tthis.material.uniforms[ 'tNormalMap0' ].value = normalMap0;\n\t\tthis.material.uniforms[ 'tNormalMap1' ].value = normalMap1;\n\n\t\t// water\n\n\t\tthis.material.uniforms[ 'color' ].value = color;\n\t\tthis.material.uniforms[ 'reflectivity' ].value = reflectivity;\n\t\tthis.material.uniforms[ 'textureMatrix' ].value = textureMatrix;\n\n\t\t// inital values\n\n\t\tthis.material.uniforms[ 'config' ].value.x = 0; // flowMapOffset0\n\t\tthis.material.uniforms[ 'config' ].value.y = halfCycle; // flowMapOffset1\n\t\tthis.material.uniforms[ 'config' ].value.z = halfCycle; // halfCycle\n\t\tthis.material.uniforms[ 'config' ].value.w = scale; // scale\n\n\t\t// functions\n\n\t\tfunction updateTextureMatrix( camera ) {\n\n\t\t\ttextureMatrix.set(\n\t\t\t\t0.5, 0.0, 0.0, 0.5,\n\t\t\t\t0.0, 0.5, 0.0, 0.5,\n\t\t\t\t0.0, 0.0, 0.5, 0.5,\n\t\t\t\t0.0, 0.0, 0.0, 1.0\n\t\t\t);\n\n\t\t\ttextureMatrix.multiply( camera.projectionMatrix );\n\t\t\ttextureMatrix.multiply( camera.matrixWorldInverse );\n\t\t\ttextureMatrix.multiply( scope.matrixWorld );\n\n\t\t}\n\n\t\tfunction updateFlow() {\n\n\t\t\tconst delta = clock.getDelta();\n\t\t\tconst config = scope.material.uniforms[ 'config' ];\n\n\t\t\tconfig.value.x += flowSpeed * delta; // flowMapOffset0\n\t\t\tconfig.value.y = config.value.x + halfCycle; // flowMapOffset1\n\n\t\t\t// Important: The distance between offsets should be always the value of \"halfCycle\".\n\t\t\t// Moreover, both offsets should be in the range of [ 0, cycle ].\n\t\t\t// This approach ensures a smooth water flow and avoids \"reset\" effects.\n\n\t\t\tif ( config.value.x >= cycle ) {\n\n\t\t\t\tconfig.value.x = 0;\n\t\t\t\tconfig.value.y = halfCycle;\n\n\t\t\t} else if ( config.value.y >= cycle ) {\n\n\t\t\t\tconfig.value.y = config.value.y - cycle;\n\n\t\t\t}\n\n\t\t}\n\n\t\t//\n\n\t\tthis.onBeforeRender = function ( renderer, scene, camera ) {\n\n\t\t\tupdateTextureMatrix( camera );\n\t\t\tupdateFlow();\n\n\t\t\tscope.visible = false;\n\n\t\t\treflector.matrixWorld.copy( scope.matrixWorld );\n\t\t\trefractor.matrixWorld.copy( scope.matrixWorld );\n\n\t\t\treflector.onBeforeRender( renderer, scene, camera );\n\t\t\trefractor.onBeforeRender( renderer, scene, camera );\n\n\t\t\tscope.visible = true;\n\n\t\t};\n\n\t}\n\n}\n\nWater.prototype.isWater = true;\n\nWater.WaterShader = {\n\n\tuniforms: {\n\n\t\t'color': {\n\t\t\ttype: 'c',\n\t\t\tvalue: null\n\t\t},\n\n\t\t'reflectivity': {\n\t\t\ttype: 'f',\n\t\t\tvalue: 0\n\t\t},\n\n\t\t'tReflectionMap': {\n\t\t\ttype: 't',\n\t\t\tvalue: null\n\t\t},\n\n\t\t'tRefractionMap': {\n\t\t\ttype: 't',\n\t\t\tvalue: null\n\t\t},\n\n\t\t'tNormalMap0': {\n\t\t\ttype: 't',\n\t\t\tvalue: null\n\t\t},\n\n\t\t'tNormalMap1': {\n\t\t\ttype: 't',\n\t\t\tvalue: null\n\t\t},\n\n\t\t'textureMatrix': {\n\t\t\ttype: 'm4',\n\t\t\tvalue: null\n\t\t},\n\n\t\t'config': {\n\t\t\ttype: 'v4',\n\t\t\tvalue: new Vector4()\n\t\t}\n\n\t},\n\n\tvertexShader: /* glsl */`\n\n\t\t#include <common>\n\t\t#include <fog_pars_vertex>\n\t\t#include <logdepthbuf_pars_vertex>\n\n\t\tuniform mat4 textureMatrix;\n\n\t\tvarying vec4 vCoord;\n\t\tvarying vec2 vUv;\n\t\tvarying vec3 vToEye;\n\n\t\tvoid main() {\n\n\t\t\tvUv = uv;\n\t\t\tvCoord = textureMatrix * vec4( position, 1.0 );\n\n\t\t\tvec4 worldPosition = modelMatrix * vec4( position, 1.0 );\n\t\t\tvToEye = cameraPosition - worldPosition.xyz;\n\n\t\t\tvec4 mvPosition =  viewMatrix * worldPosition; // used in fog_vertex\n\t\t\tgl_Position = projectionMatrix * mvPosition;\n\n\t\t\t#include <logdepthbuf_vertex>\n\t\t\t#include <fog_vertex>\n\n\t\t}`,\n\n\tfragmentShader: /* glsl */`\n\n\t\t#include <common>\n\t\t#include <fog_pars_fragment>\n\t\t#include <logdepthbuf_pars_fragment>\n\n\t\tuniform sampler2D tReflectionMap;\n\t\tuniform sampler2D tRefractionMap;\n\t\tuniform sampler2D tNormalMap0;\n\t\tuniform sampler2D tNormalMap1;\n\n\t\t#ifdef USE_FLOWMAP\n\t\t\tuniform sampler2D tFlowMap;\n\t\t#else\n\t\t\tuniform vec2 flowDirection;\n\t\t#endif\n\n\t\tuniform vec3 color;\n\t\tuniform float reflectivity;\n\t\tuniform vec4 config;\n\n\t\tvarying vec4 vCoord;\n\t\tvarying vec2 vUv;\n\t\tvarying vec3 vToEye;\n\n\t\tvoid main() {\n\n\t\t\t#include <logdepthbuf_fragment>\n\n\t\t\tfloat flowMapOffset0 = config.x;\n\t\t\tfloat flowMapOffset1 = config.y;\n\t\t\tfloat halfCycle = config.z;\n\t\t\tfloat scale = config.w;\n\n\t\t\tvec3 toEye = normalize( vToEye );\n\n\t\t\t// determine flow direction\n\t\t\tvec2 flow;\n\t\t\t#ifdef USE_FLOWMAP\n\t\t\t\tflow = texture2D( tFlowMap, vUv ).rg * 2.0 - 1.0;\n\t\t\t#else\n\t\t\t\tflow = flowDirection;\n\t\t\t#endif\n\t\t\tflow.x *= - 1.0;\n\n\t\t\t// sample normal maps (distort uvs with flowdata)\n\t\t\tvec4 normalColor0 = texture2D( tNormalMap0, ( vUv * scale ) + flow * flowMapOffset0 );\n\t\t\tvec4 normalColor1 = texture2D( tNormalMap1, ( vUv * scale ) + flow * flowMapOffset1 );\n\n\t\t\t// linear interpolate to get the final normal color\n\t\t\tfloat flowLerp = abs( halfCycle - flowMapOffset0 ) / halfCycle;\n\t\t\tvec4 normalColor = mix( normalColor0, normalColor1, flowLerp );\n\n\t\t\t// calculate normal vector\n\t\t\tvec3 normal = normalize( vec3( normalColor.r * 2.0 - 1.0, normalColor.b,  normalColor.g * 2.0 - 1.0 ) );\n\n\t\t\t// calculate the fresnel term to blend reflection and refraction maps\n\t\t\tfloat theta = max( dot( toEye, normal ), 0.0 );\n\t\t\tfloat reflectance = reflectivity + ( 1.0 - reflectivity ) * pow( ( 1.0 - theta ), 5.0 );\n\n\t\t\t// calculate final uv coords\n\t\t\tvec3 coord = vCoord.xyz / vCoord.w;\n\t\t\tvec2 uv = coord.xy + coord.z * normal.xz * 0.05;\n\n\t\t\tvec4 reflectColor = texture2D( tReflectionMap, vec2( 1.0 - uv.x, uv.y ) );\n\t\t\tvec4 refractColor = texture2D( tRefractionMap, uv );\n\n\t\t\t// multiply water color with the mix of both textures\n\t\t\tgl_FragColor = vec4( color, 1.0 ) * mix( refractColor, reflectColor, reflectance );\n\n\t\t\t#include <tonemapping_fragment>\n\t\t\t#include <encodings_fragment>\n\t\t\t#include <fog_fragment>\n\n\t\t}`\n\n};\n\nexport { Water };\n","// misc\r\nimport { addWater } from './water';\r\nimport { RepeatWrapping } from 'three';\r\nimport { logger } from '@enable3d/common/dist/logger';\r\nexport default class Misc {\r\n    constructor(scene, renderer, factories) {\r\n        this.scene = scene;\r\n        this.renderer = renderer;\r\n        this.factories = factories;\r\n    }\r\n    water(config = {}) {\r\n        addWater(this.scene, this.renderer, config);\r\n    }\r\n    textureCube(textures) {\r\n        if (textures.length !== 6) {\r\n            logger('You need to pass 6 urls to textureCube()');\r\n        }\r\n        const textureCube = new TextureCube();\r\n        textures.forEach((texture, i) => {\r\n            texture.wrapS = texture.wrapT = RepeatWrapping;\r\n            const material = this.factories.add.material({ phong: { map: texture } });\r\n            textureCube.materials[i] = material;\r\n        });\r\n        return textureCube;\r\n    }\r\n}\r\nexport class TextureCube {\r\n    constructor() {\r\n        this.materials = new Array(6);\r\n    }\r\n    get texture() {\r\n        return {\r\n            left: this.getTexture(0),\r\n            right: this.getTexture(1),\r\n            up: this.getTexture(2),\r\n            down: this.getTexture(3),\r\n            front: this.getTexture(4),\r\n            back: this.getTexture(5)\r\n        };\r\n    }\r\n    getTexture(i) {\r\n        // @ts-ignore\r\n        return this.materials[i].map;\r\n    }\r\n}\r\n//# sourceMappingURL=misc.js.map","import { Mesh, MeshStandardMaterial, PlaneBufferGeometry, Vector2 } from 'three';\r\n// @ts-ignore\r\nimport { Water } from 'three/examples/jsm/objects/Water2';\r\nconst addWater = (scene, renderer, config = {}) => {\r\n    const { width = 20, height = 20, x = 0, y = 0, z = 0, color = '#ffffff', scale = 4, flowX = 1, flowY = 1, normalMap0 = undefined, normalMap1 = undefined } = config;\r\n    //ground\r\n    const groundGeometry = new PlaneBufferGeometry(width, height);\r\n    // #0077be (also known as Ocean Boat Blue)\r\n    const groundMaterial = new MeshStandardMaterial({ color: 0x0077be, transparent: true, opacity: 0.8 });\r\n    const ground = new Mesh(groundGeometry, groundMaterial);\r\n    ground.position.set(x, y, z);\r\n    ground.rotation.x = Math.PI * -0.5;\r\n    scene.add(ground);\r\n    // water\r\n    const waterGeometry = new PlaneBufferGeometry(width, height);\r\n    const water = new Water(waterGeometry, {\r\n        color: color,\r\n        scale: scale,\r\n        flowDirection: new Vector2(flowX, flowY),\r\n        textureWidth: 1024,\r\n        textureHeight: 1024,\r\n        normalMap0: normalMap0,\r\n        normalMap1: normalMap1,\r\n        encoding: renderer.outputEncoding\r\n    });\r\n    water.position.set(x, y + 0.1, z);\r\n    water.rotation.x = Math.PI * -0.5;\r\n    scene.add(water);\r\n    return { ground, water };\r\n};\r\nexport { addWater };\r\n//# sourceMappingURL=water.js.map","/**\n * @webxr-input-profiles/motion-controllers 1.0.0 https://github.com/immersive-web/webxr-input-profiles\n */\n\nconst Constants = {\n  Handedness: Object.freeze({\n    NONE: 'none',\n    LEFT: 'left',\n    RIGHT: 'right'\n  }),\n\n  ComponentState: Object.freeze({\n    DEFAULT: 'default',\n    TOUCHED: 'touched',\n    PRESSED: 'pressed'\n  }),\n\n  ComponentProperty: Object.freeze({\n    BUTTON: 'button',\n    X_AXIS: 'xAxis',\n    Y_AXIS: 'yAxis',\n    STATE: 'state'\n  }),\n\n  ComponentType: Object.freeze({\n    TRIGGER: 'trigger',\n    SQUEEZE: 'squeeze',\n    TOUCHPAD: 'touchpad',\n    THUMBSTICK: 'thumbstick',\n    BUTTON: 'button'\n  }),\n\n  ButtonTouchThreshold: 0.05,\n\n  AxisTouchThreshold: 0.1,\n\n  VisualResponseProperty: Object.freeze({\n    TRANSFORM: 'transform',\n    VISIBILITY: 'visibility'\n  })\n};\n\n/**\n * @description Static helper function to fetch a JSON file and turn it into a JS object\n * @param {string} path - Path to JSON file to be fetched\n */\nasync function fetchJsonFile(path) {\n  const response = await fetch(path);\n  if (!response.ok) {\n    throw new Error(response.statusText);\n  } else {\n    return response.json();\n  }\n}\n\nasync function fetchProfilesList(basePath) {\n  if (!basePath) {\n    throw new Error('No basePath supplied');\n  }\n\n  const profileListFileName = 'profilesList.json';\n  const profilesList = await fetchJsonFile(`${basePath}/${profileListFileName}`);\n  return profilesList;\n}\n\nasync function fetchProfile(xrInputSource, basePath, defaultProfile = null, getAssetPath = true) {\n  if (!xrInputSource) {\n    throw new Error('No xrInputSource supplied');\n  }\n\n  if (!basePath) {\n    throw new Error('No basePath supplied');\n  }\n\n  // Get the list of profiles\n  const supportedProfilesList = await fetchProfilesList(basePath);\n\n  // Find the relative path to the first requested profile that is recognized\n  let match;\n  xrInputSource.profiles.some((profileId) => {\n    const supportedProfile = supportedProfilesList[profileId];\n    if (supportedProfile) {\n      match = {\n        profileId,\n        profilePath: `${basePath}/${supportedProfile.path}`,\n        deprecated: !!supportedProfile.deprecated\n      };\n    }\n    return !!match;\n  });\n\n  if (!match) {\n    if (!defaultProfile) {\n      throw new Error('No matching profile name found');\n    }\n\n    const supportedProfile = supportedProfilesList[defaultProfile];\n    if (!supportedProfile) {\n      throw new Error(`No matching profile name found and default profile \"${defaultProfile}\" missing.`);\n    }\n\n    match = {\n      profileId: defaultProfile,\n      profilePath: `${basePath}/${supportedProfile.path}`,\n      deprecated: !!supportedProfile.deprecated\n    };\n  }\n\n  const profile = await fetchJsonFile(match.profilePath);\n\n  let assetPath;\n  if (getAssetPath) {\n    let layout;\n    if (xrInputSource.handedness === 'any') {\n      layout = profile.layouts[Object.keys(profile.layouts)[0]];\n    } else {\n      layout = profile.layouts[xrInputSource.handedness];\n    }\n    if (!layout) {\n      throw new Error(\n        `No matching handedness, ${xrInputSource.handedness}, in profile ${match.profileId}`\n      );\n    }\n\n    if (layout.assetPath) {\n      assetPath = match.profilePath.replace('profile.json', layout.assetPath);\n    }\n  }\n\n  return { profile, assetPath };\n}\n\n/** @constant {Object} */\nconst defaultComponentValues = {\n  xAxis: 0,\n  yAxis: 0,\n  button: 0,\n  state: Constants.ComponentState.DEFAULT\n};\n\n/**\n * @description Converts an X, Y coordinate from the range -1 to 1 (as reported by the Gamepad\n * API) to the range 0 to 1 (for interpolation). Also caps the X, Y values to be bounded within\n * a circle. This ensures that thumbsticks are not animated outside the bounds of their physical\n * range of motion and touchpads do not report touch locations off their physical bounds.\n * @param {number} x The original x coordinate in the range -1 to 1\n * @param {number} y The original y coordinate in the range -1 to 1\n */\nfunction normalizeAxes(x = 0, y = 0) {\n  let xAxis = x;\n  let yAxis = y;\n\n  // Determine if the point is outside the bounds of the circle\n  // and, if so, place it on the edge of the circle\n  const hypotenuse = Math.sqrt((x * x) + (y * y));\n  if (hypotenuse > 1) {\n    const theta = Math.atan2(y, x);\n    xAxis = Math.cos(theta);\n    yAxis = Math.sin(theta);\n  }\n\n  // Scale and move the circle so values are in the interpolation range.  The circle's origin moves\n  // from (0, 0) to (0.5, 0.5). The circle's radius scales from 1 to be 0.5.\n  const result = {\n    normalizedXAxis: (xAxis * 0.5) + 0.5,\n    normalizedYAxis: (yAxis * 0.5) + 0.5\n  };\n  return result;\n}\n\n/**\n * Contains the description of how the 3D model should visually respond to a specific user input.\n * This is accomplished by initializing the object with the name of a node in the 3D model and\n * property that need to be modified in response to user input, the name of the nodes representing\n * the allowable range of motion, and the name of the input which triggers the change. In response\n * to the named input changing, this object computes the appropriate weighting to use for\n * interpolating between the range of motion nodes.\n */\nclass VisualResponse {\n  constructor(visualResponseDescription) {\n    this.componentProperty = visualResponseDescription.componentProperty;\n    this.states = visualResponseDescription.states;\n    this.valueNodeName = visualResponseDescription.valueNodeName;\n    this.valueNodeProperty = visualResponseDescription.valueNodeProperty;\n\n    if (this.valueNodeProperty === Constants.VisualResponseProperty.TRANSFORM) {\n      this.minNodeName = visualResponseDescription.minNodeName;\n      this.maxNodeName = visualResponseDescription.maxNodeName;\n    }\n\n    // Initializes the response's current value based on default data\n    this.value = 0;\n    this.updateFromComponent(defaultComponentValues);\n  }\n\n  /**\n   * Computes the visual response's interpolation weight based on component state\n   * @param {Object} componentValues - The component from which to update\n   * @param {number} xAxis - The reported X axis value of the component\n   * @param {number} yAxis - The reported Y axis value of the component\n   * @param {number} button - The reported value of the component's button\n   * @param {string} state - The component's active state\n   */\n  updateFromComponent({\n    xAxis, yAxis, button, state\n  }) {\n    const { normalizedXAxis, normalizedYAxis } = normalizeAxes(xAxis, yAxis);\n    switch (this.componentProperty) {\n      case Constants.ComponentProperty.X_AXIS:\n        this.value = (this.states.includes(state)) ? normalizedXAxis : 0.5;\n        break;\n      case Constants.ComponentProperty.Y_AXIS:\n        this.value = (this.states.includes(state)) ? normalizedYAxis : 0.5;\n        break;\n      case Constants.ComponentProperty.BUTTON:\n        this.value = (this.states.includes(state)) ? button : 0;\n        break;\n      case Constants.ComponentProperty.STATE:\n        if (this.valueNodeProperty === Constants.VisualResponseProperty.VISIBILITY) {\n          this.value = (this.states.includes(state));\n        } else {\n          this.value = this.states.includes(state) ? 1.0 : 0.0;\n        }\n        break;\n      default:\n        throw new Error(`Unexpected visualResponse componentProperty ${this.componentProperty}`);\n    }\n  }\n}\n\nclass Component {\n  /**\n   * @param {Object} componentId - Id of the component\n   * @param {Object} componentDescription - Description of the component to be created\n   */\n  constructor(componentId, componentDescription) {\n    if (!componentId\n     || !componentDescription\n     || !componentDescription.visualResponses\n     || !componentDescription.gamepadIndices\n     || Object.keys(componentDescription.gamepadIndices).length === 0) {\n      throw new Error('Invalid arguments supplied');\n    }\n\n    this.id = componentId;\n    this.type = componentDescription.type;\n    this.rootNodeName = componentDescription.rootNodeName;\n    this.touchPointNodeName = componentDescription.touchPointNodeName;\n\n    // Build all the visual responses for this component\n    this.visualResponses = {};\n    Object.keys(componentDescription.visualResponses).forEach((responseName) => {\n      const visualResponse = new VisualResponse(componentDescription.visualResponses[responseName]);\n      this.visualResponses[responseName] = visualResponse;\n    });\n\n    // Set default values\n    this.gamepadIndices = Object.assign({}, componentDescription.gamepadIndices);\n\n    this.values = {\n      state: Constants.ComponentState.DEFAULT,\n      button: (this.gamepadIndices.button !== undefined) ? 0 : undefined,\n      xAxis: (this.gamepadIndices.xAxis !== undefined) ? 0 : undefined,\n      yAxis: (this.gamepadIndices.yAxis !== undefined) ? 0 : undefined\n    };\n  }\n\n  get data() {\n    const data = { id: this.id, ...this.values };\n    return data;\n  }\n\n  /**\n   * @description Poll for updated data based on current gamepad state\n   * @param {Object} gamepad - The gamepad object from which the component data should be polled\n   */\n  updateFromGamepad(gamepad) {\n    // Set the state to default before processing other data sources\n    this.values.state = Constants.ComponentState.DEFAULT;\n\n    // Get and normalize button\n    if (this.gamepadIndices.button !== undefined\n        && gamepad.buttons.length > this.gamepadIndices.button) {\n      const gamepadButton = gamepad.buttons[this.gamepadIndices.button];\n      this.values.button = gamepadButton.value;\n      this.values.button = (this.values.button < 0) ? 0 : this.values.button;\n      this.values.button = (this.values.button > 1) ? 1 : this.values.button;\n\n      // Set the state based on the button\n      if (gamepadButton.pressed || this.values.button === 1) {\n        this.values.state = Constants.ComponentState.PRESSED;\n      } else if (gamepadButton.touched || this.values.button > Constants.ButtonTouchThreshold) {\n        this.values.state = Constants.ComponentState.TOUCHED;\n      }\n    }\n\n    // Get and normalize x axis value\n    if (this.gamepadIndices.xAxis !== undefined\n        && gamepad.axes.length > this.gamepadIndices.xAxis) {\n      this.values.xAxis = gamepad.axes[this.gamepadIndices.xAxis];\n      this.values.xAxis = (this.values.xAxis < -1) ? -1 : this.values.xAxis;\n      this.values.xAxis = (this.values.xAxis > 1) ? 1 : this.values.xAxis;\n\n      // If the state is still default, check if the xAxis makes it touched\n      if (this.values.state === Constants.ComponentState.DEFAULT\n        && Math.abs(this.values.xAxis) > Constants.AxisTouchThreshold) {\n        this.values.state = Constants.ComponentState.TOUCHED;\n      }\n    }\n\n    // Get and normalize Y axis value\n    if (this.gamepadIndices.yAxis !== undefined\n        && gamepad.axes.length > this.gamepadIndices.yAxis) {\n      this.values.yAxis = gamepad.axes[this.gamepadIndices.yAxis];\n      this.values.yAxis = (this.values.yAxis < -1) ? -1 : this.values.yAxis;\n      this.values.yAxis = (this.values.yAxis > 1) ? 1 : this.values.yAxis;\n\n      // If the state is still default, check if the yAxis makes it touched\n      if (this.values.state === Constants.ComponentState.DEFAULT\n        && Math.abs(this.values.yAxis) > Constants.AxisTouchThreshold) {\n        this.values.state = Constants.ComponentState.TOUCHED;\n      }\n    }\n\n    // Update the visual response weights based on the current component data\n    Object.values(this.visualResponses).forEach((visualResponse) => {\n      visualResponse.updateFromComponent(this.values);\n    });\n  }\n}\n\n/**\n  * @description Builds a motion controller with components and visual responses based on the\n  * supplied profile description. Data is polled from the xrInputSource's gamepad.\n  * @author Nell Waliczek / https://github.com/NellWaliczek\n*/\nclass MotionController {\n  /**\n   * @param {Object} xrInputSource - The XRInputSource to build the MotionController around\n   * @param {Object} profile - The best matched profile description for the supplied xrInputSource\n   * @param {Object} assetUrl\n   */\n  constructor(xrInputSource, profile, assetUrl) {\n    if (!xrInputSource) {\n      throw new Error('No xrInputSource supplied');\n    }\n\n    if (!profile) {\n      throw new Error('No profile supplied');\n    }\n\n    this.xrInputSource = xrInputSource;\n    this.assetUrl = assetUrl;\n    this.id = profile.profileId;\n\n    // Build child components as described in the profile description\n    this.layoutDescription = profile.layouts[xrInputSource.handedness];\n    this.components = {};\n    Object.keys(this.layoutDescription.components).forEach((componentId) => {\n      const componentDescription = this.layoutDescription.components[componentId];\n      this.components[componentId] = new Component(componentId, componentDescription);\n    });\n\n    // Initialize components based on current gamepad state\n    this.updateFromGamepad();\n  }\n\n  get gripSpace() {\n    return this.xrInputSource.gripSpace;\n  }\n\n  get targetRaySpace() {\n    return this.xrInputSource.targetRaySpace;\n  }\n\n  /**\n   * @description Returns a subset of component data for simplified debugging\n   */\n  get data() {\n    const data = [];\n    Object.values(this.components).forEach((component) => {\n      data.push(component.data);\n    });\n    return data;\n  }\n\n  /**\n   * @description Poll for updated data based on current gamepad state\n   */\n  updateFromGamepad() {\n    Object.values(this.components).forEach((component) => {\n      component.updateFromGamepad(this.xrInputSource.gamepad);\n    });\n  }\n}\n\nexport { Constants, MotionController, fetchProfile, fetchProfilesList };\n","import {\n\tMesh,\n\tMeshBasicMaterial,\n\tObject3D,\n\tSphereGeometry,\n} from 'three';\n\nimport { GLTFLoader } from '../loaders/GLTFLoader.js';\n\nimport {\n\tConstants as MotionControllerConstants,\n\tfetchProfile,\n\tMotionController\n} from '../libs/motion-controllers.module.js';\n\nconst DEFAULT_PROFILES_PATH = 'https://cdn.jsdelivr.net/npm/@webxr-input-profiles/assets@1.0/dist/profiles';\nconst DEFAULT_PROFILE = 'generic-trigger';\n\nclass XRControllerModel extends Object3D {\n\n\tconstructor() {\n\n\t\tsuper();\n\n\t\tthis.motionController = null;\n\t\tthis.envMap = null;\n\n\t}\n\n\tsetEnvironmentMap( envMap ) {\n\n\t\tif ( this.envMap == envMap ) {\n\n\t\t\treturn this;\n\n\t\t}\n\n\t\tthis.envMap = envMap;\n\t\tthis.traverse( ( child ) => {\n\n\t\t\tif ( child.isMesh ) {\n\n\t\t\t\tchild.material.envMap = this.envMap;\n\t\t\t\tchild.material.needsUpdate = true;\n\n\t\t\t}\n\n\t\t} );\n\n\t\treturn this;\n\n\t}\n\n\t/**\n\t * Polls data from the XRInputSource and updates the model's components to match\n\t * the real world data\n\t */\n\tupdateMatrixWorld( force ) {\n\n\t\tsuper.updateMatrixWorld( force );\n\n\t\tif ( ! this.motionController ) return;\n\n\t\t// Cause the MotionController to poll the Gamepad for data\n\t\tthis.motionController.updateFromGamepad();\n\n\t\t// Update the 3D model to reflect the button, thumbstick, and touchpad state\n\t\tObject.values( this.motionController.components ).forEach( ( component ) => {\n\n\t\t\t// Update node data based on the visual responses' current states\n\t\t\tObject.values( component.visualResponses ).forEach( ( visualResponse ) => {\n\n\t\t\t\tconst { valueNode, minNode, maxNode, value, valueNodeProperty } = visualResponse;\n\n\t\t\t\t// Skip if the visual response node is not found. No error is needed,\n\t\t\t\t// because it will have been reported at load time.\n\t\t\t\tif ( ! valueNode ) return;\n\n\t\t\t\t// Calculate the new properties based on the weight supplied\n\t\t\t\tif ( valueNodeProperty === MotionControllerConstants.VisualResponseProperty.VISIBILITY ) {\n\n\t\t\t\t\tvalueNode.visible = value;\n\n\t\t\t\t} else if ( valueNodeProperty === MotionControllerConstants.VisualResponseProperty.TRANSFORM ) {\n\n\t\t\t\t\tvalueNode.quaternion.slerpQuaternions(\n\t\t\t\t\t\tminNode.quaternion,\n\t\t\t\t\t\tmaxNode.quaternion,\n\t\t\t\t\t\tvalue\n\t\t\t\t\t);\n\n\t\t\t\t\tvalueNode.position.lerpVectors(\n\t\t\t\t\t\tminNode.position,\n\t\t\t\t\t\tmaxNode.position,\n\t\t\t\t\t\tvalue\n\t\t\t\t\t);\n\n\t\t\t\t}\n\n\t\t\t} );\n\n\t\t} );\n\n\t}\n\n}\n\n/**\n * Walks the model's tree to find the nodes needed to animate the components and\n * saves them to the motionContoller components for use in the frame loop. When\n * touchpads are found, attaches a touch dot to them.\n */\nfunction findNodes( motionController, scene ) {\n\n\t// Loop through the components and find the nodes needed for each components' visual responses\n\tObject.values( motionController.components ).forEach( ( component ) => {\n\n\t\tconst { type, touchPointNodeName, visualResponses } = component;\n\n\t\tif ( type === MotionControllerConstants.ComponentType.TOUCHPAD ) {\n\n\t\t\tcomponent.touchPointNode = scene.getObjectByName( touchPointNodeName );\n\t\t\tif ( component.touchPointNode ) {\n\n\t\t\t\t// Attach a touch dot to the touchpad.\n\t\t\t\tconst sphereGeometry = new SphereGeometry( 0.001 );\n\t\t\t\tconst material = new MeshBasicMaterial( { color: 0x0000FF } );\n\t\t\t\tconst sphere = new Mesh( sphereGeometry, material );\n\t\t\t\tcomponent.touchPointNode.add( sphere );\n\n\t\t\t} else {\n\n\t\t\t\tconsole.warn( `Could not find touch dot, ${component.touchPointNodeName}, in touchpad component ${component.id}` );\n\n\t\t\t}\n\n\t\t}\n\n\t\t// Loop through all the visual responses to be applied to this component\n\t\tObject.values( visualResponses ).forEach( ( visualResponse ) => {\n\n\t\t\tconst { valueNodeName, minNodeName, maxNodeName, valueNodeProperty } = visualResponse;\n\n\t\t\t// If animating a transform, find the two nodes to be interpolated between.\n\t\t\tif ( valueNodeProperty === MotionControllerConstants.VisualResponseProperty.TRANSFORM ) {\n\n\t\t\t\tvisualResponse.minNode = scene.getObjectByName( minNodeName );\n\t\t\t\tvisualResponse.maxNode = scene.getObjectByName( maxNodeName );\n\n\t\t\t\t// If the extents cannot be found, skip this animation\n\t\t\t\tif ( ! visualResponse.minNode ) {\n\n\t\t\t\t\tconsole.warn( `Could not find ${minNodeName} in the model` );\n\t\t\t\t\treturn;\n\n\t\t\t\t}\n\n\t\t\t\tif ( ! visualResponse.maxNode ) {\n\n\t\t\t\t\tconsole.warn( `Could not find ${maxNodeName} in the model` );\n\t\t\t\t\treturn;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\t// If the target node cannot be found, skip this animation\n\t\t\tvisualResponse.valueNode = scene.getObjectByName( valueNodeName );\n\t\t\tif ( ! visualResponse.valueNode ) {\n\n\t\t\t\tconsole.warn( `Could not find ${valueNodeName} in the model` );\n\n\t\t\t}\n\n\t\t} );\n\n\t} );\n\n}\n\nfunction addAssetSceneToControllerModel( controllerModel, scene ) {\n\n\t// Find the nodes needed for animation and cache them on the motionController.\n\tfindNodes( controllerModel.motionController, scene );\n\n\t// Apply any environment map that the mesh already has set.\n\tif ( controllerModel.envMap ) {\n\n\t\tscene.traverse( ( child ) => {\n\n\t\t\tif ( child.isMesh ) {\n\n\t\t\t\tchild.material.envMap = controllerModel.envMap;\n\t\t\t\tchild.material.needsUpdate = true;\n\n\t\t\t}\n\n\t\t} );\n\n\t}\n\n\t// Add the glTF scene to the controllerModel.\n\tcontrollerModel.add( scene );\n\n}\n\nclass XRControllerModelFactory {\n\n\tconstructor( gltfLoader = null ) {\n\n\t\tthis.gltfLoader = gltfLoader;\n\t\tthis.path = DEFAULT_PROFILES_PATH;\n\t\tthis._assetCache = {};\n\n\t\t// If a GLTFLoader wasn't supplied to the constructor create a new one.\n\t\tif ( ! this.gltfLoader ) {\n\n\t\t\tthis.gltfLoader = new GLTFLoader();\n\n\t\t}\n\n\t}\n\n\tcreateControllerModel( controller ) {\n\n\t\tconst controllerModel = new XRControllerModel();\n\t\tlet scene = null;\n\n\t\tcontroller.addEventListener( 'connected', ( event ) => {\n\n\t\t\tconst xrInputSource = event.data;\n\n\t\t\tif ( xrInputSource.targetRayMode !== 'tracked-pointer' || ! xrInputSource.gamepad ) return;\n\n\t\t\tfetchProfile( xrInputSource, this.path, DEFAULT_PROFILE ).then( ( { profile, assetPath } ) => {\n\n\t\t\t\tcontrollerModel.motionController = new MotionController(\n\t\t\t\t\txrInputSource,\n\t\t\t\t\tprofile,\n\t\t\t\t\tassetPath\n\t\t\t\t);\n\n\t\t\t\tconst cachedAsset = this._assetCache[ controllerModel.motionController.assetUrl ];\n\t\t\t\tif ( cachedAsset ) {\n\n\t\t\t\t\tscene = cachedAsset.scene.clone();\n\n\t\t\t\t\taddAssetSceneToControllerModel( controllerModel, scene );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tif ( ! this.gltfLoader ) {\n\n\t\t\t\t\t\tthrow new Error( 'GLTFLoader not set.' );\n\n\t\t\t\t\t}\n\n\t\t\t\t\tthis.gltfLoader.setPath( '' );\n\t\t\t\t\tthis.gltfLoader.load( controllerModel.motionController.assetUrl, ( asset ) => {\n\n\t\t\t\t\t\tthis._assetCache[ controllerModel.motionController.assetUrl ] = asset;\n\n\t\t\t\t\t\tscene = asset.scene.clone();\n\n\t\t\t\t\t\taddAssetSceneToControllerModel( controllerModel, scene );\n\n\t\t\t\t\t},\n\t\t\t\t\tnull,\n\t\t\t\t\t() => {\n\n\t\t\t\t\t\tthrow new Error( `Asset ${controllerModel.motionController.assetUrl} missing or malformed.` );\n\n\t\t\t\t\t} );\n\n\t\t\t\t}\n\n\t\t\t} ).catch( ( err ) => {\n\n\t\t\t\tconsole.warn( err );\n\n\t\t\t} );\n\n\t\t} );\n\n\t\tcontroller.addEventListener( 'disconnected', () => {\n\n\t\t\tcontrollerModel.motionController = null;\n\t\t\tcontrollerModel.remove( scene );\n\t\t\tscene = null;\n\n\t\t} );\n\n\t\treturn controllerModel;\n\n\t}\n\n}\n\nexport { XRControllerModelFactory };\n","/**\r\n * @author       Yannick Deubel (https://github.com/yandeu)\r\n * @copyright    Copyright (c) 2020 Yannick Deubel; Project Url: https://github.com/enable3d/enable3d\r\n * @license      {@link https://github.com/enable3d/enable3d/blob/master/LICENSE|GNU GPLv3}\r\n */\r\nimport * as THREE from 'three';\r\nimport { VRButton } from 'three/examples/jsm/webxr/VRButton';\r\nimport { XRControllerModelFactory } from 'three/examples/jsm/webxr/XRControllerModelFactory';\r\nexport default class WebXR {\r\n    constructor(_renderer, _scene, _camera) {\r\n        // https://medium.com/samsung-internet-dev/vr-locomotion-740dafa85914\r\n        this._renderer = _renderer;\r\n        this._scene = _scene;\r\n        this._camera = _camera;\r\n        this.controllerModelFactory = new XRControllerModelFactory();\r\n        // const geo = new THREE.SphereGeometry(0.5)\r\n        // const mat = new THREE.MeshLambertMaterial({ color: 0xff0000 })\r\n        // this.dot = new THREE.Mesh(geo, mat)\r\n        // this.dot.position.set(0, 1, 0)\r\n        this.cameraGroup = new THREE.Group();\r\n        this.cameraGroup.add(_camera);\r\n        _scene.add(this.cameraGroup);\r\n        _renderer.xr.enabled = true;\r\n        // add vr button\r\n        const vrButton = VRButton.createButton(_renderer);\r\n        vrButton.style.cssText += 'background: rgba(0, 0, 0, 0.8); ';\r\n        document.body.appendChild(vrButton);\r\n    }\r\n    get isPresenting() {\r\n        var _a, _b;\r\n        return !!((_b = (_a = this._renderer) === null || _a === void 0 ? void 0 : _a.xr) === null || _b === void 0 ? void 0 : _b.isPresenting);\r\n    }\r\n    getController(id) {\r\n        const controller = this._renderer.xr.getController(id);\r\n        this.cameraGroup.add(controller);\r\n        return controller;\r\n    }\r\n    getControllerGrip(id) {\r\n        const controllerGrip = this._renderer.xr.getControllerGrip(id);\r\n        const model = this.controllerModelFactory.createControllerModel(controllerGrip);\r\n        controllerGrip.add(model);\r\n        this.cameraGroup.add(controllerGrip);\r\n        return controllerGrip;\r\n    }\r\n    getControllerRay(data) {\r\n        // https://github.com/mrdoob/three.js/blob/master/examples/webxr_vr_ballshooter.html\r\n        const { targetRayMode } = data;\r\n        if (targetRayMode === 'tracked-pointer') {\r\n            const geometry = new THREE.BufferGeometry();\r\n            geometry.setAttribute('position', new THREE.Float32BufferAttribute([0, 0, 0, 0, 0, -1], 3));\r\n            geometry.setAttribute('color', new THREE.Float32BufferAttribute([1, 0, 0, 1, 1, 1], 3));\r\n            const material = new THREE.LineBasicMaterial({\r\n                vertexColors: true\r\n            });\r\n            return new THREE.Line(geometry, material);\r\n        }\r\n        if (targetRayMode === 'gaze') {\r\n            const geometry = new THREE.RingBufferGeometry(0.02, 0.04, 32).translate(0, 0, -1);\r\n            const material = new THREE.MeshBasicMaterial({ color: 'red', opacity: 0.5, transparent: true });\r\n            return new THREE.Mesh(geometry, material);\r\n        }\r\n        return;\r\n    }\r\n    get camera() {\r\n        return this.WebXRCamera;\r\n    }\r\n    get WebXRCamera() {\r\n        var _a;\r\n        return {\r\n            group: this.cameraGroup,\r\n            position: (_a = this.cameraGroup) === null || _a === void 0 ? void 0 : _a.position,\r\n            rotation: this.isPresenting ? this._renderer.xr.getCamera(this._camera).rotation : undefined,\r\n            getWorldDirection: (target) => this.isPresenting ? this._renderer.xr.getCamera(this._camera).getWorldDirection(target) : undefined\r\n        };\r\n    }\r\n}\r\n//# sourceMappingURL=webxr.js.map","class VRButton {\n\n\tstatic createButton( renderer, options ) {\n\n\t\tif ( options ) {\n\n\t\t\tconsole.error( 'THREE.VRButton: The \"options\" parameter has been removed. Please set the reference space type via renderer.xr.setReferenceSpaceType() instead.' );\n\n\t\t}\n\n\t\tconst button = document.createElement( 'button' );\n\n\t\tfunction showEnterVR( /*device*/ ) {\n\n\t\t\tlet currentSession = null;\n\n\t\t\tasync function onSessionStarted( session ) {\n\n\t\t\t\tsession.addEventListener( 'end', onSessionEnded );\n\n\t\t\t\tawait renderer.xr.setSession( session );\n\t\t\t\tbutton.textContent = 'EXIT VR';\n\n\t\t\t\tcurrentSession = session;\n\n\t\t\t}\n\n\t\t\tfunction onSessionEnded( /*event*/ ) {\n\n\t\t\t\tcurrentSession.removeEventListener( 'end', onSessionEnded );\n\n\t\t\t\tbutton.textContent = 'ENTER VR';\n\n\t\t\t\tcurrentSession = null;\n\n\t\t\t}\n\n\t\t\t//\n\n\t\t\tbutton.style.display = '';\n\n\t\t\tbutton.style.cursor = 'pointer';\n\t\t\tbutton.style.left = 'calc(50% - 50px)';\n\t\t\tbutton.style.width = '100px';\n\n\t\t\tbutton.textContent = 'ENTER VR';\n\n\t\t\tbutton.onmouseenter = function () {\n\n\t\t\t\tbutton.style.opacity = '1.0';\n\n\t\t\t};\n\n\t\t\tbutton.onmouseleave = function () {\n\n\t\t\t\tbutton.style.opacity = '0.5';\n\n\t\t\t};\n\n\t\t\tbutton.onclick = function () {\n\n\t\t\t\tif ( currentSession === null ) {\n\n\t\t\t\t\t// WebXR's requestReferenceSpace only works if the corresponding feature\n\t\t\t\t\t// was requested at session creation time. For simplicity, just ask for\n\t\t\t\t\t// the interesting ones as optional features, but be aware that the\n\t\t\t\t\t// requestReferenceSpace call will fail if it turns out to be unavailable.\n\t\t\t\t\t// ('local' is always available for immersive sessions and doesn't need to\n\t\t\t\t\t// be requested separately.)\n\n\t\t\t\t\tconst sessionInit = { optionalFeatures: [ 'local-floor', 'bounded-floor', 'hand-tracking', 'layers' ] };\n\t\t\t\t\tnavigator.xr.requestSession( 'immersive-vr', sessionInit ).then( onSessionStarted );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tcurrentSession.end();\n\n\t\t\t\t}\n\n\t\t\t};\n\n\t\t}\n\n\t\tfunction disableButton() {\n\n\t\t\tbutton.style.display = '';\n\n\t\t\tbutton.style.cursor = 'auto';\n\t\t\tbutton.style.left = 'calc(50% - 75px)';\n\t\t\tbutton.style.width = '150px';\n\n\t\t\tbutton.onmouseenter = null;\n\t\t\tbutton.onmouseleave = null;\n\n\t\t\tbutton.onclick = null;\n\n\t\t}\n\n\t\tfunction showWebXRNotFound() {\n\n\t\t\tdisableButton();\n\n\t\t\tbutton.textContent = 'VR NOT SUPPORTED';\n\n\t\t}\n\n\t\tfunction stylizeElement( element ) {\n\n\t\t\telement.style.position = 'absolute';\n\t\t\telement.style.bottom = '20px';\n\t\t\telement.style.padding = '12px 6px';\n\t\t\telement.style.border = '1px solid #fff';\n\t\t\telement.style.borderRadius = '4px';\n\t\t\telement.style.background = 'rgba(0,0,0,0.1)';\n\t\t\telement.style.color = '#fff';\n\t\t\telement.style.font = 'normal 13px sans-serif';\n\t\t\telement.style.textAlign = 'center';\n\t\t\telement.style.opacity = '0.5';\n\t\t\telement.style.outline = 'none';\n\t\t\telement.style.zIndex = '999';\n\n\t\t}\n\n\t\tif ( 'xr' in navigator ) {\n\n\t\t\tbutton.id = 'VRButton';\n\t\t\tbutton.style.display = 'none';\n\n\t\t\tstylizeElement( button );\n\n\t\t\tnavigator.xr.isSessionSupported( 'immersive-vr' ).then( function ( supported ) {\n\n\t\t\t\tsupported ? showEnterVR() : showWebXRNotFound();\n\n\t\t\t} );\n\n\t\t\treturn button;\n\n\t\t} else {\n\n\t\t\tconst message = document.createElement( 'a' );\n\n\t\t\tif ( window.isSecureContext === false ) {\n\n\t\t\t\tmessage.href = document.location.href.replace( /^http:/, 'https:' );\n\t\t\t\tmessage.innerHTML = 'WEBXR NEEDS HTTPS'; // TODO Improve message\n\n\t\t\t} else {\n\n\t\t\t\tmessage.href = 'https://immersiveweb.dev/';\n\t\t\t\tmessage.innerHTML = 'WEBXR NOT AVAILABLE';\n\n\t\t\t}\n\n\t\t\tmessage.style.left = 'calc(50% - 90px)';\n\t\t\tmessage.style.width = '180px';\n\t\t\tmessage.style.textDecoration = 'none';\n\n\t\t\tstylizeElement( message );\n\n\t\t\treturn message;\n\n\t\t}\n\n\t}\n\n}\n\nexport { VRButton };\n","/**\r\n * @author       Yannick Deubel (https://github.com/yandeu)\r\n * @copyright    Copyright (c) 2020 Yannick Deubel; Project Url: https://github.com/enable3d/enable3d\r\n * @license      {@link https://github.com/enable3d/enable3d/blob/master/LICENSE|GNU GPLv3}\r\n */\r\nimport { OrthographicCamera, PerspectiveCamera } from 'three';\r\nexport default class Cameras {\r\n    perspectiveCamera(config = {}) {\r\n        return Cameras.Perspective(config);\r\n    }\r\n    orthographicCamera(config = {}) {\r\n        return Cameras.Orthographic(config);\r\n    }\r\n    static Perspective(config = {}) {\r\n        // for phaser\r\n        // aspect = scene.scale.gameSize.aspectRatio\r\n        const { fov = 50, aspect = window.innerWidth / window.innerHeight, near = 0.1, far = 2000, x = 0, y = 5, z = 25 } = config;\r\n        const camera = new PerspectiveCamera(fov, aspect, near, far);\r\n        camera.position.set(x, y, z);\r\n        return camera;\r\n    }\r\n    static Orthographic(config = {}) {\r\n        // for phaser\r\n        // const { width, height } = scene.cameras.main\r\n        const width = window.innerWidth;\r\n        const height = window.innerHeight;\r\n        const { left = width / -2, right = width / 2, top = height / 2, bottom = height / -2, near = 1, far = 1000, x = 0, y = 0, z = 10 } = config;\r\n        const camera = new OrthographicCamera(left, right, top, bottom, near, far);\r\n        camera.position.set(x, y, z);\r\n        return camera;\r\n    }\r\n}\r\n//# sourceMappingURL=cameras.js.map","/**\r\n * @author       Yannick Deubel (https://github.com/yandeu)\r\n * @copyright    Copyright (c) 2020 Yannick Deubel; Project Url: https://github.com/enable3d/enable3d\r\n * @license      {@link https://github.com/enable3d/enable3d/blob/master/LICENSE|GNU GPLv3}\r\n */\r\n\r\nimport { ThreeGraphics } from '@enable3d/three-graphics/jsm'\r\nimport { EffectComposer } from 'three/examples/jsm/postprocessing/EffectComposer.js'\r\nimport { Clock, WebGLRenderer } from 'three'\r\nimport { ExtendedMesh, ExtendedObject3D } from '@enable3d/common/dist/types'\r\nimport { AmmoPhysics } from '@enable3d/ammo-physics'\r\nimport { CSG } from '@enable3d/three-graphics/jsm/csg'\r\n\r\nimport * as Plugins from '@enable3d/three-graphics/jsm/plugins'\r\n\r\n// https://www.typescriptlang.org/docs/handbook/utility-types.html Pick<T,K>\r\n// export class Scene3D implements Partial<ThreeGraphics> {\r\nexport class Scene3D implements Partial<ThreeGraphics> {\r\n  // core modules from three-graphics\r\n  public scenes: Map<string, Scene3D> = new Map()\r\n  public scene: ThreeGraphics['scene']\r\n  public camera: ThreeGraphics['camera']\r\n  public cache: ThreeGraphics['cache']\r\n  public physics: AmmoPhysics\r\n  public renderer: WebGLRenderer\r\n  public composer: EffectComposer\r\n  public parent: HTMLElement\r\n  public canvas: HTMLCanvasElement\r\n  public clock: Clock\r\n\r\n  // public plugins\r\n  public load: Plugins.Loaders\r\n  public lights: Plugins.Lights\r\n  public transform: Plugins.Transform\r\n  public heightMap: Plugins.HeightMap\r\n  public webXR: Plugins.WebXR\r\n  public misc: Plugins.Misc\r\n  public cameras: Plugins.Cameras\r\n\r\n  // other\r\n  public csg: typeof CSG\r\n\r\n  // private plugins\r\n  private factories: Plugins.Factories\r\n  private ws: Plugins.WarpSpeed\r\n  private mixers: Plugins.Mixers\r\n\r\n  public __config: any = {}\r\n  private _isRunning: boolean = false\r\n  private _deconstructor: any[] = []\r\n\r\n  constructor(private sceneConfig: { key?: string; enableXR?: boolean } = {}) {\r\n    const { key = Math.random().toString(), enableXR = false } = sceneConfig\r\n    this.__config.sceneKey = key\r\n    this.__config.enableXR = enableXR\r\n  }\r\n\r\n  public get deconstructor() {\r\n    return {\r\n      add: (...object: any[]) => {\r\n        object.forEach(o => {\r\n          this._deconstructor.push(o)\r\n        })\r\n      }\r\n    }\r\n  }\r\n\r\n  // @ts-ignore\r\n  public initializeScene(plugins: any) {\r\n    const { renderer, parent, canvas, scene, scenes, camera, cache, physics, sceneConfig } = plugins\r\n    this.scene = scene\r\n    this.scenes = scenes\r\n    this.camera = camera\r\n    this.cache = cache\r\n    this.physics = physics\r\n    this.renderer = renderer\r\n    this.parent = parent\r\n    this.canvas = canvas\r\n\r\n    const { autoStart, textureAnisotropy } = sceneConfig\r\n\r\n    // plugins\r\n    this.load = new Plugins.Loaders(this.cache, textureAnisotropy)\r\n    this.lights = new Plugins.Lights(this.scene)\r\n    this.transform = new Plugins.Transform(this.camera, this.renderer)\r\n    this.csg = CSG\r\n    this.heightMap = new Plugins.HeightMap(this.scene)\r\n    this.factories = new Plugins.Factories(this.scene)\r\n    this.misc = new Plugins.Misc(this.scene, this.renderer, this.factories)\r\n    this.ws = new Plugins.WarpSpeed(scene, renderer, camera, this.lights, this.physics, this.load, this.factories)\r\n    this.mixers = new Plugins.Mixers()\r\n    this.cameras = new Plugins.Cameras()\r\n\r\n    this.clock = new Clock()\r\n\r\n    // add vr camera\r\n    if (this.__config.enableXR) {\r\n      this.webXR = new Plugins.WebXR(this.renderer, this.scene, this.camera)\r\n    }\r\n\r\n    if (autoStart) this.start(this.__config.sceneKey)\r\n  }\r\n\r\n  public get sceneKey() {\r\n    return this.__config.sceneKey\r\n  }\r\n\r\n  /** Destroys a object and its body. */\r\n  public destroy(obj: ExtendedObject3D | ExtendedMesh) {\r\n    this.physics?.destroy(obj.body)\r\n    this.scene.remove(obj)\r\n    // @ts-ignore\r\n    obj = null\r\n  }\r\n  public async warpSpeed(...features: Plugins.WarpedStartFeatures[]): Promise<Plugins.WarpSpeedOptions> {\r\n    return await this.ws.warpSpeed(...features)\r\n  }\r\n  public get animationMixers() {\r\n    return this.mixers.mixers\r\n  }\r\n  public get make() {\r\n    return this.factories.make\r\n  }\r\n  public get add() {\r\n    return this.factories.add\r\n  }\r\n  public haveSomeFun(numberOfElements: number = 20) {\r\n    Plugins.HaveSomeFun(numberOfElements, this.physics)\r\n  }\r\n\r\n  public isRunning() {\r\n    return this._isRunning\r\n  }\r\n\r\n  public async start(key?: string, data?: any) {\r\n    // start another scene\r\n    // and stop this one\r\n    if (key && key !== this.__config.sceneKey) {\r\n      this.stop()\r\n      this.scenes.get(key)?._start(data)\r\n    } else {\r\n      this._start(data)\r\n    }\r\n  }\r\n\r\n  private async _start(data?: any) {\r\n    await this.init?.(data)\r\n    await this._preload()\r\n    await this._create()\r\n\r\n    // console.log('start')\r\n\r\n    this.renderer.setAnimationLoop(() => {\r\n      this._update()\r\n    })\r\n\r\n    this._isRunning = true\r\n  }\r\n\r\n  public async restart(data?: any) {\r\n    await this.stop()\r\n    await this.start(this.__config.sceneKey, data)\r\n  }\r\n\r\n  public async stop() {\r\n    this._isRunning = false\r\n    this.renderer.setAnimationLoop(null)\r\n\r\n    // reset clock\r\n    this.clock.start()\r\n\r\n    for (let object of this._deconstructor) {\r\n      await object.dispose?.()\r\n      await object.destroy?.()\r\n      if (typeof object === 'function') await object?.()\r\n      object = null\r\n    }\r\n    this._deconstructor = []\r\n\r\n    // destroy all rigid bodies\r\n    if (this.physics?.rigidBodies)\r\n      for (let i = this.physics.rigidBodies.length - 1; i >= 0; i--) {\r\n        this.physics.destroy(this.physics.rigidBodies[i])\r\n      }\r\n\r\n    // destroy all three objects\r\n    for (let i = this.scene.children.length - 1; i >= 0; i--) {\r\n      this.scene.remove(this.scene.children[i])\r\n    }\r\n  }\r\n\r\n  public setSize(width: number, height: number) {\r\n    this.renderer.setSize(width, height)\r\n    // @ts-ignore\r\n    if (typeof this.camera.aspect !== 'undefined') this.camera.aspect = width / height\r\n    this.camera.updateProjectionMatrix()\r\n  }\r\n\r\n  public setPixelRatio(ratio: number) {\r\n    this.renderer.setPixelRatio(ratio)\r\n  }\r\n\r\n  // public get controls() {\r\n  //   return {\r\n  //     pointerDrag: (autoStart = true) => new PointerDrag(this.canvas, autoStart),\r\n  //     pointerLock: (autoLock = true) => new PointerLock(this.canvas, autoLock),\r\n  //     joystick: () => new JoyStick(),\r\n  //     firstPerson: (target: ExtendedObject3D, config: FirstPersonControlsConfig = {}) =>\r\n  //       new FirstPersonControls(this.camera, target, config),\r\n  //     thirdPerson: (target: ExtendedObject3D, config: ThirdPersonControlsConfig = {}) =>\r\n  //       new ThirdPersonControls(this.camera, target, config)\r\n  //   }\r\n  // }\r\n\r\n  // @ts-ignore\r\n  public init(data: any = {}) {}\r\n  public preload() {}\r\n  public create() {}\r\n  public update(_time: number, _delta: number) {}\r\n  /** Will be called before THREE.WebGLRenderer.render() */\r\n  public preRender() {}\r\n  /** Will be called after THREE.WebGLRenderer.render() */\r\n  public postRender() {}\r\n\r\n  private async _preload() {\r\n    await this.preload?.()\r\n  }\r\n  private async _create() {\r\n    await this.create?.()\r\n  }\r\n  private _update() {\r\n    const delta = this.clock.getDelta() * 1000\r\n    const time = this.clock.getElapsedTime()\r\n\r\n    this.update?.(parseFloat(time.toFixed(3)), parseInt(delta.toString()))\r\n    this.physics?.update(delta)\r\n    this.physics?.updateDebugger()\r\n\r\n    this.animationMixers.update(delta)\r\n\r\n    this.preRender()\r\n    if (this.composer) this.composer.render()\r\n    else this.renderer.render(this.scene, this.camera)\r\n    this.postRender()\r\n  }\r\n}\r\n","import { AnimationMixer } from 'three';\r\nclass Mixers {\r\n    constructor() {\r\n        this._mixers = [];\r\n    }\r\n    /**\r\n     * Create an Animation Mixer and ads it to the mixers array\r\n     */\r\n    animationMixer(root) {\r\n        const mixer = new AnimationMixer(root);\r\n        this.mixers.add(mixer);\r\n        return mixer;\r\n    }\r\n    get mixers() {\r\n        return {\r\n            create: (root) => this.animationMixer(root),\r\n            add: (animationMixer) => this._mixers.push(animationMixer),\r\n            get: () => this._mixers,\r\n            update: (delta) => { var _a; return (_a = this._mixers) === null || _a === void 0 ? void 0 : _a.forEach(mixer => mixer.update(delta / 1000)); }\r\n        };\r\n    }\r\n}\r\nexport default Mixers;\r\n//# sourceMappingURL=mixers.js.map","const HaveSomeFun = (numberOfElements = 20, physics) => {\r\n    if (!window.__loadPhysics) {\r\n        console.log('There is not much fun without physics enabled!');\r\n        return;\r\n    }\r\n    // adding some boxes (with physics)\r\n    for (let i = 0; i < numberOfElements; i++) {\r\n        const materials = ['standard', 'basic', 'normal', 'phong', 'line', 'points'];\r\n        const Between = (min, max) => Math.floor(Math.random() * (max - min + 1) + min);\r\n        const RandomPick = (array) => array[Math.floor(Math.random() * array.length)];\r\n        if (Math.random() > 0.5) {\r\n            physics.add\r\n                .box({\r\n                x: Between(-10, 10),\r\n                y: Between(10, 20),\r\n                z: Between(-10, 10),\r\n                width: Between(1, 2) / 10,\r\n                height: Between(1, 2) / 10,\r\n                depth: Between(1, 2) / 10,\r\n                mass: 1\r\n            }, { [RandomPick(materials)]: { color: Math.floor(Math.random() * 0xffffff) } })\r\n                .body.setRestitution(Math.floor(Math.random() * 10) / 20);\r\n        }\r\n        else {\r\n            physics.add\r\n                .sphere({\r\n                x: Between(-10, 10),\r\n                y: Between(10, 20),\r\n                z: Between(-10, 10),\r\n                radius: Between(1, 2) / 10,\r\n                mass: 1\r\n            }, { [RandomPick(materials)]: { color: Math.floor(Math.random() * 0xffffff) } })\r\n                .body.setRestitution(Math.floor(Math.random() * 10) / 20);\r\n        }\r\n    }\r\n};\r\nexport default HaveSomeFun;\r\n//# sourceMappingURL=haveSomeFun.js.map","/**\r\n * @author       Yannick Deubel (https://github.com/yandeu)\r\n * @copyright    Copyright (c) 2021 Yannick Deubel; Project Url: https://github.com/enable3d/enable3d\r\n * @license      {@link https://github.com/enable3d/enable3d/blob/master/LICENSE|GNU GPLv3}\r\n */\r\nimport { AnimationMixer, LoopOnce, Object3D, Vector3 } from 'three';\r\nimport { logger } from './logger';\r\nexport class ExtendedObject3D extends Object3D {\r\n    constructor() {\r\n        super();\r\n        this.isExtendedObject3D = true;\r\n        this.isGroup = false;\r\n        this.vector3 = new Vector3();\r\n        this.hasBody = false;\r\n        // convex object breaking\r\n        this.fragmentDepth = 0;\r\n        this.breakable = false;\r\n        this.fractureImpulse = 1;\r\n        this._currentAnimation = '';\r\n        this._animationActions = new Map();\r\n        this.name = `object-${this.id}`;\r\n    }\r\n    /** Returns all values relative to the world. */\r\n    get world() {\r\n        return {\r\n            theta: this.worldTheta,\r\n            phi: this.worldPhi\r\n        };\r\n    }\r\n    /** Get the theta relative to the world. */\r\n    get worldTheta() {\r\n        this.getWorldDirection(this.vector3);\r\n        return Math.atan2(this.vector3.x, this.vector3.z);\r\n    }\r\n    /** Get the phi relative to the world. */\r\n    get worldPhi() {\r\n        this.getWorldDirection(this.vector3);\r\n        return Math.acos(this.vector3.y);\r\n    }\r\n    set animationMixer(animationMixer) {\r\n        this._animationMixer = animationMixer;\r\n    }\r\n    get animationMixer() {\r\n        if (!this._animationMixer)\r\n            this._animationMixer = new AnimationMixer(this);\r\n        return this._animationMixer;\r\n    }\r\n    /** Control your animations. */\r\n    get anims() {\r\n        return {\r\n            /** Get the name of the current animation. */\r\n            current: this._currentAnimation,\r\n            /** Add animation name and the AnimationClip. */\r\n            add: (name, animation) => this._animsAdd(name, animation),\r\n            /** Get AnimationAction by animation name. */\r\n            get: (name) => this._animsGet(name),\r\n            /**\r\n             * Play an animation.\r\n             * @param name Animation name.\r\n             * @param transitionDuration Transition duration in ms.\r\n             * @param loop Should the animation loop?\r\n             */\r\n            play: (name, transitionDuration = 500, loop = true) => this._animsPlay(name, transitionDuration, loop),\r\n            /** Get the AnimationMixer */\r\n            mixer: this.animationMixer\r\n        };\r\n    }\r\n    /** @deprecated Please use anims instead! */\r\n    get animation() {\r\n        logger('Please use \"anims\" instead of \"animation\"');\r\n        return this.anims;\r\n    }\r\n    _animsAdd(name, animation) {\r\n        this._animationActions.set(name, this.animationMixer.clipAction(animation));\r\n    }\r\n    _animsGet(name) {\r\n        const action = this._animationActions.get(name);\r\n        if (!action)\r\n            logger(`Animation(${name}) not found!`);\r\n        return action;\r\n    }\r\n    _animsPlay(name, transitionDuration = 500, loop = true) {\r\n        const next = this._animationActions.get(name);\r\n        const current = this._animationActions.get(this._currentAnimation);\r\n        if (next) {\r\n            next.reset();\r\n            if (current) {\r\n                next.crossFadeFrom(current, transitionDuration / 1000, true);\r\n                next.clampWhenFinished = true;\r\n            }\r\n            if (!loop)\r\n                next.setLoop(LoopOnce, 0);\r\n            next.play();\r\n        }\r\n        this._currentAnimation = name;\r\n    }\r\n    /** @deprecated Use animation.play(name) instead! */\r\n    setAction(name) {\r\n        logger(`setAction(${name}) is deprecated. Use animation.play(${name}) instead!`);\r\n    }\r\n    traverse(callback) {\r\n        super.traverse(callback);\r\n    }\r\n    traverseVisible(callback) {\r\n        super.traverseVisible(callback);\r\n    }\r\n    traverseAncestors(callback) {\r\n        super.traverseAncestors(callback);\r\n    }\r\n}\r\nexport default ExtendedObject3D;\r\n//# sourceMappingURL=extendedObject3D.js.map","/**\r\n * @author       Yannick Deubel (https://github.com/yandeu)\r\n * @copyright    Copyright (c) 2021 Yannick Deubel; Project Url: https://github.com/enable3d/enable3d\r\n * @license      {@link https://github.com/enable3d/enable3d/blob/master/LICENSE|GNU GPLv3}\r\n */\r\nimport { Group } from 'three';\r\nexport class ExtendedGroup extends Group {\r\n    constructor() {\r\n        super();\r\n        this.isExtendedGroup = true;\r\n        this.isMesh = false;\r\n        this.hasBody = false;\r\n        // convex object breaking\r\n        this.fragmentDepth = 0;\r\n        this.breakable = false;\r\n        this.fractureImpulse = 1;\r\n        this.name = `object-${this.id}`;\r\n    }\r\n}\r\n//# sourceMappingURL=extendedGroup.js.map","/**\r\n * @author       Yannick Deubel (https://github.com/yandeu)\r\n * @copyright    Copyright (c) 2020 Yannick Deubel; Project Url: https://github.com/enable3d/enable3d\r\n * @license      {@link https://github.com/enable3d/enable3d/blob/master/LICENSE|GNU GPLv3}\r\n */\r\nexport default class Constraints {\r\n    constructor(worldTransform, physicsWorld) {\r\n        this.worldTransform = worldTransform;\r\n        this.physicsWorld = physicsWorld;\r\n        this.tmpBtVector3 = new Ammo.btVector3();\r\n    }\r\n    toAmmoV3(v, d = 0) {\r\n        return new Ammo.btVector3(typeof (v === null || v === void 0 ? void 0 : v.x) !== 'undefined' ? v.x : d, typeof (v === null || v === void 0 ? void 0 : v.y) !== 'undefined' ? v.y : d, typeof (v === null || v === void 0 ? void 0 : v.z) !== 'undefined' ? v.z : d);\r\n    }\r\n    get addConstraints() {\r\n        return {\r\n            lock: (bodyA, bodyB, disableCollisionsBetweenLinkedBodies) => this.lock(bodyA, bodyB, disableCollisionsBetweenLinkedBodies),\r\n            fixed: (bodyA, bodyB, disableCollisionsBetweenLinkedBodies) => this.fixed(bodyA, bodyB, disableCollisionsBetweenLinkedBodies),\r\n            pointToPoint: (bodyA, bodyB, config, disableCollisionsBetweenLinkedBodies) => this.pointToPoint(bodyA, bodyB, config, disableCollisionsBetweenLinkedBodies),\r\n            hinge: (bodyA, bodyB, config, disableCollisionsBetweenLinkedBodies) => this.hinge(bodyA, bodyB, config, disableCollisionsBetweenLinkedBodies),\r\n            slider: (bodyA, bodyB, config = {}, disableCollisionsBetweenLinkedBodies) => this.slider(bodyA, bodyB, config, disableCollisionsBetweenLinkedBodies),\r\n            spring: (bodyA, bodyB, config = {}, disableCollisionsBetweenLinkedBodies) => this.spring(bodyA, bodyB, config, disableCollisionsBetweenLinkedBodies),\r\n            coneTwist: (bodyA, bodyB, config = { frameA: {}, frameB: {} }, disableCollisionsBetweenLinkedBodies) => this.coneTwist(bodyA, bodyB, config, disableCollisionsBetweenLinkedBodies),\r\n            dof: (bodyA, bodyB, config, disableCollisionsBetweenLinkedBodies) => this.dof(bodyA, bodyB, config, disableCollisionsBetweenLinkedBodies)\r\n        };\r\n    }\r\n    getTransform(bodyA, bodyB, offset = { x: 0, y: 0, z: 0 }, center = false) {\r\n        // @ts-ignore\r\n        offset = Object.assign({ x: 0, y: 0, z: 0 }, offset);\r\n        const centerVector = (v1, v2) => {\r\n            var dx = (v1.x() - v2.x()) / 2 + offset.x;\r\n            var dy = (v1.y() - v2.y()) / 2 + offset.y;\r\n            var dz = (v1.z() - v2.z()) / 2 + offset.z;\r\n            return new Ammo.btVector3(dx, dy, dz);\r\n        };\r\n        const transformB = new Ammo.btTransform();\r\n        transformB.setIdentity();\r\n        if (!center) {\r\n            // offset\r\n            transformB.setOrigin(new Ammo.btVector3(offset.x, offset.y, offset.z));\r\n            const transformA = bodyA.getCenterOfMassTransform().inverse().op_mul(bodyB.getWorldTransform()).op_mul(transformB);\r\n            return { transformA: transformA, transformB: transformB };\r\n        }\r\n        else {\r\n            const center = centerVector(bodyA.getWorldTransform().getOrigin(), bodyB.getWorldTransform().getOrigin());\r\n            const transformB = new Ammo.btTransform();\r\n            transformB.setIdentity();\r\n            transformB.setOrigin(center);\r\n            const transformA = bodyA.getCenterOfMassTransform().inverse().op_mul(bodyB.getWorldTransform());\r\n            transformA.op_mul(transformB);\r\n            return { transformA: transformA, transformB: transformB };\r\n        }\r\n    }\r\n    lock(bodyA, bodyB, disableCollisionsBetweenLinkedBodies = true) {\r\n        const zero = { x: 0, y: 0, z: 0 };\r\n        return this.dof(bodyA, bodyB, { angularLowerLimit: zero, angularUpperLimit: zero }, disableCollisionsBetweenLinkedBodies);\r\n    }\r\n    fixed(bodyA, bodyB, disableCollisionsBetweenLinkedBodies = true) {\r\n        const transform = this.getTransform(bodyA.ammo, bodyB.ammo);\r\n        transform.transformA.setRotation(bodyA.ammo.getWorldTransform().getRotation());\r\n        transform.transformB.setRotation(bodyB.ammo.getWorldTransform().getRotation());\r\n        const constraint = new Ammo.btFixedConstraint(bodyA.ammo, bodyB.ammo, transform.transformA, transform.transformB);\r\n        this.physicsWorld.addConstraint(constraint, disableCollisionsBetweenLinkedBodies);\r\n        return constraint;\r\n    }\r\n    pointToPoint(bodyA, bodyB, config = {}, disableCollisionsBetweenLinkedBodies = true) {\r\n        const { pivotA, pivotB } = config;\r\n        const pivotV3 = new Ammo.btVector3((pivotA === null || pivotA === void 0 ? void 0 : pivotA.x) || 0, (pivotA === null || pivotA === void 0 ? void 0 : pivotA.y) || 0, (pivotA === null || pivotA === void 0 ? void 0 : pivotA.z) || 0);\r\n        const targetPivotV3 = new Ammo.btVector3((pivotB === null || pivotB === void 0 ? void 0 : pivotB.x) || 0, (pivotB === null || pivotB === void 0 ? void 0 : pivotB.y) || 0, (pivotB === null || pivotB === void 0 ? void 0 : pivotB.z) || 0);\r\n        const constraint = new Ammo.btPoint2PointConstraint(bodyA.ammo, bodyB.ammo, pivotV3, targetPivotV3);\r\n        this.physicsWorld.addConstraint(constraint, disableCollisionsBetweenLinkedBodies);\r\n        return constraint;\r\n    }\r\n    hinge(bodyA, bodyB, config = {}, disableCollisionsBetweenLinkedBodies = true) {\r\n        const { pivotA, pivotB, axisA, axisB } = config;\r\n        const pivotV3 = new Ammo.btVector3((pivotA === null || pivotA === void 0 ? void 0 : pivotA.x) || 0, (pivotA === null || pivotA === void 0 ? void 0 : pivotA.y) || 0, (pivotA === null || pivotA === void 0 ? void 0 : pivotA.z) || 0);\r\n        const targetPivotV3 = new Ammo.btVector3((pivotB === null || pivotB === void 0 ? void 0 : pivotB.x) || 0, (pivotB === null || pivotB === void 0 ? void 0 : pivotB.y) || 0, (pivotB === null || pivotB === void 0 ? void 0 : pivotB.z) || 0);\r\n        const axisV3 = new Ammo.btVector3((axisA === null || axisA === void 0 ? void 0 : axisA.x) || 0, (axisA === null || axisA === void 0 ? void 0 : axisA.y) || 0, (axisA === null || axisA === void 0 ? void 0 : axisA.z) || 0);\r\n        const targetAxisV3 = new Ammo.btVector3((axisB === null || axisB === void 0 ? void 0 : axisB.x) || 0, (axisB === null || axisB === void 0 ? void 0 : axisB.y) || 0, (axisB === null || axisB === void 0 ? void 0 : axisB.z) || 0);\r\n        const constraint = new Ammo.btHingeConstraint(bodyA.ammo, bodyB.ammo, pivotV3, targetPivotV3, axisV3, targetAxisV3, true);\r\n        this.physicsWorld.addConstraint(constraint, disableCollisionsBetweenLinkedBodies);\r\n        return constraint;\r\n    }\r\n    // https://pybullet.org/Bullet/phpBB3/viewtopic.php?f=9&t=12690&p=42152&hilit=btSliderConstraint#p42152\r\n    slider(bodyA, bodyB, config = {}, disableCollisionsBetweenLinkedBodies = true) {\r\n        const transform = this.getTransform(bodyA.ammo, bodyB.ammo);\r\n        const { frameA = {}, frameB = {}, linearLowerLimit: lll = 0, linearUpperLimit: lul = 0, angularLowerLimit: all = 0, angularUpperLimit: aul = 0 } = config;\r\n        const rotationA = transform.transformA.getRotation();\r\n        rotationA.setEulerZYX(frameA.x || 0, frameA.y || 0, frameA.z || 0);\r\n        transform.transformA.setRotation(rotationA);\r\n        const rotationB = transform.transformB.getRotation();\r\n        rotationB.setEulerZYX(frameB.x || 0, frameB.y || 0, frameB.z || 0);\r\n        transform.transformB.setRotation(rotationB);\r\n        const constraint = new Ammo.btSliderConstraint(bodyA.ammo, bodyB.ammo, transform.transformA, transform.transformB, true);\r\n        constraint.setLowerLinLimit(lll);\r\n        constraint.setUpperLinLimit(lul);\r\n        constraint.setLowerAngLimit(all);\r\n        constraint.setUpperAngLimit(aul);\r\n        this.physicsWorld.addConstraint(constraint, disableCollisionsBetweenLinkedBodies);\r\n        return constraint;\r\n    }\r\n    spring(bodyA, bodyB, config = {}, disableCollisionsBetweenLinkedBodies = true) {\r\n        const { stiffness = 50, damping = 0.01, angularLock = false, linearLowerLimit: lll = {}, linearUpperLimit: lul = {}, angularLowerLimit: all = {}, angularUpperLimit: aul = {}, offset = {}, center = false, enableSpring = true } = config;\r\n        const off = Object.assign({ x: 0, y: 0, z: 0 }, offset);\r\n        const transform = this.getTransform(bodyA.ammo, bodyB.ammo, off, center);\r\n        const constraint = new Ammo.btGeneric6DofSpringConstraint(bodyA.ammo, bodyB.ammo, transform.transformA, transform.transformB, true);\r\n        this.tmpBtVector3.setValue(lll.x || 0, lll.y || 0, lll.z || 0);\r\n        constraint.setLinearLowerLimit(this.tmpBtVector3);\r\n        this.tmpBtVector3.setValue(lul.x || 0, lul.y || 0, lul.z || 0);\r\n        constraint.setLinearUpperLimit(this.tmpBtVector3);\r\n        if (angularLock) {\r\n            this.tmpBtVector3.setValue(0, 0, 0);\r\n            constraint.setAngularLowerLimit(this.tmpBtVector3);\r\n            constraint.setAngularUpperLimit(this.tmpBtVector3);\r\n        }\r\n        else {\r\n            console.log(all, aul);\r\n            constraint.setAngularLowerLimit(this.toAmmoV3(all, -Math.PI));\r\n            constraint.setAngularUpperLimit(this.toAmmoV3(aul, Math.PI));\r\n        }\r\n        for (let i = 0; i < 3; i++) {\r\n            constraint.enableSpring(i, enableSpring);\r\n            constraint.setStiffness(i, stiffness);\r\n            constraint.setDamping(i, damping);\r\n        }\r\n        // I have no idea what setEquilibriumPoint does :/\r\n        // constraint.setEquilibriumPoint()\r\n        this.physicsWorld.addConstraint(constraint, disableCollisionsBetweenLinkedBodies);\r\n        return constraint;\r\n    }\r\n    coneTwist(bodyA, bodyB, config, disableCollisionsBetweenLinkedBodies = true) {\r\n        const { frameA, frameB } = config;\r\n        const rbAFrame = new Ammo.btTransform();\r\n        rbAFrame.setIdentity();\r\n        rbAFrame.getOrigin().setValue((frameA === null || frameA === void 0 ? void 0 : frameA.x) || 0, (frameA === null || frameA === void 0 ? void 0 : frameA.y) || 0, (frameA === null || frameA === void 0 ? void 0 : frameA.z) || 0);\r\n        const rbBFrame = new Ammo.btTransform();\r\n        rbBFrame.setIdentity();\r\n        rbBFrame.getOrigin().setValue((frameB === null || frameB === void 0 ? void 0 : frameB.x) || 0, (frameB === null || frameB === void 0 ? void 0 : frameB.y) || 0, (frameB === null || frameB === void 0 ? void 0 : frameB.z) || 0);\r\n        const t = this.getTransform(bodyA.ammo, bodyB.ammo);\r\n        const constraint = new Ammo.btConeTwistConstraint(bodyB.ammo, bodyA.ammo, rbAFrame, rbBFrame);\r\n        // does not work at all :/\r\n        // constraint.setLimit(-Math.PI / 50, Math.PI / 50)\r\n        constraint.setAngularOnly(true);\r\n        this.physicsWorld.addConstraint(constraint, disableCollisionsBetweenLinkedBodies);\r\n        return constraint;\r\n    }\r\n    dof(bodyA, bodyB, config = {}, disableCollisionsBetweenLinkedBodies = true) {\r\n        const { offset, center = false } = config;\r\n        const off = Object.assign({ x: 0, y: 0, z: 0 }, offset);\r\n        const transform = this.getTransform(bodyA.ammo, bodyB.ammo, off, center);\r\n        const constraint = new Ammo.btGeneric6DofConstraint(bodyA.ammo, bodyB.ammo, transform.transformA, transform.transformB, true);\r\n        const { linearLowerLimit, linearUpperLimit, angularLowerLimit, angularUpperLimit } = config;\r\n        const lll = this.toAmmoV3(linearLowerLimit);\r\n        const lul = this.toAmmoV3(linearUpperLimit);\r\n        const all = this.toAmmoV3(angularLowerLimit, -Math.PI);\r\n        const aul = this.toAmmoV3(angularUpperLimit, Math.PI);\r\n        constraint.setLinearLowerLimit(lll);\r\n        constraint.setLinearUpperLimit(lul);\r\n        constraint.setAngularLowerLimit(all);\r\n        constraint.setAngularUpperLimit(aul);\r\n        Ammo.destroy(lll);\r\n        Ammo.destroy(lul);\r\n        Ammo.destroy(all);\r\n        Ammo.destroy(aul);\r\n        this.physicsWorld.addConstraint(constraint, disableCollisionsBetweenLinkedBodies);\r\n        return constraint;\r\n    }\r\n}\r\n//# sourceMappingURL=constraints.js.map","/**\r\n * @author       Yannick Deubel (https://github.com/yandeu)\r\n * @copyright    Copyright (c) 2020 Yannick Deubel; Project Url: https://github.com/enable3d/enable3d\r\n * @description  This is a modified version of the original code from Kevin Lee\r\n * (Includes latest three-to-ammo commit from August 6, 2020)\r\n */\r\n/**\r\n * @author       Kevin Lee (https://github.com/InfiniteLee)\r\n * @copyright    Copyright (c) 2020 Kevin Lee; Project Url: https://github.com/InfiniteLee/three-to-ammo\r\n * @license      {@link https://github.com/InfiniteLee/three-to-ammo/blob/master/LICENSE|MPL-2.0}\r\n */\r\nimport { Vector3, Matrix4, Quaternion, Box3, REVISION } from 'three';\r\n('use strict');\r\n/* global Ammo */\r\nexport const TYPE = {\r\n    BOX: 'box',\r\n    CYLINDER: 'cylinder',\r\n    SPHERE: 'sphere',\r\n    CAPSULE: 'capsule',\r\n    CONE: 'cone',\r\n    HULL: 'hull',\r\n    HACD: 'hacd',\r\n    VHACD: 'vhacd',\r\n    MESH: 'mesh',\r\n    HEIGHTFIELD: 'heightfield'\r\n};\r\nexport const FIT = {\r\n    ALL: 'all',\r\n    MANUAL: 'manual' //A single shape is sized manually. Requires halfExtents or sphereRadius.\r\n};\r\nexport const HEIGHTFIELD_DATA_TYPE = {\r\n    short: 'short',\r\n    float: 'float'\r\n};\r\nexport const createCollisionShapes = function (vertices, matrices, indexes, matrixWorld, options = {}) {\r\n    switch (options.type) {\r\n        case TYPE.BOX:\r\n            return [createBoxShape(vertices, matrices, matrixWorld, options)];\r\n        case TYPE.CYLINDER:\r\n            return [createCylinderShape(vertices, matrices, matrixWorld, options)];\r\n        case TYPE.CAPSULE:\r\n            return [createCapsuleShape(vertices, matrices, matrixWorld, options)];\r\n        case TYPE.CONE:\r\n            return [createConeShape(vertices, matrices, matrixWorld, options)];\r\n        case TYPE.SPHERE:\r\n            return [createSphereShape(vertices, matrices, matrixWorld, options)];\r\n        case TYPE.HULL:\r\n            return [createHullShape(vertices, matrices, matrixWorld, options)];\r\n        case TYPE.HACD:\r\n            return createHACDShapes(vertices, matrices, indexes, matrixWorld, options);\r\n        case TYPE.VHACD:\r\n            return createVHACDShapes(vertices, matrices, indexes, matrixWorld, options);\r\n        case TYPE.MESH:\r\n            return [createTriMeshShape(vertices, matrices, indexes, matrixWorld, options)];\r\n        case TYPE.HEIGHTFIELD:\r\n            return [createHeightfieldTerrainShape(options)];\r\n        default:\r\n            console.warn(options.type + ' is not currently supported');\r\n            return [];\r\n    }\r\n};\r\n//TODO: support gimpact (dynamic trimesh) and heightmap\r\nexport const createBoxShape = function (vertices, matrices, matrixWorld, options = {}) {\r\n    options.type = TYPE.BOX;\r\n    _setOptions(options);\r\n    if (options.fit === FIT.ALL) {\r\n        options.halfExtents = _computeHalfExtents(_computeBounds(vertices, matrices), options.minHalfExtent, options.maxHalfExtent);\r\n    }\r\n    const btHalfExtents = new Ammo.btVector3(options.halfExtents.x, options.halfExtents.y, options.halfExtents.z);\r\n    const collisionShape = new Ammo.btBoxShape(btHalfExtents);\r\n    Ammo.destroy(btHalfExtents);\r\n    _finishCollisionShape(collisionShape, options, _computeScale(matrixWorld, options));\r\n    return collisionShape;\r\n};\r\nexport const createCylinderShape = function (vertices, matrices, matrixWorld, options = {}) {\r\n    options.type = TYPE.CYLINDER;\r\n    _setOptions(options);\r\n    if (options.fit === FIT.ALL) {\r\n        options.halfExtents = _computeHalfExtents(_computeBounds(vertices, matrices), options.minHalfExtent, options.maxHalfExtent);\r\n    }\r\n    const btHalfExtents = new Ammo.btVector3(options.halfExtents.x, options.halfExtents.y, options.halfExtents.z);\r\n    const collisionShape = (() => {\r\n        switch (options.cylinderAxis) {\r\n            case 'y':\r\n                return new Ammo.btCylinderShape(btHalfExtents);\r\n            case 'x':\r\n                return new Ammo.btCylinderShapeX(btHalfExtents);\r\n            case 'z':\r\n                return new Ammo.btCylinderShapeZ(btHalfExtents);\r\n        }\r\n        return null;\r\n    })();\r\n    Ammo.destroy(btHalfExtents);\r\n    _finishCollisionShape(collisionShape, options, _computeScale(matrixWorld, options));\r\n    return collisionShape;\r\n};\r\nexport const createCapsuleShape = function (vertices, matrices, matrixWorld, options = {}) {\r\n    options.type = TYPE.CAPSULE;\r\n    _setOptions(options);\r\n    if (options.fit === FIT.ALL) {\r\n        options.halfExtents = _computeHalfExtents(_computeBounds(vertices, matrices), options.minHalfExtent, options.maxHalfExtent);\r\n    }\r\n    const { x, y, z } = options.halfExtents;\r\n    const collisionShape = (() => {\r\n        switch (options.cylinderAxis) {\r\n            case 'y':\r\n                return new Ammo.btCapsuleShape(Math.max(x, z), y * 2);\r\n            case 'x':\r\n                return new Ammo.btCapsuleShapeX(Math.max(y, z), x * 2);\r\n            case 'z':\r\n                return new Ammo.btCapsuleShapeZ(Math.max(x, y), z * 2);\r\n        }\r\n        return null;\r\n    })();\r\n    _finishCollisionShape(collisionShape, options, _computeScale(matrixWorld, options));\r\n    return collisionShape;\r\n};\r\nexport const createConeShape = function (vertices, matrices, matrixWorld, options = {}) {\r\n    options.type = TYPE.CONE;\r\n    _setOptions(options);\r\n    if (options.fit === FIT.ALL) {\r\n        options.halfExtents = _computeHalfExtents(_computeBounds(vertices, matrices), options.minHalfExtent, options.maxHalfExtent);\r\n    }\r\n    const { x, y, z } = options.halfExtents;\r\n    const collisionShape = (() => {\r\n        switch (options.cylinderAxis) {\r\n            case 'y':\r\n                return new Ammo.btConeShape(Math.max(x, z), y * 2);\r\n            case 'x':\r\n                return new Ammo.btConeShapeX(Math.max(y, z), x * 2);\r\n            case 'z':\r\n                return new Ammo.btConeShapeZ(Math.max(x, y), z * 2);\r\n        }\r\n        return null;\r\n    })();\r\n    _finishCollisionShape(collisionShape, options, _computeScale(matrixWorld, options));\r\n    return collisionShape;\r\n};\r\nexport const createSphereShape = function (vertices, matrices, matrixWorld, options = {}) {\r\n    options.type = TYPE.SPHERE;\r\n    _setOptions(options);\r\n    let radius;\r\n    if (options.fit === FIT.MANUAL && !isNaN(options.sphereRadius)) {\r\n        radius = options.sphereRadius;\r\n    }\r\n    else {\r\n        radius = _computeRadius(vertices, matrices, _computeBounds(vertices, matrices));\r\n    }\r\n    const collisionShape = new Ammo.btSphereShape(radius);\r\n    _finishCollisionShape(collisionShape, options, _computeScale(matrixWorld, options));\r\n    return collisionShape;\r\n};\r\nexport const createHullShape = (function () {\r\n    const vertex = new Vector3();\r\n    const center = new Vector3();\r\n    const matrix = new Matrix4();\r\n    return function (vertices, matrices, matrixWorld, options = {}) {\r\n        options.type = TYPE.HULL;\r\n        _setOptions(options);\r\n        if (options.fit === FIT.MANUAL) {\r\n            console.warn('cannot use fit: manual with type: hull');\r\n            return null;\r\n        }\r\n        const bounds = _computeBounds(vertices, matrices);\r\n        const btVertex = new Ammo.btVector3();\r\n        const originalHull = new Ammo.btConvexHullShape();\r\n        originalHull.setMargin(options.margin);\r\n        center.addVectors(bounds.max, bounds.min).multiplyScalar(0.5);\r\n        let vertexCount = 0;\r\n        for (let i = 0; i < vertices.length; i++) {\r\n            vertexCount += vertices[i].length / 3;\r\n        }\r\n        const maxVertices = options.hullMaxVertices || 100000;\r\n        // todo: might want to implement this in a deterministic way that doesn't do O(verts) calls to Math.random\r\n        if (vertexCount > maxVertices) {\r\n            console.warn(`too many vertices for hull shape; sampling ~${maxVertices} from ~${vertexCount} vertices`);\r\n        }\r\n        const p = Math.min(1, maxVertices / vertexCount);\r\n        for (let i = 0; i < vertices.length; i++) {\r\n            const components = vertices[i];\r\n            matrix.fromArray(matrices[i]);\r\n            for (let j = 0; j < components.length; j += 3) {\r\n                const isLastVertex = i === vertices.length - 1 && j === components.length - 3;\r\n                if (Math.random() <= p || isLastVertex) {\r\n                    // always include the last vertex\r\n                    vertex\r\n                        .set(components[j], components[j + 1], components[j + 2])\r\n                        .applyMatrix4(matrix)\r\n                        .sub(center);\r\n                    btVertex.setValue(vertex.x, vertex.y, vertex.z);\r\n                    originalHull.addPoint(btVertex, isLastVertex); // recalc AABB only on last geometry\r\n                }\r\n            }\r\n        }\r\n        let collisionShape = originalHull;\r\n        if (originalHull.getNumVertices() >= 100) {\r\n            //Bullet documentation says don't use convexHulls with 100 verts or more\r\n            const shapeHull = new Ammo.btShapeHull(originalHull);\r\n            shapeHull.buildHull(options.margin);\r\n            Ammo.destroy(originalHull);\r\n            collisionShape = new Ammo.btConvexHullShape(Ammo.getPointer(shapeHull.getVertexPointer()), shapeHull.numVertices());\r\n            Ammo.destroy(shapeHull); // btConvexHullShape makes a copy\r\n        }\r\n        Ammo.destroy(btVertex);\r\n        _finishCollisionShape(collisionShape, options, _computeScale(matrixWorld, options));\r\n        return collisionShape;\r\n    };\r\n})();\r\nexport const createHACDShapes = (function () {\r\n    const vector = new Vector3();\r\n    const center = new Vector3();\r\n    const matrix = new Matrix4();\r\n    return function (vertices, matrices, indexes, matrixWorld, options = {}) {\r\n        options.type = TYPE.HACD;\r\n        _setOptions(options);\r\n        if (options.fit === FIT.MANUAL) {\r\n            console.warn('cannot use fit: manual with type: hacd');\r\n            return [];\r\n        }\r\n        if (!Ammo.hasOwnProperty('HACD')) {\r\n            console.warn('HACD unavailable in included build of Ammo.js. Visit https://github.com/mozillareality/ammo.js for the latest version.');\r\n            return [];\r\n        }\r\n        const bounds = _computeBounds(vertices, matrices);\r\n        const scale = _computeScale(matrixWorld, options);\r\n        let vertexCount = 0;\r\n        let triCount = 0;\r\n        center.addVectors(bounds.max, bounds.min).multiplyScalar(0.5);\r\n        for (let i = 0; i < vertices.length; i++) {\r\n            vertexCount += vertices[i].length / 3;\r\n            if (indexes && indexes[i]) {\r\n                triCount += indexes[i].length / 3;\r\n            }\r\n            else {\r\n                triCount += vertices[i].length / 9;\r\n            }\r\n        }\r\n        const hacd = new Ammo.HACD();\r\n        if (options.hasOwnProperty('compacityWeight'))\r\n            hacd.SetCompacityWeight(options.compacityWeight);\r\n        if (options.hasOwnProperty('volumeWeight'))\r\n            hacd.SetVolumeWeight(options.volumeWeight);\r\n        if (options.hasOwnProperty('nClusters'))\r\n            hacd.SetNClusters(options.nClusters);\r\n        if (options.hasOwnProperty('nVerticesPerCH'))\r\n            hacd.SetNVerticesPerCH(options.nVerticesPerCH);\r\n        if (options.hasOwnProperty('concavity'))\r\n            hacd.SetConcavity(options.concavity);\r\n        const points = Ammo._malloc(vertexCount * 3 * 8);\r\n        const triangles = Ammo._malloc(triCount * 3 * 4);\r\n        hacd.SetPoints(points);\r\n        hacd.SetTriangles(triangles);\r\n        hacd.SetNPoints(vertexCount);\r\n        hacd.SetNTriangles(triCount);\r\n        let pptr = points / 8, tptr = triangles / 4;\r\n        for (let i = 0; i < vertices.length; i++) {\r\n            const components = vertices[i];\r\n            matrix.fromArray(matrices[i]);\r\n            for (let j = 0; j < components.length; j += 3) {\r\n                vector\r\n                    .set(components[j + 0], components[j + 1], components[j + 2])\r\n                    .applyMatrix4(matrix)\r\n                    .sub(center);\r\n                Ammo.HEAPF64[pptr + 0] = vector.x;\r\n                Ammo.HEAPF64[pptr + 1] = vector.y;\r\n                Ammo.HEAPF64[pptr + 2] = vector.z;\r\n                pptr += 3;\r\n            }\r\n            if (indexes[i]) {\r\n                const indices = indexes[i];\r\n                for (let j = 0; j < indices.length; j++) {\r\n                    Ammo.HEAP32[tptr] = indices[j];\r\n                    tptr++;\r\n                }\r\n            }\r\n            else {\r\n                for (let j = 0; j < components.length / 3; j++) {\r\n                    Ammo.HEAP32[tptr] = j;\r\n                    tptr++;\r\n                }\r\n            }\r\n        }\r\n        hacd.Compute();\r\n        Ammo._free(points);\r\n        Ammo._free(triangles);\r\n        const nClusters = hacd.GetNClusters();\r\n        const shapes = [];\r\n        for (let i = 0; i < nClusters; i++) {\r\n            const hull = new Ammo.btConvexHullShape();\r\n            hull.setMargin(options.margin);\r\n            const nPoints = hacd.GetNPointsCH(i);\r\n            const nTriangles = hacd.GetNTrianglesCH(i);\r\n            const hullPoints = Ammo._malloc(nPoints * 3 * 8);\r\n            const hullTriangles = Ammo._malloc(nTriangles * 3 * 4);\r\n            hacd.GetCH(i, hullPoints, hullTriangles);\r\n            const pptr = hullPoints / 8;\r\n            for (let pi = 0; pi < nPoints; pi++) {\r\n                const btVertex = new Ammo.btVector3();\r\n                const px = Ammo.HEAPF64[pptr + pi * 3 + 0];\r\n                const py = Ammo.HEAPF64[pptr + pi * 3 + 1];\r\n                const pz = Ammo.HEAPF64[pptr + pi * 3 + 2];\r\n                btVertex.setValue(px, py, pz);\r\n                hull.addPoint(btVertex, pi === nPoints - 1);\r\n                Ammo.destroy(btVertex);\r\n            }\r\n            _finishCollisionShape(hull, options, scale);\r\n            shapes.push(hull);\r\n        }\r\n        return shapes;\r\n    };\r\n})();\r\nexport const createVHACDShapes = (function () {\r\n    const vector = new Vector3();\r\n    const center = new Vector3();\r\n    const matrix = new Matrix4();\r\n    return function (vertices, matrices, indexes, matrixWorld, options = {}) {\r\n        options.type = TYPE.VHACD;\r\n        _setOptions(options);\r\n        if (options.fit === FIT.MANUAL) {\r\n            console.warn('cannot use fit: manual with type: vhacd');\r\n            return [];\r\n        }\r\n        if (!Ammo.hasOwnProperty('VHACD')) {\r\n            console.warn('VHACD unavailable in included build of Ammo.js. Visit https://github.com/mozillareality/ammo.js for the latest version.');\r\n            return [];\r\n        }\r\n        const bounds = _computeBounds(vertices, matrices);\r\n        const scale = _computeScale(matrixWorld, options);\r\n        let vertexCount = 0;\r\n        let triCount = 0;\r\n        center.addVectors(bounds.max, bounds.min).multiplyScalar(0.5);\r\n        for (let i = 0; i < vertices.length; i++) {\r\n            vertexCount += vertices[i].length / 3;\r\n            if (indexes && indexes[i]) {\r\n                triCount += indexes[i].length / 3;\r\n            }\r\n            else {\r\n                triCount += vertices[i].length / 9;\r\n            }\r\n        }\r\n        const vhacd = new Ammo.VHACD();\r\n        const params = new Ammo.Parameters();\r\n        //https://kmamou.blogspot.com/2014/12/v-hacd-20-parameters-description.html\r\n        if (options.hasOwnProperty('resolution'))\r\n            params.set_m_resolution(options.resolution);\r\n        if (options.hasOwnProperty('depth'))\r\n            params.set_m_depth(options.depth);\r\n        if (options.hasOwnProperty('concavity'))\r\n            params.set_m_concavity(options.concavity);\r\n        if (options.hasOwnProperty('planeDownsampling'))\r\n            params.set_m_planeDownsampling(options.planeDownsampling);\r\n        if (options.hasOwnProperty('convexhullDownsampling'))\r\n            params.set_m_convexhullDownsampling(options.convexhullDownsampling);\r\n        if (options.hasOwnProperty('alpha'))\r\n            params.set_m_alpha(options.alpha);\r\n        if (options.hasOwnProperty('beta'))\r\n            params.set_m_beta(options.beta);\r\n        if (options.hasOwnProperty('gamma'))\r\n            params.set_m_gamma(options.gamma);\r\n        if (options.hasOwnProperty('pca'))\r\n            params.set_m_pca(options.pca);\r\n        if (options.hasOwnProperty('mode'))\r\n            params.set_m_mode(options.mode);\r\n        if (options.hasOwnProperty('maxNumVerticesPerCH'))\r\n            params.set_m_maxNumVerticesPerCH(options.maxNumVerticesPerCH);\r\n        if (options.hasOwnProperty('minVolumePerCH'))\r\n            params.set_m_minVolumePerCH(options.minVolumePerCH);\r\n        if (options.hasOwnProperty('convexhullApproximation'))\r\n            params.set_m_convexhullApproximation(options.convexhullApproximation);\r\n        if (options.hasOwnProperty('oclAcceleration'))\r\n            params.set_m_oclAcceleration(options.oclAcceleration);\r\n        const points = Ammo._malloc(vertexCount * 3 * 8 + 3);\r\n        const triangles = Ammo._malloc(triCount * 3 * 4);\r\n        let pptr = points / 8, tptr = triangles / 4;\r\n        for (let i = 0; i < vertices.length; i++) {\r\n            const components = vertices[i];\r\n            matrix.fromArray(matrices[i]);\r\n            for (let j = 0; j < components.length; j += 3) {\r\n                vector\r\n                    .set(components[j + 0], components[j + 1], components[j + 2])\r\n                    .applyMatrix4(matrix)\r\n                    .sub(center);\r\n                Ammo.HEAPF64[pptr + 0] = vector.x;\r\n                Ammo.HEAPF64[pptr + 1] = vector.y;\r\n                Ammo.HEAPF64[pptr + 2] = vector.z;\r\n                pptr += 3;\r\n            }\r\n            if (indexes[i]) {\r\n                const indices = indexes[i];\r\n                for (let j = 0; j < indices.length; j++) {\r\n                    Ammo.HEAP32[tptr] = indices[j];\r\n                    tptr++;\r\n                }\r\n            }\r\n            else {\r\n                for (let j = 0; j < components.length / 3; j++) {\r\n                    Ammo.HEAP32[tptr] = j;\r\n                    tptr++;\r\n                }\r\n            }\r\n        }\r\n        vhacd.Compute(points, 3, vertexCount, triangles, 3, triCount, params);\r\n        Ammo._free(points);\r\n        Ammo._free(triangles);\r\n        const nHulls = vhacd.GetNConvexHulls();\r\n        const shapes = [];\r\n        const ch = new Ammo.ConvexHull();\r\n        for (let i = 0; i < nHulls; i++) {\r\n            vhacd.GetConvexHull(i, ch);\r\n            const nPoints = ch.get_m_nPoints();\r\n            const hullPoints = ch.get_m_points();\r\n            const hull = new Ammo.btConvexHullShape();\r\n            hull.setMargin(options.margin);\r\n            for (let pi = 0; pi < nPoints; pi++) {\r\n                const btVertex = new Ammo.btVector3();\r\n                const px = ch.get_m_points(pi * 3 + 0);\r\n                const py = ch.get_m_points(pi * 3 + 1);\r\n                const pz = ch.get_m_points(pi * 3 + 2);\r\n                btVertex.setValue(px, py, pz);\r\n                hull.addPoint(btVertex, pi === nPoints - 1);\r\n                Ammo.destroy(btVertex);\r\n            }\r\n            _finishCollisionShape(hull, options, scale);\r\n            shapes.push(hull);\r\n        }\r\n        Ammo.destroy(ch);\r\n        Ammo.destroy(vhacd);\r\n        return shapes;\r\n    };\r\n})();\r\nexport const createTriMeshShape = (function () {\r\n    const va = new Vector3();\r\n    const vb = new Vector3();\r\n    const vc = new Vector3();\r\n    const matrix = new Matrix4();\r\n    return function (vertices, matrices, indexes, matrixWorld, options = {}) {\r\n        options.type = TYPE.MESH;\r\n        _setOptions(options);\r\n        if (options.fit === FIT.MANUAL) {\r\n            console.warn('cannot use fit: manual with type: mesh');\r\n            return null;\r\n        }\r\n        const scale = _computeScale(matrixWorld, options);\r\n        const bta = new Ammo.btVector3();\r\n        const btb = new Ammo.btVector3();\r\n        const btc = new Ammo.btVector3();\r\n        const triMesh = new Ammo.btTriangleMesh(true, false);\r\n        for (let i = 0; i < vertices.length; i++) {\r\n            const components = vertices[i];\r\n            const index = indexes[i] ? indexes[i] : null;\r\n            matrix.fromArray(matrices[i]);\r\n            if (index) {\r\n                for (let j = 0; j < index.length; j += 3) {\r\n                    const ai = index[j] * 3;\r\n                    const bi = index[j + 1] * 3;\r\n                    const ci = index[j + 2] * 3;\r\n                    va.set(components[ai], components[ai + 1], components[ai + 2]).applyMatrix4(matrix);\r\n                    vb.set(components[bi], components[bi + 1], components[bi + 2]).applyMatrix4(matrix);\r\n                    vc.set(components[ci], components[ci + 1], components[ci + 2]).applyMatrix4(matrix);\r\n                    bta.setValue(va.x, va.y, va.z);\r\n                    btb.setValue(vb.x, vb.y, vb.z);\r\n                    btc.setValue(vc.x, vc.y, vc.z);\r\n                    triMesh.addTriangle(bta, btb, btc, false);\r\n                }\r\n            }\r\n            else {\r\n                for (let j = 0; j < components.length; j += 9) {\r\n                    va.set(components[j + 0], components[j + 1], components[j + 2]).applyMatrix4(matrix);\r\n                    vb.set(components[j + 3], components[j + 4], components[j + 5]).applyMatrix4(matrix);\r\n                    vc.set(components[j + 6], components[j + 7], components[j + 8]).applyMatrix4(matrix);\r\n                    bta.setValue(va.x, va.y, va.z);\r\n                    btb.setValue(vb.x, vb.y, vb.z);\r\n                    btc.setValue(vc.x, vc.y, vc.z);\r\n                    triMesh.addTriangle(bta, btb, btc, false);\r\n                }\r\n            }\r\n        }\r\n        const localScale = new Ammo.btVector3(scale.x, scale.y, scale.z);\r\n        triMesh.setScaling(localScale);\r\n        Ammo.destroy(localScale);\r\n        // MOD (yandeu): Use btConvexTriangleMeshShape for concave shapes\r\n        let collisionShape;\r\n        if (options.concave)\r\n            collisionShape = new Ammo.btBvhTriangleMeshShape(triMesh, true, true);\r\n        else\r\n            collisionShape = new Ammo.btConvexTriangleMeshShape(triMesh, true);\r\n        // const collisionShape = new Ammo.btBvhTriangleMeshShape(triMesh, true, true)\r\n        collisionShape.resources = [triMesh];\r\n        Ammo.destroy(bta);\r\n        Ammo.destroy(btb);\r\n        Ammo.destroy(btc);\r\n        _finishCollisionShape(collisionShape, options);\r\n        return collisionShape;\r\n    };\r\n})();\r\nexport const createHeightfieldTerrainShape = function (options = {}) {\r\n    _setOptions(options);\r\n    if (options.fit === FIT.ALL) {\r\n        console.warn('cannot use fit: all with type: heightfield');\r\n        return null;\r\n    }\r\n    const heightfieldDistance = options.heightfieldDistance || 1;\r\n    const heightfieldData = options.heightfieldData || [];\r\n    const heightScale = options.heightScale || 0;\r\n    const upAxis = options.hasOwnProperty('upAxis') ? options.upAxis : 1; // x = 0; y = 1; z = 2\r\n    const hdt = (() => {\r\n        switch (options.heightDataType) {\r\n            case 'short':\r\n                return Ammo.PHY_SHORT;\r\n            case 'float':\r\n                return Ammo.PHY_FLOAT;\r\n            default:\r\n                return Ammo.PHY_FLOAT;\r\n        }\r\n    })();\r\n    const flipQuadEdges = options.hasOwnProperty('flipQuadEdges') ? options.flipQuadEdges : true;\r\n    const heightStickLength = heightfieldData.length;\r\n    const heightStickWidth = heightStickLength > 0 ? heightfieldData[0].length : 0;\r\n    const data = Ammo._malloc(heightStickLength * heightStickWidth * 4);\r\n    const ptr = data / 4;\r\n    let minHeight = Number.POSITIVE_INFINITY;\r\n    let maxHeight = Number.NEGATIVE_INFINITY;\r\n    let index = 0;\r\n    for (let l = 0; l < heightStickLength; l++) {\r\n        for (let w = 0; w < heightStickWidth; w++) {\r\n            const height = heightfieldData[l][w];\r\n            Ammo.HEAPF32[ptr + index] = height;\r\n            index++;\r\n            minHeight = Math.min(minHeight, height);\r\n            maxHeight = Math.max(maxHeight, height);\r\n        }\r\n    }\r\n    const collisionShape = new Ammo.btHeightfieldTerrainShape(heightStickWidth, heightStickLength, data, heightScale, minHeight, maxHeight, upAxis, hdt, flipQuadEdges);\r\n    const scale = new Ammo.btVector3(heightfieldDistance, 1, heightfieldDistance);\r\n    collisionShape.setLocalScaling(scale);\r\n    Ammo.destroy(scale);\r\n    collisionShape.heightfieldData = data;\r\n    _finishCollisionShape(collisionShape, options);\r\n    return collisionShape;\r\n};\r\nfunction _setOptions(options) {\r\n    // MOD (yandeu): All of this will be done in physics.ts\r\n    // we only keep type and margin\r\n    options.type = options.type || TYPE.HULL;\r\n    options.margin = options.hasOwnProperty('margin') ? options.margin : 0.01;\r\n    return;\r\n    options.fit = options.hasOwnProperty('fit') ? options.fit : FIT.ALL;\r\n    options.type = options.type || TYPE.HULL;\r\n    options.minHalfExtent = options.hasOwnProperty('minHalfExtent') ? options.minHalfExtent : 0;\r\n    options.maxHalfExtent = options.hasOwnProperty('maxHalfExtent') ? options.maxHalfExtent : Number.POSITIVE_INFINITY;\r\n    options.cylinderAxis = options.cylinderAxis || 'y';\r\n    options.margin = options.hasOwnProperty('margin') ? options.margin : 0.01;\r\n    options.includeInvisible = options.hasOwnProperty('includeInvisible') ? options.includeInvisible : false;\r\n    if (!options.offset) {\r\n        options.offset = new Vector3();\r\n    }\r\n    if (!options.orientation) {\r\n        options.orientation = new Quaternion();\r\n    }\r\n}\r\nconst _finishCollisionShape = function (collisionShape, options, scale) {\r\n    // MOD (yandeu): All of this will be done in physics.ts\r\n    return;\r\n    collisionShape.type = options.type;\r\n    collisionShape.setMargin(options.margin);\r\n    collisionShape.destroy = () => {\r\n        for (let res of collisionShape.resources || []) {\r\n            Ammo.destroy(res);\r\n        }\r\n        if (collisionShape.heightfieldData) {\r\n            Ammo._free(collisionShape.heightfieldData);\r\n        }\r\n        Ammo.destroy(collisionShape);\r\n    };\r\n    const localTransform = new Ammo.btTransform();\r\n    const rotation = new Ammo.btQuaternion();\r\n    localTransform.setIdentity();\r\n    localTransform.getOrigin().setValue(options.offset.x, options.offset.y, options.offset.z);\r\n    rotation.setValue(options.orientation.x, options.orientation.y, options.orientation.z, options.orientation.w);\r\n    localTransform.setRotation(rotation);\r\n    Ammo.destroy(rotation);\r\n    if (scale) {\r\n        const localScale = new Ammo.btVector3(scale.x, scale.y, scale.z);\r\n        collisionShape.setLocalScaling(localScale);\r\n        Ammo.destroy(localScale);\r\n    }\r\n    collisionShape.localTransform = localTransform;\r\n};\r\nexport const iterateGeometries = (function () {\r\n    const inverse = new Matrix4();\r\n    return function (root, options, cb) {\r\n        // MOD (yandeu): Update to three.js r123\r\n        // compatibility fix for three.js >= r123 (Dezember 2020)\r\n        if (parseInt(REVISION) >= 123)\r\n            inverse.copy(root.matrixWorld).invert();\r\n        else\r\n            inverse.getInverse(root.matrixWorld);\r\n        const scale = new Vector3();\r\n        scale.setFromMatrixScale(root.matrixWorld);\r\n        root.traverse(mesh => {\r\n            const transform = new Matrix4();\r\n            if (mesh.isMesh &&\r\n                // MOD (yandeu): No need to check if name is 'Sky'\r\n                // mesh.name !== 'Sky' &&\r\n                (options.includeInvisible || (mesh.el && mesh.el.object3D.visible) || mesh.visible)) {\r\n                if (mesh === root) {\r\n                    transform.identity();\r\n                }\r\n                else {\r\n                    mesh.updateWorldMatrix(true);\r\n                    transform.multiplyMatrices(inverse, mesh.matrixWorld);\r\n                }\r\n                // todo: might want to return null xform if this is the root so that callers can avoid multiplying\r\n                // things by the identity matrix\r\n                cb(mesh.geometry.isBufferGeometry ? mesh.geometry.attributes.position.array : mesh.geometry.vertices, transform.elements, mesh.geometry.index ? mesh.geometry.index.array : null);\r\n            }\r\n        });\r\n    };\r\n})();\r\nconst _computeScale = (function () {\r\n    const matrix = new Matrix4();\r\n    return function (matrixWorld, options = {}) {\r\n        const scale = new Vector3(1, 1, 1);\r\n        if (options.fit === FIT.ALL) {\r\n            matrix.fromArray(matrixWorld);\r\n            scale.setFromMatrixScale(matrix);\r\n        }\r\n        return scale;\r\n    };\r\n})();\r\nconst _computeRadius = (function () {\r\n    const center = new Vector3();\r\n    return function (vertices, matrices, bounds) {\r\n        let maxRadiusSq = 0;\r\n        let { x: cx, y: cy, z: cz } = bounds.getCenter(center);\r\n        _iterateVertices(vertices, matrices, v => {\r\n            const dx = cx - v.x;\r\n            const dy = cy - v.y;\r\n            const dz = cz - v.z;\r\n            maxRadiusSq = Math.max(maxRadiusSq, dx * dx + dy * dy + dz * dz);\r\n        });\r\n        return Math.sqrt(maxRadiusSq);\r\n    };\r\n})();\r\nconst _computeHalfExtents = function (bounds, minHalfExtent, maxHalfExtent) {\r\n    const halfExtents = new Vector3();\r\n    return halfExtents.subVectors(bounds.max, bounds.min).multiplyScalar(0.5).clampScalar(minHalfExtent, maxHalfExtent);\r\n};\r\nconst _computeLocalOffset = function (matrix, bounds, target) {\r\n    target.addVectors(bounds.max, bounds.min).multiplyScalar(0.5).applyMatrix4(matrix);\r\n    return target;\r\n};\r\n// returns the bounding box for the geometries underneath `root`.\r\nconst _computeBounds = function (vertices, matrices) {\r\n    const bounds = new Box3();\r\n    let minX = +Infinity;\r\n    let minY = +Infinity;\r\n    let minZ = +Infinity;\r\n    let maxX = -Infinity;\r\n    let maxY = -Infinity;\r\n    let maxZ = -Infinity;\r\n    bounds.min.set(0, 0, 0);\r\n    bounds.max.set(0, 0, 0);\r\n    _iterateVertices(vertices, matrices, v => {\r\n        if (v.x < minX)\r\n            minX = v.x;\r\n        if (v.y < minY)\r\n            minY = v.y;\r\n        if (v.z < minZ)\r\n            minZ = v.z;\r\n        if (v.x > maxX)\r\n            maxX = v.x;\r\n        if (v.y > maxY)\r\n            maxY = v.y;\r\n        if (v.z > maxZ)\r\n            maxZ = v.z;\r\n    });\r\n    bounds.min.set(minX, minY, minZ);\r\n    bounds.max.set(maxX, maxY, maxZ);\r\n    return bounds;\r\n};\r\nconst _iterateVertices = (function () {\r\n    const vertex = new Vector3();\r\n    const matrix = new Matrix4();\r\n    return function (vertices, matrices, cb) {\r\n        for (let i = 0; i < vertices.length; i++) {\r\n            matrix.fromArray(matrices[i]);\r\n            for (let j = 0; j < vertices[i].length; j += 3) {\r\n                vertex.set(vertices[i][j], vertices[i][j + 1], vertices[i][j + 2]).applyMatrix4(matrix);\r\n                cb(vertex);\r\n            }\r\n        }\r\n    };\r\n})();\r\n//# sourceMappingURL=three-to-ammo.js.map","/**\r\n * @author       Yannick Deubel (https://github.com/yandeu)\r\n * @copyright    Copyright (c) 2020 Yannick Deubel; Project Url: https://github.com/enable3d/enable3d\r\n * @license      {@link https://github.com/enable3d/enable3d/blob/master/LICENSE|GNU GPLv3}\r\n */\r\nimport { Events } from '@yandeu/events';\r\nexport class CollisionEvents extends Events {\r\n    addCollider(object1, object2, eventCallback) {\r\n        if (!object1.body || !object2.body)\r\n            return;\r\n        object1.body.checkCollisions = true;\r\n        object2.body.checkCollisions = true;\r\n        this.on('collision', (data) => {\r\n            var _a, _b;\r\n            const { bodies, event } = data;\r\n            if (((_a = bodies[0]) === null || _a === void 0 ? void 0 : _a.name) && ((_b = bodies[1]) === null || _b === void 0 ? void 0 : _b.name) && (object1 === null || object1 === void 0 ? void 0 : object1.name) && (object2 === null || object2 === void 0 ? void 0 : object2.name)) {\r\n                if (bodies[0].name === object1.name && bodies[1].name === object2.name)\r\n                    eventCallback(event);\r\n                else if (bodies[1].name === object1.name && bodies[0].name === object2.name)\r\n                    eventCallback(event);\r\n            }\r\n        });\r\n    }\r\n}\r\n//# sourceMappingURL=collisionEvents.js.map","/**\r\n * @author       Yannick Deubel (https://github.com/yandeu)\r\n * @copyright    Copyright (c) 2020 Yannick Deubel; Project Url: https://github.com/enable3d/enable3d\r\n * @description  This is a modified version of the original code from Kevin Lee\r\n */\r\n/**\r\n * @author       Kevin Lee (https://github.com/InfiniteLee)\r\n * @copyright    Copyright (c) 2019 Kevin Lee; Project Url: https://github.com/InfiniteLee/ammo-debug-drawer\r\n * @license      {@link https://github.com/InfiniteLee/ammo-debug-drawer/blob/master/LICENSE|MPL-2.0}\r\n */\r\nimport { BufferAttribute, BufferGeometry, LineBasicMaterial, LineSegments, StaticDrawUsage } from 'three';\r\nconst AmmoDebugConstants = {\r\n    NoDebug: 0,\r\n    DrawWireframe: 1,\r\n    DrawAabb: 2,\r\n    DrawFeaturesText: 4,\r\n    DrawContactPoints: 8,\r\n    NoDeactivation: 16,\r\n    NoHelpText: 32,\r\n    DrawText: 64,\r\n    ProfileTimings: 128,\r\n    EnableSatComparison: 256,\r\n    DisableBulletLCP: 512,\r\n    EnableCCD: 1024,\r\n    DrawConstraints: 1 << 11,\r\n    DrawConstraintLimits: 1 << 12,\r\n    FastWireframe: 1 << 13,\r\n    DrawNormals: 1 << 14,\r\n    DrawOnTop: 1 << 15,\r\n    MAX_DEBUG_DRAW_MODE: 0xffffffff\r\n};\r\n/**\r\n * An implementation of the btIDebugDraw interface in Ammo.js, for debug rendering of Ammo shapes\r\n */\r\nclass DebugDrawer {\r\n    constructor(scene, world, options = {}) {\r\n        this.scene = scene;\r\n        this.world = world;\r\n        this.options = options;\r\n        this.debugDrawMode = options.debugDrawMode || AmmoDebugConstants.DrawWireframe;\r\n        const drawOnTop = this.debugDrawMode & AmmoDebugConstants.DrawOnTop || false;\r\n        const maxBufferSize = options.maxBufferSize || 1000000;\r\n        this.geometry = new BufferGeometry();\r\n        const vertices = new Float32Array(maxBufferSize * 3);\r\n        const colors = new Float32Array(maxBufferSize * 3);\r\n        /*\r\n        I do not know the difference, just using the first one.\r\n        export const StaticDrawUsage: Usage;\r\n        export const DynamicDrawUsage: Usage;\r\n        export const StreamDrawUsage: Usage;\r\n        export const StaticReadUsage: Usage;\r\n        export const DynamicReadUsage: Usage;\r\n        export const StreamReadUsage: Usage;\r\n        export const StaticCopyUsage: Usage;\r\n        export const DynamicCopyUsage: Usage;\r\n        export const StreamCopyUsage: Usage;\r\n         */\r\n        this.geometry.setAttribute('position', new BufferAttribute(vertices, 3).setUsage(StaticDrawUsage));\r\n        this.geometry.setAttribute('color', new BufferAttribute(colors, 3).setUsage(StaticDrawUsage));\r\n        this.index = 0;\r\n        const material = new LineBasicMaterial({\r\n            vertexColors: true,\r\n            depthTest: !drawOnTop\r\n        });\r\n        this.mesh = new LineSegments(this.geometry, material);\r\n        if (drawOnTop)\r\n            this.mesh.renderOrder = 999;\r\n        this.mesh.frustumCulled = false;\r\n        this.enabled = false;\r\n        this.debugDrawer = new Ammo.DebugDrawer();\r\n        this.debugDrawer.drawLine = this.drawLine.bind(this);\r\n        this.debugDrawer.drawContactPoint = this.drawContactPoint.bind(this);\r\n        this.debugDrawer.reportErrorWarning = this.reportErrorWarning.bind(this);\r\n        this.debugDrawer.draw3dText = this.draw3dText.bind(this);\r\n        this.debugDrawer.setDebugMode = this.setDebugMode.bind(this);\r\n        this.debugDrawer.getDebugMode = this.getDebugMode.bind(this);\r\n        this.world.setDebugDrawer(this.debugDrawer);\r\n    }\r\n    enable() {\r\n        this.enabled = true;\r\n        this.scene.add(this.mesh);\r\n    }\r\n    disable() {\r\n        this.enabled = false;\r\n        this.scene.remove(this.mesh);\r\n    }\r\n    update() {\r\n        if (!this.enabled) {\r\n            return;\r\n        }\r\n        if (this.index != 0) {\r\n            // @ts-ignore\r\n            this.geometry.attributes.position.needsUpdate = true;\r\n            // @ts-ignore\r\n            this.geometry.attributes.color.needsUpdate = true;\r\n        }\r\n        this.index = 0;\r\n        this.world.debugDrawWorld();\r\n        this.geometry.setDrawRange(0, this.index);\r\n    }\r\n    drawLine(from, to, color) {\r\n        // @ts-ignore\r\n        const heap = Ammo.HEAPF32;\r\n        const r = heap[(color + 0) / 4];\r\n        const g = heap[(color + 4) / 4];\r\n        const b = heap[(color + 8) / 4];\r\n        const fromX = heap[(from + 0) / 4];\r\n        const fromY = heap[(from + 4) / 4];\r\n        const fromZ = heap[(from + 8) / 4];\r\n        this.geometry.attributes.position.setXYZ(this.index, fromX, fromY, fromZ);\r\n        this.geometry.attributes.color.setXYZ(this.index++, r, g, b);\r\n        const toX = heap[(to + 0) / 4];\r\n        const toY = heap[(to + 4) / 4];\r\n        const toZ = heap[(to + 8) / 4];\r\n        this.geometry.attributes.position.setXYZ(this.index, toX, toY, toZ);\r\n        this.geometry.attributes.color.setXYZ(this.index++, r, g, b);\r\n    }\r\n    //TODO: figure out how to make lifeTime work\r\n    drawContactPoint(pointOnB, normalOnB, distance, _lifeTime, color) {\r\n        // @ts-ignore\r\n        const heap = Ammo.HEAPF32;\r\n        const r = heap[(color + 0) / 4];\r\n        const g = heap[(color + 4) / 4];\r\n        const b = heap[(color + 8) / 4];\r\n        const x = heap[(pointOnB + 0) / 4];\r\n        const y = heap[(pointOnB + 4) / 4];\r\n        const z = heap[(pointOnB + 8) / 4];\r\n        this.geometry.attributes.position.setXYZ(this.index, x, y, z);\r\n        this.geometry.attributes.color.setXYZ(this.index++, r, g, b);\r\n        const dx = heap[(normalOnB + 0) / 4] * distance;\r\n        const dy = heap[(normalOnB + 4) / 4] * distance;\r\n        const dz = heap[(normalOnB + 8) / 4] * distance;\r\n        this.geometry.attributes.position.setXYZ(this.index, x + dx, y + dy, z + dz);\r\n        this.geometry.attributes.color.setXYZ(this.index++, r, g, b);\r\n    }\r\n    reportErrorWarning(warningString) {\r\n        // eslint-disable-next-line no-prototype-builtins\r\n        if (Ammo.hasOwnProperty('Pointer_stringify')) {\r\n            // @ts-ignore\r\n            console.warn(Ammo.Pointer_stringify(warningString));\r\n        }\r\n        else if (!this.warnedOnce) {\r\n            this.warnedOnce = true;\r\n            console.warn(\"Cannot print warningString, please rebuild Ammo.js using 'debug' flag\");\r\n        }\r\n    }\r\n    draw3dText(_location, _textString) {\r\n        //TODO\r\n        console.warn('TODO: draw3dText');\r\n    }\r\n    setDebugMode(debugMode) {\r\n        this.debugDrawMode = debugMode;\r\n    }\r\n    getDebugMode() {\r\n        return this.debugDrawMode;\r\n    }\r\n}\r\nexport default DebugDrawer;\r\n//# sourceMappingURL=debugDrawer.js.map","import {\n\tLine3,\n\tPlane,\n\tTriangle,\n\tVector3\n} from 'three';\n\n/**\n * Ported from: https://github.com/maurizzzio/quickhull3d/ by Mauricio Poppe (https://github.com/maurizzzio)\n */\n\nconst Visible = 0;\nconst Deleted = 1;\n\nconst _v1 = new Vector3();\nconst _line3 = new Line3();\nconst _plane = new Plane();\nconst _closestPoint = new Vector3();\nconst _triangle = new Triangle();\n\nclass ConvexHull {\n\n\tconstructor() {\n\n\t\tthis.tolerance = - 1;\n\n\t\tthis.faces = []; // the generated faces of the convex hull\n\t\tthis.newFaces = []; // this array holds the faces that are generated within a single iteration\n\n\t\t// the vertex lists work as follows:\n\t\t//\n\t\t// let 'a' and 'b' be 'Face' instances\n\t\t// let 'v' be points wrapped as instance of 'Vertex'\n\t\t//\n\t\t//     [v, v, ..., v, v, v, ...]\n\t\t//      ^             ^\n\t\t//      |             |\n\t\t//  a.outside     b.outside\n\t\t//\n\t\tthis.assigned = new VertexList();\n\t\tthis.unassigned = new VertexList();\n\n\t\tthis.vertices = []; \t// vertices of the hull (internal representation of given geometry data)\n\n\t}\n\n\tsetFromPoints( points ) {\n\n\t\tif ( Array.isArray( points ) !== true ) {\n\n\t\t\tconsole.error( 'THREE.ConvexHull: Points parameter is not an array.' );\n\n\t\t}\n\n\t\tif ( points.length < 4 ) {\n\n\t\t\tconsole.error( 'THREE.ConvexHull: The algorithm needs at least four points.' );\n\n\t\t}\n\n\t\tthis.makeEmpty();\n\n\t\tfor ( let i = 0, l = points.length; i < l; i ++ ) {\n\n\t\t\tthis.vertices.push( new VertexNode( points[ i ] ) );\n\n\t\t}\n\n\t\tthis.compute();\n\n\t\treturn this;\n\n\t}\n\n\tsetFromObject( object ) {\n\n\t\tconst points = [];\n\n\t\tobject.updateMatrixWorld( true );\n\n\t\tobject.traverse( function ( node ) {\n\n\t\t\tconst geometry = node.geometry;\n\n\t\t\tif ( geometry !== undefined ) {\n\n\t\t\t\tif ( geometry.isGeometry ) {\n\n\t\t\t\t\tconsole.error( 'THREE.ConvexHull no longer supports Geometry. Use THREE.BufferGeometry instead.' );\n\t\t\t\t\treturn;\n\n\t\t\t\t} else if ( geometry.isBufferGeometry ) {\n\n\t\t\t\t\tconst attribute = geometry.attributes.position;\n\n\t\t\t\t\tif ( attribute !== undefined ) {\n\n\t\t\t\t\t\tfor ( let i = 0, l = attribute.count; i < l; i ++ ) {\n\n\t\t\t\t\t\t\tconst point = new Vector3();\n\n\t\t\t\t\t\t\tpoint.fromBufferAttribute( attribute, i ).applyMatrix4( node.matrixWorld );\n\n\t\t\t\t\t\t\tpoints.push( point );\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t} );\n\n\t\treturn this.setFromPoints( points );\n\n\t}\n\n\tcontainsPoint( point ) {\n\n\t\tconst faces = this.faces;\n\n\t\tfor ( let i = 0, l = faces.length; i < l; i ++ ) {\n\n\t\t\tconst face = faces[ i ];\n\n\t\t\t// compute signed distance and check on what half space the point lies\n\n\t\t\tif ( face.distanceToPoint( point ) > this.tolerance ) return false;\n\n\t\t}\n\n\t\treturn true;\n\n\t}\n\n\tintersectRay( ray, target ) {\n\n\t\t// based on \"Fast Ray-Convex Polyhedron Intersection\"  by Eric Haines, GRAPHICS GEMS II\n\n\t\tconst faces = this.faces;\n\n\t\tlet tNear = - Infinity;\n\t\tlet tFar = Infinity;\n\n\t\tfor ( let i = 0, l = faces.length; i < l; i ++ ) {\n\n\t\t\tconst face = faces[ i ];\n\n\t\t\t// interpret faces as planes for the further computation\n\n\t\t\tconst vN = face.distanceToPoint( ray.origin );\n\t\t\tconst vD = face.normal.dot( ray.direction );\n\n\t\t\t// if the origin is on the positive side of a plane (so the plane can \"see\" the origin) and\n\t\t\t// the ray is turned away or parallel to the plane, there is no intersection\n\n\t\t\tif ( vN > 0 && vD >= 0 ) return null;\n\n\t\t\t// compute the distance from the rays origin to the intersection with the plane\n\n\t\t\tconst t = ( vD !== 0 ) ? ( - vN / vD ) : 0;\n\n\t\t\t// only proceed if the distance is positive. a negative distance means the intersection point\n\t\t\t// lies \"behind\" the origin\n\n\t\t\tif ( t <= 0 ) continue;\n\n\t\t\t// now categorized plane as front-facing or back-facing\n\n\t\t\tif ( vD > 0 ) {\n\n\t\t\t\t//  plane faces away from the ray, so this plane is a back-face\n\n\t\t\t\ttFar = Math.min( t, tFar );\n\n\t\t\t} else {\n\n\t\t\t\t// front-face\n\n\t\t\t\ttNear = Math.max( t, tNear );\n\n\t\t\t}\n\n\t\t\tif ( tNear > tFar ) {\n\n\t\t\t\t// if tNear ever is greater than tFar, the ray must miss the convex hull\n\n\t\t\t\treturn null;\n\n\t\t\t}\n\n\t\t}\n\n\t\t// evaluate intersection point\n\n\t\t// always try tNear first since its the closer intersection point\n\n\t\tif ( tNear !== - Infinity ) {\n\n\t\t\tray.at( tNear, target );\n\n\t\t} else {\n\n\t\t\tray.at( tFar, target );\n\n\t\t}\n\n\t\treturn target;\n\n\t}\n\n\tintersectsRay( ray ) {\n\n\t\treturn this.intersectRay( ray, _v1 ) !== null;\n\n\t}\n\n\tmakeEmpty() {\n\n\t\tthis.faces = [];\n\t\tthis.vertices = [];\n\n\t\treturn this;\n\n\t}\n\n\t// Adds a vertex to the 'assigned' list of vertices and assigns it to the given face\n\n\taddVertexToFace( vertex, face ) {\n\n\t\tvertex.face = face;\n\n\t\tif ( face.outside === null ) {\n\n\t\t\tthis.assigned.append( vertex );\n\n\t\t} else {\n\n\t\t\tthis.assigned.insertBefore( face.outside, vertex );\n\n\t\t}\n\n\t\tface.outside = vertex;\n\n\t\treturn this;\n\n\t}\n\n\t// Removes a vertex from the 'assigned' list of vertices and from the given face\n\n\tremoveVertexFromFace( vertex, face ) {\n\n\t\tif ( vertex === face.outside ) {\n\n\t\t\t// fix face.outside link\n\n\t\t\tif ( vertex.next !== null && vertex.next.face === face ) {\n\n\t\t\t\t// face has at least 2 outside vertices, move the 'outside' reference\n\n\t\t\t\tface.outside = vertex.next;\n\n\t\t\t} else {\n\n\t\t\t\t// vertex was the only outside vertex that face had\n\n\t\t\t\tface.outside = null;\n\n\t\t\t}\n\n\t\t}\n\n\t\tthis.assigned.remove( vertex );\n\n\t\treturn this;\n\n\t}\n\n\t// Removes all the visible vertices that a given face is able to see which are stored in the 'assigned' vertext list\n\n\tremoveAllVerticesFromFace( face ) {\n\n\t\tif ( face.outside !== null ) {\n\n\t\t\t// reference to the first and last vertex of this face\n\n\t\t\tconst start = face.outside;\n\t\t\tlet end = face.outside;\n\n\t\t\twhile ( end.next !== null && end.next.face === face ) {\n\n\t\t\t\tend = end.next;\n\n\t\t\t}\n\n\t\t\tthis.assigned.removeSubList( start, end );\n\n\t\t\t// fix references\n\n\t\t\tstart.prev = end.next = null;\n\t\t\tface.outside = null;\n\n\t\t\treturn start;\n\n\t\t}\n\n\t}\n\n\t// Removes all the visible vertices that 'face' is able to see\n\n\tdeleteFaceVertices( face, absorbingFace ) {\n\n\t\tconst faceVertices = this.removeAllVerticesFromFace( face );\n\n\t\tif ( faceVertices !== undefined ) {\n\n\t\t\tif ( absorbingFace === undefined ) {\n\n\t\t\t\t// mark the vertices to be reassigned to some other face\n\n\t\t\t\tthis.unassigned.appendChain( faceVertices );\n\n\n\t\t\t} else {\n\n\t\t\t\t// if there's an absorbing face try to assign as many vertices as possible to it\n\n\t\t\t\tlet vertex = faceVertices;\n\n\t\t\t\tdo {\n\n\t\t\t\t\t// we need to buffer the subsequent vertex at this point because the 'vertex.next' reference\n\t\t\t\t\t// will be changed by upcoming method calls\n\n\t\t\t\t\tconst nextVertex = vertex.next;\n\n\t\t\t\t\tconst distance = absorbingFace.distanceToPoint( vertex.point );\n\n\t\t\t\t\t// check if 'vertex' is able to see 'absorbingFace'\n\n\t\t\t\t\tif ( distance > this.tolerance ) {\n\n\t\t\t\t\t\tthis.addVertexToFace( vertex, absorbingFace );\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\tthis.unassigned.append( vertex );\n\n\t\t\t\t\t}\n\n\t\t\t\t\t// now assign next vertex\n\n\t\t\t\t\tvertex = nextVertex;\n\n\t\t\t\t} while ( vertex !== null );\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\t// Reassigns as many vertices as possible from the unassigned list to the new faces\n\n\tresolveUnassignedPoints( newFaces ) {\n\n\t\tif ( this.unassigned.isEmpty() === false ) {\n\n\t\t\tlet vertex = this.unassigned.first();\n\n\t\t\tdo {\n\n\t\t\t\t// buffer 'next' reference, see .deleteFaceVertices()\n\n\t\t\t\tconst nextVertex = vertex.next;\n\n\t\t\t\tlet maxDistance = this.tolerance;\n\n\t\t\t\tlet maxFace = null;\n\n\t\t\t\tfor ( let i = 0; i < newFaces.length; i ++ ) {\n\n\t\t\t\t\tconst face = newFaces[ i ];\n\n\t\t\t\t\tif ( face.mark === Visible ) {\n\n\t\t\t\t\t\tconst distance = face.distanceToPoint( vertex.point );\n\n\t\t\t\t\t\tif ( distance > maxDistance ) {\n\n\t\t\t\t\t\t\tmaxDistance = distance;\n\t\t\t\t\t\t\tmaxFace = face;\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif ( maxDistance > 1000 * this.tolerance ) break;\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\t// 'maxFace' can be null e.g. if there are identical vertices\n\n\t\t\t\tif ( maxFace !== null ) {\n\n\t\t\t\t\tthis.addVertexToFace( vertex, maxFace );\n\n\t\t\t\t}\n\n\t\t\t\tvertex = nextVertex;\n\n\t\t\t} while ( vertex !== null );\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\t// Computes the extremes of a simplex which will be the initial hull\n\n\tcomputeExtremes() {\n\n\t\tconst min = new Vector3();\n\t\tconst max = new Vector3();\n\n\t\tconst minVertices = [];\n\t\tconst maxVertices = [];\n\n\t\t// initially assume that the first vertex is the min/max\n\n\t\tfor ( let i = 0; i < 3; i ++ ) {\n\n\t\t\tminVertices[ i ] = maxVertices[ i ] = this.vertices[ 0 ];\n\n\t\t}\n\n\t\tmin.copy( this.vertices[ 0 ].point );\n\t\tmax.copy( this.vertices[ 0 ].point );\n\n\t\t// compute the min/max vertex on all six directions\n\n\t\tfor ( let i = 0, l = this.vertices.length; i < l; i ++ ) {\n\n\t\t\tconst vertex = this.vertices[ i ];\n\t\t\tconst point = vertex.point;\n\n\t\t\t// update the min coordinates\n\n\t\t\tfor ( let j = 0; j < 3; j ++ ) {\n\n\t\t\t\tif ( point.getComponent( j ) < min.getComponent( j ) ) {\n\n\t\t\t\t\tmin.setComponent( j, point.getComponent( j ) );\n\t\t\t\t\tminVertices[ j ] = vertex;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\t// update the max coordinates\n\n\t\t\tfor ( let j = 0; j < 3; j ++ ) {\n\n\t\t\t\tif ( point.getComponent( j ) > max.getComponent( j ) ) {\n\n\t\t\t\t\tmax.setComponent( j, point.getComponent( j ) );\n\t\t\t\t\tmaxVertices[ j ] = vertex;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\t// use min/max vectors to compute an optimal epsilon\n\n\t\tthis.tolerance = 3 * Number.EPSILON * (\n\t\t\tMath.max( Math.abs( min.x ), Math.abs( max.x ) ) +\n\t\t\tMath.max( Math.abs( min.y ), Math.abs( max.y ) ) +\n\t\t\tMath.max( Math.abs( min.z ), Math.abs( max.z ) )\n\t\t);\n\n\t\treturn { min: minVertices, max: maxVertices };\n\n\t}\n\n\t// Computes the initial simplex assigning to its faces all the points\n\t// that are candidates to form part of the hull\n\n\tcomputeInitialHull() {\n\n\t\tconst vertices = this.vertices;\n\t\tconst extremes = this.computeExtremes();\n\t\tconst min = extremes.min;\n\t\tconst max = extremes.max;\n\n\t\t// 1. Find the two vertices 'v0' and 'v1' with the greatest 1d separation\n\t\t// (max.x - min.x)\n\t\t// (max.y - min.y)\n\t\t// (max.z - min.z)\n\n\t\tlet maxDistance = 0;\n\t\tlet index = 0;\n\n\t\tfor ( let i = 0; i < 3; i ++ ) {\n\n\t\t\tconst distance = max[ i ].point.getComponent( i ) - min[ i ].point.getComponent( i );\n\n\t\t\tif ( distance > maxDistance ) {\n\n\t\t\t\tmaxDistance = distance;\n\t\t\t\tindex = i;\n\n\t\t\t}\n\n\t\t}\n\n\t\tconst v0 = min[ index ];\n\t\tconst v1 = max[ index ];\n\t\tlet v2;\n\t\tlet v3;\n\n\t\t// 2. The next vertex 'v2' is the one farthest to the line formed by 'v0' and 'v1'\n\n\t\tmaxDistance = 0;\n\t\t_line3.set( v0.point, v1.point );\n\n\t\tfor ( let i = 0, l = this.vertices.length; i < l; i ++ ) {\n\n\t\t\tconst vertex = vertices[ i ];\n\n\t\t\tif ( vertex !== v0 && vertex !== v1 ) {\n\n\t\t\t\t_line3.closestPointToPoint( vertex.point, true, _closestPoint );\n\n\t\t\t\tconst distance = _closestPoint.distanceToSquared( vertex.point );\n\n\t\t\t\tif ( distance > maxDistance ) {\n\n\t\t\t\t\tmaxDistance = distance;\n\t\t\t\t\tv2 = vertex;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\t// 3. The next vertex 'v3' is the one farthest to the plane 'v0', 'v1', 'v2'\n\n\t\tmaxDistance = - 1;\n\t\t_plane.setFromCoplanarPoints( v0.point, v1.point, v2.point );\n\n\t\tfor ( let i = 0, l = this.vertices.length; i < l; i ++ ) {\n\n\t\t\tconst vertex = vertices[ i ];\n\n\t\t\tif ( vertex !== v0 && vertex !== v1 && vertex !== v2 ) {\n\n\t\t\t\tconst distance = Math.abs( _plane.distanceToPoint( vertex.point ) );\n\n\t\t\t\tif ( distance > maxDistance ) {\n\n\t\t\t\t\tmaxDistance = distance;\n\t\t\t\t\tv3 = vertex;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\tconst faces = [];\n\n\t\tif ( _plane.distanceToPoint( v3.point ) < 0 ) {\n\n\t\t\t// the face is not able to see the point so 'plane.normal' is pointing outside the tetrahedron\n\n\t\t\tfaces.push(\n\t\t\t\tFace.create( v0, v1, v2 ),\n\t\t\t\tFace.create( v3, v1, v0 ),\n\t\t\t\tFace.create( v3, v2, v1 ),\n\t\t\t\tFace.create( v3, v0, v2 )\n\t\t\t);\n\n\t\t\t// set the twin edge\n\n\t\t\tfor ( let i = 0; i < 3; i ++ ) {\n\n\t\t\t\tconst j = ( i + 1 ) % 3;\n\n\t\t\t\t// join face[ i ] i > 0, with the first face\n\n\t\t\t\tfaces[ i + 1 ].getEdge( 2 ).setTwin( faces[ 0 ].getEdge( j ) );\n\n\t\t\t\t// join face[ i ] with face[ i + 1 ], 1 <= i <= 3\n\n\t\t\t\tfaces[ i + 1 ].getEdge( 1 ).setTwin( faces[ j + 1 ].getEdge( 0 ) );\n\n\t\t\t}\n\n\t\t} else {\n\n\t\t\t// the face is able to see the point so 'plane.normal' is pointing inside the tetrahedron\n\n\t\t\tfaces.push(\n\t\t\t\tFace.create( v0, v2, v1 ),\n\t\t\t\tFace.create( v3, v0, v1 ),\n\t\t\t\tFace.create( v3, v1, v2 ),\n\t\t\t\tFace.create( v3, v2, v0 )\n\t\t\t);\n\n\t\t\t// set the twin edge\n\n\t\t\tfor ( let i = 0; i < 3; i ++ ) {\n\n\t\t\t\tconst j = ( i + 1 ) % 3;\n\n\t\t\t\t// join face[ i ] i > 0, with the first face\n\n\t\t\t\tfaces[ i + 1 ].getEdge( 2 ).setTwin( faces[ 0 ].getEdge( ( 3 - i ) % 3 ) );\n\n\t\t\t\t// join face[ i ] with face[ i + 1 ]\n\n\t\t\t\tfaces[ i + 1 ].getEdge( 0 ).setTwin( faces[ j + 1 ].getEdge( 1 ) );\n\n\t\t\t}\n\n\t\t}\n\n\t\t// the initial hull is the tetrahedron\n\n\t\tfor ( let i = 0; i < 4; i ++ ) {\n\n\t\t\tthis.faces.push( faces[ i ] );\n\n\t\t}\n\n\t\t// initial assignment of vertices to the faces of the tetrahedron\n\n\t\tfor ( let i = 0, l = vertices.length; i < l; i ++ ) {\n\n\t\t\tconst vertex = vertices[ i ];\n\n\t\t\tif ( vertex !== v0 && vertex !== v1 && vertex !== v2 && vertex !== v3 ) {\n\n\t\t\t\tmaxDistance = this.tolerance;\n\t\t\t\tlet maxFace = null;\n\n\t\t\t\tfor ( let j = 0; j < 4; j ++ ) {\n\n\t\t\t\t\tconst distance = this.faces[ j ].distanceToPoint( vertex.point );\n\n\t\t\t\t\tif ( distance > maxDistance ) {\n\n\t\t\t\t\t\tmaxDistance = distance;\n\t\t\t\t\t\tmaxFace = this.faces[ j ];\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\tif ( maxFace !== null ) {\n\n\t\t\t\t\tthis.addVertexToFace( vertex, maxFace );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\t// Removes inactive faces\n\n\treindexFaces() {\n\n\t\tconst activeFaces = [];\n\n\t\tfor ( let i = 0; i < this.faces.length; i ++ ) {\n\n\t\t\tconst face = this.faces[ i ];\n\n\t\t\tif ( face.mark === Visible ) {\n\n\t\t\t\tactiveFaces.push( face );\n\n\t\t\t}\n\n\t\t}\n\n\t\tthis.faces = activeFaces;\n\n\t\treturn this;\n\n\t}\n\n\t// Finds the next vertex to create faces with the current hull\n\n\tnextVertexToAdd() {\n\n\t\t// if the 'assigned' list of vertices is empty, no vertices are left. return with 'undefined'\n\n\t\tif ( this.assigned.isEmpty() === false ) {\n\n\t\t\tlet eyeVertex, maxDistance = 0;\n\n\t\t\t// grap the first available face and start with the first visible vertex of that face\n\n\t\t\tconst eyeFace = this.assigned.first().face;\n\t\t\tlet vertex = eyeFace.outside;\n\n\t\t\t// now calculate the farthest vertex that face can see\n\n\t\t\tdo {\n\n\t\t\t\tconst distance = eyeFace.distanceToPoint( vertex.point );\n\n\t\t\t\tif ( distance > maxDistance ) {\n\n\t\t\t\t\tmaxDistance = distance;\n\t\t\t\t\teyeVertex = vertex;\n\n\t\t\t\t}\n\n\t\t\t\tvertex = vertex.next;\n\n\t\t\t} while ( vertex !== null && vertex.face === eyeFace );\n\n\t\t\treturn eyeVertex;\n\n\t\t}\n\n\t}\n\n\t// Computes a chain of half edges in CCW order called the 'horizon'.\n\t// For an edge to be part of the horizon it must join a face that can see\n\t// 'eyePoint' and a face that cannot see 'eyePoint'.\n\n\tcomputeHorizon( eyePoint, crossEdge, face, horizon ) {\n\n\t\t// moves face's vertices to the 'unassigned' vertex list\n\n\t\tthis.deleteFaceVertices( face );\n\n\t\tface.mark = Deleted;\n\n\t\tlet edge;\n\n\t\tif ( crossEdge === null ) {\n\n\t\t\tedge = crossEdge = face.getEdge( 0 );\n\n\t\t} else {\n\n\t\t\t// start from the next edge since 'crossEdge' was already analyzed\n\t\t\t// (actually 'crossEdge.twin' was the edge who called this method recursively)\n\n\t\t\tedge = crossEdge.next;\n\n\t\t}\n\n\t\tdo {\n\n\t\t\tconst twinEdge = edge.twin;\n\t\t\tconst oppositeFace = twinEdge.face;\n\n\t\t\tif ( oppositeFace.mark === Visible ) {\n\n\t\t\t\tif ( oppositeFace.distanceToPoint( eyePoint ) > this.tolerance ) {\n\n\t\t\t\t\t// the opposite face can see the vertex, so proceed with next edge\n\n\t\t\t\t\tthis.computeHorizon( eyePoint, twinEdge, oppositeFace, horizon );\n\n\t\t\t\t} else {\n\n\t\t\t\t\t// the opposite face can't see the vertex, so this edge is part of the horizon\n\n\t\t\t\t\thorizon.push( edge );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tedge = edge.next;\n\n\t\t} while ( edge !== crossEdge );\n\n\t\treturn this;\n\n\t}\n\n\t// Creates a face with the vertices 'eyeVertex.point', 'horizonEdge.tail' and 'horizonEdge.head' in CCW order\n\n\taddAdjoiningFace( eyeVertex, horizonEdge ) {\n\n\t\t// all the half edges are created in ccw order thus the face is always pointing outside the hull\n\n\t\tconst face = Face.create( eyeVertex, horizonEdge.tail(), horizonEdge.head() );\n\n\t\tthis.faces.push( face );\n\n\t\t// join face.getEdge( - 1 ) with the horizon's opposite edge face.getEdge( - 1 ) = face.getEdge( 2 )\n\n\t\tface.getEdge( - 1 ).setTwin( horizonEdge.twin );\n\n\t\treturn face.getEdge( 0 ); // the half edge whose vertex is the eyeVertex\n\n\n\t}\n\n\t//  Adds 'horizon.length' faces to the hull, each face will be linked with the\n\t//  horizon opposite face and the face on the left/right\n\n\taddNewFaces( eyeVertex, horizon ) {\n\n\t\tthis.newFaces = [];\n\n\t\tlet firstSideEdge = null;\n\t\tlet previousSideEdge = null;\n\n\t\tfor ( let i = 0; i < horizon.length; i ++ ) {\n\n\t\t\tconst horizonEdge = horizon[ i ];\n\n\t\t\t// returns the right side edge\n\n\t\t\tconst sideEdge = this.addAdjoiningFace( eyeVertex, horizonEdge );\n\n\t\t\tif ( firstSideEdge === null ) {\n\n\t\t\t\tfirstSideEdge = sideEdge;\n\n\t\t\t} else {\n\n\t\t\t\t// joins face.getEdge( 1 ) with previousFace.getEdge( 0 )\n\n\t\t\t\tsideEdge.next.setTwin( previousSideEdge );\n\n\t\t\t}\n\n\t\t\tthis.newFaces.push( sideEdge.face );\n\t\t\tpreviousSideEdge = sideEdge;\n\n\t\t}\n\n\t\t// perform final join of new faces\n\n\t\tfirstSideEdge.next.setTwin( previousSideEdge );\n\n\t\treturn this;\n\n\t}\n\n\t// Adds a vertex to the hull\n\n\taddVertexToHull( eyeVertex ) {\n\n\t\tconst horizon = [];\n\n\t\tthis.unassigned.clear();\n\n\t\t// remove 'eyeVertex' from 'eyeVertex.face' so that it can't be added to the 'unassigned' vertex list\n\n\t\tthis.removeVertexFromFace( eyeVertex, eyeVertex.face );\n\n\t\tthis.computeHorizon( eyeVertex.point, null, eyeVertex.face, horizon );\n\n\t\tthis.addNewFaces( eyeVertex, horizon );\n\n\t\t// reassign 'unassigned' vertices to the new faces\n\n\t\tthis.resolveUnassignedPoints( this.newFaces );\n\n\t\treturn\tthis;\n\n\t}\n\n\tcleanup() {\n\n\t\tthis.assigned.clear();\n\t\tthis.unassigned.clear();\n\t\tthis.newFaces = [];\n\n\t\treturn this;\n\n\t}\n\n\tcompute() {\n\n\t\tlet vertex;\n\n\t\tthis.computeInitialHull();\n\n\t\t// add all available vertices gradually to the hull\n\n\t\twhile ( ( vertex = this.nextVertexToAdd() ) !== undefined ) {\n\n\t\t\tthis.addVertexToHull( vertex );\n\n\t\t}\n\n\t\tthis.reindexFaces();\n\n\t\tthis.cleanup();\n\n\t\treturn this;\n\n\t}\n\n}\n\n//\n\nclass Face {\n\n\tconstructor() {\n\n\t\tthis.normal = new Vector3();\n\t\tthis.midpoint = new Vector3();\n\t\tthis.area = 0;\n\n\t\tthis.constant = 0; // signed distance from face to the origin\n\t\tthis.outside = null; // reference to a vertex in a vertex list this face can see\n\t\tthis.mark = Visible;\n\t\tthis.edge = null;\n\n\t}\n\n\tstatic create( a, b, c ) {\n\n\t\tconst face = new Face();\n\n\t\tconst e0 = new HalfEdge( a, face );\n\t\tconst e1 = new HalfEdge( b, face );\n\t\tconst e2 = new HalfEdge( c, face );\n\n\t\t// join edges\n\n\t\te0.next = e2.prev = e1;\n\t\te1.next = e0.prev = e2;\n\t\te2.next = e1.prev = e0;\n\n\t\t// main half edge reference\n\n\t\tface.edge = e0;\n\n\t\treturn face.compute();\n\n\t}\n\n\tgetEdge( i ) {\n\n\t\tlet edge = this.edge;\n\n\t\twhile ( i > 0 ) {\n\n\t\t\tedge = edge.next;\n\t\t\ti --;\n\n\t\t}\n\n\t\twhile ( i < 0 ) {\n\n\t\t\tedge = edge.prev;\n\t\t\ti ++;\n\n\t\t}\n\n\t\treturn edge;\n\n\t}\n\n\tcompute() {\n\n\t\tconst a = this.edge.tail();\n\t\tconst b = this.edge.head();\n\t\tconst c = this.edge.next.head();\n\n\t\t_triangle.set( a.point, b.point, c.point );\n\n\t\t_triangle.getNormal( this.normal );\n\t\t_triangle.getMidpoint( this.midpoint );\n\t\tthis.area = _triangle.getArea();\n\n\t\tthis.constant = this.normal.dot( this.midpoint );\n\n\t\treturn this;\n\n\t}\n\n\tdistanceToPoint( point ) {\n\n\t\treturn this.normal.dot( point ) - this.constant;\n\n\t}\n\n}\n\n// Entity for a Doubly-Connected Edge List (DCEL).\n\nclass HalfEdge {\n\n\n\tconstructor( vertex, face ) {\n\n\t\tthis.vertex = vertex;\n\t\tthis.prev = null;\n\t\tthis.next = null;\n\t\tthis.twin = null;\n\t\tthis.face = face;\n\n\t}\n\n\thead() {\n\n\t\treturn this.vertex;\n\n\t}\n\n\ttail() {\n\n\t\treturn this.prev ? this.prev.vertex : null;\n\n\t}\n\n\tlength() {\n\n\t\tconst head = this.head();\n\t\tconst tail = this.tail();\n\n\t\tif ( tail !== null ) {\n\n\t\t\treturn tail.point.distanceTo( head.point );\n\n\t\t}\n\n\t\treturn - 1;\n\n\t}\n\n\tlengthSquared() {\n\n\t\tconst head = this.head();\n\t\tconst tail = this.tail();\n\n\t\tif ( tail !== null ) {\n\n\t\t\treturn tail.point.distanceToSquared( head.point );\n\n\t\t}\n\n\t\treturn - 1;\n\n\t}\n\n\tsetTwin( edge ) {\n\n\t\tthis.twin = edge;\n\t\tedge.twin = this;\n\n\t\treturn this;\n\n\t}\n\n}\n\n// A vertex as a double linked list node.\n\nclass VertexNode {\n\n\tconstructor( point ) {\n\n\t\tthis.point = point;\n\t\tthis.prev = null;\n\t\tthis.next = null;\n\t\tthis.face = null; // the face that is able to see this vertex\n\n\t}\n\n}\n\n// A double linked list that contains vertex nodes.\n\nclass VertexList {\n\n\tconstructor() {\n\n\t\tthis.head = null;\n\t\tthis.tail = null;\n\n\t}\n\n\tfirst() {\n\n\t\treturn this.head;\n\n\t}\n\n\tlast() {\n\n\t\treturn this.tail;\n\n\t}\n\n\tclear() {\n\n\t\tthis.head = this.tail = null;\n\n\t\treturn this;\n\n\t}\n\n\t// Inserts a vertex before the target vertex\n\n\tinsertBefore( target, vertex ) {\n\n\t\tvertex.prev = target.prev;\n\t\tvertex.next = target;\n\n\t\tif ( vertex.prev === null ) {\n\n\t\t\tthis.head = vertex;\n\n\t\t} else {\n\n\t\t\tvertex.prev.next = vertex;\n\n\t\t}\n\n\t\ttarget.prev = vertex;\n\n\t\treturn this;\n\n\t}\n\n\t// Inserts a vertex after the target vertex\n\n\tinsertAfter( target, vertex ) {\n\n\t\tvertex.prev = target;\n\t\tvertex.next = target.next;\n\n\t\tif ( vertex.next === null ) {\n\n\t\t\tthis.tail = vertex;\n\n\t\t} else {\n\n\t\t\tvertex.next.prev = vertex;\n\n\t\t}\n\n\t\ttarget.next = vertex;\n\n\t\treturn this;\n\n\t}\n\n\t// Appends a vertex to the end of the linked list\n\n\tappend( vertex ) {\n\n\t\tif ( this.head === null ) {\n\n\t\t\tthis.head = vertex;\n\n\t\t} else {\n\n\t\t\tthis.tail.next = vertex;\n\n\t\t}\n\n\t\tvertex.prev = this.tail;\n\t\tvertex.next = null; // the tail has no subsequent vertex\n\n\t\tthis.tail = vertex;\n\n\t\treturn this;\n\n\t}\n\n\t// Appends a chain of vertices where 'vertex' is the head.\n\n\tappendChain( vertex ) {\n\n\t\tif ( this.head === null ) {\n\n\t\t\tthis.head = vertex;\n\n\t\t} else {\n\n\t\t\tthis.tail.next = vertex;\n\n\t\t}\n\n\t\tvertex.prev = this.tail;\n\n\t\t// ensure that the 'tail' reference points to the last vertex of the chain\n\n\t\twhile ( vertex.next !== null ) {\n\n\t\t\tvertex = vertex.next;\n\n\t\t}\n\n\t\tthis.tail = vertex;\n\n\t\treturn this;\n\n\t}\n\n\t// Removes a vertex from the linked list\n\n\tremove( vertex ) {\n\n\t\tif ( vertex.prev === null ) {\n\n\t\t\tthis.head = vertex.next;\n\n\t\t} else {\n\n\t\t\tvertex.prev.next = vertex.next;\n\n\t\t}\n\n\t\tif ( vertex.next === null ) {\n\n\t\t\tthis.tail = vertex.prev;\n\n\t\t} else {\n\n\t\t\tvertex.next.prev = vertex.prev;\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\t// Removes a list of vertices whose 'head' is 'a' and whose 'tail' is b\n\n\tremoveSubList( a, b ) {\n\n\t\tif ( a.prev === null ) {\n\n\t\t\tthis.head = b.next;\n\n\t\t} else {\n\n\t\t\ta.prev.next = b.next;\n\n\t\t}\n\n\t\tif ( b.next === null ) {\n\n\t\t\tthis.tail = a.prev;\n\n\t\t} else {\n\n\t\t\tb.next.prev = a.prev;\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tisEmpty() {\n\n\t\treturn this.head === null;\n\n\t}\n\n}\n\nexport { ConvexHull };\n","import {\n\tBufferGeometry,\n\tFloat32BufferAttribute\n} from 'three';\nimport { ConvexHull } from '../math/ConvexHull.js';\n\nclass ConvexGeometry extends BufferGeometry {\n\n\tconstructor( points ) {\n\n\t\tsuper();\n\n\t\t// buffers\n\n\t\tconst vertices = [];\n\t\tconst normals = [];\n\n\t\tif ( ConvexHull === undefined ) {\n\n\t\t\tconsole.error( 'THREE.ConvexBufferGeometry: ConvexBufferGeometry relies on ConvexHull' );\n\n\t\t}\n\n\t\tconst convexHull = new ConvexHull().setFromPoints( points );\n\n\t\t// generate vertices and normals\n\n\t\tconst faces = convexHull.faces;\n\n\t\tfor ( let i = 0; i < faces.length; i ++ ) {\n\n\t\t\tconst face = faces[ i ];\n\t\t\tlet edge = face.edge;\n\n\t\t\t// we move along a doubly-connected edge list to access all face points (see HalfEdge docs)\n\n\t\t\tdo {\n\n\t\t\t\tconst point = edge.head().point;\n\n\t\t\t\tvertices.push( point.x, point.y, point.z );\n\t\t\t\tnormals.push( face.normal.x, face.normal.y, face.normal.z );\n\n\t\t\t\tedge = edge.next;\n\n\t\t\t} while ( edge !== face.edge );\n\n\t\t}\n\n\t\t// build geometry\n\n\t\tthis.setAttribute( 'position', new Float32BufferAttribute( vertices, 3 ) );\n\t\tthis.setAttribute( 'normal', new Float32BufferAttribute( normals, 3 ) );\n\n\t}\n\n}\n\nexport { ConvexGeometry };\n","/* eslint-disable @typescript-eslint/no-redeclare */\r\n/**\r\n * Copied from three.js examples and added a fix\r\n */\r\n/**\r\n * @author yomboprime https://github.com/yomboprime\r\n *\r\n * @fileoverview This class can be used to subdivide a convex Geometry object into pieces.\r\n *\r\n * Usage:\r\n *\r\n * Use the function prepareBreakableObject to prepare a Mesh object to be broken.\r\n *\r\n * Then, call the various functions to subdivide the object (subdivideByImpact, cutByPlane)\r\n *\r\n * Sub-objects that are product of subdivision don't need prepareBreakableObject to be called on them.\r\n *\r\n * Requisites for the object:\r\n *\r\n *  - Mesh object must have a BufferGeometry (not Geometry) and a Material\r\n *\r\n *  - Vertex normals must be planar (not smoothed)\r\n *\r\n *  - The geometry must be convex (this is not checked in the library). You can create convex\r\n *  geometries with ConvexBufferGeometry. The BoxBufferGeometry, SphereBufferGeometry and other convex primitives\r\n *  can also be used.\r\n *\r\n * Note: This lib adds member variables to object's userData member (see prepareBreakableObject function)\r\n * Use with caution and read the code when using with other libs.\r\n *\r\n * @param {double} minSizeForBreak Min size a debris can have to break.\r\n * @param {double} smallDelta Max distance to consider that a point belongs to a plane.\r\n *\r\n */\r\nimport { Line3, Mesh, Plane, Vector3 } from 'three';\r\nimport { ConvexGeometry } from './externals';\r\nimport { logger } from '@enable3d/common/dist/logger';\r\nconst newConvexGeometry = (points) => {\r\n    // @ts-ignore\r\n    const _newConvexGeometry = window.THREE && window.THREE.ConvexGeometry ? window.THREE.ConvexGeometry : ConvexGeometry;\r\n    return new _newConvexGeometry(points);\r\n};\r\nconst ConvexObjectBreaker = function (minSizeForBreak, smallDelta) {\r\n    // @ts-ignore\r\n    this.minSizeForBreak = minSizeForBreak || 1.4;\r\n    // @ts-ignore\r\n    this.smallDelta = smallDelta || 0.0001;\r\n    // @ts-ignore\r\n    this.tempLine1 = new Line3();\r\n    // @ts-ignore\r\n    this.tempPlane1 = new Plane();\r\n    // @ts-ignore\r\n    this.tempPlane2 = new Plane();\r\n    // @ts-ignore\r\n    this.tempPlane_Cut = new Plane();\r\n    // @ts-ignore\r\n    this.tempCM1 = new Vector3();\r\n    // @ts-ignore\r\n    this.tempCM2 = new Vector3();\r\n    // @ts-ignore\r\n    this.tempVector3 = new Vector3();\r\n    // @ts-ignore\r\n    this.tempVector3_2 = new Vector3();\r\n    // @ts-ignore\r\n    this.tempVector3_3 = new Vector3();\r\n    // @ts-ignore\r\n    this.tempVector3_P0 = new Vector3();\r\n    // @ts-ignore\r\n    this.tempVector3_P1 = new Vector3();\r\n    // @ts-ignore\r\n    this.tempVector3_P2 = new Vector3();\r\n    // @ts-ignore\r\n    this.tempVector3_N0 = new Vector3();\r\n    // @ts-ignore\r\n    this.tempVector3_N1 = new Vector3();\r\n    // @ts-ignore\r\n    this.tempVector3_AB = new Vector3();\r\n    // @ts-ignore\r\n    this.tempVector3_CB = new Vector3();\r\n    // @ts-ignore\r\n    this.tempResultObjects = { object1: null, object2: null };\r\n    // @ts-ignore\r\n    this.segments = [];\r\n    var n = 30 * 30;\r\n    // @ts-ignore\r\n    for (var i = 0; i < n; i++)\r\n        this.segments[i] = false;\r\n};\r\nConvexObjectBreaker.prototype = {\r\n    constructor: ConvexObjectBreaker,\r\n    prepareBreakableObject: function (object, mass, velocity, angularVelocity, breakable) {\r\n        // object is a Object3d (normally a Mesh), must have a BufferGeometry, and it must be convex.\r\n        // Its material property is propagated to its children (sub-pieces)\r\n        // mass must be > 0\r\n        if (!object.geometry.isBufferGeometry) {\r\n            console.error('THREE.ConvexObjectBreaker.prepareBreakableObject(): Parameter object must have a BufferGeometry.');\r\n        }\r\n        object.userData.ammoPhysicsData = {}; // initialise our new data container - would be best to move this to ExtendedObject and not rely on userData at all for best compatibility\r\n        var ammoPhysicsData = object.userData.ammoPhysicsData; // get reference to it\r\n        ammoPhysicsData.mass = mass;\r\n        ammoPhysicsData.velocity = velocity.clone();\r\n        ammoPhysicsData.angularVelocity = angularVelocity.clone();\r\n        ammoPhysicsData.breakable = breakable;\r\n    },\r\n    /*\r\n     * @param {int} maxRadialIterations Iterations for radial cuts.\r\n     * @param {int} maxRandomIterations Max random iterations for not-radial cuts\r\n     *\r\n     * Returns the array of pieces\r\n     */\r\n    subdivideByImpact: function (object, pointOfImpact, normal, maxRadialIterations, maxRandomIterations) {\r\n        var debris = [];\r\n        var tempPlane1 = this.tempPlane1;\r\n        var tempPlane2 = this.tempPlane2;\r\n        this.tempVector3.addVectors(pointOfImpact, normal);\r\n        tempPlane1.setFromCoplanarPoints(pointOfImpact, object.position, this.tempVector3);\r\n        var maxTotalIterations = maxRandomIterations + maxRadialIterations;\r\n        var scope = this;\r\n        function subdivideRadial(subObject, startAngle, endAngle, numIterations) {\r\n            if (Math.random() < numIterations * 0.05 || numIterations > maxTotalIterations) {\r\n                debris.push(subObject);\r\n                return;\r\n            }\r\n            var angle = Math.PI;\r\n            if (numIterations === 0) {\r\n                tempPlane2.normal.copy(tempPlane1.normal);\r\n                tempPlane2.constant = tempPlane1.constant;\r\n            }\r\n            else {\r\n                if (numIterations <= maxRadialIterations) {\r\n                    angle = (endAngle - startAngle) * (0.2 + 0.6 * Math.random()) + startAngle;\r\n                    // Rotate tempPlane2 at impact point around normal axis and the angle\r\n                    scope.tempVector3_2.copy(object.position).sub(pointOfImpact).applyAxisAngle(normal, angle).add(pointOfImpact);\r\n                    tempPlane2.setFromCoplanarPoints(pointOfImpact, scope.tempVector3, scope.tempVector3_2);\r\n                }\r\n                else {\r\n                    angle = (0.5 * (numIterations & 1) + 0.2 * (2 - Math.random())) * Math.PI;\r\n                    // Rotate tempPlane2 at object position around normal axis and the angle\r\n                    scope.tempVector3_2\r\n                        .copy(pointOfImpact)\r\n                        .sub(subObject.position)\r\n                        .applyAxisAngle(normal, angle)\r\n                        .add(subObject.position);\r\n                    scope.tempVector3_3.copy(normal).add(subObject.position);\r\n                    tempPlane2.setFromCoplanarPoints(subObject.position, scope.tempVector3_3, scope.tempVector3_2);\r\n                }\r\n            }\r\n            // Perform the cut\r\n            scope.cutByPlane(subObject, tempPlane2, scope.tempResultObjects);\r\n            var obj1 = scope.tempResultObjects.object1;\r\n            var obj2 = scope.tempResultObjects.object2;\r\n            if (obj1) {\r\n                subdivideRadial(obj1, startAngle, angle, numIterations + 1);\r\n            }\r\n            if (obj2) {\r\n                subdivideRadial(obj2, angle, endAngle, numIterations + 1);\r\n            }\r\n        }\r\n        subdivideRadial(object, 0, 2 * Math.PI, 0);\r\n        return debris;\r\n    },\r\n    cutByPlane: function (object, plane, output) {\r\n        // Returns breakable objects in output.object1 and output.object2 members, the resulting 2 pieces of the cut.\r\n        // object2 can be null if the plane doesn't cut the object.\r\n        // object1 can be null only in case of internal error\r\n        // Returned value is number of pieces, 0 for error.\r\n        var geometry = object.geometry;\r\n        var coords = geometry.attributes.position.array;\r\n        var normals = geometry.attributes.normal.array;\r\n        var numPoints = coords.length / 3;\r\n        var numFaces = numPoints / 3;\r\n        var indices = geometry.getIndex();\r\n        if (indices) {\r\n            indices = indices.array;\r\n            numFaces = indices.length / 3;\r\n        }\r\n        function getVertexIndex(faceIdx, vert) {\r\n            // vert = 0, 1 or 2.\r\n            var idx = faceIdx * 3 + vert;\r\n            return indices ? indices[idx] : idx;\r\n        }\r\n        var points1 = [];\r\n        var points2 = [];\r\n        var delta = this.smallDelta;\r\n        // Reset segments mark\r\n        var numPointPairs = numPoints * numPoints;\r\n        for (var i = 0; i < numPointPairs; i++)\r\n            this.segments[i] = false;\r\n        var p0 = this.tempVector3_P0;\r\n        var p1 = this.tempVector3_P1;\r\n        var n0 = this.tempVector3_N0;\r\n        var n1 = this.tempVector3_N1;\r\n        // Iterate through the faces to mark edges shared by coplanar faces\r\n        for (var i = 0; i < numFaces - 1; i++) {\r\n            var a1 = getVertexIndex(i, 0);\r\n            var b1 = getVertexIndex(i, 1);\r\n            var c1 = getVertexIndex(i, 2);\r\n            // Assuming all 3 vertices have the same normal\r\n            n0.set(normals[a1], normals[a1] + 1, normals[a1] + 2);\r\n            for (var j = i + 1; j < numFaces; j++) {\r\n                var a2 = getVertexIndex(j, 0);\r\n                var b2 = getVertexIndex(j, 1);\r\n                var c2 = getVertexIndex(j, 2);\r\n                // Assuming all 3 vertices have the same normal\r\n                n1.set(normals[a2], normals[a2] + 1, normals[a2] + 2);\r\n                var coplanar = 1 - n0.dot(n1) < delta;\r\n                if (coplanar) {\r\n                    if (a1 === a2 || a1 === b2 || a1 === c2) {\r\n                        if (b1 === a2 || b1 === b2 || b1 === c2) {\r\n                            this.segments[a1 * numPoints + b1] = true;\r\n                            this.segments[b1 * numPoints + a1] = true;\r\n                        }\r\n                        else {\r\n                            this.segments[c1 * numPoints + a1] = true;\r\n                            this.segments[a1 * numPoints + c1] = true;\r\n                        }\r\n                    }\r\n                    else if (b1 === a2 || b1 === b2 || b1 === c2) {\r\n                        this.segments[c1 * numPoints + b1] = true;\r\n                        this.segments[b1 * numPoints + c1] = true;\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        // Transform the plane to object local space\r\n        var localPlane = this.tempPlane_Cut;\r\n        object.updateMatrix();\r\n        ConvexObjectBreaker.transformPlaneToLocalSpace(plane, object.matrix, localPlane);\r\n        // Iterate through the faces adding points to both pieces\r\n        for (var i = 0; i < numFaces; i++) {\r\n            var va = getVertexIndex(i, 0);\r\n            var vb = getVertexIndex(i, 1);\r\n            var vc = getVertexIndex(i, 2);\r\n            for (var segment = 0; segment < 3; segment++) {\r\n                var i0 = segment === 0 ? va : segment === 1 ? vb : vc;\r\n                var i1 = segment === 0 ? vb : segment === 1 ? vc : va;\r\n                var segmentState = this.segments[i0 * numPoints + i1];\r\n                if (segmentState)\r\n                    continue; // The segment already has been processed in another face\r\n                // Mark segment as processed (also inverted segment)\r\n                this.segments[i0 * numPoints + i1] = true;\r\n                this.segments[i1 * numPoints + i0] = true;\r\n                p0.set(coords[3 * i0], coords[3 * i0 + 1], coords[3 * i0 + 2]);\r\n                p1.set(coords[3 * i1], coords[3 * i1 + 1], coords[3 * i1 + 2]);\r\n                // mark: 1 for negative side, 2 for positive side, 3 for coplanar point\r\n                var mark0 = 0;\r\n                var d = localPlane.distanceToPoint(p0);\r\n                if (d > delta) {\r\n                    mark0 = 2;\r\n                    points2.push(p0.clone());\r\n                }\r\n                else if (d < -delta) {\r\n                    mark0 = 1;\r\n                    points1.push(p0.clone());\r\n                }\r\n                else {\r\n                    mark0 = 3;\r\n                    points1.push(p0.clone());\r\n                    points2.push(p0.clone());\r\n                }\r\n                // mark: 1 for negative side, 2 for positive side, 3 for coplanar point\r\n                var mark1 = 0;\r\n                var d = localPlane.distanceToPoint(p1);\r\n                if (d > delta) {\r\n                    mark1 = 2;\r\n                    points2.push(p1.clone());\r\n                }\r\n                else if (d < -delta) {\r\n                    mark1 = 1;\r\n                    points1.push(p1.clone());\r\n                }\r\n                else {\r\n                    mark1 = 3;\r\n                    points1.push(p1.clone());\r\n                    points2.push(p1.clone());\r\n                }\r\n                if ((mark0 === 1 && mark1 === 2) || (mark0 === 2 && mark1 === 1)) {\r\n                    // Intersection of segment with the plane\r\n                    this.tempLine1.start.copy(p0);\r\n                    this.tempLine1.end.copy(p1);\r\n                    var intersection = new Vector3();\r\n                    intersection = localPlane.intersectLine(this.tempLine1, intersection);\r\n                    if (intersection === undefined) {\r\n                        // Shouldn't happen\r\n                        console.error('Internal error: segment does not intersect plane.');\r\n                        output.segmentedObject1 = null;\r\n                        output.segmentedObject2 = null;\r\n                        return 0;\r\n                    }\r\n                    points1.push(intersection);\r\n                    points2.push(intersection.clone());\r\n                }\r\n            }\r\n        }\r\n        // Calculate debris mass (very fast and imprecise):\r\n        var newMass = object.userData.ammoPhysicsData.mass * 0.5;\r\n        // Calculate debris Center of Mass (again fast and imprecise)\r\n        this.tempCM1.set(0, 0, 0);\r\n        var radius1 = 0;\r\n        var numPoints1 = points1.length;\r\n        if (numPoints1 > 0) {\r\n            for (var i = 0; i < numPoints1; i++)\r\n                this.tempCM1.add(points1[i]);\r\n            this.tempCM1.divideScalar(numPoints1);\r\n            for (var i = 0; i < numPoints1; i++) {\r\n                var p = points1[i];\r\n                p.sub(this.tempCM1);\r\n                radius1 = Math.max(radius1, p.x, p.y, p.z);\r\n            }\r\n            this.tempCM1.add(object.position);\r\n        }\r\n        this.tempCM2.set(0, 0, 0);\r\n        var radius2 = 0;\r\n        var numPoints2 = points2.length;\r\n        if (numPoints2 > 0) {\r\n            for (var i = 0; i < numPoints2; i++)\r\n                this.tempCM2.add(points2[i]);\r\n            this.tempCM2.divideScalar(numPoints2);\r\n            for (var i = 0; i < numPoints2; i++) {\r\n                var p = points2[i];\r\n                p.sub(this.tempCM2);\r\n                radius2 = Math.max(radius2, p.x, p.y, p.z);\r\n            }\r\n            this.tempCM2.add(object.position);\r\n        }\r\n        var object1 = null;\r\n        var object2 = null;\r\n        var numObjects = 0;\r\n        /**\r\n         * MOD: Wrapped in try catch block to avoid errors\r\n         */\r\n        if (numPoints1 > 4) {\r\n            try {\r\n                object1 = new Mesh(newConvexGeometry(points1), object.material);\r\n                object1.position.copy(this.tempCM1);\r\n                object1.quaternion.copy(object.quaternion);\r\n                object1.userData = object.userData;\r\n                this.prepareBreakableObject(object1, newMass, object.userData.ammoPhysicsData.velocity, object.userData.ammoPhysicsData.angularVelocity, 2 * radius1 > this.minSizeForBreak);\r\n                numObjects++;\r\n            }\r\n            catch (error) {\r\n                logger('Error in ConvexObjectBreaker.ts', true);\r\n                logger(error, true);\r\n            }\r\n        }\r\n        if (numPoints2 > 4) {\r\n            try {\r\n                object2 = new Mesh(newConvexGeometry(points2), object.material);\r\n                object2.position.copy(this.tempCM2);\r\n                object2.quaternion.copy(object.quaternion);\r\n                object2.userData = object.userData;\r\n                this.prepareBreakableObject(object2, newMass, object.userData.ammoPhysicsData.velocity, object.userData.ammoPhysicsData.angularVelocity, 2 * radius2 > this.minSizeForBreak);\r\n                numObjects++;\r\n            }\r\n            catch (error) {\r\n                logger('Error in ConvexObjectBreaker.ts', true);\r\n                logger(error, true);\r\n            }\r\n        }\r\n        output.object1 = object1;\r\n        output.object2 = object2;\r\n        return numObjects;\r\n    }\r\n};\r\nConvexObjectBreaker.transformFreeVector = function (v, m) {\r\n    // input:\r\n    // vector interpreted as a free vector\r\n    // THREE.Matrix4 orthogonal matrix (matrix without scale)\r\n    var x = v.x, y = v.y, z = v.z;\r\n    var e = m.elements;\r\n    v.x = e[0] * x + e[4] * y + e[8] * z;\r\n    v.y = e[1] * x + e[5] * y + e[9] * z;\r\n    v.z = e[2] * x + e[6] * y + e[10] * z;\r\n    return v;\r\n};\r\nConvexObjectBreaker.transformFreeVectorInverse = function (v, m) {\r\n    // input:\r\n    // vector interpreted as a free vector\r\n    // THREE.Matrix4 orthogonal matrix (matrix without scale)\r\n    var x = v.x, y = v.y, z = v.z;\r\n    var e = m.elements;\r\n    v.x = e[0] * x + e[1] * y + e[2] * z;\r\n    v.y = e[4] * x + e[5] * y + e[6] * z;\r\n    v.z = e[8] * x + e[9] * y + e[10] * z;\r\n    return v;\r\n};\r\nConvexObjectBreaker.transformTiedVectorInverse = function (v, m) {\r\n    // input:\r\n    // vector interpreted as a tied (ordinary) vector\r\n    // THREE.Matrix4 orthogonal matrix (matrix without scale)\r\n    var x = v.x, y = v.y, z = v.z;\r\n    var e = m.elements;\r\n    v.x = e[0] * x + e[1] * y + e[2] * z - e[12];\r\n    v.y = e[4] * x + e[5] * y + e[6] * z - e[13];\r\n    v.z = e[8] * x + e[9] * y + e[10] * z - e[14];\r\n    return v;\r\n};\r\nConvexObjectBreaker.transformPlaneToLocalSpace = (function () {\r\n    var v1 = new Vector3();\r\n    return function transformPlaneToLocalSpace(plane, m, resultPlane) {\r\n        resultPlane.normal.copy(plane.normal);\r\n        resultPlane.constant = plane.constant;\r\n        var referencePoint = ConvexObjectBreaker.transformTiedVectorInverse(plane.coplanarPoint(v1), m);\r\n        ConvexObjectBreaker.transformFreeVectorInverse(resultPlane.normal, m);\r\n        // recalculate constant (like in setFromNormalAndCoplanarPoint)\r\n        resultPlane.constant = -referencePoint.dot(resultPlane.normal);\r\n    };\r\n})();\r\nexport { ConvexObjectBreaker };\r\n//# sourceMappingURL=convexObjectBreaker.js.map","// Inspired by https://github.com/playcanvas/engine/blob/master/examples/wasm-loader.js\r\nconst wasmSupported = (() => {\r\n    try {\r\n        if (typeof WebAssembly === 'object' && typeof WebAssembly.instantiate === 'function') {\r\n            const module = new WebAssembly.Module(Uint8Array.of(0x0, 0x61, 0x73, 0x6d, 0x01, 0x00, 0x00, 0x00));\r\n            if (module instanceof WebAssembly.Module)\r\n                return new WebAssembly.Instance(module) instanceof WebAssembly.Instance;\r\n        }\r\n    }\r\n    catch (e) {\r\n        console.error(e.message);\r\n    }\r\n    return false;\r\n})();\r\nconst loadScriptAsync = (url, doneCallback) => {\r\n    var tag = document.createElement('script');\r\n    tag.onload = () => {\r\n        doneCallback();\r\n    };\r\n    tag.onerror = () => {\r\n        throw new Error(`failed to load ${url}`);\r\n    };\r\n    tag.async = true;\r\n    tag.src = url;\r\n    document.head.appendChild(tag);\r\n};\r\nconst loadAmmoModule = (path, doneCallback) => {\r\n    // console.log(wasmSupported ? 'WebAssembly is supported' : 'WebAssembly is not supported')\r\n    if (wasmSupported)\r\n        loadScriptAsync(`${path}/ammo.wasm.js`, () => doneCallback());\r\n    else\r\n        loadScriptAsync(`${path}/ammo.js`, () => doneCallback());\r\n};\r\nexport default loadAmmoModule;\r\n//# sourceMappingURL=wasmLoader.js.map","import loadAmmoModule from './wasmLoader';\r\nconst PhysicsLoader = (path, callback) => {\r\n    if (typeof window !== 'undefined')\r\n        window.__loadPhysics = true;\r\n    loadAmmoModule(path, () => {\r\n        Ammo().then(() => {\r\n            callback();\r\n        });\r\n    });\r\n};\r\nexport { PhysicsLoader };\r\n//# sourceMappingURL=physicsLoader.js.map","// https://www.typescriptlang.org/docs/handbook/mixins.html\r\nconst applyMixins = (derivedCtor, baseCtors) => {\r\n    baseCtors.forEach(baseCtor => {\r\n        Object.getOwnPropertyNames(baseCtor.prototype).forEach(name => {\r\n            // @ts-ignore\r\n            Object.defineProperty(derivedCtor.prototype, name, Object.getOwnPropertyDescriptor(baseCtor.prototype, name));\r\n        });\r\n    });\r\n};\r\nexport default applyMixins;\r\n//# sourceMappingURL=applyMixins.js.map","/**\r\n * @author       Yannick Deubel (https://github.com/yandeu)\r\n * @copyright    Copyright (c) 2020 Yannick Deubel; Project Url: https://github.com/enable3d/enable3d\r\n * @license      {@link https://github.com/enable3d/enable3d/blob/master/LICENSE|GNU GPLv3}\r\n */\r\nimport applyMixins from '@enable3d/common/dist/applyMixins';\r\nimport ClosestRayResultCallback from './closestRayResultCallback';\r\nimport AllHitsRayResultCallback from './allHitsRayResultCallback';\r\nclass Raycaster {\r\n    constructor(physics) {\r\n        this.physics = physics;\r\n    }\r\n    setRayFromWorld(x = 0, y = 0, z = 0) {\r\n        this._btRayFrom.setValue(x, y, z);\r\n    }\r\n    setRayToWorld(x = 0, y = 0, z = 0) {\r\n        this._btRayTo.setValue(x, y, z);\r\n    }\r\n    hasHit() {\r\n        return this._btRayCallback.hasHit();\r\n    }\r\n    rayTest() {\r\n        if (typeof this._btRayCallback !== 'undefined')\r\n            Ammo.destroy(this._btRayCallback);\r\n        this._btRayCallback =\r\n            this.type === 'closest'\r\n                ? new Ammo.ClosestRayResultCallback(this._btRayFrom, this._btRayTo)\r\n                : new Ammo.AllHitsRayResultCallback(this._btRayFrom, this._btRayTo);\r\n        this.physics.physicsWorld.rayTest(this._btRayFrom, this._btRayTo, this._btRayCallback);\r\n    }\r\n    destroy() {\r\n        if (typeof this._btRayFrom !== 'undefined')\r\n            Ammo.destroy(this._btRayFrom);\r\n        if (typeof this._btRayTo !== 'undefined')\r\n            Ammo.destroy(this._btRayTo);\r\n        if (typeof this._btRayCallback !== 'undefined')\r\n            Ammo.destroy(this._btRayCallback);\r\n    }\r\n}\r\nclass ClosestRaycaster {\r\n    constructor(physics) {\r\n        this.physics = physics;\r\n        this.type = 'closest';\r\n        this._btRayFrom = new Ammo.btVector3(0, 0, 0);\r\n        this._btRayTo = new Ammo.btVector3(0, 0, 0);\r\n    }\r\n}\r\nclass AllHitsRaycaster {\r\n    constructor(physics) {\r\n        this.physics = physics;\r\n        this.type = 'allHits';\r\n        this._btRayFrom = new Ammo.btVector3(0, 0, 0);\r\n        this._btRayTo = new Ammo.btVector3(0, 0, 0);\r\n    }\r\n}\r\napplyMixins(ClosestRaycaster, [Raycaster, ClosestRayResultCallback]);\r\napplyMixins(AllHitsRaycaster, [Raycaster, AllHitsRayResultCallback]);\r\nexport { ClosestRaycaster, AllHitsRaycaster };\r\n//# sourceMappingURL=raycaster.js.map","/**\r\n * @author       Yannick Deubel (https://github.com/yandeu)\r\n * @copyright    Copyright (c) 2020 Yannick Deubel; Project Url: https://github.com/enable3d/enable3d\r\n * @license      {@link https://github.com/enable3d/enable3d/blob/master/LICENSE|GNU GPLv3}\r\n */\r\nexport default class ClosestRayResultCallback {\r\n    constructor(physics) {\r\n        this.physics = physics;\r\n    }\r\n    getHitPointWorld() {\r\n        const h = this._btRayCallback.get_m_hitPointWorld();\r\n        const point = { x: h.x(), y: h.y(), z: h.z() };\r\n        return point;\r\n    }\r\n    getHitNormalWorld() {\r\n        const h = this._btRayCallback.get_m_hitNormalWorld();\r\n        const normal = { x: h.x(), y: h.y(), z: h.z() };\r\n        return normal;\r\n    }\r\n    getCollisionObject() {\r\n        // @ts-ignore\r\n        const rb = Ammo.castObject(this._btRayCallback.get_m_collisionObject(), Ammo.btRigidBody);\r\n        // @ts-ignore\r\n        return rb.threeObject;\r\n    }\r\n}\r\n//# sourceMappingURL=closestRayResultCallback.js.map","/**\r\n * @author       Yannick Deubel (https://github.com/yandeu)\r\n * @copyright    Copyright (c) 2020 Yannick Deubel; Project Url: https://github.com/enable3d/enable3d\r\n * @license      {@link https://github.com/enable3d/enable3d/blob/master/LICENSE|GNU GPLv3}\r\n */\r\nimport { logger } from '@enable3d/common/dist/logger';\r\nexport default class AllHitsRayResultCallback {\r\n    constructor(physics) {\r\n        this.physics = physics;\r\n    }\r\n    getHitPointsWorld() {\r\n        const h = this._btRayCallback.get_m_hitPointWorld();\r\n        const points = [];\r\n        for (let i = h.size() - 1; i >= 0; i--) {\r\n            const hh = h.at(i);\r\n            points.push({ x: hh.x(), y: hh.y(), z: hh.z() });\r\n        }\r\n        return points;\r\n    }\r\n    // TODO: Remove this in future versions!\r\n    getHitPointWorld() {\r\n        logger('Use getHitPointsWorld() instead of getHitPointWorld() for the AllHitsRayCaster!');\r\n        return this.getHitPointsWorld();\r\n    }\r\n    getHitNormalsWorld() {\r\n        const h = this._btRayCallback.get_m_hitNormalWorld();\r\n        const normals = [];\r\n        for (let i = h.size() - 1; i >= 0; i--) {\r\n            const hh = h.at(i);\r\n            normals.push({ x: hh.x(), y: hh.y(), z: hh.z() });\r\n        }\r\n        return normals;\r\n    }\r\n    getCollisionObjects() {\r\n        const threeObjects = [];\r\n        const objects = this._btRayCallback.get_m_collisionObjects();\r\n        for (let i = objects.size() - 1; i >= 0; i--) {\r\n            // @ts-ignore\r\n            const rb = Ammo.castObject(objects.at(i), Ammo.btRigidBody);\r\n            // @ts-ignore\r\n            threeObjects.push(rb.threeObject);\r\n        }\r\n        return threeObjects;\r\n    }\r\n}\r\n//# sourceMappingURL=allHitsRayResultCallback.js.map","/**\r\n * @author       Yannick Deubel (https://github.com/yandeu)\r\n * @copyright    Copyright (c) 2020 Yannick Deubel; Project Url: https://github.com/enable3d/enable3d\r\n * @license      {@link https://github.com/enable3d/enable3d/blob/master/LICENSE|GNU GPLv3}\r\n */\r\nimport { logger } from '@enable3d/common/dist/logger';\r\nimport PhysicsBody from '@enable3d/common/dist/physicsBody';\r\nimport { ExtendedObject3D } from '@enable3d/common/dist/extendedObject3D';\r\nexport { ExtendedObject3D };\r\nimport { ExtendedMesh } from '@enable3d/common/dist/extendedMesh';\r\nexport { ExtendedMesh };\r\nimport { ExtendedGroup } from '@enable3d/common/dist/extendedGroup';\r\nexport { ExtendedGroup };\r\nimport Shapes from './shapes';\r\nimport Constraints from './constraints';\r\nimport { Events } from '@yandeu/events';\r\nimport { BufferGeometry, Euler, Matrix4, Quaternion, REVISION, Vector3 } from 'three';\r\nimport { createHACDShapes, createHullShape, createTriMeshShape, createVHACDShapes, iterateGeometries } from './three-to-ammo';\r\nimport { createTorusShape } from './torusShape';\r\nimport Factories from '@enable3d/common/dist/factories';\r\nimport { CollisionEvents } from './collisionEvents';\r\nimport DebugDrawer from './debugDrawer';\r\nimport { ConvexObjectBreaker } from './convexObjectBreaker';\r\nimport { PhysicsLoader } from '@enable3d/common/dist/physicsLoader';\r\nimport DefaultMaterial from '@enable3d/common/dist/defaultMaterial';\r\nexport { PhysicsLoader };\r\nimport * as Types from '@enable3d/common/dist/types';\r\nimport { AllHitsRaycaster, ClosestRaycaster } from './raycaster/raycaster';\r\nexport { ClosestRaycaster, AllHitsRaycaster };\r\nexport { Types };\r\n// Export THREE.Clock\r\nexport { Clock } from './lib/Clock';\r\nclass AmmoPhysics extends Events {\r\n    constructor(scene, config = {}) {\r\n        super();\r\n        this.scene = scene;\r\n        this.config = config;\r\n        this.rigidBodies = [];\r\n        this.earlierDetectedCollisions = [];\r\n        this.complexShapes = ['plane', 'hull', 'hacd', 'vhacd', 'convexMesh', 'concaveMesh'];\r\n        this.gravity = config.gravity || { x: 0, y: -9.81, z: 0 };\r\n        this.isHeadless = scene === 'headless' ? true : false;\r\n        this.tmpEuler = new Euler();\r\n        this.tmpQuaternion = new Quaternion();\r\n        this.tmpVector3 = new Vector3();\r\n        this.tmpVector3a = new Vector3();\r\n        this.tmpMatrix4 = new Matrix4();\r\n        this.tmpMatrix4a = new Matrix4();\r\n        this.tmpBtVector3 = new Ammo.btVector3();\r\n        this.tmpBtQuaternion = new Ammo.btQuaternion(0, 0, 0, 1);\r\n        this.emptyV3 = new Vector3();\r\n        this.impactPoint = new Vector3();\r\n        this.impactNormal = new Vector3();\r\n        if (scene !== 'headless') {\r\n            this.defaultMaterial = new DefaultMaterial();\r\n            // const info = `Ammo.js physics provided by enable3d`\r\n            // console.log(\r\n            //   `%c %c %c %c %c ${info} %c https://enable3d.io/`,\r\n            //   'background: #ff0000',\r\n            //   'background: #ffff00',\r\n            //   'background: #00ff00',\r\n            //   'background: #00ffff',\r\n            //   'color: #fff; background: #000000;',\r\n            //   'background: none'\r\n            // )\r\n        }\r\n        this.start();\r\n    }\r\n    /** @deprecated Use worldTransform instead of tmpTrans. */\r\n    get tmpTrans() {\r\n        console.warn('Use worldTransform instead of tmpTrans.');\r\n        return this.worldTransform;\r\n    }\r\n    /** @deprecated Use worldTransform instead of tmpTrans. */\r\n    set tmpTrans(transform) {\r\n        console.warn('Use worldTransform instead of tmpTrans.');\r\n        this.worldTransform = transform;\r\n    }\r\n    /** Destroys a physics body. */\r\n    destroy(body) {\r\n        var _a;\r\n        // @ts-ignore\r\n        const b = Object.keys(body).includes('body') ? body.body : body;\r\n        if (typeof (b === null || b === void 0 ? void 0 : b.ammo) === 'undefined')\r\n            return;\r\n        // @ts-ignore\r\n        const name = b.ammo.name;\r\n        // @ts-ignore\r\n        let obj = b.ammo.threeObject;\r\n        if (name && obj) {\r\n            if ((_a = obj === null || obj === void 0 ? void 0 : obj.body) === null || _a === void 0 ? void 0 : _a.ammo) {\r\n                // remove from physics world\r\n                !obj.body.isSoftBody\r\n                    ? this.physicsWorld.removeRigidBody(obj.body.ammo)\r\n                    : this.physicsWorld.removeSoftBody(obj.body.ammo);\r\n                // call destructor on body\r\n                obj.body.destructor();\r\n                // reset properties\r\n                // @ts-ignore\r\n                obj.body = undefined;\r\n                obj.hasBody = false;\r\n                // remove from this.objectAmmo\r\n                // @ts-ignore\r\n                delete b.ammo.threeObject;\r\n                // remove from this.rigidBodies\r\n                for (let i = 0; i < this.rigidBodies.length; i++) {\r\n                    if (this.rigidBodies[i].name === name) {\r\n                        this.rigidBodies.splice(i, 1);\r\n                        i--;\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        if (this.scene === 'headless' && obj)\r\n            obj = null;\r\n    }\r\n    setup() {\r\n        // add worldTransform\r\n        this.worldTransform = new Ammo.btTransform();\r\n        // setup ammo physics\r\n        if (typeof this.config.setupPhysicsWorld === 'function')\r\n            this.physicsWorld = this.config.setupPhysicsWorld();\r\n        else\r\n            this.physicsWorld = this.setupPhysicsWorld();\r\n        if (this.scene !== 'headless') {\r\n            // Initialize convexBreaker\r\n            // @ts-ignore\r\n            this.convexBreaker = new ConvexObjectBreaker();\r\n            this.objectsToRemove = [];\r\n            this.numObjectsToRemove = 0;\r\n            for (let i = 0; i < 500; i++) {\r\n                this.objectsToRemove[i] = null;\r\n            }\r\n        }\r\n        this.collisionEvents = new CollisionEvents();\r\n        this.factory = new Factories(this.scene);\r\n        this.shapes = new Shapes(this.factory, (object, config) => this.addExisting(object, config));\r\n        this.constraints = new Constraints(this.worldTransform, this.physicsWorld);\r\n        if (this.scene !== 'headless')\r\n            this.debugDrawer = new DebugDrawer(this.scene, this.physicsWorld, {});\r\n    }\r\n    updateDebugger() {\r\n        if (this.scene === 'headless')\r\n            return;\r\n        if (this.debugDrawer && this.debugDrawer.enabled)\r\n            this.debugDrawer.update();\r\n    }\r\n    setupPhysicsWorld() {\r\n        const g = this.gravity;\r\n        const { softBodies = false } = this.config;\r\n        let physicsWorld;\r\n        if (!softBodies) {\r\n            const collisionConfiguration = new Ammo.btDefaultCollisionConfiguration(), dispatcher = new Ammo.btCollisionDispatcher(collisionConfiguration), broadphase = new Ammo.btDbvtBroadphase(), solver = new Ammo.btSequentialImpulseConstraintSolver();\r\n            physicsWorld = new Ammo.btDiscreteDynamicsWorld(dispatcher, broadphase, solver, collisionConfiguration);\r\n        }\r\n        if (softBodies) {\r\n            const collisionConfiguration = new Ammo.btSoftBodyRigidBodyCollisionConfiguration(), dispatcher = new Ammo.btCollisionDispatcher(collisionConfiguration), broadphase = new Ammo.btDbvtBroadphase(), solver = new Ammo.btSequentialImpulseConstraintSolver(), softBodySolver = new Ammo.btDefaultSoftBodySolver();\r\n            physicsWorld = new Ammo.btSoftRigidDynamicsWorld(dispatcher, broadphase, solver, collisionConfiguration, softBodySolver);\r\n        }\r\n        physicsWorld.setGravity(new Ammo.btVector3(g.x, g.y, g.z));\r\n        return physicsWorld;\r\n    }\r\n    createDebrisFromBreakableObject(object, parent) {\r\n        if (this.scene === 'headless')\r\n            return;\r\n        object.material = parent.material;\r\n        object.shape = 'hull';\r\n        object.fragmentDepth = parent.fragmentDepth + 1;\r\n        // Add the object to the scene\r\n        this.scene.add(object);\r\n        // Add physics to the object\r\n        // @ts-ignore\r\n        this.addExisting(object);\r\n        object.body.fractureImpulse = parent.body.fractureImpulse;\r\n        object.body.breakable = false;\r\n        // make this fragment breakable in 2.5seconds\r\n        setTimeout(() => {\r\n            object.body.breakable = true;\r\n        }, 2500);\r\n    }\r\n    removeDebris(object) {\r\n        if (this.scene === 'headless')\r\n            return;\r\n        this.scene.remove(object);\r\n        this.destroy(object);\r\n    }\r\n    update(delta) {\r\n        this.updatePhysics(delta);\r\n        this.detectCollisions();\r\n    }\r\n    updatePhysics(delta) {\r\n        // step world\r\n        const deltaTime = delta / 1000;\r\n        // must always satisfy the equation timeStep < maxSubSteps * fixedTimeStep\r\n        this.physicsWorld.stepSimulation(deltaTime, this.config.maxSubSteps || 4, this.config.fixedTimeStep || 1 / 60);\r\n        // update rigid bodies\r\n        for (let i = 0; i < this.rigidBodies.length; i++) {\r\n            const objThree = this.rigidBodies[i];\r\n            const objPhys = objThree.body.ammo;\r\n            const ms = objPhys.getMotionState();\r\n            if (ms) {\r\n                ms.getWorldTransform(this.worldTransform);\r\n                // check if object did an update since last call\r\n                if (objThree.body.didUpdate) {\r\n                    // @ts-ignore\r\n                    if (objThree.body._emitUpdateEvents)\r\n                        objThree.body.eventEmitter.emit('update');\r\n                    objThree.body.didUpdate = false;\r\n                }\r\n                // update positions\r\n                if (objThree.body.ammo.isKinematicObject() && objThree.body.needUpdate) {\r\n                    // get position and rotation\r\n                    objThree.getWorldQuaternion(this.tmpQuaternion);\r\n                    objThree.getWorldPosition(this.tmpVector3);\r\n                    // adjust tmp variables\r\n                    this.tmpBtVector3.setValue(this.tmpVector3.x, this.tmpVector3.y, this.tmpVector3.z);\r\n                    this.tmpBtQuaternion.setValue(this.tmpQuaternion.x, this.tmpQuaternion.y, this.tmpQuaternion.z, this.tmpQuaternion.w);\r\n                    // set position and rotation\r\n                    this.worldTransform.setOrigin(this.tmpBtVector3);\r\n                    this.worldTransform.setRotation(this.tmpBtQuaternion);\r\n                    // set transform\r\n                    ms.setWorldTransform(this.worldTransform);\r\n                    // reset needsUpdate\r\n                    objThree.body.needUpdate = false;\r\n                }\r\n                else if (objThree.body.skipUpdate) {\r\n                    // do nothing ...\r\n                }\r\n                else if (!objThree.body.ammo.isStaticObject()) {\r\n                    // get position and rotation\r\n                    const p = this.worldTransform.getOrigin();\r\n                    const q = this.worldTransform.getRotation();\r\n                    // body offset\r\n                    const o = objThree.body.offset;\r\n                    // set position and rotation\r\n                    if (objThree.body.ignoreScale) {\r\n                        this.tmpVector3a.set(objThree.scale.x, objThree.scale.y, objThree.scale.z);\r\n                    }\r\n                    else {\r\n                        const scale = objThree.body.ammo.getCollisionShape().getLocalScaling();\r\n                        this.tmpVector3a.set(scale.x(), scale.y(), scale.z());\r\n                    }\r\n                    this.tmpVector3.set(p.x() + o.x, p.y() + o.y, p.z() + o.z);\r\n                    this.tmpQuaternion.set(q.x(), q.y(), q.z(), q.w());\r\n                    this.tmpMatrix4.compose(this.tmpVector3, this.tmpQuaternion, this.tmpVector3a);\r\n                    if (objThree.parent) {\r\n                        // compatibility fix for three.js >= r123 (Dezember 2020)\r\n                        // @ts-ignore\r\n                        if (parseInt(REVISION) >= 123)\r\n                            this.tmpMatrix4a.copy(objThree.parent.matrixWorld).invert();\r\n                        else\r\n                            this.tmpMatrix4a.getInverse(objThree.parent.matrixWorld);\r\n                    }\r\n                    else {\r\n                        this.tmpMatrix4a.identity();\r\n                    }\r\n                    this.tmpMatrix4a.multiply(this.tmpMatrix4);\r\n                    this.tmpMatrix4a.decompose(objThree.position, objThree.quaternion, objThree.scale);\r\n                }\r\n            }\r\n        }\r\n    }\r\n    detectCollisions() {\r\n        var _a, _b;\r\n        const detectedCollisions = [];\r\n        // reset these vectors\r\n        this.impactPoint.set(0, 0, 0);\r\n        this.impactNormal.set(0, 0, 0);\r\n        const dispatcher = this.physicsWorld.getDispatcher();\r\n        const numManifolds = dispatcher.getNumManifolds();\r\n        // check collisions\r\n        for (let i = 0; i < numManifolds; i++) {\r\n            const contactManifold = dispatcher.getManifoldByIndexInternal(i);\r\n            const numContacts = contactManifold.getNumContacts();\r\n            // @ts-ignore\r\n            const rb0 = Ammo.castObject(contactManifold.getBody0(), Ammo.btRigidBody);\r\n            // @ts-ignore\r\n            const rb1 = Ammo.castObject(contactManifold.getBody1(), Ammo.btRigidBody);\r\n            const threeObject0 = rb0.threeObject;\r\n            const threeObject1 = rb1.threeObject;\r\n            if (!threeObject0 || !threeObject1) {\r\n                continue;\r\n            }\r\n            // do not check collision between 2 unnamed objects\r\n            // (fragments do not have a name, for example)\r\n            if (rb0.name === '' && rb1.name === '')\r\n                continue;\r\n            /**\r\n             * Get some information\r\n             */\r\n            const checkCollisions0 = (_a = threeObject0.body) === null || _a === void 0 ? void 0 : _a.checkCollisions;\r\n            const checkCollisions1 = (_b = threeObject1.body) === null || _b === void 0 ? void 0 : _b.checkCollisions;\r\n            const breakable0 = threeObject0.body.breakable;\r\n            const breakable1 = threeObject1.body.breakable;\r\n            const fractureImpulse0 = threeObject0.body.fractureImpulse;\r\n            const fractureImpulse1 = threeObject1.body.fractureImpulse;\r\n            const checkCollisions = checkCollisions0 || checkCollisions1;\r\n            const checkBreakable = breakable0 || breakable1;\r\n            if (!checkCollisions && !checkBreakable)\r\n                continue;\r\n            let contact = false;\r\n            let maxImpulse = 0;\r\n            let event = 'start';\r\n            for (let j = 0; j < numContacts; j++) {\r\n                const contactPoint = contactManifold.getContactPoint(j);\r\n                const distance = contactPoint.getDistance();\r\n                // Distance definition: when the distance between objects is positive, they are separated. When the distance is negative, they are penetrating. Zero distance means exactly touching.\r\n                // https://pybullet.org/Bullet/phpBB3/viewtopic.php?t=5831\r\n                if (distance <= 0) {\r\n                    contact = true;\r\n                    const impulse = contactPoint.getAppliedImpulse();\r\n                    const impactPoint = contactPoint.get_m_positionWorldOnB();\r\n                    const impactNormal = contactPoint.get_m_normalWorldOnB();\r\n                    // handle collision events\r\n                    if (checkCollisions0 || checkCollisions1) {\r\n                        const names = [threeObject0.name, threeObject1.name].sort();\r\n                        const combinedName = `${names[0]}__${names[1]}`;\r\n                        if (this.earlierDetectedCollisions.find(el => el.combinedName === combinedName))\r\n                            event = 'collision';\r\n                        if (!detectedCollisions.find(el => el.combinedName === combinedName)) {\r\n                            detectedCollisions.push({ combinedName, collision: true });\r\n                            this.collisionEvents.emit('collision', { bodies: [threeObject0, threeObject1], event });\r\n                        }\r\n                    }\r\n                    // get impactPoint and impactNormal of the hight impulse point (for breakable objects)\r\n                    if (impulse >= maxImpulse) {\r\n                        maxImpulse = impulse;\r\n                        // get what ween need for the convex breaking\r\n                        if (breakable0 || breakable1) {\r\n                            this.impactPoint.set(impactPoint.x(), impactPoint.y(), impactPoint.z());\r\n                            this.impactNormal.set(impactNormal.x(), impactNormal.y(), impactNormal.z());\r\n                        }\r\n                    }\r\n                    break;\r\n                }\r\n            }\r\n            // if no point has contact, abort\r\n            if (!contact)\r\n                continue;\r\n            // if no objects are breakable, abort\r\n            if (!checkBreakable)\r\n                continue;\r\n            /**\r\n             * check for breakable objects (subdivision)\r\n             */\r\n            const MAX_FRAGMENT_DEPTH = 2;\r\n            // since the library convexBreaker makes use of three's userData.ammoPhysicsData\r\n            // we have to clone the necessary params to threeObjectX.userData.ammoPhysicsData\r\n            // TODO improve this\r\n            this.emptyV3.set(0, 0, 0);\r\n            threeObject0.userData.ammoPhysicsData = {\r\n                mass: 1,\r\n                velocity: this.emptyV3,\r\n                angularVelocity: this.emptyV3,\r\n                breakable: breakable0,\r\n                physicsBody: rb0\r\n            };\r\n            threeObject1.userData.ammoPhysicsData = {\r\n                mass: 1,\r\n                velocity: this.emptyV3,\r\n                angularVelocity: this.emptyV3,\r\n                breakable: breakable1,\r\n                physicsBody: rb1\r\n            };\r\n            // threeObject0\r\n            if (breakable0 && maxImpulse > fractureImpulse0 && threeObject0.fragmentDepth < MAX_FRAGMENT_DEPTH) {\r\n                const debris = this.convexBreaker.subdivideByImpact(threeObject0, this.impactPoint, this.impactNormal, 1, 2); //, 1.5)\r\n                const numObjects = debris.length;\r\n                for (let j = 0; j < numObjects; j++) {\r\n                    const vel = rb0.getLinearVelocity();\r\n                    const angVel = rb0.getAngularVelocity();\r\n                    const fragment = debris[j];\r\n                    fragment.userData.ammoPhysicsData.velocity.set(vel.x(), vel.y(), vel.z());\r\n                    fragment.userData.ammoPhysicsData.angularVelocity.set(angVel.x(), angVel.y(), angVel.z());\r\n                    this.createDebrisFromBreakableObject(fragment, threeObject0);\r\n                }\r\n                this.objectsToRemove[this.numObjectsToRemove++] = threeObject0;\r\n            }\r\n            // threeObject1\r\n            if (breakable1 && maxImpulse > fractureImpulse1 && threeObject1.fragmentDepth < MAX_FRAGMENT_DEPTH) {\r\n                const debris = this.convexBreaker.subdivideByImpact(threeObject1, this.impactPoint, this.impactNormal, 1, 2); //, 1.5)\r\n                const numObjects = debris.length;\r\n                for (let j = 0; j < numObjects; j++) {\r\n                    const vel = rb1.getLinearVelocity();\r\n                    const angVel = rb1.getAngularVelocity();\r\n                    const fragment = debris[j];\r\n                    fragment.userData.ammoPhysicsData.velocity.set(vel.x(), vel.y(), vel.z());\r\n                    fragment.userData.ammoPhysicsData.angularVelocity.set(angVel.x(), angVel.y(), angVel.z());\r\n                    this.createDebrisFromBreakableObject(fragment, threeObject1);\r\n                }\r\n                this.objectsToRemove[this.numObjectsToRemove++] = threeObject1;\r\n            }\r\n        }\r\n        // remove objects\r\n        for (let i = 0; i < this.numObjectsToRemove; i++) {\r\n            this.removeDebris(this.objectsToRemove[i]);\r\n        }\r\n        this.numObjectsToRemove = 0;\r\n        // handle collision end events\r\n        this.earlierDetectedCollisions.forEach(el => {\r\n            const { combinedName } = el;\r\n            if (!detectedCollisions.find(el => el.combinedName === combinedName)) {\r\n                const split = combinedName.split('__');\r\n                const obj0 = this.rigidBodies.find(obj => obj.name === split[0]);\r\n                const obj1 = this.rigidBodies.find(obj => obj.name === split[1]);\r\n                const event = 'end';\r\n                if (obj0 && obj1)\r\n                    this.collisionEvents.emit('collision', { bodies: [obj0, obj1], event });\r\n            }\r\n        });\r\n        this.earlierDetectedCollisions = [...detectedCollisions];\r\n    }\r\n    setGravity(x = 0, y = -9.8, z = 0) {\r\n        this.tmpBtVector3.setValue(x, y, z);\r\n        this.physicsWorld.setGravity(this.tmpBtVector3);\r\n    }\r\n    get debug() {\r\n        if (this.isHeadless)\r\n            return null;\r\n        return {\r\n            enable: () => {\r\n                this.debugDrawer.enable();\r\n            },\r\n            mode: (debugMode = 1) => {\r\n                this.debugDrawer.setDebugMode(debugMode);\r\n            },\r\n            disable: () => {\r\n                this.debugDrawer.disable();\r\n            }\r\n        };\r\n    }\r\n    start() {\r\n        if (typeof Ammo === 'undefined') {\r\n            logger('Are you sure you included ammo.js?');\r\n            return;\r\n        }\r\n        if (typeof Ammo === 'function')\r\n            Ammo().then(() => {\r\n                this.setup();\r\n            });\r\n        else\r\n            this.setup();\r\n    }\r\n    get add() {\r\n        return {\r\n            collider: (object1, object2, eventCallback) => this.collisionEvents.addCollider(object1, object2, eventCallback),\r\n            constraints: this.constraints.addConstraints,\r\n            existing: (object, config) => this.addExisting(object, config),\r\n            plane: (planeConfig = {}, materialConfig = {}) => this.shapes.addPlane(planeConfig, materialConfig),\r\n            sphere: (sphereConfig = {}, materialConfig = {}) => this.shapes.addSphere(sphereConfig, materialConfig),\r\n            ground: (groundConfig = {}, materialConfig = {}) => this.shapes.addGround(groundConfig, materialConfig),\r\n            box: (boxConfig = {}, materialConfig = {}) => this.shapes.addBox(boxConfig, materialConfig),\r\n            cylinder: (cylinderConfig = {}, materialConfig = {}) => this.shapes.addCylinder(cylinderConfig, materialConfig),\r\n            cone: (coneConfig = {}, materialConfig = {}) => this.shapes.addCone(coneConfig, materialConfig),\r\n            torus: (torusConfig = {}, materialConfig = {}) => this.shapes.addTorus(torusConfig, materialConfig),\r\n            extrude: (extrudeConfig, materialConfig = {}) => this.shapes.addExtrude(extrudeConfig, materialConfig),\r\n            /**\r\n             * Creates a new Raycaster\r\n             * @param type Returns only the closes body by default. Can be 'closest' or 'allHits'.\r\n             */\r\n            raycaster: (type = 'closest') => {\r\n                if (type === 'closest')\r\n                    return new ClosestRaycaster(this);\r\n                else\r\n                    return new AllHitsRaycaster(this);\r\n            }\r\n        };\r\n    }\r\n    prepareThreeObjectForCollisionShape(object, config = {}) {\r\n        var _a, _b;\r\n        const { autoCenter = false } = config;\r\n        // set default params\r\n        const defaultParams = {\r\n            width: 1,\r\n            height: 1,\r\n            depth: 1,\r\n            radius: 1,\r\n            radiusTop: 1,\r\n            radiusBottom: 1,\r\n            tube: 0.4,\r\n            tubularSegments: 6 // for the torus\r\n        };\r\n        // determine the shape (fallback to hacd)\r\n        let shape = 'unknown';\r\n        // retrieve the shape from the geometry\r\n        const type = ((_a = object.geometry) === null || _a === void 0 ? void 0 : _a.type) || 'unknown';\r\n        if (/box/i.test(type))\r\n            shape = 'box';\r\n        else if (/cone/i.test(type))\r\n            shape = 'cone';\r\n        else if (/cylinder/i.test(type))\r\n            shape = 'cylinder';\r\n        else if (/extrude/i.test(type))\r\n            shape = 'extrude';\r\n        else if (/plane/i.test(type))\r\n            shape = 'plane';\r\n        else if (/sphere/i.test(type))\r\n            shape = 'sphere';\r\n        else if (/torus/i.test(type))\r\n            shape = 'torus';\r\n        // @ts-ignore\r\n        let params = Object.assign(Object.assign({}, defaultParams), (_b = object === null || object === void 0 ? void 0 : object.geometry) === null || _b === void 0 ? void 0 : _b.parameters);\r\n        if (config.shape) {\r\n            params = Object.assign(Object.assign({}, defaultParams), config);\r\n            shape = config.shape;\r\n        }\r\n        else if (object.shape) {\r\n            shape = object.shape;\r\n        }\r\n        // Add all default params if undefined\r\n        Object.keys(params).forEach(key => {\r\n            // @ts-ignore\r\n            if (typeof params[key] === 'undefined' && defaultParams[key]) {\r\n                // @ts-ignore\r\n                params[key] = defaultParams[key];\r\n            }\r\n        });\r\n        // auto adjust the center for custom shapes\r\n        if (autoCenter)\r\n            object.geometry.center();\r\n        // adjust the cylinder radius for its physcis body\r\n        if (shape === 'cylinder')\r\n            params.radius = config.radius || params.radiusTop;\r\n        // some aliases\r\n        if (shape === 'extrude')\r\n            shape = 'hacd';\r\n        if (shape === 'mesh' || shape === 'convex')\r\n            shape = 'convexMesh';\r\n        if (shape === 'concave')\r\n            shape = 'concaveMesh';\r\n        // if we have not found a shape until here, we fallback to 'box'\r\n        if (shape === 'unknown') {\r\n            logger(`Shape for ${object === null || object === void 0 ? void 0 : object.name} not recognized! Will fallback to box.`);\r\n            shape = 'box';\r\n        }\r\n        return { shape, params, object };\r\n    }\r\n    createCollisionShape(shape, params, object) {\r\n        const quat = (object === null || object === void 0 ? void 0 : object.quaternion) ? object === null || object === void 0 ? void 0 : object.quaternion : new Quaternion(0, 0, 0, 1);\r\n        const { axis = 'y' } = params;\r\n        const btHalfExtents = new Ammo.btVector3();\r\n        // transform geometry to bufferGeometry (because three-to-ammo works only with bufferGeometry)\r\n        // @ts-ignore\r\n        const geometry = object === null || object === void 0 ? void 0 : object.geometry;\r\n        if (object && (geometry === null || geometry === void 0 ? void 0 : geometry.isGeometry)) {\r\n            // @ts-ignore\r\n            object.geometry = new BufferGeometry().fromGeometry(geometry);\r\n        }\r\n        // prepare data to pass to three-to-ammo.js\r\n        const extractData = (object) => {\r\n            const matrixWorld = new Matrix4().elements;\r\n            const vertices = [];\r\n            const matrices = [];\r\n            const indexes = [];\r\n            iterateGeometries(object, {}, (vertexArray, matrixArray, indexArray) => {\r\n                vertices.push(vertexArray);\r\n                matrices.push(matrixArray);\r\n                indexes.push(indexArray);\r\n            });\r\n            return { vertices, matrices, indexes, matrixWorld };\r\n        };\r\n        let d = {};\r\n        // extract data for complex shapes generated with three-to-ammo.js\r\n        if (this.complexShapes.indexOf(shape) !== -1)\r\n            d = extractData(object);\r\n        let collisionShape;\r\n        switch (shape) {\r\n            case 'box':\r\n                btHalfExtents.setValue(params.width / 2, params.height / 2, params.depth / 2);\r\n                collisionShape = new Ammo.btBoxShape(btHalfExtents);\r\n                break;\r\n            case 'sphere':\r\n                collisionShape = new Ammo.btSphereShape(params.radius);\r\n                break;\r\n            case 'cylinder':\r\n                switch (axis) {\r\n                    case 'y':\r\n                        btHalfExtents.setValue(params.radius, params.height / 2, params.radius);\r\n                        collisionShape = new Ammo.btCylinderShape(btHalfExtents);\r\n                        break;\r\n                    case 'x':\r\n                        btHalfExtents.setValue(params.height / 2, params.radius, params.radius);\r\n                        collisionShape = new Ammo.btCylinderShapeX(btHalfExtents);\r\n                        break;\r\n                    case 'z':\r\n                        btHalfExtents.setValue(params.radius, params.radius, params.height / 2);\r\n                        collisionShape = new Ammo.btCylinderShapeZ(btHalfExtents);\r\n                        break;\r\n                }\r\n                break;\r\n            case 'cone':\r\n                switch (axis) {\r\n                    case 'y':\r\n                        collisionShape = new Ammo.btConeShape(params.radius, params.height);\r\n                        break;\r\n                    case 'x':\r\n                        collisionShape = new Ammo.btConeShapeX(params.radius, params.height);\r\n                        break;\r\n                    case 'z':\r\n                        collisionShape = new Ammo.btConeShapeZ(params.radius, params.height);\r\n                        break;\r\n                }\r\n                break;\r\n            case 'capsule':\r\n                switch (axis) {\r\n                    case 'y':\r\n                        collisionShape = new Ammo.btCapsuleShape(params.radius, params.height);\r\n                        break;\r\n                    case 'x':\r\n                        collisionShape = new Ammo.btCapsuleShapeX(params.radius, params.height);\r\n                        break;\r\n                    case 'z':\r\n                        collisionShape = new Ammo.btCapsuleShapeZ(params.radius, params.height);\r\n                        break;\r\n                }\r\n                break;\r\n            case 'torus':\r\n                collisionShape = createTorusShape(params, quat);\r\n                break;\r\n            case 'plane':\r\n                // uses a triMeshShape for the plane\r\n                collisionShape = createTriMeshShape(d.vertices, d.matrices, d.indexes, d.matrixWorld, Object.assign(Object.assign({}, params), { concave: false }));\r\n                break;\r\n            case 'hull':\r\n                collisionShape = createHullShape(d.vertices, d.matrices, d.matrixWorld, params);\r\n                break;\r\n            case 'hacd':\r\n                collisionShape = createHACDShapes(d.vertices, d.matrices, d.indexes, d.matrixWorld, params);\r\n                break;\r\n            case 'vhacd':\r\n                collisionShape = createVHACDShapes(d.vertices, d.matrices, d.indexes, d.matrixWorld, params);\r\n                break;\r\n            case 'convexMesh':\r\n                collisionShape = createTriMeshShape(d.vertices, d.matrices, d.indexes, d.matrixWorld, Object.assign(Object.assign({}, params), { concave: false }));\r\n                break;\r\n            case 'concaveMesh':\r\n                collisionShape = createTriMeshShape(d.vertices, d.matrices, d.indexes, d.matrixWorld, Object.assign(Object.assign({}, params), { concave: true }));\r\n                break;\r\n        }\r\n        Ammo.destroy(btHalfExtents);\r\n        // if there is a x, y or z, take is as temporary offset parameter\r\n        const { x, y, z } = params;\r\n        if (x || y || z) {\r\n            // @ts-ignore\r\n            collisionShape.offset = { x: x || 0, y: y || 0, z: z || 0 };\r\n        }\r\n        // in some cases, like hacd, it will be an array of shapes\r\n        // so we merge them\r\n        if (Array.isArray(collisionShape))\r\n            collisionShape = this.mergeCollisionShapesToCompoundShape(collisionShape);\r\n        return collisionShape;\r\n    }\r\n    mergeCollisionShapesToCompoundShape(collisionShapes) {\r\n        const compoundShape = new Ammo.btCompoundShape();\r\n        collisionShapes.forEach(shape => {\r\n            // @ts-ignore // _tmp is a custom parameter\r\n            const _tmp = shape._tmp;\r\n            if (_tmp) {\r\n                const { pos, quat, scale, margin } = _tmp;\r\n                const transform = this.applyPosQuatScaleMargin(shape, pos, quat, scale, margin);\r\n                compoundShape.addChildShape(transform, shape);\r\n            }\r\n            else {\r\n                const transform = new Ammo.btTransform();\r\n                transform.setIdentity();\r\n                compoundShape.addChildShape(transform, shape);\r\n            }\r\n        });\r\n        return compoundShape;\r\n    }\r\n    addExisting(object, config = {}) {\r\n        const { hasBody } = object;\r\n        if (hasBody) {\r\n            logger(`Object \"${object.name}\" already has a physical body!`);\r\n            return;\r\n        }\r\n        const pos = new Vector3();\r\n        const quat = new Quaternion();\r\n        const scale = new Vector3();\r\n        object.getWorldPosition(pos);\r\n        object.getWorldQuaternion(quat);\r\n        object.getWorldScale(scale);\r\n        const isStaticObject = (config.collisionFlags || 0).toString(2).slice(-1) === '1';\r\n        const isKinematicObject = (config.collisionFlags || 0).toString(2).slice(-2, -1) === '1';\r\n        const { shape = 'unknown', compound = [], mass = isStaticObject || isKinematicObject ? 0 : 1, // set default mass of 0 for static objects, and 1 for all other objects\r\n        collisionFlags = 0, collisionGroup = 1, collisionMask = -1, offset = undefined, breakable = false, addChildren = true, margin = 0.01, ignoreScale = false, fractureImpulse = 1 } = config;\r\n        if (ignoreScale)\r\n            scale.set(1, 1, 1);\r\n        if (compound.length >= 1) {\r\n            // if we want a custom compound shape, we simply do\r\n            const collisionShapes = compound.map((s) => this.createCollisionShape(s.shape, s));\r\n            const compoundShape = this.mergeCollisionShapesToCompoundShape(collisionShapes);\r\n            const localTransform = this.applyPosQuatScaleMargin(compoundShape, pos, quat, scale, margin);\r\n            const rigidBody = this.collisionShapeToRigidBody(compoundShape, localTransform, mass, isKinematicObject);\r\n            this.addRigidBodyToWorld(object, rigidBody, collisionFlags, collisionGroup, collisionMask, offset);\r\n            object.body.breakable = breakable;\r\n            object.body.fractureImpulse = fractureImpulse;\r\n            object.body.ignoreScale = ignoreScale;\r\n            return;\r\n        }\r\n        const collisionShapes = [];\r\n        // if object is a THREE.Group, object does not have a mesh\r\n        if (shape !== 'unknown' || object.isMesh) {\r\n            const p = this.prepareThreeObjectForCollisionShape(object, config);\r\n            const cs = this.createCollisionShape(p.shape, p.params, p.object);\r\n            collisionShapes.push(cs);\r\n        }\r\n        // check if the object has children\r\n        if (shape === 'unknown' && addChildren && object.children.length >= 1) {\r\n            object.children.forEach((child) => {\r\n                if (child.isMesh) {\r\n                    const p = this.prepareThreeObjectForCollisionShape(child);\r\n                    const cs = this.createCollisionShape(p.shape, p.params, p.object);\r\n                    // @ts-ignore // the relative pos, quat and scale to its parent\r\n                    cs._tmp = {\r\n                        pos: child.position.clone(),\r\n                        quat: child.quaternion.clone(),\r\n                        scale: child.scale.clone(),\r\n                        margin: margin\r\n                    };\r\n                    collisionShapes.push(cs);\r\n                }\r\n            });\r\n        }\r\n        // FALLBACK: if we do not have any collisionShapes yet, add a simple box as a fallback\r\n        if (collisionShapes.length === 0) {\r\n            const p = this.prepareThreeObjectForCollisionShape(object, config);\r\n            const cs = this.createCollisionShape(p.shape, p.params, p.object);\r\n            collisionShapes.push(cs);\r\n        }\r\n        const collisionShape = collisionShapes.length === 1 ? collisionShapes[0] : this.mergeCollisionShapesToCompoundShape(collisionShapes);\r\n        // add rigid body\r\n        // object.position.copy(pos)\r\n        // object.quaternion.copy(quat)\r\n        const localTransform = this.applyPosQuatScaleMargin(collisionShape, pos, quat, scale, margin);\r\n        const rigidBody = this.collisionShapeToRigidBody(collisionShape, localTransform, mass, isKinematicObject);\r\n        this.addRigidBodyToWorld(object, rigidBody, collisionFlags, collisionGroup, collisionMask, offset);\r\n        object.body.breakable = breakable;\r\n        object.body.fractureImpulse = fractureImpulse;\r\n        object.body.ignoreScale = ignoreScale;\r\n    }\r\n    addRigidBodyToWorld(object, rigidBody, collisionFlags, collisionGroup, collisionMask, offset) {\r\n        this.rigidBodies.push(object);\r\n        this.physicsWorld.addRigidBody(rigidBody, collisionGroup, collisionMask);\r\n        const ptr = Object.values(rigidBody)[0];\r\n        // @ts-ignore\r\n        rigidBody.name = object.name;\r\n        object.body = new PhysicsBody(this, rigidBody);\r\n        object.hasBody = true;\r\n        // @ts-ignore\r\n        object.ptr = ptr;\r\n        // @ts-ignore\r\n        rigidBody.threeObject = object;\r\n        if (offset)\r\n            object.body.offset = Object.assign({ x: 0, y: 0, z: 0 }, offset);\r\n        object.body.setCollisionFlags(collisionFlags);\r\n    }\r\n    applyPosQuatScaleMargin(collisionShape, pos = new Vector3(), quat = new Quaternion(), scale = new Vector3(), margin = 0.01) {\r\n        collisionShape.setMargin(margin);\r\n        const rotation = new Ammo.btQuaternion(0, 0, 0, 1);\r\n        rotation.setValue(quat.x, quat.y, quat.z, quat.w);\r\n        const localTransform = new Ammo.btTransform();\r\n        localTransform.setIdentity();\r\n        localTransform.getOrigin().setValue(pos.x, pos.y, pos.z);\r\n        localTransform.setRotation(rotation);\r\n        Ammo.destroy(rotation);\r\n        const localScale = new Ammo.btVector3(scale.x, scale.y, scale.z);\r\n        collisionShape.setLocalScaling(localScale);\r\n        Ammo.destroy(localScale);\r\n        return localTransform;\r\n    }\r\n    collisionShapeToRigidBody(collisionShape, localTransform, mass, disableDeactivation) {\r\n        const motionState = new Ammo.btDefaultMotionState(localTransform);\r\n        const localInertia = new Ammo.btVector3(0, 0, 0);\r\n        if (mass > 0)\r\n            collisionShape.calculateLocalInertia(mass, localInertia);\r\n        const rbInfo = new Ammo.btRigidBodyConstructionInfo(mass, motionState, collisionShape, localInertia);\r\n        const rigidBody = new Ammo.btRigidBody(rbInfo);\r\n        if (mass > 0 || disableDeactivation)\r\n            rigidBody.setActivationState(4); // Disable deactivation\r\n        return rigidBody;\r\n    }\r\n}\r\nexport { AmmoPhysics };\r\n//# sourceMappingURL=physics.js.map","/**\r\n * @author       Yannick Deubel (https://github.com/yandeu)\r\n * @copyright    Copyright (c) 2020 Yannick Deubel; Project Url: https://github.com/enable3d/enable3d\r\n * @license      {@link https://github.com/enable3d/enable3d/blob/master/LICENSE|GNU GPLv3}\r\n */\r\nclass Shapes {\r\n    constructor(factory, addExisting) {\r\n        this.factory = factory;\r\n        this.addExisting = addExisting;\r\n    }\r\n    addPlane(planeConfig = {}, materialConfig = {}) {\r\n        const plane = this.factory.add.plane(planeConfig, materialConfig);\r\n        this.addExisting(plane, planeConfig);\r\n        return plane;\r\n    }\r\n    addSphere(sphereConfig = {}, materialConfig = {}) {\r\n        const sphere = this.factory.add.sphere(sphereConfig, materialConfig);\r\n        this.addExisting(sphere, sphereConfig);\r\n        return sphere;\r\n    }\r\n    addBox(boxConfig = {}, materialConfig = {}) {\r\n        const box = this.factory.add.box(boxConfig, materialConfig);\r\n        this.addExisting(box, boxConfig);\r\n        return box;\r\n    }\r\n    addGround(groundConfig, materialConfig = {}) {\r\n        const ground = this.factory.add.ground(groundConfig, materialConfig);\r\n        const config = Object.assign(Object.assign({}, groundConfig), { mass: 0, collisionFlags: 1 });\r\n        this.addExisting(ground, config);\r\n        return ground;\r\n    }\r\n    addCylinder(cylinderConfig = {}, materialConfig = {}) {\r\n        const cylinder = this.factory.add.cylinder(cylinderConfig, materialConfig);\r\n        this.addExisting(cylinder, cylinderConfig);\r\n        return cylinder;\r\n    }\r\n    addCone(coneConfig = {}, materialConfig = {}) {\r\n        const cone = this.factory.add.cone(coneConfig, materialConfig);\r\n        this.addExisting(cone, coneConfig);\r\n        return cone;\r\n    }\r\n    addTorus(torusConfig = {}, materialConfig = {}) {\r\n        const torus = this.factory.add.torus(torusConfig, materialConfig);\r\n        this.addExisting(torus, torusConfig);\r\n        return torus;\r\n    }\r\n    addExtrude(extrudeConfig, materialConfig = {}) {\r\n        const object = this.factory.add.extrude(extrudeConfig, materialConfig);\r\n        object.translateX(1);\r\n        this.addExisting(object);\r\n        return object;\r\n    }\r\n}\r\nexport default Shapes;\r\n//# sourceMappingURL=shapes.js.map","/**\r\n * @author       Yannick Deubel (https://github.com/yandeu)\r\n * @copyright    Copyright (c) 2020 Yannick Deubel; Project Url: https://github.com/enable3d/enable3d\r\n * @license      {@link https://github.com/enable3d/enable3d/blob/master/LICENSE|GNU GPLv3}\r\n */\r\n// https://pybullet.org/Bullet/phpBB3/viewtopic.php?t=7228\r\nexport const createTorusShape = (config, quat) => {\r\n    const { radius = 1, tube = 0.4, tubularSegments = 8 } = config;\r\n    const SIMD_PI = Math.PI;\r\n    const subdivisions = tubularSegments;\r\n    const gap = Math.sqrt(2.0 * tube * tube - 2.0 * tube * tube * Math.cos((2.0 * SIMD_PI) / subdivisions));\r\n    const btHalfExtents = new Ammo.btVector3(tube, SIMD_PI / subdivisions + 0.5 * gap, tube);\r\n    const cylinderShape = new Ammo.btCylinderShape(btHalfExtents);\r\n    cylinderShape.setMargin(0.05);\r\n    const compoundShape = new Ammo.btCompoundShape();\r\n    const forward = new Ammo.btVector3(0, 0, 1);\r\n    const side = new Ammo.btVector3(0, radius, 0);\r\n    const rotation = new Ammo.btQuaternion(quat.x, quat.y, quat.z, quat.w);\r\n    for (let x = 0; x < subdivisions; x++) {\r\n        const angle = (x * 2.0 * SIMD_PI) / subdivisions;\r\n        const position = side.rotate(forward, angle);\r\n        const transform = new Ammo.btTransform();\r\n        rotation.setRotation(forward, angle + Math.PI / 2);\r\n        transform.setIdentity();\r\n        transform.setOrigin(position);\r\n        transform.setRotation(rotation);\r\n        compoundShape.addChildShape(transform, cylinderShape);\r\n    }\r\n    return compoundShape;\r\n};\r\n//# sourceMappingURL=torusShape.js.map","/**\r\n * @author       Yannick Deubel (https://github.com/yandeu)\r\n * @copyright    Copyright (c) 2020 Yannick Deubel; Project Url: https://github.com/enable3d/enable3d\r\n * @license      {@link https://github.com/enable3d/enable3d/blob/master/LICENSE|GNU GPLv3}\r\n */\r\nimport { Events } from '@yandeu/events';\r\nimport { Euler, Quaternion } from 'three';\r\nclass PhysicsBody {\r\n    constructor(physics, ammo) {\r\n        this.physics = physics;\r\n        this.ammo = ammo;\r\n        this.ignoreScale = false;\r\n        this.isSoftBody = false;\r\n        this.offset = { x: 0, y: 0, z: 0 };\r\n        this.errors = [];\r\n        this.checkCollisions = false;\r\n        this.breakable = false;\r\n        this.fractureImpulse = 1;\r\n        this.didUpdate = false;\r\n        /** Skip syncing the mesh to the physics body. */\r\n        this.skipUpdate = false;\r\n        this._emitUpdateEvents = false;\r\n        this._needUpdate = false;\r\n        this.tmpEuler = new Euler();\r\n        this.tmpQuaternion = new Quaternion();\r\n        this.tmpBtVector3 = new Ammo.btVector3();\r\n        this.tmpBtVector3_1 = new Ammo.btVector3();\r\n        this.tmpBtQuaternion = new Ammo.btQuaternion(0, 0, 0, 1);\r\n        this.eventEmitter = new Events();\r\n        // @ts-ignore\r\n        this.name = ammo.name;\r\n    }\r\n    /**\r\n     * Don't call this manually! Do physics.destroy() instead.\r\n     */\r\n    destructor() {\r\n        // remove events\r\n        if (this.eventEmitter)\r\n            this.eventEmitter.removeAllListeners();\r\n        // destroy tmp ammo values\r\n        Ammo.destroy(this.tmpBtVector3);\r\n        Ammo.destroy(this.tmpBtVector3_1);\r\n        Ammo.destroy(this.tmpBtQuaternion);\r\n        // destory collision shape\r\n        Ammo.destroy(this.ammo.getCollisionShape());\r\n        // destroy body\r\n        Ammo.destroy(this.ammo);\r\n    }\r\n    setupEventEmitter() {\r\n        if (typeof this.eventEmitter === 'undefined')\r\n            this.eventEmitter = new Events();\r\n    }\r\n    get needUpdate() {\r\n        return this._needUpdate;\r\n    }\r\n    set needUpdate(need) {\r\n        if (!need && this._needUpdate)\r\n            this.didUpdate = true;\r\n        this._needUpdate = need;\r\n    }\r\n    onUpdateEvent(updateCallback, once = false) {\r\n        this.setupEventEmitter();\r\n        this._emitUpdateEvents = true;\r\n        if (once)\r\n            this.eventEmitter.once('update', () => {\r\n                updateCallback();\r\n            });\r\n        else\r\n            this.eventEmitter.on('update', () => {\r\n                updateCallback();\r\n            });\r\n    }\r\n    get on() {\r\n        return {\r\n            update: (updateCallback) => this.onUpdateEvent(updateCallback),\r\n            collision: (collisionCallback) => this.onCollision(collisionCallback)\r\n        };\r\n    }\r\n    get once() {\r\n        return {\r\n            update: (updateCallback) => this.onUpdateEvent(updateCallback, true)\r\n        };\r\n    }\r\n    onCollision(collisionCallback) {\r\n        this.checkCollisions = true;\r\n        this.physics.collisionEvents.on('collision', (data) => {\r\n            const { bodies, event } = data;\r\n            if (bodies[0].name === this.name)\r\n                collisionCallback(bodies[1], event);\r\n            else if (bodies[1].name === this.name)\r\n                collisionCallback(bodies[0], event);\r\n        });\r\n    }\r\n    /** You have to call transform() before you can get or set the body's position or rotation. (for headless mode only) */\r\n    transform() {\r\n        const t = this.physics.worldTransform;\r\n        this.ammo.getMotionState().getWorldTransform(t);\r\n    }\r\n    /** You have to call refresh() after you set the position or rotation of the body. (for headless mode only) */\r\n    refresh() {\r\n        const t = this.physics.worldTransform;\r\n        this.ammo.getMotionState().setWorldTransform(t);\r\n    }\r\n    /** Set the rotation in radians. (for headless mode only) */\r\n    setRotation(x, y, z) {\r\n        const e = this.tmpEuler.set(x, y, z);\r\n        const q = this.tmpQuaternion.set(0, 0, 0, 1);\r\n        q.setFromEuler(e);\r\n        this.tmpBtQuaternion.setValue(0, 0, 0, 1);\r\n        const ammoQuat = this.tmpBtQuaternion;\r\n        ammoQuat.setValue(q.x, q.y, q.z, q.w);\r\n        const t = this.physics.worldTransform;\r\n        t.setRotation(ammoQuat);\r\n    }\r\n    /** Get the rotation in radians. (for headless mode only) */\r\n    get rotation() {\r\n        // https://www.euclideanspace.com/maths/geometry/rotations/conversions/quaternionToAngle/index.htm\r\n        let x, y, z;\r\n        const t = this.physics.worldTransform;\r\n        const ammoQuat = t.getRotation();\r\n        let q1 = this.tmpQuaternion.set(ammoQuat.x(), ammoQuat.y(), ammoQuat.z(), ammoQuat.w());\r\n        if (q1.w > 1)\r\n            q1 = q1.normalize(); // if w>1 acos and sqrt will produce errors, this cant happen if quaternion is normalized\r\n        const angle = 2 * Math.acos(q1.w);\r\n        const s = Math.sqrt(1 - q1.w * q1.w); // assuming quaternion normalized then w is less than 1, so term always positive.\r\n        if (s < 0.001) {\r\n            // test to avoid divide by zero, s is always positive due to sqrt\r\n            // if s close to zero then direction of axis not important\r\n            x = q1.x; // if it is important that axis is normalized then replace with x=1; y=z=0;\r\n            y = q1.y;\r\n            z = q1.z;\r\n        }\r\n        else {\r\n            x = q1.x / s; // normalized axis\r\n            y = q1.y / s;\r\n            z = q1.z / s;\r\n        }\r\n        return { x: x * angle, y: y * angle, z: z * angle };\r\n    }\r\n    /** Get the quaternion. (for headless mode only) */\r\n    get quaternion() {\r\n        const t = this.physics.worldTransform;\r\n        const q = t.getRotation();\r\n        return { x: q.x(), y: q.y(), z: q.z(), w: q.w() };\r\n    }\r\n    /** Set position. (for headless mode only) */\r\n    setPosition(x, y, z) {\r\n        const t = this.physics.worldTransform;\r\n        t.getOrigin().setValue(x, y, z);\r\n    }\r\n    /** Get position. (for headless mode only) */\r\n    get position() {\r\n        const t = this.physics.worldTransform;\r\n        return { x: t.getOrigin().x(), y: t.getOrigin().y(), z: t.getOrigin().z() };\r\n    }\r\n    get velocity() {\r\n        return {\r\n            x: this.ammo.getLinearVelocity().x(),\r\n            y: this.ammo.getLinearVelocity().y(),\r\n            z: this.ammo.getLinearVelocity().z()\r\n        };\r\n    }\r\n    get angularVelocity() {\r\n        return {\r\n            x: this.ammo.getAngularVelocity().x(),\r\n            y: this.ammo.getAngularVelocity().y(),\r\n            z: this.ammo.getAngularVelocity().z()\r\n        };\r\n    }\r\n    setVelocity(x, y, z) {\r\n        this.tmpBtVector3.setValue(x, y, z);\r\n        this.ammo.setLinearVelocity(this.tmpBtVector3);\r\n    }\r\n    setVelocityX(value) {\r\n        this.tmpBtVector3.setValue(value, this.velocity.y, this.velocity.z);\r\n        this.ammo.setLinearVelocity(this.tmpBtVector3);\r\n    }\r\n    setVelocityY(value) {\r\n        this.tmpBtVector3.setValue(this.velocity.x, value, this.velocity.z);\r\n        this.ammo.setLinearVelocity(this.tmpBtVector3);\r\n    }\r\n    setVelocityZ(value) {\r\n        this.tmpBtVector3.setValue(this.velocity.x, this.velocity.y, value);\r\n        this.ammo.setLinearVelocity(this.tmpBtVector3);\r\n    }\r\n    setAngularVelocity(x, y, z) {\r\n        this.tmpBtVector3.setValue(x, y, z);\r\n        this.ammo.setAngularVelocity(this.tmpBtVector3);\r\n    }\r\n    setAngularVelocityX(value) {\r\n        this.tmpBtVector3.setValue(value, this.angularVelocity.y, this.angularVelocity.z);\r\n        this.ammo.setAngularVelocity(this.tmpBtVector3);\r\n    }\r\n    setAngularVelocityY(value) {\r\n        this.tmpBtVector3.setValue(this.angularVelocity.x, value, this.angularVelocity.z);\r\n        this.ammo.setAngularVelocity(this.tmpBtVector3);\r\n    }\r\n    setAngularVelocityZ(value) {\r\n        this.tmpBtVector3.setValue(this.angularVelocity.x, this.angularVelocity.y, value);\r\n        this.ammo.setAngularVelocity(this.tmpBtVector3);\r\n    }\r\n    // Apply Force methods\r\n    applyForce(x, y, z) {\r\n        this.tmpBtVector3.setValue(x, y, z);\r\n        this.ammo.applyCentralImpulse(this.tmpBtVector3);\r\n    }\r\n    applyForceX(value) {\r\n        this.tmpBtVector3.setValue(value, 0, 0);\r\n        this.ammo.applyCentralImpulse(this.tmpBtVector3);\r\n    }\r\n    applyForceY(value) {\r\n        this.tmpBtVector3.setValue(0, value, 0);\r\n        this.ammo.applyCentralImpulse(this.tmpBtVector3);\r\n    }\r\n    applyForceZ(value) {\r\n        this.tmpBtVector3.setValue(0, 0, value);\r\n        this.ammo.applyCentralImpulse(this.tmpBtVector3);\r\n    }\r\n    // Apply \"Something\" Methods\r\n    applyCentralForce(x, y, z) {\r\n        this.tmpBtVector3.setValue(x, y, z);\r\n        this.ammo.applyCentralForce(this.tmpBtVector3);\r\n    }\r\n    applyCentralImpulse(x, y, z) {\r\n        this.tmpBtVector3.setValue(x, y, z);\r\n        this.ammo.applyCentralImpulse(this.tmpBtVector3);\r\n    }\r\n    applyCentralLocalForce(x, y, z) {\r\n        this.tmpBtVector3.setValue(x, y, z);\r\n        this.ammo.applyCentralLocalForce(this.tmpBtVector3);\r\n    }\r\n    applyImpulse(impulse, relativePosition) {\r\n        this.tmpBtVector3.setValue(impulse.x || 0, impulse.y || 0, impulse.z || 0);\r\n        this.tmpBtVector3_1.setValue(relativePosition.x || 0, relativePosition.y || 0, relativePosition.z || 0);\r\n        this.ammo.applyImpulse(this.tmpBtVector3, this.tmpBtVector3_1);\r\n    }\r\n    applyLocalTorque(x, y, z) {\r\n        this.tmpBtVector3.setValue(x, y, z);\r\n        this.ammo.applyLocalTorque(this.tmpBtVector3);\r\n    }\r\n    applyTorque(x, y, z) {\r\n        this.tmpBtVector3.setValue(x, y, z);\r\n        this.ammo.applyTorque(this.tmpBtVector3);\r\n    }\r\n    applyTorqueImpulse(x, y, z) {\r\n        this.tmpBtVector3.setValue(x, y, z);\r\n        this.ammo.applyTorqueImpulse(this.tmpBtVector3);\r\n    }\r\n    /**\r\n     * Add the collision flags\r\n     * @param value 0 is DYNAMIC, 1 is STATIC, 2 is KINEMATIC, 4 GHOST\r\n     */\r\n    // https://github.com/bulletphysics/bullet3/blob/aae8048722f2596f7e2bdd52d2a1dcb52a218f2b/src/BulletCollision/CollisionDispatch/btCollisionObject.h#L128\r\n    setCollisionFlags(value) {\r\n        this.ammo.setCollisionFlags(value);\r\n    }\r\n    /**\r\n     * Get the collision flags\r\n     * @param value 0 is DYNAMIC, 1 is STATIC, 2 is KINEMATIC, 4 GHOST\r\n     */\r\n    getCollisionFlags() {\r\n        return this.ammo.getCollisionFlags();\r\n    }\r\n    /**\r\n     * Set the restitution (same as bounciness)\r\n     * @param value A number from 0 to 1.\r\n     */\r\n    setRestitution(value) {\r\n        this.ammo.setRestitution(value);\r\n    }\r\n    /**\r\n     * Set the bounciness (same as restitution)\r\n     * @param value A number from 0 to 1.\r\n     */\r\n    setBounciness(value) {\r\n        this.setRestitution(value);\r\n    }\r\n    /**\r\n     * Set the friction\r\n     * @param value A number from 0 to 1.\r\n     */\r\n    setFriction(value) {\r\n        this.ammo.setFriction(value);\r\n    }\r\n    /**\r\n     * Set the linear and angular damping\r\n     * @param linear A number from 0 to 1.\r\n     * @param angular A number from 0 to 1.\r\n     */\r\n    setDamping(linear, angular) {\r\n        this.ammo.setDamping(linear, angular);\r\n    }\r\n    /** Set per body gravity */\r\n    setGravity(x, y, z) {\r\n        this.tmpBtVector3.setValue(x, y, z);\r\n        this.ammo.setGravity(this.tmpBtVector3);\r\n    }\r\n    setLinearFactor(x, y, z) {\r\n        this.tmpBtVector3.setValue(x, y, z);\r\n        this.ammo.setLinearFactor(this.tmpBtVector3);\r\n    }\r\n    setAngularFactor(x, y, z) {\r\n        this.tmpBtVector3.setValue(x, y, z);\r\n        this.ammo.setAngularFactor(this.tmpBtVector3);\r\n    }\r\n    setCcdMotionThreshold(threshold) {\r\n        this.ammo.setCcdMotionThreshold(threshold);\r\n    }\r\n    setCcdSweptSphereRadius(radius) {\r\n        this.ammo.setCcdSweptSphereRadius(radius);\r\n    }\r\n}\r\nexport default PhysicsBody;\r\n//# sourceMappingURL=physicsBody.js.map","export { ThreeGraphics } from './core';\r\nexport { PhysicsLoader } from '@enable3d/common/dist/physicsLoader';\r\nimport * as Types_1 from '@enable3d/common/dist/types';\r\nexport { Types_1 as Types };\r\nimport { VERSION } from './version';\r\nconst info = `Powered by enable3d v${VERSION}`;\r\nconsole.log(`%c %c %c %c %c ${info} %c https://enable3d.io/`, 'background: #ff0000', 'background: #ffff00', 'background: #00ff00', 'background: #00ffff', 'color: #fff; background: #000000;', 'background: none');\r\n//# sourceMappingURL=index.js.map","/**\r\n * @author       Yannick Deubel (https://github.com/yandeu)\r\n * @copyright    Copyright (c) 2020 Yannick Deubel; Project Url: https://github.com/enable3d/enable3d\r\n * @license      {@link https://github.com/enable3d/enable3d/blob/master/LICENSE|GNU GPLv3}\r\n */\r\n\r\nimport { ThreeGraphics } from '@enable3d/three-graphics/jsm'\r\nimport { Scene3D } from './scene3d'\r\nimport { ThreeGraphicsConfig } from '@enable3d/common/dist/types'\r\nimport { logger } from '@enable3d/common/dist/logger'\r\n\r\ninterface Scene3DConfig extends Omit<ThreeGraphicsConfig, 'camera' | 'usePhysics' | 'enableXR'> {\r\n  parent?: string\r\n  scenes: typeof Scene3D[]\r\n}\r\n\r\nexport class Project extends ThreeGraphics {\r\n  public parent: HTMLElement\r\n  public canvas: HTMLCanvasElement\r\n  public scenes: Map<string, Scene3D> = new Map()\r\n\r\n  constructor(private projectConfig: Scene3DConfig) {\r\n    super(projectConfig)\r\n\r\n    this.renderer.setSize(window.innerWidth, window.innerHeight)\r\n\r\n    if (this.projectConfig.parent) this.parent = document.getElementById(this.projectConfig.parent) as HTMLElement\r\n    else this.parent = document.body\r\n\r\n    if (!this.parent) {\r\n      logger(`Parent \"${this.projectConfig.parent}\" not found! Will add it to the body.`)\r\n      this.parent = document.body\r\n    }\r\n\r\n    this.parent.appendChild(this.renderer.domElement)\r\n\r\n    this.canvas = this.renderer.domElement\r\n\r\n    let firstSceneKey = ''\r\n    this.projectConfig.scenes.forEach((scene, i) => {\r\n      const s = new scene()\r\n      if (i === 0) firstSceneKey = s.sceneKey\r\n      const plug = {\r\n        // scene configuration\r\n        sceneConfig: {\r\n          textureAnisotropy: this.textureAnisotropy,\r\n          autoStart: false\r\n        },\r\n        // add core features from three-graphicsconfig: {\r\n        renderer: this.renderer,\r\n        parent: this.parent,\r\n        canvas: this.canvas,\r\n        scene: this.scene, // three scene\r\n        scenes: this.scenes, // access to all Scene3D's\r\n        camera: this.camera,\r\n        cache: this.cache,\r\n        physics: this.physics\r\n      }\r\n\r\n      s.initializeScene(plug)\r\n\r\n      if (i === 0) {\r\n        s.setSize(this.parent.clientWidth, this.parent.clientHeight)\r\n        s.setPixelRatio(Math.max(1, window.devicePixelRatio / 2))\r\n      }\r\n\r\n      this.scenes.set(s.sceneKey, s)\r\n    })\r\n    // start the first scene\r\n    this.scenes.get(firstSceneKey)?.start(firstSceneKey)\r\n  }\r\n}\r\n","/**\r\n * @author       Yannick Deubel (https://github.com/yandeu)\r\n * @copyright    Copyright (c) 2020 Yannick Deubel; Project Url: https://github.com/enable3d/enable3d\r\n * @license      {@link https://github.com/enable3d/enable3d/blob/master/LICENSE|GNU GPLv3}\r\n */\r\nimport * as THREE from 'three';\r\nimport Cameras from './plugins/cameras';\r\nimport { AmmoPhysics } from '@enable3d/ammo-physics/dist/index';\r\nimport { logger } from '@enable3d/common/dist/logger';\r\nexport class ThreeGraphics {\r\n    constructor(threeGraphicsConfig = {}) {\r\n        this.threeGraphicsConfig = threeGraphicsConfig;\r\n        const { alpha = false, anisotropy = 1, camera = Cameras.Perspective({ z: 25, y: 5 }), antialias = false, usePhysics = true, renderer } = threeGraphicsConfig;\r\n        this.textureAnisotropy = anisotropy;\r\n        this.camera = camera;\r\n        this.scene = new THREE.Scene();\r\n        // this.renderer.physicallyCorrectLights = true\r\n        this.renderer = renderer || new THREE.WebGLRenderer({ antialias, alpha });\r\n        // see https://threejs.org/docs/#examples/en/loaders/GLTFLoader\r\n        // this.renderer.outputEncoding = sRGBEncoding\r\n        // shadow\r\n        this.renderer.shadowMap.enabled = true;\r\n        this.renderer.shadowMap.type = THREE.PCFSoftShadowMap;\r\n        // enable cache\r\n        this.cache = THREE.Cache;\r\n        this.cache.enabled = true;\r\n        if (usePhysics) {\r\n            if (typeof Ammo !== 'undefined')\r\n                this.physics = new AmmoPhysics(this.scene, threeGraphicsConfig);\r\n            else\r\n                logger('Are you sure you included ammo.js?');\r\n        }\r\n    }\r\n}\r\n//# sourceMappingURL=core.js.map","export const eventMatrix = [\n    {\n        name: 'pointer',\n        enabled: true,\n        test: 'onpointerdown' in window,\n        events: {\n            down: 'pointerdown',\n            move: 'pointermove',\n            up: 'pointerup'\n        }\n    },\n    {\n        name: 'touch',\n        enabled: true,\n        test: 'ontouchstart' in window && window.navigator.maxTouchPoints >= 1,\n        events: {\n            down: 'touchstart',\n            move: 'touchmove',\n            up: 'touchend'\n        }\n    },\n    {\n        name: 'mouse',\n        enabled: true,\n        test: 'onmousedown' in window,\n        events: {\n            down: 'mousedown',\n            move: 'mousemove',\n            up: 'mouseup'\n        }\n    }\n];\n//# sourceMappingURL=eventMatrix.js.map","/**\n * @package      npmjs.com/package/@yandeu/tap (tap.min.js)\n *\n * @author       Yannick Deubel (https://github.com/yandeu)\n * @copyright    Copyright (c) 2021 Yannick Deubel; Project Url: https://github.com/yandeu/tap\n * @license      {@link https://github.com/yandeu/tap/blob/master/LICENSE|MIT}\n * @description  Inspired by tapjs (https://www.npmjs.com/package/tapjs)\n */\nimport { Events } from '@yandeu/events';\nimport { eventMatrix } from './eventMatrix';\nimport { VERSION } from './version';\nexport class Tap {\n    constructor(domElement) {\n        this._events = new Events();\n        this.domElement = null;\n        this._isDown = false;\n        this._isPaused = false;\n        this.active = {\n            touch: false,\n            mouse: false,\n            pointer: false\n        };\n        this.registered = {\n            touch: false,\n            mouse: false,\n            pointer: false\n        };\n        this._currentPosition = { x: -1, y: -1 };\n        this._lastPosition = { x: -1, y: -1 };\n        this._isPointerLockAvailable = 'onpointerlockchange' in document;\n        this._add(domElement);\n    }\n    static get VERSION() {\n        return VERSION;\n    }\n    get isDown() {\n        return this._isDown;\n    }\n    set _position(position) {\n        if (position.x === this._currentPosition.x && position.y == this._currentPosition.y)\n            return;\n        this._lastPosition = this._currentPosition;\n        this._currentPosition = position;\n    }\n    get currentPosition() {\n        return this._currentPosition;\n    }\n    get lastPosition() {\n        return this._lastPosition;\n    }\n    get isPaused() {\n        return this._isPaused;\n    }\n    pause() {\n        this._isPaused = true;\n    }\n    resume() {\n        this._isPaused = false;\n    }\n    // listen to pointer lock change events\n    _onPointerLockChange() {\n        return new Promise(resolve => {\n            document.addEventListener('pointerlockchange', e => {\n                resolve(e);\n            }, { once: true });\n        });\n    }\n    get pointerLock() {\n        return {\n            onceChange: this._onPointerLockChange,\n            request: () => {\n                return new Promise((resolve, reject) => {\n                    if (!this._isPointerLockAvailable)\n                        return reject('PointerLock is not available!');\n                    if (this.pointerLock.isLocked)\n                        return reject('Pointer is already locked!');\n                    // listen to pointer lock change events\n                    this._onPointerLockChange().then(e => {\n                        resolve(e);\n                    });\n                    this.once.down(() => {\n                        var _a;\n                        (_a = this.domElement) === null || _a === void 0 ? void 0 : _a.requestPointerLock();\n                    });\n                });\n            },\n            exit: () => {\n                return new Promise((resolve, reject) => {\n                    if (!this.pointerLock.isLocked)\n                        return reject('Pointer is not locked!');\n                    // listen to pointer lock change events\n                    this._onPointerLockChange().then(e => {\n                        resolve(e);\n                    });\n                    document.exitPointerLock();\n                });\n            },\n            available: this._isPointerLockAvailable,\n            isLocked: !!document.pointerLockElement\n        };\n    }\n    /** (once ignores paused) */\n    get once() {\n        return {\n            down: (callback) => {\n                this._events.once('down', data => {\n                    callback(data);\n                });\n            },\n            move: (callback) => {\n                this._events.once('move', data => {\n                    callback(data);\n                });\n            },\n            up: (callback) => {\n                this._events.once('up', data => {\n                    callback(data);\n                });\n            }\n        };\n    }\n    get on() {\n        return {\n            down: (callback) => {\n                this._events.on('down', data => {\n                    if (!this._isPaused)\n                        callback(data);\n                });\n            },\n            move: (callback) => {\n                this._events.on('move', data => {\n                    if (!this._isPaused)\n                        callback(data);\n                });\n            },\n            up: (callback) => {\n                this._events.on('up', data => {\n                    if (!this._isPaused)\n                        callback(data);\n                });\n            }\n        };\n    }\n    _add(element) {\n        const el = (this.domElement = element !== null && element !== void 0 ? element : window);\n        if (!el)\n            console.warn('[tap] No domElement found!');\n        this._onDown = this._onDown.bind(this);\n        this._onMove = this._onMove.bind(this);\n        this._onUp = this._onUp.bind(this);\n        eventMatrix.forEach(input => {\n            if (input.test && input.enabled) {\n                this.active[input.name] = true;\n                el.addEventListener(input.events.down, this._onDown, false);\n                el.addEventListener(input.events.move, this._onMove, false);\n                el.addEventListener(input.events.up, this._onUp, false);\n            }\n        });\n    }\n    _remove(type) {\n        if (!this.active[type])\n            return;\n        const el = this.domElement;\n        if (!el)\n            console.warn('[tap] No domElement found!');\n        eventMatrix.forEach(input => {\n            if (input.name === type) {\n                el.removeEventListener(input.events.down, this._onDown, false);\n                el.removeEventListener(input.events.move, this._onMove, false);\n                el.removeEventListener(input.events.up, this._onUp, false);\n            }\n        });\n        this.active[type] = false;\n    }\n    destroy() {\n        this.pause();\n        Object.keys(this.active).forEach(key => {\n            this._remove(key);\n        });\n        this._events.removeAllListeners();\n        // @ts-ignore\n        this._events = null;\n        // @ts-ignore\n        this.domElement = null;\n        // @ts-ignore\n        this._isDown = null;\n        // @ts-ignore\n        this._isPaused = null;\n        // @ts-ignore\n        this.active = null;\n        // @ts-ignore\n        this.registered = null;\n        // @ts-ignore\n        this._currentPosition = null;\n        // @ts-ignore\n        this._lastPosition = null;\n    }\n    _calcPosition(e) {\n        let x;\n        let y;\n        if (e.touches && e.touches[0]) {\n            x = e.touches[0].pageX;\n            y = e.touches[0].pageY;\n        }\n        else if (e.clientX) {\n            x = e.clientX;\n            y = e.clientY;\n        }\n        else {\n            x = this._currentPosition.x;\n            y = this._currentPosition.y;\n        }\n        if (this.pointerLock.isLocked) {\n            x = e.movementX;\n            y = e.movementY;\n        }\n        this._position = { x, y };\n        return { x, y };\n    }\n    _removeDuplicates(e) {\n        if (e.type === 'pointerdown')\n            this.registered.pointer = true;\n        if (e.type === 'touchstart')\n            this.registered.touch = true;\n        if (e.type === 'mousedown')\n            this.registered.mouse = true;\n        if (e.type === 'touchstart' && this.active.touch && this.registered.pointer) {\n            this._remove('touch');\n            return false;\n        }\n        if (e.type === 'mousedown' && this.active.mouse && (this.registered.pointer || this.registered.touch)) {\n            this._remove('mouse');\n            return false;\n        }\n        return true;\n    }\n    _onDown(e) {\n        const proceed = this._removeDuplicates(e);\n        if (!proceed)\n            return;\n        this._isDown = true;\n        this._events.emit('down', { position: this._calcPosition(e), event: e });\n    }\n    _onMove(e) {\n        this._events.emit('move', { position: this._calcPosition(e), event: e, dragging: this._isDown });\n    }\n    _onUp(e) {\n        this._isDown = false;\n        this._events.emit('up', { position: this._calcPosition(e), event: e });\n    }\n}\n// test section\n// const test = new Tap(document.body)\n// test.pointerLock.onceChange()\n// test.on.down(({ event, position }) => {\n//   console.log(event, position)\n// })\n// const requestPointerLockLoop = () => {\n//   console.log('request')\n//   test.pointerLock.request().then(() => {\n//     console.log('locked')\n//     test.pointerLock.onceChange().then(() => {\n//       console.log('onceChange', !test.pointerLock.isLocked)\n//       if (!test.pointerLock.isLocked) requestPointerLockLoop()\n//     })\n//   })\n// }\n// requestPointerLockLoop()\n// setTimeout(() => {\n//   test.pointerLock.request()\n// }, 2000)\n//# sourceMappingURL=index.js.map","// THIS IS AN AUTOGENERATED FILE. DO NOT EDIT THIS FILE DIRECTLY.\nexport const VERSION = \"0.0.3\";\n//# sourceMappingURL=version.js.map","/**\r\n * @author       Yannick Deubel (https://github.com/yandeu)\r\n * @copyright    Copyright (c) 2021 Yannick Deubel; Project Url: https://github.com/enable3d/enable3d\r\n * @license      {@link https://github.com/enable3d/enable3d/blob/master/LICENSE|GNU GPLv3}\r\n */\r\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n};\r\nimport { LinearFilter, Raycaster, Texture, Vector2 } from 'three';\r\nimport { Tap } from '@yandeu/tap';\r\n// https://stackoverflow.com/a/7838871\r\nexport const roundRect = (ctx, x, y, w, h, r) => {\r\n    if (w < 2 * r)\r\n        r = w / 2;\r\n    if (h < 2 * r)\r\n        r = h / 2;\r\n    ctx.beginPath();\r\n    ctx.moveTo(x + r, y);\r\n    ctx.arcTo(x + w, y, x + w, y + h, r);\r\n    ctx.arcTo(x + w, y + h, x, y + h, r);\r\n    ctx.arcTo(x, y + h, x, y, r);\r\n    ctx.arcTo(x, y, x + w, y, r);\r\n    ctx.closePath();\r\n};\r\nexport const fontHeightCache = new Map();\r\nexport const calcHeight = (text, fontSize, fontFamily, lineHeight = 1) => {\r\n    const key = fontSize + fontFamily;\r\n    let height = fontHeightCache.get(key);\r\n    if (!height) {\r\n        // https://stackoverflow.com/a/10500938\r\n        const span = document.createElement('p');\r\n        span.style.fontFamily = fontFamily;\r\n        span.style.fontSize = `${fontSize}px`;\r\n        span.style.whiteSpace = 'nowrap';\r\n        span.style.lineHeight = lineHeight.toString();\r\n        span.textContent = text;\r\n        document.body.appendChild(span);\r\n        height = Math.ceil(span.offsetHeight);\r\n        document.body.removeChild(span);\r\n        // add to cache\r\n        fontHeightCache.set(key, height);\r\n    }\r\n    return height;\r\n};\r\nexport const calcWidth = (ctx, lines) => {\r\n    // return the longest line\r\n    return Math.max(...lines.map(line => Math.ceil(ctx.measureText(line).width)));\r\n};\r\nexport const createNewTexture = (image) => {\r\n    const texture = new Texture(image);\r\n    texture.minFilter = LinearFilter;\r\n    texture.generateMipmaps = false;\r\n    // texture.magFilter = NearestFilter\r\n    // texture.minFilter = NearestFilter\r\n    // texture.magFilter = NearestFilter\r\n    // texture.minFilter = LinearMipMapLinearFilter\r\n    texture.needsUpdate = true;\r\n    return texture;\r\n};\r\n// create the canvas for the texture\r\nexport const canvas = document.createElement('canvas');\r\nlet parent;\r\nlet orbitCtl;\r\nlet tap;\r\nlet down = false;\r\nconst objects = [];\r\nconst raycaster = new Raycaster();\r\nconst mouse = new Vector2();\r\nconst pos = new Vector2();\r\nconst size = new Vector2();\r\nconst messages = [];\r\nconst warn = (msg) => {\r\n    if (messages.includes(msg))\r\n        return;\r\n    console.warn(msg);\r\n    messages.push(msg);\r\n};\r\nexport const setSize = (width, height) => {\r\n    size.x = width;\r\n    size.y = height;\r\n};\r\nexport const setParent = (canvas) => {\r\n    parent = canvas;\r\n};\r\nexport const getParent = () => parent;\r\nexport const setOrbitControls = (orbitControls) => {\r\n    if (orbitControls)\r\n        orbitCtl = orbitControls;\r\n};\r\nconst addEventListeners = () => {\r\n    // get the canvas element for the input events\r\n    const canvas = getParent();\r\n    if (!canvas) {\r\n        warn('Please call \"FLAT.initEvents()\" first.');\r\n        return;\r\n    }\r\n    tap = new Tap(canvas);\r\n};\r\nexport const destroy = () => {\r\n    clearObjects();\r\n    if (tap)\r\n        tap.destroy();\r\n};\r\nexport const addObject = (object) => {\r\n    if (objects.length === 0)\r\n        addEventListeners();\r\n    objects.push(object);\r\n};\r\nexport const clearObjects = () => {\r\n    while (objects.length > 0) {\r\n        objects.pop();\r\n    }\r\n};\r\n// TODO(yandeu) Don't call this in a update loop! Call it on an input event!!! Or not? I don't know :/\r\nexport const updateEvents = (camera) => __awaiter(void 0, void 0, void 0, function* () {\r\n    // console.log(tap.currentPosition)\r\n    if (!tap)\r\n        return;\r\n    const { currentPosition: { x, y }, isDown } = tap;\r\n    const hasMouseMoved = mouse.x !== x || mouse.y !== y;\r\n    const hasClicked = down !== isDown;\r\n    if (!hasMouseMoved && !hasClicked)\r\n        return;\r\n    down = isDown;\r\n    mouse.x = x;\r\n    mouse.y = y;\r\n    if (size.x === 0 || typeof size.x === 'undefined') {\r\n        warn('[FLAT] Please call FLAT.setSize() first!');\r\n        return;\r\n    }\r\n    // calculate mouse position in normalized device coordinates\r\n    // (-1 to +1) for both components\r\n    pos.x = (x / size.x) * 2 - 1;\r\n    pos.y = -(y / size.y) * 2 + 1;\r\n    // update the picking ray with the camera and mouse position\r\n    raycaster.setFromCamera(pos, camera);\r\n    let _objects = [...objects];\r\n    // calculate objects intersecting the picking ray\r\n    const intersects = raycaster.intersectObjects(_objects);\r\n    // console.log('i', intersects)\r\n    if (intersects.length === 0)\r\n        document.body.style.cursor = 'default';\r\n    else\r\n        document.body.style.cursor = 'pointer';\r\n    if (orbitCtl && orbitCtl.enabled && intersects.length >= 0)\r\n        orbitCtl.enabled = false;\r\n    if (orbitCtl && !orbitCtl.enabled && intersects.length === 0)\r\n        orbitCtl.enabled = true;\r\n    for (let i = 0; i < intersects.length; i++) {\r\n        const object = intersects[i].object;\r\n        let isTransparent = false;\r\n        if (object.pixelPerfect) {\r\n            // https://github.com/mrdoob/three.js/issues/758\r\n            const getImageData = (image) => {\r\n                // const canvas = document.createElement('canvas')\r\n                canvas.width = image.width;\r\n                canvas.height = image.height;\r\n                const context = canvas.getContext('2d');\r\n                context.drawImage(image, 0, 0);\r\n                return context.getImageData(0, 0, image.width, image.height);\r\n            };\r\n            const getPixel = (imagedata, x, y) => {\r\n                const position = (x + imagedata.width * y) * 4;\r\n                const data = imagedata.data;\r\n                return { r: data[position], g: data[position + 1], b: data[position + 2], a: data[position + 3] };\r\n            };\r\n            const uv = intersects[0].uv;\r\n            const { x, y } = object.texture.transformUv(uv);\r\n            const bitmap = yield createImageBitmap(object.texture.image);\r\n            const imageData = getImageData(bitmap);\r\n            const { r, g, b, a } = getPixel(imageData, Math.round(x * imageData.width), Math.round(y * imageData.height));\r\n            isTransparent = r + g + b + a === 0;\r\n        }\r\n        // get the colors of the pixel\r\n        // var gl = renderer.getContext()\r\n        // var pixels = new Uint8Array(1 * 1 * 4)\r\n        // gl.readPixels(client.x, window.innerHeight - client.y, 1, 1, gl.RGBA, gl.UNSIGNED_BYTE, pixels)\r\n        // console.log(pixels) // Uint8Array\r\n        // we skip to the next object in intersects[] if this pixel is transparent\r\n        if (object.pixelPerfect && isTransparent)\r\n            continue;\r\n        // set event\r\n        object.event = tap.isDown ? 'down' : 'over';\r\n        // Removing Items in Arrays\r\n        const removeIndex = _objects.findIndex(o => o.uuid === object.uuid);\r\n        _objects = [..._objects.slice(0, removeIndex), ..._objects.slice(removeIndex + 1)];\r\n        // we do not want to send events to objects that lay lower\r\n        break;\r\n    }\r\n    // send out event remaining objects\r\n    _objects.forEach(o => {\r\n        o.event = 'out';\r\n    });\r\n    return intersects;\r\n});\r\n//# sourceMappingURL=_misc.js.map","/**\r\n * @author       Yannick Deubel (https://github.com/yandeu)\r\n * @copyright    Copyright (c) 2021 Yannick Deubel; Project Url: https://github.com/enable3d/enable3d\r\n * @license      {@link https://github.com/enable3d/enable3d/blob/master/LICENSE|GNU GPLv3}\r\n */\r\nimport { Sprite, SpriteMaterial } from 'three';\r\nimport { addObject } from './_misc';\r\nexport class SimpleSprite extends Sprite {\r\n    constructor(texture, clone = true) {\r\n        super(new SpriteMaterial({\r\n            map: clone ? texture.clone() : texture,\r\n            color: 0xffffff\r\n        }));\r\n        this._event = 'out';\r\n        this._pixelPerfect = false;\r\n        this._isInteractive = false;\r\n        this._depth = 0;\r\n        this._bodyOffset = { x: 0, y: 0 };\r\n        this._internalScale = { x: 1, y: 1 };\r\n        this._pixelRatio = 1;\r\n        this.onInputOver = () => { };\r\n        this.onInputOut = () => { };\r\n        this.onInputDown = () => { };\r\n        this._setTexture();\r\n        this.setScale(this._internalScale.x, this._internalScale.y);\r\n        this.setDepth(this._calcZ());\r\n    }\r\n    _onInputOver() { }\r\n    _onInputOut() { }\r\n    _onInputDown() { }\r\n    set event(event) {\r\n        if (this._event === event)\r\n            return;\r\n        this._event = event;\r\n        if (event === 'over') {\r\n            this._onInputOver();\r\n            this.onInputOver();\r\n        }\r\n        else if (event === 'out') {\r\n            this._onInputOut();\r\n            this.onInputOut();\r\n        }\r\n        else if (event === 'down') {\r\n            this._onInputDown();\r\n            this.onInputDown();\r\n        }\r\n    }\r\n    setPixelRatio(pixelRatio) {\r\n        this._pixelRatio = pixelRatio;\r\n        this.setScale(this._internalScale.x, this._internalScale.y);\r\n    }\r\n    setInteractive({ pixelPerfect = false } = {}) {\r\n        if (this._isInteractive)\r\n            return;\r\n        this._isInteractive = true;\r\n        this._pixelPerfect = pixelPerfect;\r\n        addObject(this);\r\n    }\r\n    get pixelPerfect() {\r\n        return this._pixelPerfect;\r\n    }\r\n    _calcZ() {\r\n        return this._depth / 100 - this.id * 1e-8;\r\n    }\r\n    getTexture() {\r\n        return this.texture;\r\n    }\r\n    setTexture(texture) {\r\n        this._setTexture(texture);\r\n    }\r\n    get texture() {\r\n        return this.material.map;\r\n    }\r\n    _setTexture(texture) {\r\n        if (!this.material.map) {\r\n            console.warn('Something went wrong!');\r\n            return;\r\n        }\r\n        if (texture)\r\n            this.material.map = texture;\r\n        const { width, height } = this.material.map.image;\r\n        this.textureWidth = width;\r\n        this.textureHeight = height;\r\n        this.material.map.needsUpdate = true;\r\n    }\r\n    getBodyOffset() {\r\n        // remember: pixelRatio is only for the sprite, not the body\r\n        return {\r\n            x: this._bodyOffset.x * this.getScale().x /* / this.getPixelRatio()*/,\r\n            y: this._bodyOffset.y * this.getScale().y /* / this.getPixelRatio()*/\r\n        };\r\n    }\r\n    setPosition(x, y) {\r\n        this.position.set(x, y, this._calcZ());\r\n    }\r\n    setDepth(z) {\r\n        this._depth = z;\r\n        this.position.setZ(this._calcZ());\r\n    }\r\n    setRotation(rotation) {\r\n        this.material.rotation = rotation;\r\n    }\r\n    getRotation() {\r\n        return this.material.rotation;\r\n    }\r\n    getPixelRatio() {\r\n        return this._pixelRatio;\r\n    }\r\n    getScale() {\r\n        return { x: this._internalScale.x, y: this._internalScale.y };\r\n    }\r\n    setScale(x, y) {\r\n        this._internalScale.x = x;\r\n        if (y)\r\n            this._internalScale.y = y;\r\n        else\r\n            this._internalScale.y = x;\r\n        const xx = x;\r\n        const yy = y ? y : x;\r\n        this.scale.set((xx * this.textureWidth) / this._pixelRatio, (yy * this.textureHeight) / this._pixelRatio, 1);\r\n    }\r\n}\r\n//# sourceMappingURL=simpleSprite.js.map","/**\r\n * @author       Yannick Deubel (https://github.com/yandeu)\r\n * @copyright    Copyright (c) 2021 Yannick Deubel; Project Url: https://github.com/enable3d/enable3d\r\n * @license      {@link https://github.com/enable3d/enable3d/blob/master/LICENSE|GNU GPLv3}\r\n */\r\nimport { SimpleSprite } from './simpleSprite';\r\nimport { Events } from '@yandeu/events';\r\nexport class ActionSprite extends SimpleSprite {\r\n    constructor(texture) {\r\n        super(texture);\r\n        this._anims = [];\r\n        this._flipX = false;\r\n        this._frame = {\r\n            name: '',\r\n            index: -1,\r\n            width: -1,\r\n            height: -1\r\n        };\r\n        this._currentIndex = 0;\r\n        this._currentAnimationName = '';\r\n    }\r\n    get frame() {\r\n        return {\r\n            name: this._frame.name,\r\n            index: this._frame.index,\r\n            width: (this._frame.width * this._internalScale.x * 1) / this._pixelRatio,\r\n            height: (this._frame.height * this._internalScale.y * 1) / this._pixelRatio\r\n        };\r\n    }\r\n    get anims() {\r\n        return {\r\n            add: this._add.bind(this),\r\n            get: this.getAnimationByName.bind(this),\r\n            play: this._play.bind(this),\r\n            stop: this._stop.bind(this),\r\n            getName: () => this._currentAnimationName,\r\n            name: this._currentAnimationName\r\n        };\r\n    }\r\n    getAnimationByName(name) {\r\n        return this._anims.filter(a => a.name === name)[0];\r\n    }\r\n    _add(name, frameOptions) {\r\n        const { start, end, rate = 30, repeat = -1, timeline = [] } = frameOptions;\r\n        if (this.getAnimationByName(name)) {\r\n            console.warn(`The animation \"${name}\" does already exist!`);\r\n            return;\r\n        }\r\n        if (timeline.length === 0) {\r\n            if (typeof end === 'undefined' || typeof start === 'undefined') {\r\n                console.warn(`You need to provide \"start\" and \"end or a \"timeline\"!`);\r\n                return;\r\n            }\r\n            for (let i = start; i <= end; i++) {\r\n                timeline.push(i);\r\n            }\r\n        }\r\n        this._anims.push({ name, timeline, rate, repeat });\r\n    }\r\n    _stop() {\r\n        if (this.interval)\r\n            clearInterval(this.interval);\r\n    }\r\n    _play(name) {\r\n        this._stop();\r\n        this._currentAnimationName = name;\r\n        const animation = this.getAnimationByName(name);\r\n        if (!animation)\r\n            console.warn(`Animation \"${name}\" does not exist!`);\r\n        const { timeline, rate, repeat } = animation;\r\n        this._currentIndex = -1;\r\n        let loops = 0;\r\n        const playNextFrame = () => {\r\n            this._currentIndex++;\r\n            if (this._currentIndex >= timeline.length) {\r\n                this._currentIndex = 0;\r\n                loops++;\r\n            }\r\n            this._currentIndex = timeline[this._currentIndex];\r\n            const shouldStop = !(repeat === -1 || loops < repeat);\r\n            if (shouldStop) {\r\n                this._stop();\r\n                this._events.emit('complete');\r\n                return;\r\n            }\r\n            this.setFrame(this._currentIndex);\r\n        };\r\n        playNextFrame();\r\n        this.interval = window.setInterval(() => {\r\n            playNextFrame();\r\n        }, 1000 / rate);\r\n        return { onComplete: (cb) => this._events.once('complete', cb) };\r\n    }\r\n    get _events() {\r\n        return {\r\n            emit: (event) => {\r\n                if (!this._eventEmitter)\r\n                    this._eventEmitter = new Events();\r\n                this._eventEmitter.emit(event);\r\n            },\r\n            once: (event, callback) => {\r\n                if (!this._eventEmitter)\r\n                    this._eventEmitter = new Events();\r\n                this._eventEmitter.once(event, callback);\r\n            }\r\n        };\r\n    }\r\n}\r\n//# sourceMappingURL=actionSprite.js.map","/**\r\n * @author       Yannick Deubel (https://github.com/yandeu)\r\n * @copyright    Copyright (c) 2021 Yannick Deubel; Project Url: https://github.com/enable3d/enable3d\r\n * @license      {@link https://github.com/enable3d/enable3d/blob/master/LICENSE|GNU GPLv3}\r\n */\r\n// inspired by\r\n// https://felixmariotto.github.io/from_indexed_texture\r\n// https://github.com/felixmariotto/three-SpriteMixer/blob/master/examples/from_indexed_texture.html\r\nimport { RepeatWrapping } from 'three';\r\nimport { ActionSprite } from './actionSprite';\r\nexport class SpriteSheet extends ActionSprite {\r\n    constructor(texture, frameOptions) {\r\n        super(texture);\r\n        const { width = this.textureWidth, height = this.textureHeight } = frameOptions;\r\n        this._tilesHoriz = this.textureWidth / width;\r\n        this._tilesVert = this.textureHeight / height;\r\n        if (this._tilesHoriz !== Math.round(this._tilesHoriz))\r\n            console.warn('The horizontal row does not seem to fit!');\r\n        if (this._tilesVert !== Math.round(this._tilesVert))\r\n            console.warn('The vertical row does not seem to fit!');\r\n        this._width = width;\r\n        this._height = height;\r\n        // stays always the same\r\n        this._frame.width = width;\r\n        this._frame.height = height;\r\n        // this.texture.center.set(0.5, 0.5)\r\n        // this.material.rotation = Math.PI // turn 180 deg\r\n        this.sizeFrame(1 / this._tilesHoriz, 1 / this._tilesVert);\r\n        this.scaleFrame();\r\n    }\r\n    setScale(x, y) {\r\n        super.setScale(x, y);\r\n        this.scaleFrame();\r\n    }\r\n    scaleFrame() {\r\n        this.scale.set((this._width * this._internalScale.x) / this._pixelRatio, (this._height * this._internalScale.y) / this._pixelRatio, 1);\r\n    }\r\n    // returns the row of the current tile.\r\n    getRow(index) {\r\n        return Math.floor(index / this._tilesHoriz);\r\n    }\r\n    // returns the column of the current tile.\r\n    getColumn(index) {\r\n        return index % this._tilesHoriz;\r\n    }\r\n    sizeFrame(width, height) {\r\n        this.texture.wrapS = this.texture.wrapT = RepeatWrapping;\r\n        this.texture.repeat.set(width, height);\r\n        this.texture.needsUpdate = true;\r\n    }\r\n    offsetTexture(x, y) {\r\n        if (this._flipX)\r\n            x += 1 / this._tilesHoriz;\r\n        this.texture.offset.setX(x);\r\n        this.texture.offset.setY(y);\r\n    }\r\n    flipX(flip) {\r\n        this._flipX = flip;\r\n        let x = 1 / this._tilesHoriz;\r\n        const y = 1 / this._tilesVert;\r\n        if (flip)\r\n            x *= -1;\r\n        this.texture.repeat.set(x, y);\r\n        this.setFrame(this._frame.index);\r\n    }\r\n    setFrame(index) {\r\n        this._frame.index = index;\r\n        const x = this.getColumn(index) / this._tilesHoriz;\r\n        const y = (this._tilesVert - this.getRow(index) - 1) / this._tilesVert;\r\n        this.offsetTexture(x, y);\r\n    }\r\n}\r\n//# sourceMappingURL=spriteSheet.js.map","/**\r\n * @author       Yannick Deubel (https://github.com/yandeu)\r\n * @copyright    Copyright (c) 2021 Yannick Deubel; Project Url: https://github.com/enable3d/enable3d\r\n * @license      {@link https://github.com/enable3d/enable3d/blob/master/LICENSE|GNU GPLv3}\r\n */\r\nimport { SpriteSheet } from './spriteSheet';\r\nexport class Button extends SpriteSheet {\r\n    constructor(texture, frameOptions, overFrame, outFrame, downFrame) {\r\n        super(texture, frameOptions);\r\n        this.overFrame = overFrame;\r\n        this.outFrame = outFrame;\r\n        this.downFrame = downFrame;\r\n        this.setFrame(outFrame);\r\n    }\r\n    _onInputOver() {\r\n        this.setFrame(this.overFrame);\r\n    }\r\n    _onInputOut() {\r\n        this.setFrame(this.outFrame);\r\n    }\r\n    _onInputDown() {\r\n        this.setFrame(this.downFrame);\r\n    }\r\n}\r\n//# sourceMappingURL=button.js.map","/**\r\n * @author       Yannick Deubel (https://github.com/yandeu)\r\n * @copyright    Copyright (c) 2021 Yannick Deubel; Project Url: https://github.com/enable3d/enable3d\r\n * @license      {@link https://github.com/enable3d/enable3d/blob/master/LICENSE|GNU GPLv3}\r\n */\r\nimport { LinearFilter, Texture } from 'three';\r\nimport { SimpleSprite } from './simpleSprite';\r\nimport { canvas, createNewTexture } from './_misc';\r\nexport class DrawTexture extends Texture {\r\n    constructor(width, height, drawCanvas) {\r\n        // get ctx and clear\r\n        const ctx = canvas.getContext('2d');\r\n        ctx.clearRect(0, 0, canvas.width, canvas.height);\r\n        // set width and height\r\n        canvas.height = height;\r\n        canvas.width = width;\r\n        // let the user draw the ctx\r\n        drawCanvas(ctx);\r\n        // generate image and texture\r\n        const imageData = ctx.getImageData(0, 0, canvas.width, canvas.height);\r\n        super(imageData);\r\n        this.minFilter = LinearFilter;\r\n        this.generateMipmaps = false;\r\n        this.width = width;\r\n        this.height = height;\r\n        this.drawCanvas = drawCanvas;\r\n        this.needsUpdate = true;\r\n    }\r\n    // @ts-ignore\r\n    clone() {\r\n        // return new this.constructor(this.width, this.height, this.drawCanvas).copy(this)\r\n        return new DrawTexture(this.width, this.height, this.drawCanvas).copy(this);\r\n    }\r\n}\r\nexport class DrawSprite extends SimpleSprite {\r\n    constructor(width, height, drawCanvas) {\r\n        // get ctx and clear\r\n        const ctx = canvas.getContext('2d');\r\n        ctx.clearRect(0, 0, canvas.width, canvas.height);\r\n        // set width and height\r\n        canvas.height = height;\r\n        canvas.width = width;\r\n        // let the user draw the ctx\r\n        drawCanvas(ctx);\r\n        // generate image and texture\r\n        const image = ctx.getImageData(0, 0, canvas.width, canvas.height);\r\n        const texture = createNewTexture(image);\r\n        super(texture);\r\n        this._drawCanvas = drawCanvas;\r\n    }\r\n    // @ts-ignore\r\n    clone() {\r\n        return new DrawSprite(this.textureWidth, this.textureHeight, this._drawCanvas).clone();\r\n    }\r\n}\r\n//# sourceMappingURL=draw.js.map","/**\r\n * @author       Yannick Deubel (https://github.com/yandeu)\r\n * @copyright    Copyright (c) 2021 Yannick Deubel; Project Url: https://github.com/enable3d/enable3d\r\n * @license      {@link https://github.com/enable3d/enable3d/blob/master/LICENSE|GNU GPLv3}\r\n */\r\nimport { setOrbitControls, setParent } from './_misc';\r\nexport { updateEvents, getParent, destroy, setSize } from './_misc';\r\nexport const initEvents = ({ canvas, orbitControls }) => {\r\n    setOrbitControls(orbitControls);\r\n    setParent(canvas);\r\n};\r\n//# sourceMappingURL=flat.js.map","/**\r\n * @author       Yannick Deubel (https://github.com/yandeu)\r\n * @copyright    Copyright (c) 2021 Yannick Deubel; Project Url: https://github.com/enable3d/enable3d\r\n * @license      {@link https://github.com/enable3d/enable3d/blob/master/LICENSE|GNU GPLv3}\r\n */\r\nimport { LinearFilter, Texture } from 'three';\r\nimport { SimpleSprite } from './simpleSprite';\r\nimport { calcHeight, calcWidth, canvas, createNewTexture, roundRect } from './_misc';\r\nexport class TextTexture extends Texture {\r\n    constructor(text, styles = {}) {\r\n        const { imageData, width, height } = createTextImage(text, styles);\r\n        super(imageData);\r\n        this.width = width;\r\n        this.height = height;\r\n        this._text = text;\r\n        this._styles = styles;\r\n        this._image = imageData;\r\n        this.minFilter = LinearFilter;\r\n        this.generateMipmaps = false;\r\n        this.needsUpdate = true;\r\n    }\r\n    getText() {\r\n        return this._text;\r\n    }\r\n    getStyles() {\r\n        return this._styles;\r\n    }\r\n    // @ts-ignore\r\n    clone() {\r\n        // @ts-ignore\r\n        return new this.constructor(this._text, this._styles).copy(this);\r\n    }\r\n}\r\nexport class TextSprite extends SimpleSprite {\r\n    constructor(texture) {\r\n        super(texture, false);\r\n        this._text = texture.getText();\r\n        this._styles = texture.getStyles();\r\n    }\r\n    getText() {\r\n        return this._text;\r\n    }\r\n    getStyles() {\r\n        return this._styles;\r\n    }\r\n    setStyles(styles) {\r\n        this._styles = styles;\r\n        this.texture.dispose();\r\n        this.setTexture(createNewTexture(createTextImage(this._text, styles).imageData));\r\n    }\r\n    setText(text) {\r\n        this._text = text;\r\n        this.texture.dispose();\r\n        this.setTexture(createNewTexture(createTextImage(text, this._styles).imageData));\r\n        this._update();\r\n    }\r\n    _update() {\r\n        // update size\r\n        this.textureHeight = this.texture.image.height;\r\n        this.textureWidth = this.texture.image.width;\r\n        // update\r\n        this.texture.needsUpdate = true;\r\n        this.material.needsUpdate = true;\r\n        const { x, y } = this._internalScale;\r\n        this.setScale(x, y);\r\n    }\r\n}\r\nconst createTextImage = (text, styles) => {\r\n    const { align = 'center', background = '', baseline = 'middle', borderColor = '', borderRadius = 0, borderWidth = 0, fillStyle = 'SlateBlue', fontFamily = 'Arial', fontSize = 48, fontWeight = '', lineHeight = 1, lineWidth = 4, padding = 0, strokeStyle = '' } = styles;\r\n    // get offset\r\n    const { offset: { x: offsetX = 0, y: offsetY = 0 } = {} } = styles;\r\n    // get padding\r\n    let paddingX;\r\n    let paddingY;\r\n    if (typeof padding !== 'number') {\r\n        paddingX = padding.x || 0;\r\n        paddingY = padding.y || 0;\r\n    }\r\n    else {\r\n        paddingX = padding;\r\n        paddingY = padding;\r\n    }\r\n    const font = `${fontWeight} ${fontSize}px ${fontFamily}`;\r\n    const ctx = canvas.getContext('2d');\r\n    // clean up\r\n    ctx.clearRect(0, 0, canvas.width, canvas.height);\r\n    const lines = text.split('\\n');\r\n    ctx.font = font;\r\n    const line_height = calcHeight(text, fontSize, fontFamily, lineHeight);\r\n    const line_width = fillStyle ? lineWidth * 2 : lineWidth;\r\n    const height = line_height * lines.length + paddingY * 2 + borderWidth * 2;\r\n    const width = calcWidth(ctx, lines) + line_width + paddingX * 2 + borderWidth * 2;\r\n    // adjust to PowerOfTwo (WebGL1 only)\r\n    // width = Math.max(2, MathUtils.ceilPowerOfTwo(width))\r\n    // height = Math.max(2, MathUtils.ceilPowerOfTwo(height))\r\n    canvas.height = height;\r\n    canvas.width = width;\r\n    // border\r\n    if (borderColor) {\r\n        ctx.strokeStyle = borderColor;\r\n        roundRect(ctx, borderWidth / 2, borderWidth / 2, canvas.width - borderWidth, canvas.height - borderWidth, borderRadius);\r\n        ctx.lineWidth = borderWidth;\r\n        ctx.stroke();\r\n    }\r\n    // background\r\n    if (background) {\r\n        ctx.fillStyle = background;\r\n        roundRect(ctx, borderWidth, borderWidth, canvas.width - borderWidth * 2, canvas.height - borderWidth * 2, borderColor ? borderRadius / 2 : borderRadius);\r\n        ctx.fill();\r\n        // if (borderColor && borderWidth)\r\n        //   ctx.fillRect(borderWidth, borderWidth, canvas.width - borderWidth * 2, canvas.height - borderWidth * 2)\r\n        // else ctx.fillRect(0, 0, canvas.width, canvas.height)\r\n    }\r\n    // text\r\n    ctx.font = font;\r\n    ctx.textAlign = align;\r\n    ctx.textBaseline = baseline;\r\n    if (strokeStyle && lineWidth) {\r\n        ctx.strokeStyle = strokeStyle;\r\n        ctx.lineWidth = line_width;\r\n    }\r\n    if (fillStyle)\r\n        ctx.fillStyle = fillStyle;\r\n    for (var i = 0; i < lines.length; i++) {\r\n        let top = i * line_height + line_height / 2;\r\n        let left = 0;\r\n        if (align === 'left') {\r\n            left = line_width / 2;\r\n            left += paddingX;\r\n            left += borderWidth;\r\n        }\r\n        if (align === 'center') {\r\n            left = width / 2;\r\n        }\r\n        if (align === 'right') {\r\n            left = width - line_width / 2;\r\n            left -= paddingX;\r\n            left -= borderWidth;\r\n        }\r\n        top += paddingY;\r\n        top += borderWidth;\r\n        top += offsetY;\r\n        left += offsetX;\r\n        if (strokeStyle && lineWidth)\r\n            ctx.strokeText(lines[i], left, top);\r\n        if (fillStyle)\r\n            ctx.fillText(lines[i], left, top);\r\n    }\r\n    // https://github.com/makc/Edelweiss/blob/c3e63135f2f57f1a422c30abbeca35e579b84f02/docs/js/AssetManager.js#L245\r\n    const imageData = ctx.getImageData(0, 0, canvas.width, canvas.height);\r\n    return { imageData, width, height };\r\n};\r\n//# sourceMappingURL=text.js.map","/**\r\n * @author       Yannick Deubel (https://github.com/yandeu)\r\n * @copyright    Copyright (c) 2021 Yannick Deubel; Project Url: https://github.com/enable3d/enable3d\r\n * @license      {@link https://github.com/enable3d/enable3d/blob/master/LICENSE|GNU GPLv3}\r\n */\r\nimport { ActionSprite } from './actionSprite';\r\nimport { RepeatWrapping } from 'three';\r\nexport class TextureAtlas extends ActionSprite {\r\n    /**\r\n     * @param texture Atlas Texture (image)\r\n     * @param json Atlas .json file (string). Needs to be  \"JSON hash\".\r\n     */\r\n    constructor(atlas, frame) {\r\n        super(atlas.texture);\r\n        this.positionOffset = { x: 0, y: 0 };\r\n        this.JSONHash = atlas.json;\r\n        if (frame)\r\n            this.setFrame(frame);\r\n    }\r\n    setScale(x, y) {\r\n        this._internalScale.x = x;\r\n        if (y)\r\n            this._internalScale.y = y;\r\n        else\r\n            this._internalScale.y = x;\r\n        this.scaleFrame();\r\n    }\r\n    scaleFrame() {\r\n        var _a;\r\n        if (!((_a = this._frame) === null || _a === void 0 ? void 0 : _a.name))\r\n            return;\r\n        const { frame: { w, h } } = this.getFrame(this._frame.name);\r\n        const scaleX = (w * this._internalScale.x) / this._pixelRatio;\r\n        const scaleY = (h * this._internalScale.y) / this._pixelRatio;\r\n        this.scale.set(scaleX, scaleY, 1);\r\n    }\r\n    sizeFrame(width, height) {\r\n        this.texture.wrapS = this.texture.wrapT = RepeatWrapping;\r\n        this.texture.repeat.set(width, height);\r\n        this.texture.needsUpdate = true;\r\n    }\r\n    offsetTexture(x, y) {\r\n        this.texture.offset.setX(x);\r\n        this.texture.offset.setY(y);\r\n    }\r\n    flipX(flip) {\r\n        this._flipX = flip;\r\n        this.update();\r\n    }\r\n    getFrame(frameName) {\r\n        return this.JSONHash.frames[frameName];\r\n    }\r\n    setFrame(frameName) {\r\n        this.update(frameName);\r\n    }\r\n    update(frameName) {\r\n        if (!frameName)\r\n            frameName = this._frame.name;\r\n        if (!frameName)\r\n            return;\r\n        const f = this.getFrame(frameName);\r\n        if (!f)\r\n            console.warn(`Frame ${frameName} not found!`);\r\n        const { frame, rotated, trimmed, spriteSourceSize, sourceSize } = f;\r\n        // set current frame\r\n        this._frame.name = frameName;\r\n        // reset rotation\r\n        this.texture.rotation = 0;\r\n        // set values\r\n        const x = frame.x / this.textureWidth;\r\n        let y = 1 - (frame.y + frame.h) / this.textureHeight;\r\n        let w = frame.w;\r\n        let h = frame.h;\r\n        this._frame.width = w;\r\n        this._frame.height = h;\r\n        // if the frame is rotated\r\n        if (rotated) {\r\n            // rotate texture\r\n            this.texture.rotation = Math.PI / 2;\r\n            // adjust y\r\n            y = 1 - frame.y / this.textureHeight;\r\n            [w, h] = [h, w];\r\n            // check flipX\r\n            if (this._flipX)\r\n                this.texture.rotation *= -1;\r\n        }\r\n        // if the frame is trimmed\r\n        if (trimmed) {\r\n            const newOffX = ((sourceSize.w - frame.w) / 2 - spriteSourceSize.x) / (1 / this._internalScale.x);\r\n            const newOffY = ((sourceSize.h - frame.h) / 2 - spriteSourceSize.y) / (1 / this._internalScale.x);\r\n            // x\r\n            if (!this._flipX)\r\n                this.position.x -= newOffX - this.positionOffset.x;\r\n            else\r\n                this.position.x += newOffX - this.positionOffset.x;\r\n            //y\r\n            this.position.y += newOffY - this.positionOffset.y;\r\n            this.positionOffset.x = newOffX;\r\n            this.positionOffset.y = newOffY;\r\n        }\r\n        // set offset, size and scale\r\n        let offsetX = x;\r\n        let offsetY = y;\r\n        let sizeX = w / this.textureWidth;\r\n        const sizeY = h / this.textureHeight;\r\n        // if the frame is flipped\r\n        if (this._flipX) {\r\n            sizeX *= -1;\r\n            if (!rotated)\r\n                offsetX += frame.w / this.textureWidth;\r\n            else\r\n                offsetY -= frame.w / this.textureHeight;\r\n        }\r\n        this.offsetTexture(offsetX, offsetY);\r\n        this.sizeFrame(sizeX, sizeY);\r\n        this.scaleFrame();\r\n    }\r\n}\r\n//# sourceMappingURL=textureAtlas.js.map","/**\r\n * @author       Yannick Deubel (https://github.com/yandeu)\r\n * @copyright    Copyright (c) 2021 Yannick Deubel; Project Url: https://github.com/enable3d/enable3d\r\n * @license      {@link https://github.com/enable3d/enable3d/blob/master/LICENSE|GNU GPLv3}\r\n */\r\nexport const debugSettings = {\r\n    colors: {\r\n        dynamic: '#ff0000',\r\n        static: '#90ee90',\r\n        sensor: '#ffff00',\r\n        sleeping: '#464646' // gray\r\n    },\r\n    lineWidth: 2,\r\n    fill: false,\r\n    opacity: 0.25\r\n};\r\nexport const getDebugColors = (options = {}) => {\r\n    const { colors } = debugSettings;\r\n    if (options.isStatic)\r\n        return colors.static;\r\n    if (options.isSensor)\r\n        return colors.sensor;\r\n    if (options.isSleeping)\r\n        return colors.sleeping;\r\n    return colors.dynamic;\r\n};\r\nexport const adjustDebugColor = (body, depth = 0, _fill, _stroke) => {\r\n    // get color\r\n    const color = getDebugColors(body);\r\n    const opacity = debugSettings.opacity;\r\n    const lineWidth = debugSettings.lineWidth;\r\n    const shouldFill = debugSettings.fill;\r\n    let fill = _fill !== null && _fill !== void 0 ? _fill : color + Math.round(255 * opacity).toString(16);\r\n    if (!shouldFill)\r\n        fill = _fill !== null && _fill !== void 0 ? _fill : 'transparent';\r\n    if (body.isSleeping && !body.isStatic && !body.isSensor)\r\n        fill = _fill !== null && _fill !== void 0 ? _fill : color; //+ Math.round(255 * opacity).toString(16)\r\n    const stroke = _stroke !== null && _stroke !== void 0 ? _stroke : color;\r\n    body.render.fillStyle = fill;\r\n    body.render.strokeStyle = stroke;\r\n    body.render.lineWidth = lineWidth;\r\n    if (depth >= 5)\r\n        return;\r\n    body.parts.forEach(part => {\r\n        adjustDebugColor(part, depth + 1, fill, stroke);\r\n    });\r\n};\r\n//# sourceMappingURL=_misc.js.map","/**\r\n * @author       Yannick Deubel (https://github.com/yandeu)\r\n * @copyright    Copyright (c) 2021 Yannick Deubel; Project Url: https://github.com/enable3d/enable3d\r\n * @license      {@link https://github.com/enable3d/enable3d/blob/master/LICENSE|GNU GPLv3}\r\n */\r\nimport { Bodies, Body, Engine, Events, Render, Runner, Vector, Vertices, World } from 'matter-js';\r\nimport { Vector2 } from 'three';\r\nimport { adjustDebugColor } from './_misc';\r\n// manually update circle radius for debugging (bug in matter-js ??)\r\n// copied from Body.js\r\nconst scaleCircle_Fix = (body, scaleX, scaleY) => {\r\n    // handle circles\r\n    if (body.circleRadius) {\r\n        if (scaleX === scaleY) {\r\n            body.circleRadius *= scaleX;\r\n        }\r\n        else {\r\n            // body is no longer a circle\r\n            body.circleRadius = undefined;\r\n        }\r\n    }\r\n};\r\nconst scaleBody_Fix = (body, scaleX, scaleY) => {\r\n    if (!body.circleRadius) {\r\n        body.parts.forEach(part => {\r\n            scaleCircle_Fix(part, scaleX, scaleY);\r\n        });\r\n    }\r\n    Body.scale(body, scaleX, scaleY);\r\n};\r\nexport class Physics {\r\n    constructor(debug = true) {\r\n        this._objects = new Map();\r\n        this.width = window.innerWidth;\r\n        this.height = window.innerHeight;\r\n        const DEBUG = debug;\r\n        this.engine = Engine.create({ enableSleeping: true });\r\n        this.world = this.engine.world;\r\n        this.runner = Runner.create();\r\n        // for debugging\r\n        if (DEBUG) {\r\n            const canvas = document.createElement('canvas');\r\n            canvas.id = 'matter-debug';\r\n            canvas.style.position = 'absolute';\r\n            canvas.style.top = '0px';\r\n            canvas.style.left = '0px';\r\n            canvas.style.pointerEvents = 'none';\r\n            document.body.append(canvas);\r\n            this.render = Render.create({\r\n                canvas: canvas,\r\n                engine: this.engine,\r\n                options: {\r\n                    width: this.width,\r\n                    height: this.height,\r\n                    background: 'transparent',\r\n                    wireframeBackground: 'transparent',\r\n                    wireframes: false,\r\n                    showConvexHulls: true,\r\n                    showPositions: true,\r\n                    showVelocity: true\r\n                }\r\n            });\r\n            Render.run(this.render);\r\n        }\r\n        Runner.run(this.runner, this.engine);\r\n        Events.on(this.engine, 'afterUpdate', () => this.update());\r\n    }\r\n    destroy() {\r\n        World.clear(this.world, false);\r\n        Engine.clear(this.engine);\r\n    }\r\n    parsePhysics(file) {\r\n        const json = JSON.parse(file);\r\n        delete json['generator_info'];\r\n        let bodies = {};\r\n        for (const key in json) {\r\n            const fixtures = json[key].fixtures;\r\n            bodies = Object.assign(Object.assign({}, bodies), { [key]: fixtures });\r\n        }\r\n        return bodies;\r\n    }\r\n    addBodyFromFixtures(x, y, fixtures) {\r\n        const bodies = [];\r\n        fixtures.forEach(fixture => {\r\n            let body;\r\n            if (fixture.vertices) {\r\n                body = this.add.fromVertices(x, y, fixture.vertices);\r\n            }\r\n            else if (fixture.circle) {\r\n                body = this.add.circle(x + fixture.circle.x, y + fixture.circle.y, fixture.circle.radius);\r\n            }\r\n            else {\r\n                console.log(`Shape not recognized!`);\r\n            }\r\n            if (body)\r\n                bodies.push(body);\r\n        });\r\n        let body;\r\n        if (bodies.length > 1)\r\n            body = Body.create({\r\n                parts: bodies\r\n            });\r\n        else\r\n            body = bodies[0];\r\n        Body.setPosition(body, { x, y });\r\n        return body;\r\n    }\r\n    fromVertices_Fixed(x, y, vertexSets, options = {}) {\r\n        // https://github.com/liabru/matter-js/issues/248#issuecomment-361983251\r\n        const bodies = [];\r\n        for (var i = 0; i < vertexSets.length; i++) {\r\n            const body = Bodies.fromVertices(x, y, [vertexSets[i]], Object.assign({}, options));\r\n            bodies.push(body);\r\n            const centre = Vertices.centre(vertexSets[i]);\r\n            Body.setPosition(body, {\r\n                x: body.position.x + centre.x,\r\n                y: body.position.y + centre.y\r\n            });\r\n        }\r\n        const compound = Body.create(Object.assign(Object.assign({}, options), { parts: bodies }));\r\n        return compound;\r\n    }\r\n    fromVertices(x, y, vertexSets, options = {}) {\r\n        return this.fromVertices_Fixed(x, y, vertexSets, Object.assign({}, options));\r\n    }\r\n    setBounds(x = 0, y = 0, width = this.width, height = this.height, depth = 50) {\r\n        // x = 100\r\n        // y = 100\r\n        // width = 300\r\n        // height = 500\r\n        // walls\r\n        World.add(this.world, [\r\n            // top\r\n            this.add.rectangle(x + width / 2, y + 0 - depth / 2, width + depth * 2, depth, { isStatic: true }),\r\n            // bottom\r\n            this.add.rectangle(x + width / 2, y + height + depth / 2, width + depth * 2, depth, { isStatic: true }),\r\n            // left\r\n            this.add.rectangle(x + 0 - depth / 2, y + height / 2, depth, height + depth * 2, { isStatic: true }),\r\n            // right\r\n            this.add.rectangle(x + width + depth / 2, y + height / 2, depth, height + depth * 2, { isStatic: true })\r\n        ]);\r\n    }\r\n    rectangle(x, y, width, height, options = {}) {\r\n        return Bodies.rectangle(x, y, width, height, Object.assign({}, options));\r\n    }\r\n    circle(x, y, radius, options = {}) {\r\n        return Bodies.circle(x, y, radius, Object.assign({}, options));\r\n    }\r\n    existing(sprite) {\r\n        this.add.bodyToSprite(sprite);\r\n        this._objects.set(sprite.body.id.toString(), sprite);\r\n    }\r\n    calcBodyOffset(sprite) {\r\n        const body = sprite.body;\r\n        // https://github.com/liabru/matter-js/issues/211#issuecomment-184804576\r\n        const width = body.bounds.max.x - body.bounds.min.x;\r\n        const height = body.bounds.max.y - body.bounds.min.y;\r\n        const topLeft = Vector.sub(body.bounds.min, body.position);\r\n        const centerOfBody = { x: width / 2, y: height / 2 };\r\n        const centerOfMass = body.position;\r\n        const offsetX = topLeft.x + width / 2;\r\n        const offsetY = topLeft.y + height / 2;\r\n        const offset = { x: offsetX, y: offsetY };\r\n        // @ts-expect-error\r\n        sprite._bodyOffset = offset;\r\n    }\r\n    _addBodyToSprite(sprite) {\r\n        this.add.body(sprite.body);\r\n        this.calcBodyOffset(sprite);\r\n        // /remember: pixelRatio is only for the sprite, not the body\r\n        const scaleX = sprite.getScale().x; // / sprite.getPixelRatio()\r\n        const scaleY = sprite.getScale().y; // / sprite.getPixelRatio()\r\n        scaleBody_Fix(sprite.body, scaleX, scaleY);\r\n        sprite.setBodyPosition = (x, y) => {\r\n            Body.setPosition(sprite.body, {\r\n                x: x - sprite.getBodyOffset().x,\r\n                y: y - sprite.getBodyOffset().y\r\n            });\r\n        };\r\n    }\r\n    _addBody(body) {\r\n        World.add(this.world, body);\r\n    }\r\n    get add() {\r\n        return {\r\n            body: this._addBody.bind(this),\r\n            bodyToSprite: this._addBodyToSprite.bind(this),\r\n            fromVertices: this.fromVertices.bind(this),\r\n            circle: this.circle.bind(this),\r\n            existing: this.existing.bind(this),\r\n            rectangle: this.rectangle.bind(this)\r\n        };\r\n    }\r\n    adjustDebugColor(body) {\r\n        adjustDebugColor(body);\r\n    }\r\n    update() {\r\n        this._objects.forEach(object => {\r\n            const { body } = object;\r\n            const { angle, position } = body;\r\n            const { x, y } = position;\r\n            // https://github.com/liabru/matter-js/issues/211#issuecomment-184804576\r\n            const offset = new Vector2(object.getBodyOffset().x, object.getBodyOffset().y);\r\n            offset.rotateAround(new Vector2(), angle);\r\n            object.setPosition(x + offset.x, this.height - y - offset.y);\r\n            object.setRotation(-angle);\r\n            adjustDebugColor(body);\r\n        });\r\n    }\r\n}\r\n//# sourceMappingURL=physics.js.map","/**\r\n * @author       Yannick Deubel (https://github.com/yandeu)\r\n * @copyright    Copyright (c) 2020 Yannick Deubel; Project Url: https://github.com/enable3d/enable3d\r\n * @license      {@link https://github.com/enable3d/enable3d/blob/master/LICENSE|GNU GPLv3}\r\n */\r\nimport { Events } from '@yandeu/events';\r\n// This class is based on a file I found online called toon3d.js\r\n// Unfortunately I could not find its license or author.\r\n// I just ported it to TypeScript and improved the code.\r\nexport class JoyStick extends Events {\r\n    constructor() {\r\n        super(...arguments);\r\n        this.id = -1;\r\n    }\r\n    get add() {\r\n        return {\r\n            axis: (config = {}) => this.addAxis(config),\r\n            button: (config = {}) => this.addButton(config)\r\n        };\r\n    }\r\n    addAxis(config = {}) {\r\n        this.id++;\r\n        const { styles = { left: 35, bottom: 35, size: 100 } } = config;\r\n        const circle = this.circle({ styles });\r\n        const thumb = this.thumb({ styles });\r\n        circle.appendChild(thumb);\r\n        document.body.appendChild(circle);\r\n        const { maxRadius = 40, rotationDamping = 0.06, moveDamping = 0.01 } = config;\r\n        // element\r\n        const element = {\r\n            id: this.id,\r\n            domElement: thumb,\r\n            maxRadius: maxRadius,\r\n            maxRadiusSquared: maxRadius * maxRadius,\r\n            origin: { left: thumb.offsetLeft, top: thumb.offsetTop },\r\n            offset: { x: 0, y: 0 },\r\n            rotationDamping: rotationDamping,\r\n            moveDamping: moveDamping\r\n        };\r\n        if (element === null || element === void 0 ? void 0 : element.domElement) {\r\n            const { domElement } = element;\r\n            if ('ontouchstart' in window) {\r\n                domElement.addEventListener('touchstart', evt => {\r\n                    evt.preventDefault();\r\n                    this.tap(evt, element);\r\n                    evt.stopPropagation();\r\n                });\r\n            }\r\n            else {\r\n                domElement.addEventListener('mousedown', evt => {\r\n                    evt.preventDefault();\r\n                    this.tap(evt, element);\r\n                    evt.stopPropagation();\r\n                });\r\n            }\r\n        }\r\n        return {\r\n            onMove: (event) => {\r\n                this.on(`axis_onmove_${element.id}`, (delta) => {\r\n                    event(delta);\r\n                });\r\n            }\r\n        };\r\n    }\r\n    addButton(config = {}) {\r\n        this.id++;\r\n        const { styles = { right: 35, bottom: 35, size: 80 }, letter: l = 'A' } = config;\r\n        const circle = this.circle({ styles });\r\n        const letter = this.letter({ letter: l });\r\n        circle.appendChild(letter);\r\n        document.body.appendChild(circle);\r\n        // element\r\n        const element = {\r\n            id: this.id,\r\n            domElement: circle,\r\n            offset: { x: 0, y: 0 }\r\n        };\r\n        if (element === null || element === void 0 ? void 0 : element.domElement) {\r\n            this.click(element);\r\n        }\r\n        return {\r\n            onClick: (event) => {\r\n                this.on(`button_onclick_${element.id}`, (data) => {\r\n                    event(data);\r\n                });\r\n            },\r\n            onRelease: (event) => {\r\n                this.on(`button_onrelease_${element.id}`, (data) => {\r\n                    event(data);\r\n                });\r\n            }\r\n        };\r\n    }\r\n    circle(config = {}) {\r\n        const { styles } = config;\r\n        const { top, right, bottom, left, size } = styles;\r\n        const circle = document.createElement('div');\r\n        let css = `position:absolute; width:${size}px; height:${size}px; background:rgba(126, 126, 126, 0.5); border:#444 solid medium; border-radius:50%; cursor: pointer; `;\r\n        if (top)\r\n            css += `top:${top}px; `;\r\n        if (right)\r\n            css += `right:${right}px; `;\r\n        if (bottom)\r\n            css += `bottom:${bottom}px; `;\r\n        if (left)\r\n            css += `left:${left}px; `;\r\n        circle.style.cssText = css;\r\n        return circle;\r\n    }\r\n    thumb(config = {}) {\r\n        const { styles } = config;\r\n        const { size } = styles;\r\n        const thumb = document.createElement('div');\r\n        thumb.style.cssText = `position: absolute; left: ${size / 4}px; top: ${size / 4}px; width: ${size / 2}px; height: ${size / 2}px; border-radius: 50%; background: #fff; `;\r\n        return thumb;\r\n    }\r\n    letter(config = {}) {\r\n        const { letter: l } = config;\r\n        const letter = document.createElement('span');\r\n        letter.innerText = l;\r\n        letter.style.cssText =\r\n            'position: absolute; text-align: center; top: 4px; width: 80px; height: 80px; font-size: 64px; color: #fff; ';\r\n        return letter;\r\n    }\r\n    click(element) {\r\n        const { id, domElement } = element;\r\n        if ('ontouchstart' in window) {\r\n            domElement.addEventListener('touchstart', evt => {\r\n                evt.preventDefault();\r\n                this.emit(`button_onclick_${id}`);\r\n            });\r\n            domElement.addEventListener('touchend', evt => {\r\n                evt.preventDefault();\r\n                this.emit(`button_onrelease_${id}`);\r\n            });\r\n        }\r\n        else {\r\n            domElement.addEventListener('mousedown', evt => {\r\n                evt.preventDefault();\r\n                this.emit(`button_onclick_${id}`);\r\n                evt.stopPropagation();\r\n            });\r\n            domElement.addEventListener('mouseup', evt => {\r\n                evt.preventDefault();\r\n                this.emit(`button_onrelease_${id}`);\r\n                evt.stopPropagation();\r\n            });\r\n        }\r\n    }\r\n    tap(evt, element) {\r\n        evt = evt || window.event;\r\n        // get the mouse cursor position at startup:\r\n        element.offset = this.getMousePosition(evt);\r\n        if ('ontouchstart' in window) {\r\n            document.ontouchmove = evt => {\r\n                if (evt.target === element.domElement)\r\n                    this.move(evt, element);\r\n            };\r\n            document.ontouchend = evt => {\r\n                if (evt.target === element.domElement)\r\n                    this.up(element);\r\n            };\r\n        }\r\n        else {\r\n            document.onmousemove = evt => {\r\n                if (evt.target === element.domElement)\r\n                    this.move(evt, element);\r\n            };\r\n            document.onmouseup = _evt => {\r\n                this.up(element);\r\n            };\r\n        }\r\n    }\r\n    move(evt, element) {\r\n        const { domElement, maxRadius, maxRadiusSquared, origin, offset, id } = element;\r\n        evt = evt || window.event;\r\n        const mouse = this.getMousePosition(evt);\r\n        // calculate the new cursor position:\r\n        let left = mouse.x - offset.x;\r\n        let top = mouse.y - offset.y;\r\n        //this.offset = mouse;\r\n        const sqMag = left * left + top * top;\r\n        if (sqMag > maxRadiusSquared) {\r\n            //Only use sqrt if essential\r\n            const magnitude = Math.sqrt(sqMag);\r\n            left /= magnitude;\r\n            top /= magnitude;\r\n            left *= maxRadius;\r\n            top *= maxRadius;\r\n        }\r\n        // set the element's new position:\r\n        domElement.style.top = `${top + domElement.clientHeight / 2}px`;\r\n        domElement.style.left = `${left + domElement.clientWidth / 2}px`;\r\n        const forward = -(top - origin.top + domElement.clientHeight / 2) / maxRadius;\r\n        const turn = (left - origin.left + domElement.clientWidth / 2) / maxRadius;\r\n        this.emit(`axis_onmove_${id}`, { top: forward, right: turn });\r\n    }\r\n    up(element) {\r\n        const { domElement, origin, id } = element;\r\n        if ('ontouchstart' in window) {\r\n            document.ontouchmove = null;\r\n            // @ts-ignore\r\n            document.touchend = null;\r\n        }\r\n        else {\r\n            document.onmousemove = null;\r\n            document.onmouseup = null;\r\n        }\r\n        domElement.style.top = `${origin.top}px`;\r\n        domElement.style.left = `${origin.left}px`;\r\n        this.emit(`axis_onmove_${id}`, { top: 0, right: 0 });\r\n    }\r\n    getMousePosition(evt) {\r\n        // @ts-ignore\r\n        const clientX = evt.targetTouches ? evt.targetTouches[0].pageX : evt.clientX;\r\n        // @ts-ignore\r\n        const clientY = evt.targetTouches ? evt.targetTouches[0].pageY : evt.clientY;\r\n        return { x: clientX, y: clientY };\r\n    }\r\n}\r\n//# sourceMappingURL=joystick.js.map","/**\r\n * @description  This code has originally been copied from Sketchbook\r\n *\r\n * @author       swift502 <blaha.j502@gmail.com> (http://jblaha.art/)\r\n * @copyright    Copyright (c) 2018 swift502; Project Url: https://github.com/swift502/Sketchbook\r\n * @license      {@link https://github.com/swift502/Sketchbook/blob/master/LICENSE GPL-3.0}\r\n *\r\n * @author       Yannick Deubel (https://github.com/yandeu)\r\n * @copyright    Copyright (c) 2021 Yannick Deubel; Project Url: https://github.com/enable3d/enable3d\r\n * @license      {@link https://github.com/enable3d/enable3d/blob/master/LICENSE GNU GPLv3}\r\n */\r\nimport { MathUtils as THREE_Math, Vector2, Vector3 } from 'three';\r\nclass ThirdPersonControls {\r\n    constructor(camera, target, config) {\r\n        this.camera = camera;\r\n        this.target = target;\r\n        this.config = config;\r\n        const { offset = new Vector3(0, 0, 0), sensitivity = new Vector2(0.25, 0.25), radius = 8, targetRadius = 10, interpolationFactor = 0.05, pointerLock = true, autoUpdate = true, theta = 0, phi = 0, \r\n        /** Max Phi in deg */\r\n        maxPhi = 85, \r\n        /** Min Phi in deg */\r\n        minPhi = -85 } = config;\r\n        this.offset = offset;\r\n        this.sensitivity = sensitivity;\r\n        this.radius = radius;\r\n        this.targetRadius = targetRadius;\r\n        this.interpolationFactor = interpolationFactor;\r\n        this.theta = theta;\r\n        this.phi = phi;\r\n        this.maxPhi = maxPhi;\r\n        this.minPhi = minPhi;\r\n        // if (pointerLock) {\r\n        //   scene.input.on('pointerdown', () => {\r\n        //     scene.input.mouse.requestPointerLock()\r\n        //   })\r\n        //   scene.input.on('pointermove', (pointer: PointerEvent) => {\r\n        //     if (scene.input.mouse.locked) {\r\n        //       this.update(pointer.movementX, pointer.movementY)\r\n        //     }\r\n        //   })\r\n        // }\r\n        // if (autoUpdate) {\r\n        //   scene.events.on('update', () => {\r\n        //     this.update(0, 0)\r\n        //   })\r\n        // }\r\n    }\r\n    update(deltaX, deltaY) {\r\n        const target = this.target.position.clone().add(this.offset);\r\n        this.theta -= deltaX * (this.sensitivity.x / 2);\r\n        this.theta %= 360;\r\n        this.phi += deltaY * (this.sensitivity.y / 2);\r\n        this.phi = Math.min(this.maxPhi, Math.max(this.minPhi, this.phi));\r\n        this.radius = THREE_Math.lerp(this.radius, this.targetRadius, this.interpolationFactor);\r\n        this.camera.position.x =\r\n            target.x + this.radius * Math.sin((this.theta * Math.PI) / 180) * Math.cos((this.phi * Math.PI) / 180);\r\n        this.camera.position.y = target.y + this.radius * Math.sin((this.phi * Math.PI) / 180);\r\n        this.camera.position.z =\r\n            target.z + this.radius * Math.cos((this.theta * Math.PI) / 180) * Math.cos((this.phi * Math.PI) / 180);\r\n        this.camera.updateMatrix();\r\n        this.camera.lookAt(target);\r\n    }\r\n}\r\nexport { ThirdPersonControls };\r\n//# sourceMappingURL=thirdPersonControls.js.map","/**\r\n * @description  This code has originally been copied from Sketchbook\r\n *\r\n * @author       swift502 <blaha.j502@gmail.com> (http://jblaha.art/)\r\n * @copyright    Copyright (c) 2018 swift502; Project Url: https://github.com/swift502/Sketchbook\r\n * @license      {@link https://github.com/swift502/Sketchbook/blob/master/LICENSE GPL-3.0}\r\n *\r\n * @author       Yannick Deubel (https://github.com/yandeu)\r\n * @copyright    Copyright (c) 2021 Yannick Deubel; Project Url: https://github.com/enable3d/enable3d\r\n * @license      {@link https://github.com/enable3d/enable3d/blob/master/LICENSE GNU GPLv3}\r\n */\r\nimport { Vector2, Vector3 } from 'three';\r\nclass FirstPersonControls {\r\n    constructor(camera, target, config) {\r\n        this.camera = camera;\r\n        this.target = target;\r\n        this.config = config;\r\n        const { offset = new Vector3(0, 0, 0), sensitivity = new Vector2(0.25, 0.25), radius = 8, targetRadius = 10, interpolationFactor = 0.05, pointerLock = true, autoUpdate = true } = config;\r\n        this.offset = offset;\r\n        this.sensitivity = sensitivity;\r\n        this.radius = radius;\r\n        this.targetRadius = targetRadius;\r\n        this.interpolationFactor = interpolationFactor;\r\n        this.theta = 0;\r\n        this.phi = 0;\r\n        // if (pointerLock) {\r\n        //   scene.input.on('pointerdown', () => {\r\n        //     scene.input.mouse.requestPointerLock()\r\n        //   })\r\n        //   scene.input.on('pointermove', (pointer: PointerEvent) => {\r\n        //     if (scene.input.mouse.locked) {\r\n        //       this.update(pointer.movementX, pointer.movementY)\r\n        //     }\r\n        //   })\r\n        // }\r\n        // if (autoUpdate) {\r\n        //   scene.events.on('update', () => {\r\n        //     this.update(0, 0)\r\n        //   })\r\n        // }\r\n    }\r\n    update(deltaX, deltaY) {\r\n        const center = this.target.position.clone().add(this.offset);\r\n        this.camera.position.copy(center);\r\n        this.theta -= deltaX * (this.sensitivity.x / 2);\r\n        this.theta %= 360;\r\n        this.phi += deltaY * (-this.sensitivity.y / 2);\r\n        this.phi = Math.min(85, Math.max(-85, this.phi));\r\n        const lookAt = new Vector3();\r\n        lookAt.x = center.x + this.radius * Math.sin((this.theta * Math.PI) / 180) * Math.cos((this.phi * Math.PI) / 180);\r\n        lookAt.y = center.y + this.radius * Math.sin((this.phi * Math.PI) / 180);\r\n        lookAt.z = center.z + this.radius * Math.cos((this.theta * Math.PI) / 180) * Math.cos((this.phi * Math.PI) / 180);\r\n        this.camera.updateMatrix();\r\n        this.camera.lookAt(lookAt);\r\n    }\r\n}\r\nexport { FirstPersonControls };\r\n//# sourceMappingURL=firstPersonControls.js.map","class PointerLock {\r\n    constructor(_element, autoLock = true) {\r\n        this._element = _element;\r\n        this._isRunning = false;\r\n        if (autoLock)\r\n            this.request();\r\n    }\r\n    isLocked() {\r\n        return !!document.pointerLockElement;\r\n    }\r\n    exit() {\r\n        this._isRunning = false;\r\n        document.exitPointerLock();\r\n        this.removeListeners();\r\n    }\r\n    removeListeners() {\r\n        document.removeEventListener('pointerlockchange', () => this.pointerLockChangeHandler());\r\n        this._element.removeEventListener('pointerdown', () => this.pointerDownHandlerHandler());\r\n    }\r\n    pointerLockChangeHandler() {\r\n        if (!this._isRunning)\r\n            return;\r\n        this._request();\r\n    }\r\n    pointerDownHandlerHandler() {\r\n        if (!this._isRunning)\r\n            return;\r\n        this._element.requestPointerLock();\r\n    }\r\n    request() {\r\n        this._isRunning = true;\r\n        this._request();\r\n    }\r\n    _request() {\r\n        // listen to pointer lock change events\r\n        document.addEventListener('pointerlockchange', () => this.pointerLockChangeHandler(), {\r\n            once: true\r\n        });\r\n        // return if pointer is already locked\r\n        if (document.pointerLockElement)\r\n            return;\r\n        // listen for pointerdown event\r\n        this._element.addEventListener('pointerdown', () => this.pointerDownHandlerHandler(), { once: true });\r\n    }\r\n}\r\nexport { PointerLock };\r\n//# sourceMappingURL=pointerLock.js.map","class PointerDrag {\r\n    constructor(_element, autoStart = true) {\r\n        this._element = _element;\r\n        this._isRunning = false;\r\n        this._position = { x: 0, y: 0 };\r\n        this._delta = { x: 0, y: 0 };\r\n        this._onMoveCallback = () => { };\r\n        this._isPointerDown = false;\r\n        if (autoStart)\r\n            this.start();\r\n    }\r\n    get isTouchDevice() {\r\n        return 'ontouchstart' in window;\r\n    }\r\n    get isPointerDown() {\r\n        return this._isPointerDown;\r\n    }\r\n    start() {\r\n        if (this._isRunning)\r\n            return;\r\n        this._isRunning = true;\r\n        if (this.isTouchDevice) {\r\n            this._element.addEventListener('touchstart', e => this.onTouchStart(e));\r\n            this._element.addEventListener('touchend', e => this.onTouchEnd(e));\r\n            this._element.addEventListener('touchmove', e => this.onTouchMove(e));\r\n        }\r\n        else {\r\n            this._element.addEventListener('mousedown', e => this.onPointerDown(e));\r\n            this._element.addEventListener('mouseup', e => this.onPointerUp(e));\r\n            this._element.addEventListener('mouseleave', e => this.onPointerLeave(e));\r\n            this._element.addEventListener('mouseover', e => this.onPointerOver(e));\r\n            this._element.addEventListener('mousemove', e => this.onPointerMove(e));\r\n        }\r\n    }\r\n    stop() {\r\n        if (this.isTouchDevice) {\r\n            this._element.removeEventListener('touchstart', e => this.onTouchStart(e));\r\n            this._element.removeEventListener('touchend', e => this.onTouchEnd(e));\r\n            this._element.removeEventListener('touchmove', e => this.onTouchMove(e));\r\n        }\r\n        else {\r\n            this._element.removeEventListener('mousedown', e => this.onPointerDown(e));\r\n            this._element.removeEventListener('mouseleave', e => this.onPointerLeave(e));\r\n            this._element.removeEventListener('mouseup', e => this.onPointerUp(e));\r\n            this._element.removeEventListener('mouseover', e => this.onPointerOver(e));\r\n            this._element.removeEventListener('mousemove', e => this.onPointerMove(e));\r\n        }\r\n        this._isRunning = false;\r\n    }\r\n    removeListeners() {\r\n        this.stop();\r\n    }\r\n    onMove(onMoveCallback) {\r\n        this._onMoveCallback = onMoveCallback;\r\n    }\r\n    onPointerDown(_e) {\r\n        this._isPointerDown = true;\r\n    }\r\n    onPointerUp(_e) {\r\n        this._isPointerDown = false;\r\n    }\r\n    onPointerLeave(_e) {\r\n        this._isPointerDown = false;\r\n    }\r\n    onPointerMove(e) {\r\n        const clientX = e.movementX;\r\n        const clientY = e.movementY;\r\n        this._delta = { x: clientX, y: clientY };\r\n        this._onMoveCallback(this._delta);\r\n    }\r\n    onPointerOver(_e) { }\r\n    onTouchStart(e) {\r\n        const clientX = e.touches[0].clientX;\r\n        const clientY = e.touches[0].clientY;\r\n        this._position = { x: clientX, y: clientY };\r\n    }\r\n    onTouchEnd(_e) {\r\n        this._position = { x: 0, y: 0 };\r\n        this._delta = { x: 0, y: 0 };\r\n        this._onMoveCallback(this._delta);\r\n    }\r\n    onTouchMove(e) {\r\n        const clientX = e.touches[0].clientX;\r\n        const clientY = e.touches[0].clientY;\r\n        this._delta = { x: clientX - this._position.x, y: clientY - this._position.y };\r\n        this._onMoveCallback(this._delta);\r\n        this._position = { x: clientX, y: clientY };\r\n    }\r\n}\r\nexport { PointerDrag };\r\n//# sourceMappingURL=pointerDrag.js.map","/**\n * Full-screen textured quad shader\n */\n\nvar CopyShader = {\n\n\tuniforms: {\n\n\t\t'tDiffuse': { value: null },\n\t\t'opacity': { value: 1.0 }\n\n\t},\n\n\tvertexShader: /* glsl */`\n\n\t\tvarying vec2 vUv;\n\n\t\tvoid main() {\n\n\t\t\tvUv = uv;\n\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\n\t\t}`,\n\n\tfragmentShader: /* glsl */`\n\n\t\tuniform float opacity;\n\n\t\tuniform sampler2D tDiffuse;\n\n\t\tvarying vec2 vUv;\n\n\t\tvoid main() {\n\n\t\t\tvec4 texel = texture2D( tDiffuse, vUv );\n\t\t\tgl_FragColor = opacity * texel;\n\n\t\t}`\n\n};\n\nexport { CopyShader };\n","import {\n\tBufferGeometry,\n\tFloat32BufferAttribute,\n\tOrthographicCamera,\n\tMesh\n} from 'three';\n\nclass Pass {\n\n\tconstructor() {\n\n\t\t// if set to true, the pass is processed by the composer\n\t\tthis.enabled = true;\n\n\t\t// if set to true, the pass indicates to swap read and write buffer after rendering\n\t\tthis.needsSwap = true;\n\n\t\t// if set to true, the pass clears its buffer before rendering\n\t\tthis.clear = false;\n\n\t\t// if set to true, the result of the pass is rendered to screen. This is set automatically by EffectComposer.\n\t\tthis.renderToScreen = false;\n\n\t}\n\n\tsetSize( /* width, height */ ) {}\n\n\trender( /* renderer, writeBuffer, readBuffer, deltaTime, maskActive */ ) {\n\n\t\tconsole.error( 'THREE.Pass: .render() must be implemented in derived pass.' );\n\n\t}\n\n}\n\n// Helper for passes that need to fill the viewport with a single quad.\n\nconst _camera = new OrthographicCamera( - 1, 1, 1, - 1, 0, 1 );\n\n// https://github.com/mrdoob/three.js/pull/21358\n\nconst _geometry = new BufferGeometry();\n_geometry.setAttribute( 'position', new Float32BufferAttribute( [ - 1, 3, 0, - 1, - 1, 0, 3, - 1, 0 ], 3 ) );\n_geometry.setAttribute( 'uv', new Float32BufferAttribute( [ 0, 2, 0, 0, 2, 0 ], 2 ) );\n\nclass FullScreenQuad {\n\n\tconstructor( material ) {\n\n\t\tthis._mesh = new Mesh( _geometry, material );\n\n\t}\n\n\tdispose() {\n\n\t\tthis._mesh.geometry.dispose();\n\n\t}\n\n\trender( renderer ) {\n\n\t\trenderer.render( this._mesh, _camera );\n\n\t}\n\n\tget material() {\n\n\t\treturn this._mesh.material;\n\n\t}\n\n\tset material( value ) {\n\n\t\tthis._mesh.material = value;\n\n\t}\n\n}\n\nexport { Pass, FullScreenQuad };\n","import {\n\tShaderMaterial,\n\tUniformsUtils\n} from 'three';\nimport { Pass, FullScreenQuad } from '../postprocessing/Pass.js';\n\nclass ShaderPass extends Pass {\n\n\tconstructor( shader, textureID ) {\n\n\t\tsuper();\n\n\t\tthis.textureID = ( textureID !== undefined ) ? textureID : 'tDiffuse';\n\n\t\tif ( shader instanceof ShaderMaterial ) {\n\n\t\t\tthis.uniforms = shader.uniforms;\n\n\t\t\tthis.material = shader;\n\n\t\t} else if ( shader ) {\n\n\t\t\tthis.uniforms = UniformsUtils.clone( shader.uniforms );\n\n\t\t\tthis.material = new ShaderMaterial( {\n\n\t\t\t\tdefines: Object.assign( {}, shader.defines ),\n\t\t\t\tuniforms: this.uniforms,\n\t\t\t\tvertexShader: shader.vertexShader,\n\t\t\t\tfragmentShader: shader.fragmentShader\n\n\t\t\t} );\n\n\t\t}\n\n\t\tthis.fsQuad = new FullScreenQuad( this.material );\n\n\t}\n\n\trender( renderer, writeBuffer, readBuffer /*, deltaTime, maskActive */ ) {\n\n\t\tif ( this.uniforms[ this.textureID ] ) {\n\n\t\t\tthis.uniforms[ this.textureID ].value = readBuffer.texture;\n\n\t\t}\n\n\t\tthis.fsQuad.material = this.material;\n\n\t\tif ( this.renderToScreen ) {\n\n\t\t\trenderer.setRenderTarget( null );\n\t\t\tthis.fsQuad.render( renderer );\n\n\t\t} else {\n\n\t\t\trenderer.setRenderTarget( writeBuffer );\n\t\t\t// TODO: Avoid using autoClear properties, see https://github.com/mrdoob/three.js/pull/15571#issuecomment-465669600\n\t\t\tif ( this.clear ) renderer.clear( renderer.autoClearColor, renderer.autoClearDepth, renderer.autoClearStencil );\n\t\t\tthis.fsQuad.render( renderer );\n\n\t\t}\n\n\t}\n\n}\n\nexport { ShaderPass };\n","import { Pass } from '../postprocessing/Pass.js';\n\nclass MaskPass extends Pass {\n\n\tconstructor( scene, camera ) {\n\n\t\tsuper();\n\n\t\tthis.scene = scene;\n\t\tthis.camera = camera;\n\n\t\tthis.clear = true;\n\t\tthis.needsSwap = false;\n\n\t\tthis.inverse = false;\n\n\t}\n\n\trender( renderer, writeBuffer, readBuffer /*, deltaTime, maskActive */ ) {\n\n\t\tconst context = renderer.getContext();\n\t\tconst state = renderer.state;\n\n\t\t// don't update color or depth\n\n\t\tstate.buffers.color.setMask( false );\n\t\tstate.buffers.depth.setMask( false );\n\n\t\t// lock buffers\n\n\t\tstate.buffers.color.setLocked( true );\n\t\tstate.buffers.depth.setLocked( true );\n\n\t\t// set up stencil\n\n\t\tlet writeValue, clearValue;\n\n\t\tif ( this.inverse ) {\n\n\t\t\twriteValue = 0;\n\t\t\tclearValue = 1;\n\n\t\t} else {\n\n\t\t\twriteValue = 1;\n\t\t\tclearValue = 0;\n\n\t\t}\n\n\t\tstate.buffers.stencil.setTest( true );\n\t\tstate.buffers.stencil.setOp( context.REPLACE, context.REPLACE, context.REPLACE );\n\t\tstate.buffers.stencil.setFunc( context.ALWAYS, writeValue, 0xffffffff );\n\t\tstate.buffers.stencil.setClear( clearValue );\n\t\tstate.buffers.stencil.setLocked( true );\n\n\t\t// draw into the stencil buffer\n\n\t\trenderer.setRenderTarget( readBuffer );\n\t\tif ( this.clear ) renderer.clear();\n\t\trenderer.render( this.scene, this.camera );\n\n\t\trenderer.setRenderTarget( writeBuffer );\n\t\tif ( this.clear ) renderer.clear();\n\t\trenderer.render( this.scene, this.camera );\n\n\t\t// unlock color and depth buffer for subsequent rendering\n\n\t\tstate.buffers.color.setLocked( false );\n\t\tstate.buffers.depth.setLocked( false );\n\n\t\t// only render where stencil is set to 1\n\n\t\tstate.buffers.stencil.setLocked( false );\n\t\tstate.buffers.stencil.setFunc( context.EQUAL, 1, 0xffffffff ); // draw if == 1\n\t\tstate.buffers.stencil.setOp( context.KEEP, context.KEEP, context.KEEP );\n\t\tstate.buffers.stencil.setLocked( true );\n\n\t}\n\n}\n\nclass ClearMaskPass extends Pass {\n\n\tconstructor() {\n\n\t\tsuper();\n\n\t\tthis.needsSwap = false;\n\n\t}\n\n\trender( renderer /*, writeBuffer, readBuffer, deltaTime, maskActive */ ) {\n\n\t\trenderer.state.buffers.stencil.setLocked( false );\n\t\trenderer.state.buffers.stencil.setTest( false );\n\n\t}\n\n}\n\nexport { MaskPass, ClearMaskPass };\n","import {\n\tBufferGeometry,\n\tClock,\n\tFloat32BufferAttribute,\n\tLinearFilter,\n\tMesh,\n\tOrthographicCamera,\n\tRGBAFormat,\n\tVector2,\n\tWebGLRenderTarget\n} from 'three';\nimport { CopyShader } from '../shaders/CopyShader.js';\nimport { ShaderPass } from '../postprocessing/ShaderPass.js';\nimport { MaskPass } from '../postprocessing/MaskPass.js';\nimport { ClearMaskPass } from '../postprocessing/MaskPass.js';\n\nclass EffectComposer {\n\n\tconstructor( renderer, renderTarget ) {\n\n\t\tthis.renderer = renderer;\n\n\t\tif ( renderTarget === undefined ) {\n\n\t\t\tconst parameters = {\n\t\t\t\tminFilter: LinearFilter,\n\t\t\t\tmagFilter: LinearFilter,\n\t\t\t\tformat: RGBAFormat\n\t\t\t};\n\n\t\t\tconst size = renderer.getSize( new Vector2() );\n\t\t\tthis._pixelRatio = renderer.getPixelRatio();\n\t\t\tthis._width = size.width;\n\t\t\tthis._height = size.height;\n\n\t\t\trenderTarget = new WebGLRenderTarget( this._width * this._pixelRatio, this._height * this._pixelRatio, parameters );\n\t\t\trenderTarget.texture.name = 'EffectComposer.rt1';\n\n\t\t} else {\n\n\t\t\tthis._pixelRatio = 1;\n\t\t\tthis._width = renderTarget.width;\n\t\t\tthis._height = renderTarget.height;\n\n\t\t}\n\n\t\tthis.renderTarget1 = renderTarget;\n\t\tthis.renderTarget2 = renderTarget.clone();\n\t\tthis.renderTarget2.texture.name = 'EffectComposer.rt2';\n\n\t\tthis.writeBuffer = this.renderTarget1;\n\t\tthis.readBuffer = this.renderTarget2;\n\n\t\tthis.renderToScreen = true;\n\n\t\tthis.passes = [];\n\n\t\t// dependencies\n\n\t\tif ( CopyShader === undefined ) {\n\n\t\t\tconsole.error( 'THREE.EffectComposer relies on CopyShader' );\n\n\t\t}\n\n\t\tif ( ShaderPass === undefined ) {\n\n\t\t\tconsole.error( 'THREE.EffectComposer relies on ShaderPass' );\n\n\t\t}\n\n\t\tthis.copyPass = new ShaderPass( CopyShader );\n\n\t\tthis.clock = new Clock();\n\n\t}\n\n\tswapBuffers() {\n\n\t\tconst tmp = this.readBuffer;\n\t\tthis.readBuffer = this.writeBuffer;\n\t\tthis.writeBuffer = tmp;\n\n\t}\n\n\taddPass( pass ) {\n\n\t\tthis.passes.push( pass );\n\t\tpass.setSize( this._width * this._pixelRatio, this._height * this._pixelRatio );\n\n\t}\n\n\tinsertPass( pass, index ) {\n\n\t\tthis.passes.splice( index, 0, pass );\n\t\tpass.setSize( this._width * this._pixelRatio, this._height * this._pixelRatio );\n\n\t}\n\n\tremovePass( pass ) {\n\n\t\tconst index = this.passes.indexOf( pass );\n\n\t\tif ( index !== - 1 ) {\n\n\t\t\tthis.passes.splice( index, 1 );\n\n\t\t}\n\n\t}\n\n\tisLastEnabledPass( passIndex ) {\n\n\t\tfor ( let i = passIndex + 1; i < this.passes.length; i ++ ) {\n\n\t\t\tif ( this.passes[ i ].enabled ) {\n\n\t\t\t\treturn false;\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn true;\n\n\t}\n\n\trender( deltaTime ) {\n\n\t\t// deltaTime value is in seconds\n\n\t\tif ( deltaTime === undefined ) {\n\n\t\t\tdeltaTime = this.clock.getDelta();\n\n\t\t}\n\n\t\tconst currentRenderTarget = this.renderer.getRenderTarget();\n\n\t\tlet maskActive = false;\n\n\t\tfor ( let i = 0, il = this.passes.length; i < il; i ++ ) {\n\n\t\t\tconst pass = this.passes[ i ];\n\n\t\t\tif ( pass.enabled === false ) continue;\n\n\t\t\tpass.renderToScreen = ( this.renderToScreen && this.isLastEnabledPass( i ) );\n\t\t\tpass.render( this.renderer, this.writeBuffer, this.readBuffer, deltaTime, maskActive );\n\n\t\t\tif ( pass.needsSwap ) {\n\n\t\t\t\tif ( maskActive ) {\n\n\t\t\t\t\tconst context = this.renderer.getContext();\n\t\t\t\t\tconst stencil = this.renderer.state.buffers.stencil;\n\n\t\t\t\t\t//context.stencilFunc( context.NOTEQUAL, 1, 0xffffffff );\n\t\t\t\t\tstencil.setFunc( context.NOTEQUAL, 1, 0xffffffff );\n\n\t\t\t\t\tthis.copyPass.render( this.renderer, this.writeBuffer, this.readBuffer, deltaTime );\n\n\t\t\t\t\t//context.stencilFunc( context.EQUAL, 1, 0xffffffff );\n\t\t\t\t\tstencil.setFunc( context.EQUAL, 1, 0xffffffff );\n\n\t\t\t\t}\n\n\t\t\t\tthis.swapBuffers();\n\n\t\t\t}\n\n\t\t\tif ( MaskPass !== undefined ) {\n\n\t\t\t\tif ( pass instanceof MaskPass ) {\n\n\t\t\t\t\tmaskActive = true;\n\n\t\t\t\t} else if ( pass instanceof ClearMaskPass ) {\n\n\t\t\t\t\tmaskActive = false;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\tthis.renderer.setRenderTarget( currentRenderTarget );\n\n\t}\n\n\treset( renderTarget ) {\n\n\t\tif ( renderTarget === undefined ) {\n\n\t\t\tconst size = this.renderer.getSize( new Vector2() );\n\t\t\tthis._pixelRatio = this.renderer.getPixelRatio();\n\t\t\tthis._width = size.width;\n\t\t\tthis._height = size.height;\n\n\t\t\trenderTarget = this.renderTarget1.clone();\n\t\t\trenderTarget.setSize( this._width * this._pixelRatio, this._height * this._pixelRatio );\n\n\t\t}\n\n\t\tthis.renderTarget1.dispose();\n\t\tthis.renderTarget2.dispose();\n\t\tthis.renderTarget1 = renderTarget;\n\t\tthis.renderTarget2 = renderTarget.clone();\n\n\t\tthis.writeBuffer = this.renderTarget1;\n\t\tthis.readBuffer = this.renderTarget2;\n\n\t}\n\n\tsetSize( width, height ) {\n\n\t\tthis._width = width;\n\t\tthis._height = height;\n\n\t\tconst effectiveWidth = this._width * this._pixelRatio;\n\t\tconst effectiveHeight = this._height * this._pixelRatio;\n\n\t\tthis.renderTarget1.setSize( effectiveWidth, effectiveHeight );\n\t\tthis.renderTarget2.setSize( effectiveWidth, effectiveHeight );\n\n\t\tfor ( let i = 0; i < this.passes.length; i ++ ) {\n\n\t\t\tthis.passes[ i ].setSize( effectiveWidth, effectiveHeight );\n\n\t\t}\n\n\t}\n\n\tsetPixelRatio( pixelRatio ) {\n\n\t\tthis._pixelRatio = pixelRatio;\n\n\t\tthis.setSize( this._width, this._height );\n\n\t}\n\n}\n\n\nclass Pass {\n\n\tconstructor() {\n\n\t\t// if set to true, the pass is processed by the composer\n\t\tthis.enabled = true;\n\n\t\t// if set to true, the pass indicates to swap read and write buffer after rendering\n\t\tthis.needsSwap = true;\n\n\t\t// if set to true, the pass clears its buffer before rendering\n\t\tthis.clear = false;\n\n\t\t// if set to true, the result of the pass is rendered to screen. This is set automatically by EffectComposer.\n\t\tthis.renderToScreen = false;\n\n\t}\n\n\tsetSize( /* width, height */ ) {}\n\n\trender( /* renderer, writeBuffer, readBuffer, deltaTime, maskActive */ ) {\n\n\t\tconsole.error( 'THREE.Pass: .render() must be implemented in derived pass.' );\n\n\t}\n\n}\n\n// Helper for passes that need to fill the viewport with a single quad.\n\nconst _camera = new OrthographicCamera( - 1, 1, 1, - 1, 0, 1 );\n\n// https://github.com/mrdoob/three.js/pull/21358\n\nconst _geometry = new BufferGeometry();\n_geometry.setAttribute( 'position', new Float32BufferAttribute( [ - 1, 3, 0, - 1, - 1, 0, 3, - 1, 0 ], 3 ) );\n_geometry.setAttribute( 'uv', new Float32BufferAttribute( [ 0, 2, 0, 0, 2, 0 ], 2 ) );\n\nclass FullScreenQuad {\n\n\tconstructor( material ) {\n\n\t\tthis._mesh = new Mesh( _geometry, material );\n\n\t}\n\n\tdispose() {\n\n\t\tthis._mesh.geometry.dispose();\n\n\t}\n\n\trender( renderer ) {\n\n\t\trenderer.render( this._mesh, _camera );\n\n\t}\n\n\tget material() {\n\n\t\treturn this._mesh.material;\n\n\t}\n\n\tset material( value ) {\n\n\t\tthis._mesh.material = value;\n\n\t}\n\n}\n\nexport { EffectComposer, Pass, FullScreenQuad };\n","import {\n\tColor\n} from 'three';\nimport { Pass } from '../postprocessing/Pass.js';\n\nclass RenderPass extends Pass {\n\n\tconstructor( scene, camera, overrideMaterial, clearColor, clearAlpha ) {\n\n\t\tsuper();\n\n\t\tthis.scene = scene;\n\t\tthis.camera = camera;\n\n\t\tthis.overrideMaterial = overrideMaterial;\n\n\t\tthis.clearColor = clearColor;\n\t\tthis.clearAlpha = ( clearAlpha !== undefined ) ? clearAlpha : 0;\n\n\t\tthis.clear = true;\n\t\tthis.clearDepth = false;\n\t\tthis.needsSwap = false;\n\t\tthis._oldClearColor = new Color();\n\n\t}\n\n\trender( renderer, writeBuffer, readBuffer /*, deltaTime, maskActive */ ) {\n\n\t\tconst oldAutoClear = renderer.autoClear;\n\t\trenderer.autoClear = false;\n\n\t\tlet oldClearAlpha, oldOverrideMaterial;\n\n\t\tif ( this.overrideMaterial !== undefined ) {\n\n\t\t\toldOverrideMaterial = this.scene.overrideMaterial;\n\n\t\t\tthis.scene.overrideMaterial = this.overrideMaterial;\n\n\t\t}\n\n\t\tif ( this.clearColor ) {\n\n\t\t\trenderer.getClearColor( this._oldClearColor );\n\t\t\toldClearAlpha = renderer.getClearAlpha();\n\n\t\t\trenderer.setClearColor( this.clearColor, this.clearAlpha );\n\n\t\t}\n\n\t\tif ( this.clearDepth ) {\n\n\t\t\trenderer.clearDepth();\n\n\t\t}\n\n\t\trenderer.setRenderTarget( this.renderToScreen ? null : readBuffer );\n\n\t\t// TODO: Avoid using autoClear properties, see https://github.com/mrdoob/three.js/pull/15571#issuecomment-465669600\n\t\tif ( this.clear ) renderer.clear( renderer.autoClearColor, renderer.autoClearDepth, renderer.autoClearStencil );\n\t\trenderer.render( this.scene, this.camera );\n\n\t\tif ( this.clearColor ) {\n\n\t\t\trenderer.setClearColor( this._oldClearColor, oldClearAlpha );\n\n\t\t}\n\n\t\tif ( this.overrideMaterial !== undefined ) {\n\n\t\t\tthis.scene.overrideMaterial = oldOverrideMaterial;\n\n\t\t}\n\n\t\trenderer.autoClear = oldAutoClear;\n\n\t}\n\n}\n\nexport { RenderPass };\n","/**\n * RGB Shift Shader\n * Shifts red and blue channels from center in opposite directions\n * Ported from http://kriss.cx/tom/2009/05/rgb-shift/\n * by Tom Butterworth / http://kriss.cx/tom/\n *\n * amount: shift distance (1 is width of input)\n * angle: shift angle in radians\n */\n\nconst DigitalGlitch = {\n\n\tuniforms: {\n\n\t\t'tDiffuse': { value: null }, //diffuse texture\n\t\t'tDisp': { value: null }, //displacement texture for digital glitch squares\n\t\t'byp': { value: 0 }, //apply the glitch ?\n\t\t'amount': { value: 0.08 },\n\t\t'angle': { value: 0.02 },\n\t\t'seed': { value: 0.02 },\n\t\t'seed_x': { value: 0.02 }, //-1,1\n\t\t'seed_y': { value: 0.02 }, //-1,1\n\t\t'distortion_x': { value: 0.5 },\n\t\t'distortion_y': { value: 0.6 },\n\t\t'col_s': { value: 0.05 }\n\t},\n\n\tvertexShader: /* glsl */`\n\n\t\tvarying vec2 vUv;\n\t\tvoid main() {\n\t\t\tvUv = uv;\n\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\t\t}`,\n\n\tfragmentShader: /* glsl */`\n\n\t\tuniform int byp; //should we apply the glitch ?\n\n\t\tuniform sampler2D tDiffuse;\n\t\tuniform sampler2D tDisp;\n\n\t\tuniform float amount;\n\t\tuniform float angle;\n\t\tuniform float seed;\n\t\tuniform float seed_x;\n\t\tuniform float seed_y;\n\t\tuniform float distortion_x;\n\t\tuniform float distortion_y;\n\t\tuniform float col_s;\n\n\t\tvarying vec2 vUv;\n\n\n\t\tfloat rand(vec2 co){\n\t\t\treturn fract(sin(dot(co.xy ,vec2(12.9898,78.233))) * 43758.5453);\n\t\t}\n\n\t\tvoid main() {\n\t\t\tif(byp<1) {\n\t\t\t\tvec2 p = vUv;\n\t\t\t\tfloat xs = floor(gl_FragCoord.x / 0.5);\n\t\t\t\tfloat ys = floor(gl_FragCoord.y / 0.5);\n\t\t\t\t//based on staffantans glitch shader for unity https://github.com/staffantan/unityglitch\n\t\t\t\tvec4 normal = texture2D (tDisp, p*seed*seed);\n\t\t\t\tif(p.y<distortion_x+col_s && p.y>distortion_x-col_s*seed) {\n\t\t\t\t\tif(seed_x>0.){\n\t\t\t\t\t\tp.y = 1. - (p.y + distortion_y);\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\tp.y = distortion_y;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif(p.x<distortion_y+col_s && p.x>distortion_y-col_s*seed) {\n\t\t\t\t\tif(seed_y>0.){\n\t\t\t\t\t\tp.x=distortion_x;\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\tp.x = 1. - (p.x + distortion_x);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tp.x+=normal.x*seed_x*(seed/5.);\n\t\t\t\tp.y+=normal.y*seed_y*(seed/5.);\n\t\t\t\t//base from RGB shift shader\n\t\t\t\tvec2 offset = amount * vec2( cos(angle), sin(angle));\n\t\t\t\tvec4 cr = texture2D(tDiffuse, p + offset);\n\t\t\t\tvec4 cga = texture2D(tDiffuse, p);\n\t\t\t\tvec4 cb = texture2D(tDiffuse, p - offset);\n\t\t\t\tgl_FragColor = vec4(cr.r, cga.g, cb.b, cga.a);\n\t\t\t\t//add noise\n\t\t\t\tvec4 snow = 200.*amount*vec4(rand(vec2(xs * seed,ys * seed*50.))*0.2);\n\t\t\t\tgl_FragColor = gl_FragColor+ snow;\n\t\t\t}\n\t\t\telse {\n\t\t\t\tgl_FragColor=texture2D (tDiffuse, vUv);\n\t\t\t}\n\t\t}`\n\n};\n\nexport { DigitalGlitch };\n","import {\n\tDataTexture,\n\tFloatType,\n\tMathUtils,\n\tRGBFormat,\n\tShaderMaterial,\n\tUniformsUtils\n} from 'three';\nimport { Pass, FullScreenQuad } from '../postprocessing/Pass.js';\nimport { DigitalGlitch } from '../shaders/DigitalGlitch.js';\n\nclass GlitchPass extends Pass {\n\n\tconstructor( dt_size = 64 ) {\n\n\t\tsuper();\n\n\t\tif ( DigitalGlitch === undefined ) console.error( 'THREE.GlitchPass relies on DigitalGlitch' );\n\n\t\tconst shader = DigitalGlitch;\n\n\t\tthis.uniforms = UniformsUtils.clone( shader.uniforms );\n\n\t\tthis.uniforms[ 'tDisp' ].value = this.generateHeightmap( dt_size );\n\n\t\tthis.material = new ShaderMaterial( {\n\t\t\tuniforms: this.uniforms,\n\t\t\tvertexShader: shader.vertexShader,\n\t\t\tfragmentShader: shader.fragmentShader\n\t\t} );\n\n\t\tthis.fsQuad = new FullScreenQuad( this.material );\n\n\t\tthis.goWild = false;\n\t\tthis.curF = 0;\n\t\tthis.generateTrigger();\n\n\t}\n\n\trender( renderer, writeBuffer, readBuffer /*, deltaTime, maskActive */ ) {\n\n\t\tthis.uniforms[ 'tDiffuse' ].value = readBuffer.texture;\n\t\tthis.uniforms[ 'seed' ].value = Math.random();//default seeding\n\t\tthis.uniforms[ 'byp' ].value = 0;\n\n\t\tif ( this.curF % this.randX == 0 || this.goWild == true ) {\n\n\t\t\tthis.uniforms[ 'amount' ].value = Math.random() / 30;\n\t\t\tthis.uniforms[ 'angle' ].value = MathUtils.randFloat( - Math.PI, Math.PI );\n\t\t\tthis.uniforms[ 'seed_x' ].value = MathUtils.randFloat( - 1, 1 );\n\t\t\tthis.uniforms[ 'seed_y' ].value = MathUtils.randFloat( - 1, 1 );\n\t\t\tthis.uniforms[ 'distortion_x' ].value = MathUtils.randFloat( 0, 1 );\n\t\t\tthis.uniforms[ 'distortion_y' ].value = MathUtils.randFloat( 0, 1 );\n\t\t\tthis.curF = 0;\n\t\t\tthis.generateTrigger();\n\n\t\t} else if ( this.curF % this.randX < this.randX / 5 ) {\n\n\t\t\tthis.uniforms[ 'amount' ].value = Math.random() / 90;\n\t\t\tthis.uniforms[ 'angle' ].value = MathUtils.randFloat( - Math.PI, Math.PI );\n\t\t\tthis.uniforms[ 'distortion_x' ].value = MathUtils.randFloat( 0, 1 );\n\t\t\tthis.uniforms[ 'distortion_y' ].value = MathUtils.randFloat( 0, 1 );\n\t\t\tthis.uniforms[ 'seed_x' ].value = MathUtils.randFloat( - 0.3, 0.3 );\n\t\t\tthis.uniforms[ 'seed_y' ].value = MathUtils.randFloat( - 0.3, 0.3 );\n\n\t\t} else if ( this.goWild == false ) {\n\n\t\t\tthis.uniforms[ 'byp' ].value = 1;\n\n\t\t}\n\n\t\tthis.curF ++;\n\n\t\tif ( this.renderToScreen ) {\n\n\t\t\trenderer.setRenderTarget( null );\n\t\t\tthis.fsQuad.render( renderer );\n\n\t\t} else {\n\n\t\t\trenderer.setRenderTarget( writeBuffer );\n\t\t\tif ( this.clear ) renderer.clear();\n\t\t\tthis.fsQuad.render( renderer );\n\n\t\t}\n\n\t}\n\n\tgenerateTrigger() {\n\n\t\tthis.randX = MathUtils.randInt( 120, 240 );\n\n\t}\n\n\tgenerateHeightmap( dt_size ) {\n\n\t\tconst data_arr = new Float32Array( dt_size * dt_size * 3 );\n\t\tconst length = dt_size * dt_size;\n\n\t\tfor ( let i = 0; i < length; i ++ ) {\n\n\t\t\tconst val = MathUtils.randFloat( 0, 1 );\n\t\t\tdata_arr[ i * 3 + 0 ] = val;\n\t\t\tdata_arr[ i * 3 + 1 ] = val;\n\t\t\tdata_arr[ i * 3 + 2 ] = val;\n\n\t\t}\n\n\t\treturn new DataTexture( data_arr, dt_size, dt_size, RGBFormat, FloatType );\n\n\t}\n\n}\n\nexport { GlitchPass };\n","import {\n\tVector2\n} from 'three';\n\n/**\n * Dot screen shader\n * based on glfx.js sepia shader\n * https://github.com/evanw/glfx.js\n */\n\nconst DotScreenShader = {\n\n\tuniforms: {\n\n\t\t'tDiffuse': { value: null },\n\t\t'tSize': { value: new Vector2( 256, 256 ) },\n\t\t'center': { value: new Vector2( 0.5, 0.5 ) },\n\t\t'angle': { value: 1.57 },\n\t\t'scale': { value: 1.0 }\n\n\t},\n\n\tvertexShader: /* glsl */`\n\n\t\tvarying vec2 vUv;\n\n\t\tvoid main() {\n\n\t\t\tvUv = uv;\n\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\n\t\t}`,\n\n\tfragmentShader: /* glsl */`\n\n\t\tuniform vec2 center;\n\t\tuniform float angle;\n\t\tuniform float scale;\n\t\tuniform vec2 tSize;\n\n\t\tuniform sampler2D tDiffuse;\n\n\t\tvarying vec2 vUv;\n\n\t\tfloat pattern() {\n\n\t\t\tfloat s = sin( angle ), c = cos( angle );\n\n\t\t\tvec2 tex = vUv * tSize - center;\n\t\t\tvec2 point = vec2( c * tex.x - s * tex.y, s * tex.x + c * tex.y ) * scale;\n\n\t\t\treturn ( sin( point.x ) * sin( point.y ) ) * 4.0;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvec4 color = texture2D( tDiffuse, vUv );\n\n\t\t\tfloat average = ( color.r + color.g + color.b ) / 3.0;\n\n\t\t\tgl_FragColor = vec4( vec3( average * 10.0 - 5.0 + pattern() ), color.a );\n\n\t\t}`\n\n};\n\nexport { DotScreenShader };\n"],"names":["root","factory","exports","module","require","define","amd","self","__WEBPACK_EXTERNAL_MODULE__428__","__WEBPACK_EXTERNAL_MODULE__626__","__spreadArray","this","to","from","i","il","length","j","Object","defineProperty","value","Events","version_1","EE","fn","context","once","addListener","emitter","event","TypeError","listener","_events","has","get","set","push","_eventsCount","clearEvent","Map","delete","VERSION","enumerable","configurable","prototype","eventNames","Array","keys","listeners","handlers","l","ee","listenerCount","emit","_a","_b","args","_i","arguments","removeListener","undefined","call","apply","length_1","on","events","removeAllListeners","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","__webpack_modules__","d","definition","key","o","obj","prop","hasOwnProperty","r","Symbol","toStringTag","_m1","Matrix4","_obj","Object3D","_offset","Vector3","Geometry","EventDispatcher","constructor","super","uuid","MathUtils","name","type","vertices","colors","faces","faceVertexUvs","morphTargets","morphNormals","skinWeights","skinIndices","lineDistances","boundingBox","boundingSphere","elementsNeedUpdate","verticesNeedUpdate","uvsNeedUpdate","normalsNeedUpdate","colorsNeedUpdate","lineDistancesNeedUpdate","groupsNeedUpdate","applyMatrix4","matrix","normalMatrix","Matrix3","getNormalMatrix","face","normal","applyMatrix3","normalize","jl","vertexNormals","computeBoundingBox","computeBoundingSphere","rotateX","angle","makeRotationX","rotateY","makeRotationY","rotateZ","makeRotationZ","translate","x","y","z","makeTranslation","scale","makeScale","lookAt","vector","updateMatrix","fromBufferGeometry","geometry","scope","index","attributes","position","console","error","color","uv","uv2","count","fromBufferAttribute","Color","addFace","a","b","c","materialIndex","vertexColors","clone","Face3","Vector2","groups","group","start","getX","computeFaceNormals","center","getCenter","negate","radius","s","cb","ab","f","fl","vA","vB","vC","subVectors","cross","copy","computeVertexNormals","areaWeighted","v","vl","add","computeFlatVertexNormals","computeMorphNormals","__originalFaceNormal","__originalVertexNormals","tmpGeo","faceNormals","dstNormalsFace","dstNormalsVertex","faceNormal","Box3","setFromPoints","Sphere","merge","materialIndexOffset","isGeometry","vertexOffset","vertices1","vertices2","faces1","faces2","colors1","colors2","vertexCopy","faceVertexNormals","faceVertexColors","faceCopy","faceVertexUvs2","uvs2","uvsCopy","k","kl","mergeMesh","mesh","isMesh","matrixAutoUpdate","mergeVertices","precisionPoints","verticesMap","unique","changes","precision","Math","pow","round","faceIndicesToRemove","indices","n","idx","splice","diff","points","point","sortFacesByMaterialIndex","_id","sort","uvs1","newUvs1","newUvs2","id","toJSON","data","metadata","version","generator","parameters","vertex","normals","normalsHash","colorsHash","uvs","uvsHash","hasMaterial","hasFaceUv","hasFaceVertexUv","hasFaceNormal","hasFaceVertexNormal","hasFaceColor","g","hasFaceVertexColor","faceType","setBit","getUvIndex","getNormalIndex","getColorIndex","enabled","hash","toString","getHex","source","morphTarget","morphNormal","srcVertexNormal","destVertexNormal","toBufferGeometry","DirectGeometry","fromGeometry","buffergeometry","BufferGeometry","positions","Float32Array","setAttribute","BufferAttribute","copyVector3sArray","copyColorsArray","copyVector2sArray","array","attribute","Float32BufferAttribute","morphAttributes","copyVector4sArray","computeTangents","computeLineDistances","applyMatrix","warn","dispose","dispatchEvent","object","isPoints","isLine","copyArray","computeGroups","hasFaceVertexUv2","morphTargetsLength","morphTargetsPosition","morphNormalsLength","morphTargetsNormal","hasSkinIndices","hasSkinWeights","vertexUvs","isVector3","isArray","isColor","SVGLoader","Loader","manager","defaultDPI","defaultUnit","load","url","onLoad","onProgress","onError","loader","FileLoader","setPath","path","setRequestHeader","requestHeader","setWithCredentials","withCredentials","text","parse","e","itemError","parseArcCommand","rx","ry","x_axis_rotation","large_arc_flag","sweep_flag","end","lineTo","PI","abs","dx2","dy2","x1p","cos","sin","y1p","rxs","rys","x1ps","y1ps","cr","sqrt","dq","pq","q","max","cxp","cyp","cx","cy","theta","svgAngle","delta","currentPath","absellipse","ux","uy","vx","vy","dot","len","ang","acos","min","parseStyle","node","style","assign","stylesheetStyles","hasAttribute","classSelectors","getAttribute","split","filter","Boolean","map","trim","stylesheets","addStyle","svgName","jsName","adjustFunction","startsWith","clamp","parseFloatWithUnits","positive","getReflection","parseFloats","input","flags","stride","RE","SEPARATOR","WHITESPACE","DIGIT","SIGN","POINT","COMMA","EXP","FLAGS","state","seenComma","number","exponent","result","throwSyntaxError","current","partial","SyntaxError","newNumber","Number","includes","test","units","unitConversion","string","theUnit","String","u","endsWith","substring","parseFloat","getTransformScaleX","m","te","elements","getTransformScaleY","paths","transformStack","tempTransform0","tempTransform1","tempTransform2","tempTransform3","tempV2","tempV3","currentTransform","xml","DOMParser","parseFromString","parseNode","nodeType","transform","nodeName","tx","ty","transformsTexts","tIndex","transformText","openParPos","indexOf","closeParPos","transformType","substr","identity","rotate","multiplyMatrices","scaleX","scaleY","tan","premultiply","parseNodeTransform","getNodeTransform","traverseChildNodes","sheet","cssRules","stylesheet","selectorList","selectorText","parseCSSStylesheet","ShapePath","control","firstPoint","isFirstPoint","doSetFirstPoint","commands","match","command","charAt","numbers","moveTo","bezierCurveTo","quadraticCurveTo","autoClose","curves","currentPoint","parsePathNode","w","h","parseRectNode","replace","parsePolygonNode","parsePolylineNode","subpath","Path","absarc","subPaths","parseCircleNode","parseEllipseNode","x1","y1","x2","y2","parseLineNode","usedNodeId","href","baseVal","usedNode","viewportElement","getElementById","fill","setStyle","transfVec2","v2","isRotated","isTransformRotated","curve","isLineCurve","v1","isCubicBezierCurve","v0","v3","isQuadraticBezierCurve","isEllipseCurve","aX","aY","xRadius","yRadius","transformPath","userData","nodes","childNodes","pop","documentElement","fillOpacity","strokeOpacity","strokeWidth","strokeLineJoin","strokeLineCap","strokeMiterLimit","shapePath","BIGNUMBER","classifyResult","loc","t","findEdgeIntersection","a0","a1","b0","b1","x3","x4","y3","y4","nom1","denom","t1","t2","classifyPoint","toPrecision","p","edgeStart","edgeEnd","ax","ay","bx","by","sa","EPSILON","identifier","scanlineMinX","scanlineMaxX","simplePaths","getPoints","maxY","minY","maxX","minX","isCW","ShapeUtils","Box2","sp","isAHole","simplePath","allPaths","_fillRule","centerBoundingBox","scanlineIntersections","scanline","allIntersections","forEach","containsPoint","path1","path2","intersectionsRaw","intersections","path1EdgeStart","path1EdgeEnd","index2","intersection","find","getIntersections","i1","i2","getScanlineIntersections","baseIntersections","otherIntersections","firstXOfPath","stack","isHole","isHoleFor","for","lastCWValue","isHoleTo","fillRule","shapesToReturn","shape","Shape","holes","width","lineJoin","lineCap","miterLimit","strokeColor","arcDivisions","minDistance","pointsToStrokeWithBuffers","tempV2_1","tempV2_2","tempV2_3","tempV2_4","tempV2_5","tempV2_6","tempV2_7","lastPointL","lastPointR","point0L","point0R","currentPointL","currentPointR","nextPointL","nextPointR","innerPoint","outerPoint","numPoints","dupPoints","distanceTo","newPoints","removeDuplicatedPoints","isClosed","equals","nextPoint","previousPoint","strokeWidth2","deltaU","u1","innerSideModified","joinIsOnLeftSide","isMiter","u0","initialJoinIsOnLeftSide","numVertices","currentCoordinate","currentCoordinateUV","getNormal","multiplyScalar","sub","iPoint","normal1","miterSide","setLength","miterLength2","segmentLengthPrev","divideScalar","segmentLengthNext","makeSegmentTriangles","makeSegmentWithBevelJoin","createSegmentTrianglesWithMiddleSection","makeCircularSector","miterFraction","addVertex","addCapGeometry","lastOuter","lastInner","toArray","p1","p2","rotateAround","addVectors","buffer","directGeometry","fromDirectGeometry","Transform","camera","renderer","bufferGeometry","isBufferGeometry","fromSVGtoShape","svg","isCCW","noHoles","svgLoader","shapes","toShapes","from3dto2d","vector3","canvas","domElement","updateMatrixWorld","project","height","from2dto3d","distanceFromCamera","tmpPlane","geo","PlaneBufferGeometry","mat","MeshBasicMaterial","transparent","opacity","Mesh","tmpRaycaster","Raycaster","tmpVector3","setRotationFromEuler","rotation","getWorldDirection","setFromCamera","intersects","intersectObjects","CSGWrapper","meshA","meshB","bufferGeometryToGeometry","meshC","geometryToBufferGeometry","toGeometry","doCSG","operation","bspA","CSG","fromMesh","bspB","bspC","toMesh","polygons","csg","geom","fs","vs","polys","fm","Vertex","Polygon","fromPolygons","_tmpm3","pos","toMatrix","ps","fvuv","pvs","pvlen","pv","fc","fuv","fnml","plane","inv","parseInt","REVISION","invert","getInverse","decompose","tokens","_index","currentOp","token","iEval","op","sourceMesh","nextPrim","currentPrim","doRemove","parent","remove","material","castShadow","receiveShadow","toPolygons","union","Node","clipTo","build","allPolygons","subtract","intersect","inverse","flip","Vector","Error","negated","plus","minus","times","dividedBy","lerp","unit","interpolate","other","Plane","splitPolygon","polygon","coplanarFront","coplanarBack","front","back","polygonType","types","ti","tj","vi","vj","shared","fromPoints","reverse","temp","clipPolygons","slice","concat","bsp","ch2","durl","URL","createObjectURL","Blob","cwk","Worker","revokeObjectURL","encodeURI","u8","Uint8Array","u16","Uint16Array","u32","Uint32Array","fleb","fdeb","clim","freb","eb","revfl","fd","revfd","rev","hMap","cd","mb","co","le","rvb","sv","r_1","flt","fdt","flm","flrm","fdm","fdrm","bits","bits16","shft","slc","subarray","inflt","dat","buf","st","sl","noBuf","noSt","cbuf","bl","nbuf","final","bt","lm","dm","lbt","dbt","tbts","hLit","hcLen","tl","ldt","clt","clb","clbmsk","clm","lt","dt","lms","dms","lpos","sym","dsym","wbits","wbits16","hTree","et","i0","maxSym","tr","mbt","ln","lft","cst","i2_1","i2_2","i2_3","lc","cl","cli","cln","cls","clen","cf","wfblk","out","wblk","syms","lf","df","li","bs","dlt","mlb","ddt","mdb","_c","lclt","nlc","_d","lcdt","ndc","lcfreq","_e","lct","mlcb","nlcc","ll","dl","flen","ftlen","dtlen","llm","lcts","it","clct","dst","deo","dflt","lvl","plvl","pre","post","lst","ceil","opt","msk_1","prev","head","bs1_1","bs2_1","hsh","lc_1","wi","hv","imod","pimod","rem","ch_1","dif","maxn","maxd","ml","nl","mmd","md","lin","din","crct","crc","adler","dopt","level","mem","log","mrg","wcln","fnStr","td","ks","lastIndexOf","st_1","spInd","ch","wrkr","fns","init","td_1","msg","transfer","onerror","onmessage","postMessage","wk","cbfs","bInflt","inflateSync","pbf","gu8","bDflt","deflateSync","gze","gzh","gzhl","wbytes","guze","gzs","gzl","zle","zlh","zule","zlv","size","cbify","opts","err","terminate","consume","astrm","strm","ondata","ev","astrmify","b2","b4","b8","filename","mtime","floor","Date","now","charCodeAt","flg","zs","lv","AsyncCmpStrm","Deflate","chunk","AsyncDeflate","deflate","Inflate","bts","AsyncInflate","inflate","Gzip","raw","AsyncGzip","gzip","gzipSync","Gunzip","AsyncGunzip","gunzip","gunzipSync","Zlib","AsyncZlib","zlib","zlibSync","Unzlib","AsyncUnzlib","unzlib","unzlibSync","Decompress","G","I","Z","_this_1","AsyncDecompress","decompress","decompressSync","fltn","val","TextEncoder","TextDecoder","tds","decode","stream","dutf8","fromCharCode","DecodeUTF8","np","EncodeUTF8","strToU8","str","latin1","ar_1","encode","ar","ai","strFromU8","dbf","slzh","zh","fnl","es","z64e","sc","su","off","exfl","ex","wzh","ce","extra","col","exl","os","flag","compression","getFullYear","getMonth","getDate","getHours","getMinutes","getSeconds","attrs","exf","wzf","ZipPassThrough","process","ZipDeflate","AsyncZipDeflate","Zip","file","com","comment","hl","header","chks","pAll","chks_1","chk","ind","uf","nxt","dd","zip","tot","slft","files","term","tAll","cbf","oe","cdl","badd","_loop_1","ms","cbl","zipSync","UnzipPassThrough","UnzipInflate","AsyncUnzipInflate","_","sz","Unzip","onfile","toAdd","is","oc","_loop_2","sig","this_1","bf","cmp_1","chks_2","unshift","d_1","sc_1","su_1","fn_1","file_1","ctr","chks_3","originalSize","register","decoder","unzip","_loop_3","c_1","no","infl","unzipSync","c_2","NURBSUtils","U","low","high","mid","span","N","left","right","saved","rv","P","findSpan","calcBasisFunctions","C","Vector4","Nj","wNj","zeroArr","ders","ndu","s1","s2","rk","pk","j2","nd","du","CK","nders","calcBasisFunctionDerivatives","Pw","nom","Pders","Aders","wders","calcKoverI","calcBSplineDerivatives","calcRationalCurveDerivatives","V","target","uspan","vspan","Nu","Nv","Sw","NURBSCurve","Curve","degree","knots","controlPoints","startKnot","endKnot","getPoint","optionalTarget","hpoint","calcBSplinePoint","getTangent","tangent","calcNURBSDerivatives","fbxTree","connections","sceneGraph","FBXLoader","LoaderUtils","setResponseType","FBXBuffer","CORRECT","byteLength","convertArrayBufferToString","isFbxFormatBinary","BinaryParser","FBXText","cursor","read","offset","isFbxFormatASCII","getFbxVersion","TextParser","textureLoader","TextureLoader","resourcePath","setCrossOrigin","crossOrigin","FBXTreeParser","parseConnections","images","parseImages","textures","parseTextures","materials","parseMaterials","deformers","parseDeformers","geometryMap","GeometryParser","parseScene","connectionMap","Connections","rawConnection","fromID","toID","relationship","parents","children","parentRelationship","ID","childRelationship","blobs","Objects","videoNodes","Video","nodeID","videoNode","RelativeFilename","Filename","arrayBufferContent","Content","ArrayBuffer","base64Content","image","parseImage","content","fileName","extension","toLowerCase","getHandler","window","textureMap","textureNodes","Texture","texture","parseTexture","textureNode","loadTexture","attrName","wrapModeU","WrapModeU","wrapModeV","WrapModeV","valueU","valueV","wrapS","RepeatWrapping","ClampToEdgeWrapping","wrapT","values","Scaling","repeat","FileName","materialMap","materialNodes","Material","parseMaterial","materialNode","ShadingModel","parseParameters","MeshPhongMaterial","MeshLambertMaterial","setValues","BumpFactor","bumpScale","Diffuse","fromArray","DiffuseColor","DisplacementFactor","displacementScale","Emissive","emissive","EmissiveColor","EmissiveFactor","emissiveIntensity","Opacity","ReflectionFactor","reflectivity","Shininess","shininess","Specular","specular","SpecularColor","child","bumpMap","getTexture","aoMap","encoding","sRGBEncoding","displacementMap","emissiveMap","normalMap","envMap","mapping","EquirectangularReflectionMapping","specularMap","alphaMap","LayeredTexture","skeletons","DeformerNodes","Deformer","deformerNode","relationships","attrType","skeleton","parseSkeleton","geometryID","rawTargets","parseMorphTargets","deformerNodes","rawBones","boneNode","rawBone","weights","transformLink","TransformLink","Indexes","Weights","bones","rawMorphTargets","morphTargetNode","rawMorphTarget","initialWeight","DeformPercent","fullWeights","FullWeights","geoID","Group","modelMap","parseModels","modelNodes","Model","model","modelNode","setLookAtProperties","connection","bindSkeleton","createAmbientLight","setupMorphMaterials","traverse","transformData","parentMatrix","parentMatrixWorld","matrixWorld","generateTransform","updateWorldMatrix","animations","AnimationParser","isGroup","buildSkeleton","createCamera","createLight","createMesh","createCurve","Bone","PropertyBinding","getTransformData","bone","subBone","cameraAttribute","attr","NodeAttribute","CameraProjectionType","nearClippingPlane","NearPlane","farClippingPlane","FarPlane","innerWidth","innerHeight","AspectWidth","AspectHeight","aspect","fov","FieldOfView","focalLength","FocalLength","PerspectiveCamera","setFocalLength","OrthographicCamera","lightAttribute","LightType","intensity","Intensity","CastLightOnObject","distance","FarAttenuationEnd","EnableFarAttenuation","decay","PointLight","DirectionalLight","InnerAngle","penumbra","OuterAngle","SpotLight","CastShadows","FBX_Deformer","SkinnedMesh","normalizeSkinWeights","reduce","LineBasicMaterial","linewidth","Line","inheritType","InheritType","eulerOrder","getEulerOrder","RotationOrder","translation","Lcl_Translation","preRotation","PreRotation","Lcl_Rotation","postRotation","PostRotation","Lcl_Scaling","scalingOffset","ScalingOffset","scalingPivot","ScalingPivot","rotationOffset","RotationOffset","rotationPivot","RotationPivot","lookAtTarget","bindMatrices","parsePoseNodes","geoConnParent","bind","Skeleton","BindPoseNode","Pose","poseNodes","PoseNode","poseNode","Matrix","GlobalSettings","ambientColor","AmbientColor","AmbientLight","setupMorphMaterial","matUuid","sharedMat","clonedMat","geoNodes","parseGeometry","geoNode","parseMeshGeometry","parseNurbsGeometry","GeometricTranslation","GeometricRotation","GeometricScaling","genGeometry","preTransform","geoInfo","parseGeoNode","buffers","genBuffers","positionAttribute","Uint16BufferAttribute","weightsIndices","vertexWeights","normalAttribute","applyNormalMatrix","uvBuffer","mappingType","prevMaterialIndex","startIndex","currentIndex","addGroup","lastGroup","lastIndex","addMorphTargets","vertexPositions","Vertices","vertexIndices","PolygonVertexIndex","LayerElementColor","parseVertexColors","LayerElementMaterial","parseMaterialIndices","LayerElementNormal","parseNormals","LayerElementUV","UV","parseUVs","weightTable","weight","polygonIndex","faceLength","displayedWeightsWarning","facePositionIndexes","faceColors","faceUVs","faceWeights","faceWeightIndices","vertexIndex","polygonVertexIndex","endOfFace","weightIndices","getData","wt","wIndex","Weight","weightIndex","currentWeight","comparedWeight","comparedWeightIndex","comparedWeightArray","tmp","genFace","parentGeo","parentGeoNode","morphTargetsRelative","rawTarget","morphGeoNode","genMorphGeometry","morphPositionsSparse","morphPositions","morphIndex","morphGeoInfo","morphBuffers","NormalNode","MappingInformationType","referenceType","ReferenceInformationType","Normals","indexBuffer","NormalIndex","NormalsIndex","dataSize","UVNode","UVIndex","ColorNode","Colors","ColorIndex","MaterialNode","materialIndexBuffer","Materials","materialIndices","order","Order","isNaN","KnotVector","pointsValues","Points","Form","animationClips","rawClips","parseClips","rawClip","clip","addClip","AnimationCurve","curveNodesMap","parseAnimationCurveNodes","parseAnimationCurves","layersMap","parseAnimationLayers","parseAnimStacks","rawCurveNodes","AnimationCurveNode","rawCurveNode","curveNode","rawCurves","animationCurve","KeyTime","convertFBXTimeToSeconds","KeyValueFloat","animationCurveID","animationCurveRelationship","rawLayers","AnimationLayer","layerCurveNodes","modelID","rawModel","modelName","initialPosition","initialRotation","initialScale","morph","deformerID","morpherID","morphName","rawStacks","AnimationStack","layer","tracks","rawTracks","generateTracks","AnimationClip","Quaternion","Euler","setFromQuaternion","T","positionTrack","generateVectorTrack","R","rotationTrack","generateRotationTrack","S","scaleTrack","morphTrack","generateMorphTrack","initialValue","getTimesForAllAxes","getKeyframeTrackValues","VectorKeyframeTrack","interpolateRotations","setFromEuler","quaternion","euler","quaternionValues","multiply","QuaternionKeyframeTrack","morphNum","getObjectByName","morphTargetDictionary","NumberKeyframeTrack","targetIndex","lastValue","currentValue","prevValue","xIndex","yIndex","zIndex","time","xValue","yValue","zValue","valuesSpan","absoluteSpan","numSubIntervals","step","nextValue","initialTime","interval","nextTime","interpolatedTimes","interpolatedValues","inject","getPrevNode","nodeStack","currentIndent","getCurrentNode","getCurrentProp","currentProp","pushStack","popStack","setCurrentProp","currentPropName","allNodes","FBXTree","line","matchComment","matchEmpty","matchBeginning","matchProperty","matchEnd","parseNodeBegin","parseNodeProperty","parseNodePropertyContinued","property","nodeAttrs","parseNodeAttr","currentNode","contentLine","propName","propValue","connProps","rest","elem","append","parseNumberArray","parseNodeSpecialProperty","props","innerPropName","innerPropType1","innerPropType2","innerPropFlag","innerPropValue","reader","BinaryReader","skip","getUint32","endOfContent","getOffset","endOffset","getUint64","numProperties","nameLen","getUint8","getString","propertyList","parseProperty","singleProperty","subNode","parseSubNode","getBoolean","getFloat64","getFloat32","getInt32","getInt64","getArrayBuffer","getInt16","arrayLength","compressedLength","getBooleanArray","getFloat64Array","getFloat32Array","getInt32Array","getInt64Array","reader2","littleEndian","dv","DataView","nullByte","dataArray","infoObject","tempEuler","tempVec","lTranslationM","lPreRotationM","lRotationM","lPostRotationM","lScalingM","lScalingPivotM","lScalingOffsetM","lRotationOffsetM","lRotationPivotM","lParentGX","lParentLX","lGlobalT","setPosition","makeRotationFromEuler","lLRM","lParentGRM","extractRotation","lParentTM","copyPosition","lParentGRSM","lParentGSM","lLSM","lGlobalRS","lParentLSM_inv","setFromMatrixScale","lParentGSM_noLocal","lRotationPivotM_inv","lScalingPivotM_inv","lTransform","lLocalTWithAllPivotAndOffsetInfo","lGlobalTranslation","enums","a2","GLTFLoader","dracoLoader","ktx2Loader","meshoptDecoder","pluginCallbacks","parser","GLTFMaterialsClearcoatExtension","GLTFTextureBasisUExtension","GLTFTextureWebPExtension","GLTFMaterialsTransmissionExtension","GLTFLightsExtension","GLTFMeshoptCompression","itemStart","_onError","itemEnd","gltf","setDRACOLoader","setDDSLoader","setKTX2Loader","setMeshoptDecoder","callback","unregister","extensions","plugins","BINARY_EXTENSION_HEADER_MAGIC","EXTENSIONS","KHR_BINARY_GLTF","GLTFBinaryExtension","json","JSON","asset","GLTFParser","fileLoader","plugin","extensionsUsed","extensionName","extensionsRequired","KHR_MATERIALS_UNLIT","GLTFMaterialsUnlitExtension","KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS","GLTFMaterialsPbrSpecularGlossinessExtension","KHR_DRACO_MESH_COMPRESSION","GLTFDracoMeshCompressionExtension","KHR_TEXTURE_TRANSFORM","GLTFTextureTransformExtension","KHR_MESH_QUANTIZATION","GLTFMeshQuantizationExtension","setExtensions","setPlugins","GLTFRegistry","objects","removeAll","KHR_LIGHTS_PUNCTUAL","KHR_MATERIALS_CLEARCOAT","KHR_MATERIALS_TRANSMISSION","KHR_TEXTURE_BASISU","EXT_TEXTURE_WEBP","EXT_MESHOPT_COMPRESSION","cache","refs","uses","_markDefs","nodeDefs","nodeIndex","nodeLength","nodeDef","light","_addNodeRef","_loadLight","lightIndex","cacheKey","dependency","lightDef","lights","lightNode","range","spot","innerConeAngle","outerConeAngle","createUniqueName","Promise","resolve","createNodeAttachment","then","_getNodeRef","getMaterialType","extendParams","materialParams","materialDef","pending","metallicRoughness","pbrMetallicRoughness","baseColorFactor","baseColorTexture","assignTexture","all","MeshPhysicalMaterial","extendMaterialParams","clearcoatFactor","clearcoat","clearcoatTexture","clearcoatRoughnessFactor","clearcoatRoughness","clearcoatRoughnessTexture","clearcoatNormalTexture","clearcoatNormalScale","transmissionFactor","transmission","transmissionTexture","textureIndex","textureDef","options","loadTextureImage","isSupported","uri","handler","detectSupport","Image","src","onload","loadBufferView","bufferView","bufferViews","extensionDef","getDependency","supported","ready","res","byteOffset","byteStride","decodeGltfBuffer","mode","body","headerView","magic","chunkContentsLength","chunkView","chunkIndex","chunkLength","chunkType","contentArray","preload","decodePrimitive","primitive","bufferViewIndex","gltfAttributeMap","threeAttributeMap","attributeNormalizedMap","attributeTypeMap","attributeName","threeAttributeName","ATTRIBUTES","accessorDef","accessors","componentType","WEBGL_COMPONENT_TYPES","normalized","decodeDracoFile","extendTexture","texCoord","needsUpdate","GLTFMeshStandardSGMaterial","MeshStandardMaterial","params","isGLTFSpecularGlossinessMaterial","specularMapParsFragmentChunk","join","glossinessMapParsFragmentChunk","specularMapFragmentChunk","glossinessMapFragmentChunk","lightPhysicalFragmentChunk","uniforms","setHex","glossiness","glossinessMap","_extraUniforms","onBeforeCompile","shader","uniformName","fragmentShader","defineProperties","defines","USE_SPECULARMAP","USE_GLOSSINESSMAP","USE_UV","metalness","roughness","metalnessMap","roughnessMap","specularGlossinessParams","pbrSpecularGlossiness","diffuseFactor","diffuseTexture","glossinessFactor","specularFactor","specularGlossinessTexture","specGlossMapDef","createMaterial","fog","lightMap","lightMapIntensity","aoMapIntensity","normalMapType","TangentSpaceNormalMap","normalScale","displacementBias","envMapIntensity","refractionRatio","GLTFCubicSplineInterpolant","Interpolant","parameterPositions","sampleValues","sampleSize","resultBuffer","copySampleValue_","valueSize","beforeStart_","afterEnd_","interpolate_","t0","stride2","stride3","pp","ppp","offset1","offset0","s3","s0","p0","m0","m1","Int8Array","Int16Array","WEBGL_FILTERS","NearestFilter","LinearFilter","NearestMipmapNearestFilter","LinearMipmapNearestFilter","NearestMipmapLinearFilter","LinearMipmapLinearFilter","WEBGL_WRAPPINGS","MirroredRepeatWrapping","WEBGL_TYPE_SIZES","POSITION","NORMAL","TANGENT","TEXCOORD_0","TEXCOORD_1","COLOR_0","WEIGHTS_0","JOINTS_0","PATH_PROPERTIES","INTERPOLATION","CUBICSPLINE","LINEAR","InterpolateLinear","STEP","InterpolateDiscrete","resolveURL","addUnknownExtensionsToUserData","knownExtensions","objectDef","gltfExtensions","assignExtrasToUserData","gltfDef","extras","updateMorphTargets","meshDef","morphTargetInfluences","targetNames","createPrimitiveKey","primitiveDef","dracoExtension","geometryKey","createAttributesKey","attributesKey","getNormalizedComponentScale","associations","primitiveCache","meshCache","cameraCache","lightCache","textureCache","nodeNamesUsed","createImageBitmap","navigator","userAgent","ImageBitmapLoader","_invokeAll","ext","beforeRoot","getDependencies","dependencies","scene","scenes","cameras","afterRoot","catch","skinDefs","skins","meshDefs","meshes","skinIndex","skinLength","joints","isBone","skin","isSkinnedMesh","ref","_invokeOne","func","loadScene","loadNode","loadMesh","loadAccessor","loadBuffer","loadMaterial","loadSkin","loadAnimation","loadCamera","defs","def","bufferIndex","bufferDef","reject","bufferViewDef","accessorIndex","sparse","pendingBufferViews","itemSize","TypedArray","elementBytes","BYTES_PER_ELEMENT","itemBytes","bufferAttribute","ibSlice","ibCacheKey","ib","InterleavedBuffer","InterleavedBufferAttribute","itemSizeIndices","SCALAR","TypedArrayIndices","byteOffsetIndices","byteOffsetValues","sparseIndices","sparseValues","setX","setY","setZ","setW","sampler","webkitURL","sourceURI","isObjectURL","hasAlpha","isJPEG","search","mimeType","colorType","blob","promise","isImageBitmapLoader","imageBitmap","flipY","format","RGBFormat","samplers","magFilter","minFilter","mapName","mapDef","gltfReference","assignFinalMaterial","useVertexTangents","useVertexColors","useFlatShading","useMorphTargets","useMorphNormals","pointsMaterial","PointsMaterial","sizeAttenuation","lineMaterial","cachedMaterial","flatShading","vertexTangents","materialType","materialExtensions","sgExtension","kmuExtension","metallicFactor","roughnessFactor","metallicRoughnessTexture","doubleSided","side","DoubleSide","alphaMode","depthWrite","alphaTest","alphaCutoff","normalTexture","occlusionTexture","strength","emissiveFactor","emissiveTexture","originalName","sanitizedName","loadGeometries","primitives","createDracoPrimitive","addPrimitiveAttributes","cached","geometryPromise","meshIndex","depthTest","FrontSide","results","geometries","skinWeight","toTrianglesDrawMode","TriangleStripDrawMode","TriangleFanDrawMode","LineSegments","LineLoop","cameraIndex","cameraDef","yfov","aspectRatio","znear","zfar","xmag","ymag","skinDef","skinEntry","inverseBindMatrices","accessor","animationIndex","animationDef","pendingNodes","pendingInputAccessors","pendingOutputAccessors","pendingSamplers","pendingTargets","channels","channel","output","inputAccessors","outputAccessors","targets","inputAccessor","outputAccessor","TypedKeyframeTrack","targetName","interpolation","outputArray","scaled","track","createInterpolant","getValueSize","isInterpolantFactoryMethodGLTFCubicSpline","createNodeMesh","meshPromise","sceneIndex","sceneDef","nodeIds","buildNodeHierachy","nodeId","parentObject","pendingJoints","jointNodes","boneInverses","jointNode","assignAttributeAccessor","gltfAttributeName","setIndex","box","boxScale","maxDisplacement","expandByVector","sphere","computeBounds","hasMorphPosition","hasMorphNormal","pendingPositionAccessors","pendingNormalAccessors","pendingAccessor","drawMode","getIndex","numberOfTriangles","newIndices","newGeometry","__awaiter","thisArg","_arguments","fulfilled","next","rejected","done","Loaders","textureAnisotropy","_fileLoader","_imgLoader","ImageLoader","_svgLoader","_textureLoader","_objectLoader","ObjectLoader","_gltfLoader","_fbxLoader","isModel","textureAtlas","_type","parsed","frames","jsonHash","frame","rotated","sourceSize","spriteSourceSize","trimmed","anisotropy","objectLoader","gltfLoader","fbx","fbxLoader","PointLightHelper","SphereBufferGeometry","update","Lights","directionalLightHelper","helper","DirectionalLightHelper","spotLightHelper","SpotLightHelper","pointLightHelper","directionalLight","hemisphereLight","skyColor","groundColor","HemisphereLight","ambientLight","pointLight","spotLight","rectAreaLight","RectAreaLight","ExtendedMesh","isExtendedMesh","hasBody","fragmentDepth","breakable","fractureImpulse","worldTheta","phi","worldPhi","atan2","loggerCache","logger","_defaultMaterial","__rest","getOwnPropertySymbols","propertyIsEnumerable","Factories","isHeadless","defaultMaterial","planeConfig","materialConfig","makePlane","boxConfig","makeBox","sphereConfig","makeSphere","cylinder","cylinderConfig","makeCylinder","cone","coneConfig","makeCone","torus","torusConfig","makeTorus","extrude","extrudeConfig","makeExtrude","addMesh","existing","addExisting","addPlane","addBox","ground","groundConfig","addGround","addSphere","addCylinder","addCone","addTorus","addExtrude","addMaterial","autoCenter","depth","bevelEnabled","ExtrudeBufferGeometry","widthSegments","heightSegments","phiStart","phiLength","thetaStart","thetaLength","BoxBufferGeometry","depthSegments","CylinderBufferGeometry","radiusTop","radiusBottom","radiusSegments","openEnded","ConeBufferGeometry","TorusBufferGeometry","tube","radialSegments","tubularSegments","arc","basic","MeshNormalMaterial","standard","lambert","phong","physical","MeshToonMaterial","toon","custom","HeightMap","config","heightMap","make","colorScale","document","createElement","ctx","getContext","drawImage","pixel","getImageData","getHighPoint","hex","_changeEvent","_startEvent","_endEvent","OrbitControls","touchAction","maxDistance","Infinity","minZoom","maxZoom","minPolarAngle","maxPolarAngle","minAzimuthAngle","maxAzimuthAngle","enableDamping","dampingFactor","enableZoom","zoomSpeed","enableRotate","rotateSpeed","enablePan","panSpeed","screenSpacePanning","keyPanSpeed","autoRotate","autoRotateSpeed","LEFT","UP","RIGHT","BOTTOM","mouseButtons","MOUSE","MIDDLE","touches","ONE","TOUCH","TWO","target0","position0","zoom0","zoom","_domElementKeyEvents","getPolarAngle","spherical","getAzimuthalAngle","listenToKeyEvents","addEventListener","onKeyDown","saveState","reset","updateProjectionMatrix","STATE","NONE","quat","setFromUnitVectors","up","quatInverse","lastPosition","lastQuaternion","twoPI","applyQuaternion","setFromVector3","rotateLeft","sphericalDelta","isFinite","makeSafe","addScaledVector","panOffset","setFromSpherical","zoomChanged","distanceToSquared","EPS","removeEventListener","onContextMenu","onPointerDown","onPointerCancel","onMouseWheel","ownerDocument","onPointerMove","onPointerUp","ROTATE","DOLLY","PAN","TOUCH_ROTATE","TOUCH_PAN","TOUCH_DOLLY_PAN","TOUCH_DOLLY_ROTATE","Spherical","rotateStart","rotateEnd","rotateDelta","panStart","panEnd","panDelta","dollyStart","dollyEnd","dollyDelta","pointers","pointerPositions","getZoomScale","rotateUp","panLeft","objectMatrix","setFromMatrixColumn","panUp","crossVectors","pan","deltaX","deltaY","element","isPerspectiveCamera","targetDistance","clientHeight","isOrthographicCamera","clientWidth","top","bottom","dollyOut","dollyScale","dollyIn","handleMouseDownRotate","clientX","clientY","handleMouseDownPan","handleTouchStartRotate","pageX","pageY","handleTouchStartPan","handleTouchStartDolly","dx","dy","handleTouchMoveRotate","getSecondPointerPosition","handleTouchMovePan","handleTouchMoveDolly","addPointer","pointerType","trackPointer","onTouchStart","mouseAction","button","handleMouseDownDolly","ctrlKey","metaKey","shiftKey","onMouseDown","handleTouchMoveDollyPan","handleTouchMoveDollyRotate","onTouchMove","handleMouseMoveRotate","handleMouseMoveDolly","handleMouseMovePan","onMouseMove","removePointer","preventDefault","handleMouseWheel","code","handleKeyDown","pointerId","pointer","passive","WarpSpeed","physics","factories","warpSpeed","features","Features","negativeFeatures","feature","hasNegativeFeatures","vertexShader","topColor","bottomColor","skyGeo","skyMat","ShaderMaterial","BackSide","sky","shadow","mapSize","addGrid","gridData","__loadPhysics","setRestitution","orbitControls","Reflector","textureWidth","textureHeight","clipBias","ReflectorShader","reflectorPlane","reflectorWorldPosition","cameraWorldPosition","rotationMatrix","lookAtPosition","clipPlane","view","textureMatrix","virtualCamera","renderTarget","WebGLRenderTarget","generateMipmaps","UniformsUtils","onBeforeRender","setFromMatrixPosition","reflect","far","projectionMatrix","matrixWorldInverse","setFromNormalAndCoplanarPoint","constant","sign","outputEncoding","visible","currentRenderTarget","getRenderTarget","currentXrEnabled","xr","currentShadowAutoUpdate","shadowMap","autoUpdate","setRenderTarget","setMask","autoClear","clear","render","viewport","isReflector","Refractor","RefractorShader","refractor","refractorPlane","refractorWorldPosition","updateRefractorPlane","updateVirtualCamera","clipVector","updateTextureMatrix","isRefractor","Water","flowDirection","flowSpeed","WaterShader","LinearEncoding","flowMap","normalMap0","normalMap1","cycle","halfCycle","clock","Clock","reflector","UniformsLib","USE_FLOWMAP","getDelta","updateFlow","isWater","Misc","water","flowX","flowY","groundGeometry","groundMaterial","waterGeometry","addWater","textureCube","TextureCube","down","Constants","Handedness","freeze","ComponentState","DEFAULT","TOUCHED","PRESSED","ComponentProperty","BUTTON","X_AXIS","Y_AXIS","ComponentType","TRIGGER","SQUEEZE","TOUCHPAD","THUMBSTICK","ButtonTouchThreshold","AxisTouchThreshold","VisualResponseProperty","TRANSFORM","VISIBILITY","async","fetchJsonFile","response","fetch","ok","statusText","defaultComponentValues","xAxis","yAxis","VisualResponse","visualResponseDescription","componentProperty","states","valueNodeName","valueNodeProperty","minNodeName","maxNodeName","updateFromComponent","normalizedXAxis","normalizedYAxis","normalizeAxes","Component","componentId","componentDescription","visualResponses","gamepadIndices","rootNodeName","touchPointNodeName","responseName","visualResponse","updateFromGamepad","gamepad","buttons","gamepadButton","pressed","touched","axes","MotionController","xrInputSource","profile","assetUrl","profileId","layoutDescription","layouts","handedness","components","gripSpace","targetRaySpace","component","XRControllerModel","motionController","setEnvironmentMap","force","valueNode","minNode","maxNode","slerpQuaternions","lerpVectors","addAssetSceneToControllerModel","controllerModel","touchPointNode","sphereGeometry","SphereGeometry","findNodes","XRControllerModelFactory","_assetCache","createControllerModel","controller","targetRayMode","basePath","defaultProfile","getAssetPath","supportedProfilesList","fetchProfilesList","profiles","some","supportedProfile","profilePath","deprecated","assetPath","layout","fetchProfile","cachedAsset","WebXR","_renderer","_scene","_camera","controllerModelFactory","cameraGroup","vrButton","stylizeElement","padding","border","borderRadius","background","font","textAlign","outline","display","isSessionSupported","currentSession","onSessionStarted","session","onSessionEnded","setSession","textContent","onmouseenter","onmouseleave","onclick","sessionInit","optionalFeatures","requestSession","showEnterVR","message","isSecureContext","location","innerHTML","textDecoration","createButton","cssText","appendChild","isPresenting","getController","getControllerGrip","controllerGrip","getControllerRay","WebXRCamera","getCamera","Cameras","perspectiveCamera","Perspective","orthographicCamera","Orthographic","near","Scene3D","sceneConfig","__config","_isRunning","_deconstructor","random","enableXR","sceneKey","initializeScene","autoStart","misc","ws","mixers","_mixers","animationMixer","mixer","AnimationMixer","create","webXR","destroy","haveSomeFun","numberOfElements","Between","RandomPick","mass","isRunning","stop","_start","_preload","_create","setAnimationLoop","_update","restart","rigidBodies","setSize","setPixelRatio","ratio","_time","_delta","preRender","postRender","getElapsedTime","toFixed","updateDebugger","animationMixers","composer","ExtendedObject3D","isExtendedObject3D","_currentAnimation","_animationActions","_animationMixer","animation","_animsAdd","_animsGet","play","transitionDuration","loop","_animsPlay","anims","clipAction","action","crossFadeFrom","clampWhenFinished","setLoop","LoopOnce","setAction","traverseVisible","traverseAncestors","ExtendedGroup","isExtendedGroup","Constraints","worldTransform","physicsWorld","tmpBtVector3","Ammo","btVector3","toAmmoV3","lock","bodyA","bodyB","disableCollisionsBetweenLinkedBodies","fixed","pointToPoint","hinge","slider","spring","coneTwist","frameA","frameB","dof","getTransform","transformB","btTransform","setIdentity","getWorldTransform","getOrigin","dz","setOrigin","transformA","getCenterOfMassTransform","op_mul","zero","angularLowerLimit","angularUpperLimit","ammo","setRotation","getRotation","constraint","btFixedConstraint","addConstraint","pivotA","pivotB","pivotV3","targetPivotV3","btPoint2PointConstraint","axisA","axisB","axisV3","targetAxisV3","btHingeConstraint","linearLowerLimit","lll","linearUpperLimit","lul","aul","rotationA","setEulerZYX","rotationB","btSliderConstraint","setLowerLinLimit","setUpperLinLimit","setLowerAngLimit","setUpperAngLimit","stiffness","damping","angularLock","enableSpring","btGeneric6DofSpringConstraint","setValue","setLinearLowerLimit","setLinearUpperLimit","setAngularLowerLimit","setAngularUpperLimit","setStiffness","setDamping","rbAFrame","rbBFrame","btConeTwistConstraint","setAngularOnly","btGeneric6DofConstraint","TYPE","FIT","createHullShape","matrices","_setOptions","fit","bounds","_computeBounds","btVertex","originalHull","btConvexHullShape","setMargin","margin","vertexCount","maxVertices","hullMaxVertices","isLastVertex","addPoint","collisionShape","getNumVertices","shapeHull","btShapeHull","buildHull","getPointer","getVertexPointer","_finishCollisionShape","_computeScale","createHACDShapes","indexes","triCount","hacd","HACD","SetCompacityWeight","compacityWeight","SetVolumeWeight","volumeWeight","SetNClusters","nClusters","SetNVerticesPerCH","nVerticesPerCH","SetConcavity","concavity","_malloc","triangles","SetPoints","SetTriangles","SetNPoints","SetNTriangles","pptr","tptr","HEAPF64","HEAP32","Compute","_free","GetNClusters","hull","nPoints","GetNPointsCH","nTriangles","GetNTrianglesCH","hullPoints","hullTriangles","GetCH","pi","px","py","pz","createVHACDShapes","vhacd","VHACD","Parameters","set_m_resolution","resolution","set_m_depth","set_m_concavity","set_m_planeDownsampling","planeDownsampling","set_m_convexhullDownsampling","convexhullDownsampling","set_m_alpha","alpha","set_m_beta","beta","set_m_gamma","gamma","set_m_pca","pca","set_m_mode","set_m_maxNumVerticesPerCH","maxNumVerticesPerCH","set_m_minVolumePerCH","minVolumePerCH","set_m_convexhullApproximation","convexhullApproximation","set_m_oclAcceleration","oclAcceleration","nHulls","GetNConvexHulls","ConvexHull","GetConvexHull","get_m_nPoints","get_m_points","createTriMeshShape","va","vb","vc","bta","btb","btc","triMesh","btTriangleMesh","bi","ci","addTriangle","localScale","setScaling","concave","btBvhTriangleMeshShape","btConvexTriangleMeshShape","resources","iterateGeometries","includeInvisible","el","object3D","minZ","maxZ","_iterateVertices","CollisionEvents","addCollider","object1","object2","eventCallback","checkCollisions","bodies","_v1","_line3","Line3","_plane","_closestPoint","_triangle","Triangle","tolerance","newFaces","assigned","VertexList","unassigned","makeEmpty","VertexNode","compute","setFromObject","distanceToPoint","intersectRay","ray","tNear","tFar","vN","origin","vD","direction","at","intersectsRay","addVertexToFace","outside","insertBefore","removeVertexFromFace","removeAllVerticesFromFace","removeSubList","deleteFaceVertices","absorbingFace","faceVertices","appendChain","nextVertex","resolveUnassignedPoints","isEmpty","first","maxFace","mark","computeExtremes","minVertices","getComponent","setComponent","computeInitialHull","extremes","closestPointToPoint","setFromCoplanarPoints","Face","getEdge","setTwin","reindexFaces","activeFaces","nextVertexToAdd","eyeVertex","eyeFace","computeHorizon","eyePoint","crossEdge","horizon","edge","twinEdge","twin","oppositeFace","addAdjoiningFace","horizonEdge","tail","addNewFaces","firstSideEdge","previousSideEdge","sideEdge","addVertexToHull","cleanup","midpoint","area","e0","HalfEdge","e1","e2","getMidpoint","getArea","lengthSquared","last","insertAfter","ConvexGeometry","newConvexGeometry","THREE","ConvexObjectBreaker","minSizeForBreak","smallDelta","tempLine1","tempPlane1","tempPlane2","tempPlane_Cut","tempCM1","tempCM2","tempVector3","tempVector3_2","tempVector3_3","tempVector3_P0","tempVector3_P1","tempVector3_P2","tempVector3_N0","tempVector3_N1","tempVector3_AB","tempVector3_CB","tempResultObjects","segments","prepareBreakableObject","velocity","angularVelocity","ammoPhysicsData","subdivideByImpact","pointOfImpact","maxRadialIterations","maxRandomIterations","debris","maxTotalIterations","subdivideRadial","subObject","startAngle","endAngle","numIterations","applyAxisAngle","cutByPlane","obj1","obj2","coords","numFaces","getVertexIndex","faceIdx","vert","points1","points2","numPointPairs","n0","n1","c1","c2","localPlane","transformPlaneToLocalSpace","segment","mark0","mark1","intersectLine","segmentedObject1","segmentedObject2","newMass","radius1","numPoints1","radius2","numPoints2","numObjects","transformFreeVector","transformFreeVectorInverse","transformTiedVectorInverse","resultPlane","referencePoint","coplanarPoint","wasmSupported","WebAssembly","instantiate","Module","of","Instance","doneCallback","tag","loadScriptAsync","PhysicsLoader","derivedCtor","baseCtors","baseCtor","getOwnPropertyNames","getOwnPropertyDescriptor","setRayFromWorld","_btRayFrom","setRayToWorld","_btRayTo","hasHit","_btRayCallback","rayTest","ClosestRayResultCallback","AllHitsRayResultCallback","ClosestRaycaster","AllHitsRaycaster","getHitPointWorld","get_m_hitPointWorld","getHitNormalWorld","get_m_hitNormalWorld","getCollisionObject","castObject","get_m_collisionObject","btRigidBody","threeObject","getHitPointsWorld","hh","getHitNormalsWorld","getCollisionObjects","threeObjects","get_m_collisionObjects","rb","AmmoPhysics","earlierDetectedCollisions","complexShapes","gravity","tmpEuler","tmpQuaternion","tmpVector3a","tmpMatrix4","tmpMatrix4a","tmpBtQuaternion","btQuaternion","emptyV3","impactPoint","impactNormal","isSoftBody","removeSoftBody","removeRigidBody","destructor","setup","setupPhysicsWorld","convexBreaker","objectsToRemove","numObjectsToRemove","collisionEvents","collisionFlags","translateX","constraints","debugDrawer","world","debugDrawMode","drawOnTop","maxBufferSize","setUsage","StaticDrawUsage","renderOrder","frustumCulled","DebugDrawer","drawLine","drawContactPoint","reportErrorWarning","draw3dText","setDebugMode","getDebugMode","setDebugDrawer","enable","disable","debugDrawWorld","setDrawRange","heap","HEAPF32","fromX","fromY","fromZ","setXYZ","toX","toY","toZ","pointOnB","normalOnB","_lifeTime","warningString","Pointer_stringify","warnedOnce","_location","_textString","debugMode","softBodies","collisionConfiguration","btDefaultCollisionConfiguration","dispatcher","btCollisionDispatcher","broadphase","btDbvtBroadphase","solver","btSequentialImpulseConstraintSolver","btDiscreteDynamicsWorld","btSoftBodyRigidBodyCollisionConfiguration","softBodySolver","btDefaultSoftBodySolver","btSoftRigidDynamicsWorld","setGravity","createDebrisFromBreakableObject","setTimeout","removeDebris","updatePhysics","detectCollisions","deltaTime","stepSimulation","maxSubSteps","fixedTimeStep","objThree","getMotionState","didUpdate","_emitUpdateEvents","eventEmitter","isKinematicObject","needUpdate","getWorldQuaternion","getWorldPosition","setWorldTransform","skipUpdate","isStaticObject","ignoreScale","getCollisionShape","getLocalScaling","compose","detectedCollisions","getDispatcher","numManifolds","getNumManifolds","contactManifold","getManifoldByIndexInternal","numContacts","getNumContacts","rb0","getBody0","rb1","getBody1","threeObject0","threeObject1","checkCollisions0","checkCollisions1","breakable0","breakable1","fractureImpulse0","fractureImpulse1","checkBreakable","contact","maxImpulse","contactPoint","getContactPoint","getDistance","impulse","getAppliedImpulse","get_m_positionWorldOnB","get_m_normalWorldOnB","names","combinedName","collision","MAX_FRAGMENT_DEPTH","physicsBody","vel","getLinearVelocity","angVel","getAngularVelocity","fragment","obj0","collider","addConstraints","raycaster","prepareThreeObjectForCollisionShape","defaultParams","createCollisionShape","axis","btHalfExtents","vertexArray","matrixArray","indexArray","extractData","btBoxShape","btSphereShape","btCylinderShape","btCylinderShapeX","btCylinderShapeZ","btConeShape","btConeShapeX","btConeShapeZ","btCapsuleShape","btCapsuleShapeX","btCapsuleShapeZ","SIMD_PI","subdivisions","gap","cylinderShape","compoundShape","btCompoundShape","forward","addChildShape","createTorusShape","mergeCollisionShapesToCompoundShape","collisionShapes","_tmp","applyPosQuatScaleMargin","getWorldScale","compound","collisionGroup","collisionMask","addChildren","localTransform","rigidBody","collisionShapeToRigidBody","addRigidBodyToWorld","cs","addRigidBody","ptr","errors","_needUpdate","tmpBtVector3_1","setupEventEmitter","need","onUpdateEvent","updateCallback","collisionCallback","onCollision","refresh","ammoQuat","q1","setVelocity","setLinearVelocity","setVelocityX","setVelocityY","setVelocityZ","setAngularVelocity","setAngularVelocityX","setAngularVelocityY","setAngularVelocityZ","applyForce","applyCentralImpulse","applyForceX","applyForceY","applyForceZ","applyCentralForce","applyCentralLocalForce","applyImpulse","relativePosition","applyLocalTorque","applyTorque","applyTorqueImpulse","setCollisionFlags","getCollisionFlags","setBounciness","setFriction","linear","angular","setLinearFactor","setAngularFactor","setCcdMotionThreshold","threshold","setCcdSweptSphereRadius","setLocalScaling","disableDeactivation","motionState","btDefaultMotionState","localInertia","calculateLocalInertia","rbInfo","btRigidBodyConstructionInfo","setActivationState","Project","threeGraphicsConfig","antialias","usePhysics","projectConfig","firstSceneKey","plug","devicePixelRatio","eventMatrix","move","maxTouchPoints","Tap","_isDown","_isPaused","active","touch","mouse","registered","_currentPosition","_lastPosition","_isPointerLockAvailable","_add","pause","resume","_onPointerLockChange","onceChange","request","pointerLock","isLocked","requestPointerLock","exit","exitPointerLock","available","pointerLockElement","_onDown","_onMove","_onUp","_remove","_calcPosition","movementX","movementY","_position","_removeDuplicates","dragging","roundRect","beginPath","arcTo","closePath","fontHeightCache","createNewTexture","orbitCtl","tap","messages","getParent","clearObjects","updateEvents","currentPosition","isDown","_objects","isTransparent","pixelPerfect","getPixel","imagedata","transformUv","imageData","removeIndex","findIndex","SimpleSprite","Sprite","SpriteMaterial","_event","_pixelPerfect","_isInteractive","_depth","_bodyOffset","_internalScale","_pixelRatio","onInputOver","onInputOut","onInputDown","_setTexture","setScale","setDepth","_calcZ","_onInputOver","_onInputOut","_onInputDown","pixelRatio","setInteractive","addEventListeners","setTexture","getBodyOffset","getScale","getPixelRatio","xx","yy","ActionSprite","_anims","_flipX","_frame","_currentIndex","_currentAnimationName","getAnimationByName","_play","_stop","getName","frameOptions","rate","timeline","clearInterval","loops","playNextFrame","setFrame","setInterval","onComplete","_eventEmitter","SpriteSheet","_tilesHoriz","_tilesVert","_width","_height","sizeFrame","scaleFrame","getRow","getColumn","offsetTexture","flipX","Button","overFrame","outFrame","downFrame","DrawTexture","drawCanvas","clearRect","DrawSprite","_drawCanvas","initEvents","setOrbitControls","setParent","TextTexture","styles","createTextImage","_text","_styles","_image","getText","getStyles","TextSprite","setStyles","setText","align","baseline","borderColor","borderWidth","fillStyle","fontFamily","fontSize","fontWeight","lineHeight","lineWidth","strokeStyle","offsetX","offsetY","paddingX","paddingY","lines","line_height","whiteSpace","offsetHeight","removeChild","calcHeight","line_width","measureText","calcWidth","stroke","textBaseline","strokeText","fillText","TextureAtlas","atlas","positionOffset","JSONHash","getFrame","frameName","newOffX","newOffY","sizeX","sizeY","debugSettings","dynamic","static","sensor","sleeping","adjustDebugColor","_fill","_stroke","isStatic","isSensor","isSleeping","getDebugColors","shouldFill","parts","part","Physics","debug","DEBUG","engine","Engine","enableSleeping","runner","Runner","pointerEvents","Render","wireframeBackground","wireframes","showConvexHulls","showPositions","showVelocity","World","parsePhysics","fixtures","addBodyFromFixtures","fixture","fromVertices","circle","Body","fromVertices_Fixed","vertexSets","Bodies","centre","setBounds","rectangle","sprite","bodyToSprite","calcBodyOffset","topLeft","_addBodyToSprite","circleRadius","scaleCircle_Fix","scaleBody_Fix","setBodyPosition","_addBody","JoyStick","addAxis","addButton","thumb","maxRadius","rotationDamping","moveDamping","maxRadiusSquared","offsetLeft","offsetTop","evt","stopPropagation","onMove","letter","click","onClick","onRelease","css","innerText","getMousePosition","ontouchmove","ontouchend","onmousemove","onmouseup","_evt","sqMag","magnitude","turn","touchend","targetTouches","ThirdPersonControls","sensitivity","targetRadius","interpolationFactor","maxPhi","minPhi","FirstPersonControls","PointerLock","_element","autoLock","removeListeners","pointerLockChangeHandler","pointerDownHandlerHandler","_request","PointerDrag","_onMoveCallback","_isPointerDown","isTouchDevice","onTouchEnd","onPointerLeave","onPointerOver","onMoveCallback","CopyShader","Pass","needsSwap","renderToScreen","_geometry","FullScreenQuad","_mesh","ShaderPass","textureID","fsQuad","writeBuffer","readBuffer","autoClearColor","autoClearDepth","autoClearStencil","MaskPass","writeValue","clearValue","setLocked","stencil","setTest","setOp","REPLACE","setFunc","ALWAYS","setClear","EQUAL","KEEP","ClearMaskPass","EffectComposer","RGBAFormat","getSize","renderTarget1","renderTarget2","passes","copyPass","swapBuffers","addPass","pass","insertPass","removePass","isLastEnabledPass","passIndex","maskActive","NOTEQUAL","effectiveWidth","effectiveHeight","RenderPass","overrideMaterial","clearColor","clearAlpha","clearDepth","_oldClearColor","oldAutoClear","oldClearAlpha","oldOverrideMaterial","getClearColor","getClearAlpha","setClearColor","DigitalGlitch","GlitchPass","dt_size","generateHeightmap","goWild","curF","generateTrigger","randX","data_arr","DataTexture","FloatType","DotScreenShader"],"sourceRoot":""}